/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 @license  MIT
*/
var $jscomp$templatelit$1=['\n    <ul class="','">\n      ',"\n    </ul>\n  "];$jscomp$templatelit$1.raw=$jscomp$templatelit$1.slice();var $jscomp$templatelit$0=['\n        <li class="','">',"</li>\n      "];$jscomp$templatelit$0.raw=$jscomp$templatelit$0.slice();var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(m){var t=0;return function(){return t<m.length?{done:!1,value:m[t++]}:{done:!0}}};$jscomp.arrayIterator=function(m){return{next:$jscomp.arrayIteratorImpl(m)}};
$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(m,t,n){m!=Array.prototype&&m!=Object.prototype&&(m[t]=n.value)};$jscomp.getGlobal=function(m){return"undefined"!=typeof window&&window===m?m:"undefined"!=typeof global&&null!=global?global:m};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(m,t){this.$jscomp$symbol$id_=m;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:t})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function m(n){if(this instanceof m)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(n||"")+"_"+t++,n)}var t=0;return m}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var m=$jscomp.global.Symbol.iterator;m||(m=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[m]&&$jscomp.defineProperty(Array.prototype,m,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var m=$jscomp.global.Symbol.asyncIterator;m||(m=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(m){$jscomp.initSymbolIterator();m={next:m};m[$jscomp.global.Symbol.iterator]=function(){return this};return m};
$jscomp.makeIterator=function(m){var t="undefined"!=typeof Symbol&&Symbol.iterator&&m[Symbol.iterator];return t?t.call(m):$jscomp.arrayIterator(m)};$jscomp.arrayFromIterator=function(m){for(var t,n=[];!(t=m.next()).done;)n.push(t.value);return n};$jscomp.arrayFromIterable=function(m){return m instanceof Array?m:$jscomp.arrayFromIterator($jscomp.makeIterator(m))};$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(m){var t=function(){};t.prototype=m;return new t};
$jscomp.underscoreProtoCanBeSet=function(){var m={a:!0},t={};try{return t.__proto__=m,t.a}catch(n){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(m,t){m.__proto__=t;if(m.__proto__!==t)throw new TypeError(m+" is not extensible");return m}:null;
$jscomp.inherits=function(m,t){m.prototype=$jscomp.objectCreate(t.prototype);m.prototype.constructor=m;if($jscomp.setPrototypeOf){var n=$jscomp.setPrototypeOf;n(m,t)}else for(n in t)if("prototype"!=n)if(Object.defineProperties){var h=Object.getOwnPropertyDescriptor(t,n);h&&Object.defineProperty(m,n,h)}else m[n]=t[n];m.superClass_=t.prototype};
$jscomp.polyfill=function(m,t,n,h){if(t){n=$jscomp.global;m=m.split(".");for(h=0;h<m.length-1;h++){var l=m[h];l in n||(n[l]={});n=n[l]}m=m[m.length-1];h=n[m];t=t(h);t!=h&&null!=t&&$jscomp.defineProperty(n,m,{configurable:!0,writable:!0,value:t})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(m){function t(){this.batch_=null}function n(b){return b instanceof l?b:new l(function(a,c){a(b)})}if(m&&!$jscomp.FORCE_POLYFILL_PROMISE)return m;t.prototype.asyncExecute=function(b){if(null==this.batch_){this.batch_=[];var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})}this.batch_.push(b)};var h=$jscomp.global.setTimeout;t.prototype.asyncExecuteFunction=function(b){h(b,0)};t.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var b=
this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var c=b[a];b[a]=null;try{c()}catch(g){this.asyncThrow_(g)}}}this.batch_=null};t.prototype.asyncThrow_=function(b){this.asyncExecuteFunction(function(){throw b;})};var l=function(b){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{b(a.resolve,a.reject)}catch(c){a.reject(c)}};l.prototype.createResolveAndReject_=function(){function b(g){return function(b){c||(c=!0,g.call(a,b))}}var a=this,c=!1;
return{resolve:b(this.resolveTo_),reject:b(this.reject_)}};l.prototype.resolveTo_=function(b){if(b===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof l)this.settleSameAsPromise_(b);else{a:switch(typeof b){case "object":var a=null!=b;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(b):this.fulfill_(b)}};l.prototype.resolveToNonPromiseObj_=function(b){var a=void 0;try{a=b.then}catch(c){this.reject_(c);return}"function"==typeof a?
this.settleSameAsThenable_(a,b):this.fulfill_(b)};l.prototype.reject_=function(b){this.settle_(2,b)};l.prototype.fulfill_=function(b){this.settle_(1,b)};l.prototype.settle_=function(b,a){if(0!=this.state_)throw Error("Cannot settle("+b+", "+a+"): Promise already settled in state"+this.state_);this.state_=b;this.result_=a;this.executeOnSettledCallbacks_()};l.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var b=0;b<this.onSettledCallbacks_.length;++b)e.asyncExecute(this.onSettledCallbacks_[b]);
this.onSettledCallbacks_=null}};var e=new t;l.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};l.prototype.settleSameAsThenable_=function(b,a){var c=this.createResolveAndReject_();try{b.call(a,c.resolve,c.reject)}catch(g){c.reject(g)}};l.prototype.then=function(b,a){function c(d,a){return"function"==typeof d?function(a){try{g(d(a))}catch(v){e(v)}}:a}var g,e,d=new l(function(d,a){g=d;e=a});this.callWhenSettled_(c(b,g),c(a,e));return d};
l.prototype.catch=function(b){return this.then(void 0,b)};l.prototype.callWhenSettled_=function(b,a){function c(){switch(g.state_){case 1:b(g.result_);break;case 2:a(g.result_);break;default:throw Error("Unexpected state: "+g.state_);}}var g=this;null==this.onSettledCallbacks_?e.asyncExecute(c):this.onSettledCallbacks_.push(c)};l.resolve=n;l.reject=function(b){return new l(function(a,c){c(b)})};l.race=function(b){return new l(function(a,c){for(var g=$jscomp.makeIterator(b),e=g.next();!e.done;e=g.next())n(e.value).callWhenSettled_(a,
c)})};l.all=function(b){var a=$jscomp.makeIterator(b),c=a.next();return c.done?n([]):new l(function(g,b){function d(d){return function(a){e[d]=a;q--;0==q&&g(e)}}var e=[],q=0;do e.push(void 0),q++,n(c.value).callWhenSettled_(d(e.length-1),b),c=a.next();while(!c.done)})};return l},"es6","es3");$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(m){if(!(m instanceof Object))throw new TypeError("Iterator result "+m+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(m){this.yieldResult=m};$jscomp.generator.Context.prototype.throw_=function(m){this.abruptCompletion_={exception:m,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(m){this.abruptCompletion_={return:m};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(m){this.abruptCompletion_={jumpTo:m};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(m,t){this.nextAddress=t;return{value:m}};$jscomp.generator.Context.prototype.yieldAll=function(m,t){m=$jscomp.makeIterator(m);var n=m.next();$jscomp.generator.ensureIteratorResultIsObject_(n);if(n.done)this.yieldResult=n.value,this.nextAddress=t;else return this.yieldAllIterator_=m,this.yield(n.value,t)};
$jscomp.generator.Context.prototype.jumpTo=function(m){this.nextAddress=m};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(m,t){this.catchAddress_=m;void 0!=t&&(this.finallyAddress_=t)};$jscomp.generator.Context.prototype.setFinallyBlock=function(m){this.catchAddress_=0;this.finallyAddress_=m||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(m,t){this.nextAddress=m;this.catchAddress_=t||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(m){this.catchAddress_=m||0;m=this.abruptCompletion_.exception;this.abruptCompletion_=null;return m};$jscomp.generator.Context.prototype.enterFinallyBlock=function(m,t,n){n?this.finallyContexts_[n]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=m||0;this.finallyAddress_=t||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(m,t){t=this.finallyContexts_.splice(t||0)[0];if(t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();void 0!=t.jumpTo&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=m};$jscomp.generator.Context.prototype.forIn=function(m){return new $jscomp.generator.Context.PropertyIterator(m)};
$jscomp.generator.Context.PropertyIterator=function(m){this.object_=m;this.properties_=[];for(var t in m)this.properties_.push(t);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var m=this.properties_.pop();if(m in this.object_)return m}return null};$jscomp.generator.Engine_=function(m){this.context_=new $jscomp.generator.Context;this.program_=m};
$jscomp.generator.Engine_.prototype.next_=function(m){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,m,this.context_.next_);this.context_.next_(m);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(m){this.context_.start_();var t=this.context_.yieldAllIterator_;if(t)return this.yieldAllStep_("return"in t?t["return"]:function(m){return{value:m,done:!0}},m,this.context_.return);this.context_.return(m);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(m){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],m,this.context_.next_);this.context_.throw_(m);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(m,t,n){try{var h=m.call(this.context_.yieldAllIterator_,t);$jscomp.generator.ensureIteratorResultIsObject_(h);if(!h.done)return this.context_.stop_(),h;var l=h.value}catch(e){return this.context_.yieldAllIterator_=null,this.context_.throw_(e),this.nextStep_()}this.context_.yieldAllIterator_=null;n.call(this.context_,l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var m=this.program_(this.context_);if(m)return this.context_.stop_(),{value:m.value,done:!1}}catch(t){this.context_.yieldResult=void 0,this.context_.throw_(t)}this.context_.stop_();if(this.context_.abruptCompletion_){m=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(m.isException)throw m.exception;return{value:m.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(m){this.next=function(t){return m.next_(t)};this.throw=function(t){return m.throw_(t)};this.return=function(t){return m.return_(t)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(m,t){t=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(t));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(t,m.prototype);return t};
$jscomp.asyncExecutePromiseGenerator=function(m){function t(h){return m.next(h)}function n(h){return m.throw(h)}return new Promise(function(h,l){function e(b){b.done?h(b.value):Promise.resolve(b.value).then(t,n).then(e,l)}e(m.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(m){return $jscomp.asyncExecutePromiseGenerator(m())};$jscomp.asyncExecutePromiseGeneratorProgram=function(m){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(m)))};
$jscomp.iteratorFromArray=function(m,t){$jscomp.initSymbolIterator();m instanceof String&&(m+="");var n=0,h={next:function(){if(n<m.length){var l=n++;return{value:t(l,m[l]),done:!1}}h.next=function(){return{done:!0,value:void 0}};return h.next()}};h[Symbol.iterator]=function(){return h};return h};$jscomp.polyfill("Array.prototype.keys",function(m){return m?m:function(){return $jscomp.iteratorFromArray(this,function(m){return m})}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var m={},t=Object.create(new $jscomp.global.Proxy(m,{get:function(n,h,l){return n==m&&"q"==h&&l==t}}));return!0===t.q}catch(n){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(m,t){return Object.prototype.hasOwnProperty.call(m,t)};
$jscomp.polyfill("WeakMap",function(m){function t(){if(!m||!Object.seal)return!1;try{var a=Object.seal({}),c=Object.seal({}),d=new m([[a,2],[c,3]]);if(2!=d.get(a)||3!=d.get(c))return!1;d.delete(a);d.set(c,4);return!d.has(a)&&4==d.get(c)}catch(r){return!1}}function n(){}function h(a){var c=typeof a;return"object"===c&&null!==a||"function"===c}function l(a){if(!$jscomp.owns(a,b)){var c=new n;$jscomp.defineProperty(a,b,{value:c})}}function e(a){var c=Object[a];c&&(Object[a]=function(d){if(d instanceof
n)return d;l(d);return c(d)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(m&&$jscomp.ES6_CONFORMANCE)return m}else if(t())return m;var b="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var a=0,c=function(c){this.id_=(a+=Math.random()+1).toString();if(c){c=$jscomp.makeIterator(c);for(var b;!(b=c.next()).done;)b=b.value,this.set(b[0],b[1])}};c.prototype.set=function(a,c){if(!h(a))throw Error("Invalid WeakMap key");l(a);if(!$jscomp.owns(a,b))throw Error("WeakMap key fail: "+
a);a[b][this.id_]=c;return this};c.prototype.get=function(a){return h(a)&&$jscomp.owns(a,b)?a[b][this.id_]:void 0};c.prototype.has=function(a){return h(a)&&$jscomp.owns(a,b)&&$jscomp.owns(a[b],this.id_)};c.prototype.delete=function(a){return h(a)&&$jscomp.owns(a,b)&&$jscomp.owns(a[b],this.id_)?delete a[b][this.id_]:!1};return c},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(m){function t(){if($jscomp.ASSUME_NO_NATIVE_MAP||!m||"function"!=typeof m||!m.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),b=new m($jscomp.makeIterator([[a,"s"]]));if("s"!=b.get(a)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var e=b.entries(),d=e.next();if(d.done||d.value[0]!=a||"s"!=d.value[1])return!1;d=e.next();return d.done||4!=d.value[0].x||"t"!=d.value[1]||!e.next().done?!1:!0}catch(r){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(m&&$jscomp.ES6_CONFORMANCE)return m}else if(t())return m;$jscomp.initSymbolIterator();var n=new WeakMap,h=function(a){this.data_={};this.head_=b();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};h.prototype.set=function(a,b){a=0===a?0:a;var c=l(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};h.prototype.delete=function(a){a=l(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};h.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=b();this.size=0};h.prototype.has=function(a){return!!l(this,a).entry};
h.prototype.get=function(a){return(a=l(this,a).entry)&&a.value};h.prototype.entries=function(){return e(this,function(a){return[a.key,a.value]})};h.prototype.keys=function(){return e(this,function(a){return a.key})};h.prototype.values=function(){return e(this,function(a){return a.value})};h.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};h.prototype[Symbol.iterator]=h.prototype.entries;var l=function(c,b){var g=b&&typeof b;"object"==
g||"function"==g?n.has(b)?g=n.get(b):(g=""+ ++a,n.set(b,g)):g="p_"+b;var d=c.data_[g];if(d&&$jscomp.owns(c.data_,g))for(c=0;c<d.length;c++){var e=d[c];if(b!==b&&e.key!==e.key||b===e.key)return{id:g,list:d,index:c,entry:e}}return{id:g,list:d,index:-1,entry:void 0}},e=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},b=function(){var a={};return a.previous=
a.next=a.head=a},a=0;return h},"es6","es3");$jscomp.polyfill("Object.is",function(m){return m?m:function(m,n){return m===n?0!==m||1/m===1/n:m!==m&&n!==n}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(m){return m?m:function(m,n){var h=this;h instanceof String&&(h=String(h));var l=h.length;n=n||0;for(0>n&&(n=Math.max(n+l,0));n<l;n++){var e=h[n];if(e===m||Object.is(e,m))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(m,t,n){if(null==m)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return m+""};$jscomp.polyfill("String.prototype.includes",function(m){return m?m:function(m,n){return-1!==$jscomp.checkStringArgs(this,m,"includes").indexOf(m,n||0)}},"es6","es3");
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(m,t){for(var n=1;n<arguments.length;n++){var h=arguments[n];if(h)for(var l in h)$jscomp.owns(h,l)&&(m[l]=h[l])}return m};$jscomp.polyfill("Object.assign",function(m){return m||$jscomp.assign},"es6","es3");$jscomp.polyfill("Math.log10",function(m){return m?m:function(m){return Math.log(m)/Math.LN10}},"es6","es3");
$jscomp.polyfill("Array.from",function(m){return m?m:function(m,n,h){n=null!=n?n:function(a){return a};var l=[],e="undefined"!=typeof Symbol&&Symbol.iterator&&m[Symbol.iterator];if("function"==typeof e){m=e.call(m);for(var b=0;!(e=m.next()).done;)l.push(n.call(h,e.value,b++))}else for(e=m.length,b=0;b<e;b++)l.push(n.call(h,m[b],b));return l}},"es6","es3");
$jscomp.findInternal=function(m,t,n){m instanceof String&&(m=String(m));for(var h=m.length,l=0;l<h;l++){var e=m[l];if(t.call(n,e,l,m))return{i:l,v:e}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(m){return m?m:function(m,n){return $jscomp.findInternal(this,m,n).v}},"es6","es3");$jscomp.polyfill("Array.prototype.entries",function(m){return m?m:function(){return $jscomp.iteratorFromArray(this,function(m,n){return[m,n]})}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(m){return m?m:function(m,n,h){var l=this.length||0;0>n&&(n=Math.max(0,l+n));if(null==h||h>l)h=l;h=Number(h);0>h&&(h=Math.max(0,l+h));for(n=Number(n||0);n<h;n++)this[n]=m;return this}},"es6","es3");
$jscomp.polyfill("Array.prototype.copyWithin",function(m){function t(m){m=Number(m);return Infinity===m||-Infinity===m?m:m|0}return m?m:function(m,h,l){var e=this.length;m=t(m);h=t(h);l=void 0===l?e:t(l);m=0>m?Math.max(e+m,0):Math.min(m,e);h=0>h?Math.max(e+h,0):Math.min(h,e);l=0>l?Math.max(e+l,0):Math.min(l,e);if(m<h)for(;h<l;)h in this?this[m++]=this[h++]:(delete this[m++],h++);else for(l=Math.min(l,e+h-m),m+=l-h;l>h;)--l in this?this[--m]=this[l]:delete this[--m];return this}},"es6","es3");
$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");
$jscomp.polyfill("Set",function(m){function t(){if($jscomp.ASSUME_NO_NATIVE_SET||!m||"function"!=typeof m||!m.prototype.entries||"function"!=typeof Object.seal)return!1;try{var h=Object.seal({x:4}),l=new m($jscomp.makeIterator([h]));if(!l.has(h)||1!=l.size||l.add(h)!=l||1!=l.size||l.add({x:4})!=l||2!=l.size)return!1;var e=l.entries(),b=e.next();if(b.done||b.value[0]!=h||b.value[1]!=h)return!1;b=e.next();return b.done||b.value[0]==h||4!=b.value[0].x||b.value[1]!=b.value[0]?!1:e.next().done}catch(a){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(m&&$jscomp.ES6_CONFORMANCE)return m}else if(t())return m;$jscomp.initSymbolIterator();var n=function(h){this.map_=new Map;if(h){h=$jscomp.makeIterator(h);for(var l;!(l=h.next()).done;)this.add(l.value)}this.size=this.map_.size};n.prototype.add=function(h){h=0===h?0:h;this.map_.set(h,h);this.size=this.map_.size;return this};n.prototype.delete=function(h){h=this.map_.delete(h);this.size=this.map_.size;return h};n.prototype.clear=function(){this.map_.clear();
this.size=0};n.prototype.has=function(h){return this.map_.has(h)};n.prototype.entries=function(){return this.map_.entries()};n.prototype.values=function(){return this.map_.values()};n.prototype.keys=n.prototype.values;n.prototype[Symbol.iterator]=n.prototype.values;n.prototype.forEach=function(h,l){var e=this;this.map_.forEach(function(b){return h.call(l,b,b,e)})};return n},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(m){return m?m:function(m,n){var h=$jscomp.checkStringArgs(this,m,"startsWith");m+="";var l=h.length,e=m.length;n=Math.max(0,Math.min(n|0,h.length));for(var b=0;b<e&&n<l;)if(h[n++]!=m[b++])return!1;return b>=e}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(m){return m?m:function(m,n){var h=$jscomp.checkStringArgs(this,m,"endsWith");m+="";void 0===n&&(n=h.length);n=Math.max(0,Math.min(n|0,h.length));for(var l=m.length;0<l&&0<n;)if(h[--n]!=m[--l])return!1;return 0>=l}},"es6","es3");
var EnxRtc=function(m){function t(h){if(n[h])return n[h].exports;var l=n[h]={i:h,l:!1,exports:{}};m[h].call(l.exports,l,l.exports,t);l.l=!0;return l.exports}var n={};t.m=m;t.c=n;t.d=function(h,l,e){t.o(h,l)||Object.defineProperty(h,l,{configurable:!1,enumerable:!0,get:e})};t.n=function(h){var l=h&&h.__esModule?function(){return h["default"]}:function(){return h};t.d(l,"a",l);return l};t.o=function(h,l){return Object.prototype.hasOwnProperty.call(h,l)};t.p="";return t(t.s=33)}([function(m,t,n){m=n(1);
var h=n.n(m),l=n(34),e=function(){var b=l().format("YYMMDDHHmmss")+"::";var a=function(a){console.log.apply(console,$jscomp.arrayFromIterable(a))};return{DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogLevel:function(a){console.log("setting log level:  old: "+e.logLevel+" new: "+a);if("string"===typeof a||"number"===typeof a){var b=a;"number"===typeof b?(b=Math.round(a),a>e.NONE?b=e.NONE:a<e.DEBUG&&(b=e.DEBUG),e.logLevel=b):-1<"DEBUG TRACE INFO WARNING ERROR NONE".split(" ").indexOf(b)?e.logLevel=
b:e.error("setLogLevel() invalid param")}else e.error("setLogLevel() invalid param type")},getLogLevel:function(a){return e.logLevel},setOutputFunction:function(b){a=b},setLogPrefix:function(a){b=a},log:function(c,g){for(var w=[],d=1;d<arguments.length;++d)w[d-1]=arguments[d];var r=b;if(!(c<e.logLevel)){c===e.DEBUG?r+="D":c===e.TRACE?r+="T":c===e.INFO?r+="I":c===e.WARNING?r+="W":c===e.ERROR&&(r+="E");r+="::WB::";d=h.a.getLocalStorageItem("logID");r+=null!=d?d:"";d=[r].concat(w);if(null!=h.a.getLocalStorageItem("vcxRTCLib-log")){var q=
JSON.parse(h.a.getLocalStorageItem("vcxRTCLib-log"));500<Object.keys(q).length&&delete Object.keys(q)[0];var l="",v;for(v in w)l="object"===typeof w[v]?l+JSON.stringify(w[v],null,2):l+w[v];q[r]=l;h.a.removeLocalStorageItem("vcxRTCLib-log");h.a.setLocalStorageItem("vcxRTCLib-log",JSON.stringify(q,null,2))}if(void 0!==e.panel){w="";for(v=0;v<d.length;v+=1)w+=d[v];e.panel.value=e.panel.value+"\n"+w}else a.apply(e,[d])}},debug:function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];e.log.apply(e,
[e.DEBUG].concat($jscomp.arrayFromIterable(b)))},trace:function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];e.log.apply(e,[e.TRACE].concat($jscomp.arrayFromIterable(b)))},info:function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];e.log.apply(e,[e.INFO].concat($jscomp.arrayFromIterable(b)))},warning:function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];e.log.apply(e,[e.WARNING].concat($jscomp.arrayFromIterable(b)))},error:function(a){for(var b=
[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];e.log.apply(e,[e.ERROR].concat($jscomp.arrayFromIterable(b)))}}}();e.logLevel=e.NONE;t.a=e},function(m,t,n){n(35);var h={};h.browser_info=function(){var b="none",a,c=window.navigator.userAgent;if(-1!=(a=c.indexOf("OPR")))var g="opera";else-1!=(a=c.indexOf("Firefox"))?g="mozilla":-1!=(a=c.indexOf("Edg"))?g="edge":-1!=(a=c.indexOf("Chrome"))?g="chrome-stable":-1!=c.indexOf("Safari")?(g="safari",-1!=(a=c.indexOf("Version"))&&(b=c.substring(a+8))):g=-1!=
(a=c.indexOf("MSIE"))||-1!=(a=c.indexOf("Windows NT"))?"IE":"none";if("none"==b&&-1!=a){var e=c.substring(a);-1!=(a=e.indexOf("/"))&&(b=e.substring(a+1))}var d;-1!=(d=b.indexOf(";"))&&(b=b.substring(0,d));-1!=(d=b.indexOf(" "))&&(b=b.substring(0,d));a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(c)?"mobile":"desktop";return{name:g,version:b,device_type:a}}();h.is_supported=!(void 0===RTCPeerConnection||!/chrome-stable|mozilla|safari|opera|edge/i.test(h.browser_info.name));
h.browser_type=window.navigator.userAgent.match("Chrome")?"chrome-stable":window.navigator.userAgent.match("Firefox")?"mozilla":window.navigator.userAgent.match(/Safari|AppleWebKit/g)?"safari":window.navigator.userAgent.match("Edge")?"edge":window.navigator.userAgent.match("Electron")?"electron":window.navigator.userAgent.match(".NET")?"IE":"none";h.device_type=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(window.navigator.userAgent)?"mobile":"desktop";
h.videoBitrateQualityMap;h.cameraResolutionTable;var l=function(b,a,c,g){var e=c;switch(a){case "get":e=b.getItem(c);break;case "set":b.setItem(c,g);break;case "remove":b.removeItem(c)}return e},e=function(b,a,c){try{return l(localStorage,b,a,c)}catch(g){if(void 0!=g.SecurityError)try{return l(sessionStorage,b,a,c)}catch(w){}return null}};m.exports={product:{company:"Vcloudx Inc",product:"enablex.io",version:"2.3.1",release:"2.3.1"},default_region:["IN"],data_throughput_duration:2,video_bandwidth_duration:10,
audio_bandwidth_duration:10,video_layer_bitrates:{0:3E5,1:8E5,2:15E5},video_resolution_range:{HD:{min:{width:320,height:180},max:{width:1280,height:720}},SD:{min:{width:320,height:180},max:{width:960,height:540}},LD:{min:{width:80,height:45},max:{width:640,height:360}},Default:{min:{width:80,height:45},max:{width:1280,height:720}}},video_bandwidth_range:{HD:{0:{min:100,max:1200},1:{min:100,max:800},2:{min:100,max:400}},SD:{0:{min:100,max:700},1:{min:100,max:400},2:{min:100,max:250}},LD:{0:{min:80,
max:400},1:{min:80,max:250},2:{min:80,max:150}},ND:{0:{min:0,max:0},1:{min:40,max:200},2:{min:40,max:100}},share:{min:100,max:400},canvas:{min:1024,max:4096}},screen_resolution_range:{HD:{bw:600,fps:20},SD:{bw:400,fps:15},LD:{bw:200,fps:10}},proxy_api_url:"apiproxy.enablex.io",proxy_api_port:443,ice_servers:{IN:{turnURI:"turns:ts.enablex.io:443",turnUsername:"vcxturn",turnCredential:"V201301",stunURI:"stun:stun.l.google.com:19302"},US:{turnURI:"turns:eu2ts.enablex.io:443",turnUsername:"vcxturn",turnCredential:"V201301",
stunURI:"stun:stun.l.google.com:19302"},SG:{turnURI:"turns:sgts.enablex.io:443",turnUsername:"vcxturn",turnCredential:"V201301",stunURI:"stun:stun.l.google.com:19302"},DE:{turnURI:"turns:gwcts.enablex.io:443",turnUsername:"vcxturn",turnCredential:"V201301",stunURI:"stun:stun.l.google.com:19302"}},browser_info:h.browser_info,browser_type:h.browser_type,device_type:h.device_type,user_agent:window.navigator.userAgent,is_supported:function(){return h.is_supported},setVideoBwQualityMapper:function(b){b.minBwKbpsToCheck&&
(h.videoBitrateQualityMap=b.bpsQualityMapTable.slice(),h.cameraResolutionTable=b.camResTable.slice());h.videoQualityMapMinBwKbps=b.minBwKbpsToCheck},getBitrateMapTable:function(){return h.videoBitrateQualityMap},getCamResolutionTable:function(){return h.cameraResolutionTable},getCamResTableToCheck:function(b){if(void 0!==h.videoBitrateQualityMap&&b<=h.videoQualityMapMinBwKbps)for(var a=0;a<h.videoBitrateQualityMap.length;a++)if(h.videoBitrateQualityMap[a].kbps<=b)return{resTable:h.cameraResolutionTable.slice(h.videoBitrateQualityMap[a].resTable.index),
fps:h.videoBitrateQualityMap[a].fps.max}},internetDetectionUrl:"https://api.enablex.io/status",getLocalStorageItem:function(b){return e("get",b)},setLocalStorageItem:function(b,a){return e("set",b,a)},removeLocalStorageItem:function(b){return e("remove",b)},senduserDataMaximumLimit:100,noise_analysis:!1,csp_enabled:!1,eventLogLevel:"error"}},function(m,t,n){var h=n(4);t.a=function(){var l=Object(h.c)({});l.url="";return l}},function(m,t,n){var h=function(l){var e=l.name;var b=l.src;var a=l.srcObject;
var c=l.href;var g=l.rel;var w=l.type;var d=l.target;var r=l.autoplay;var q=l.playsinline;var m=l.alt;var v=l.title;var p=l.id;var u=l.class;l=h.getStyle(l.style);var C=null;e&&""!=e&&null!=e&&(C=document.createElement(e),b&&""!=b&&null!=b&&C.setAttribute("src",b),a&&""!=a&&null!=a&&C.setAttribute("srcObject",a),c&&""!=c&&null!=c&&C.setAttribute("href",c),d&&""!=d&&null!=d&&C.setAttribute("target",d),m&&""!=m&&null!=m&&C.setAttribute("alt",m),v&&""!=v&&null!=v&&C.setAttribute("title",v),g&&""!=g&&
null!=g&&C.setAttribute("rel",g),w&&""!=w&&null!=w&&C.setAttribute("type",w),r&&""!=r&&null!=r&&C.setAttribute("autoplay",r),q&&""!=q&&null!=q&&C.setAttribute("playsinline",q),p&&""!=p&&null!=p&&C.setAttribute("id",p),u&&""!=u&&null!=u&&C.setAttribute("class",u),l&&""!=l&&null!=l&&C.setAttribute("style",l));return C};h.getStyle=function(h){var e="",b;for(b in h)e+=b+":"+h[b]+";";return e};h.getById=function(h){return document.getElementById(h)};h.getByClass=function(h){return document.getElementsByClassName(h)[0]};
h.getByTag=function(h){return document.getElementsByTagName(h)[0]};h.getTagByDOM=function(h,e){return e.getElementsByTagName(h)[0]};h.getByClass=function(h,e){return e.getElementsByClassName(h)[0]};h.append=function(h,e){return e.appendChild(h)};h.setStyle=function(h,e,b){h.style[e]=b};h.addCssFile=function(l){h.getByTag("head").appendChild(l)};h.checkParam=function(h){var e=!1;h&&null!=h&&""!=h&&(e=!0);return e};t.a=h},function(m,t,n){n.d(t,"c",function(){return e});n.d(t,"b",function(){return b});
n.d(t,"e",function(){return a});n.d(t,"f",function(){return c});n.d(t,"d",function(){return g});n.d(t,"g",function(){return w});n.d(t,"a",function(){return d});var h=n(0),l=n(7),e=function(){var a={},d={};a.addEventListener=function(a,b){void 0===d[a]&&(d[a]=[]);d[a].push(b)};a.removeEventListener=function(a,b){d[a]&&(b=d[a].indexOf(b),-1!==b&&d[a].splice(b,1))};if("IE"!==l.a.browserEngineCheck())a.dispatchEvent=function(a){if(!a||!a.type)throw Error("Undefined event");"onStatSubscription"!=a.type&&
"genericEvents"!=a.type&&"talker-notification"!=a.type&&h.a.debug("Event: "+a.type);for(var b=d[a.type]||[],c=0;c<b.length;c+=1)b[c](a)};else{var b=function(a,d){d=d||{bubbles:!1,cancelable:!1,detail:void 0};var b=document.createEvent("CustomEvent");b.initCustomEvent(a,d.bubbles,d.cancelable,d.detail);b.data=d.detail;return b};b.prototype=window.Event.prototype;window.CustomEvent=b;a.dispatchEvent=function(a){"onStatSubscription"!=a.type&&"genericEvents"!=a.type&&"talker-notification"!=a.type&&h.a.debug("Event: "+
a.type);a=b(a.type,{bubbles:!1,cancelable:!1,detail:a});document.getElementById("WebrtcEverywherePluginId").dispatchEvent(a)}}a.on=a.addEventListener;a.off=a.removeEventListener;a.emit=a.dispatchEvent;a.eventsList=d;return a},b=function(a){var d={};d.type=a.type;return d},a=function(a){var d=b(a);d.streams=a.streams;d.message=a.message;d.room=a.room;d.users=a.users;d.type=a.type;d.bandwidth=a.bandwidth;d.TalkerCount=a.TalkerCount;d.me=a.me;d.mediaRecord=a.mediaRecord;d.error=a.error;return d},c=function(a){var d=
b(a);d.stream=a.stream;d.msg=a.msg;d.bandwidth=a.bandwidth;d.attrs=a.attrs;return d},g=function(a){return b(a)},w=function(a){var d=b(a);d.name=a.name;d.role=a.role;d.clientId=a.clientId;d.permissions=a.permission;return d},d=function(a){var d=b(a);d.message=a.message;return d}},function(m,t,n){m={SocketEvent:{},RoomEvent:{},UserEvent:{},StreamEvent:{}};m.SocketEvent.onAddStream="onAddStream";m.SocketEvent.onRemoveTrack="onRemoveTrack";m.SocketEvent.media_engine_connecting="media_engine_connecting";
m.SocketEvent.signaling_message_peer="signaling_message_peer";m.SocketEvent.publish_me="publish_me";m.SocketEvent.unpublish_me="unpublish_me";m.SocketEvent.onBandwidthAlert="onBandwidthAlert";m.SocketEvent.onBandwidthEvents="bandwidthEvents";m.SocketEvent.onSelfBandwidthAlert="onSelfBandwidthAlert";m.SocketEvent.onDataStream="onDataStream";m.SocketEvent.onUpdateAttributeStream="onUpdateAttributeStream";m.SocketEvent.onRemoveStream="onRemoveStream";m.SocketEvent.disconnect="disconnect";m.SocketEvent.connection_failed=
"connection_failed";m.SocketEvent.error="error";m.SocketEvent.connect_error="connect_error";m.SocketEvent.connect_timeout="connect_timeout";m.SocketEvent.reconnecting="reconnecting";m.SocketEvent.reconnect="reconnect";m.SocketEvent.reconnected="reconnected";m.SocketEvent.reconnect_attempt="reconnect_attempt";m.SocketEvent.reconnect_error="reconnect_error";m.SocketEvent.reconnect_failed="reconnect_failed";m.SocketEvent.user_connected="user-connected";m.SocketEvent.user_updated="user-updated";m.SocketEvent.user_disconnected=
"user-disconnected";m.SocketEvent.user_subscribed="user-subscribed";m.SocketEvent.user_unsubscribed="user-unsubscribed";m.SocketEvent.dial_state_events="dialStateEvents";m.RoomEvent.user_role_changed="userRoleChanged";m.SocketEvent.onStatSubscription="onStatSubscription";m.SocketEvent.onStreamingNotification="onStreamingNotification";m.SocketEvent.onHlsStreamingNotification="onHlsStreamingNotification";m.SocketEvent.onHlsStreamingNotificationToPublisher="onHlsStreamingNotificationToPublisher";m.SocketEvent.onLiveRecordingNotification=
"onLiveRecordingNotification";m.SocketEvent.onRoomLiveRecordingOn="room-live-recording-on";m.SocketEvent.onRoomLiveRecordingOff="room-live-recording-off";m.SocketEvent.onRoomLiveRecordingFailed="room-live-recording-failed";m.SocketEvent.data_stream_room="onDataStreamToRoom";m.RoomEvent.onStreamingNotification="onStreamingNotification";m.RoomEvent.onHlsStreamingNotification="onHlsStreamingNotification";m.RoomEvent.onHlsStreamingNotificationToPublisher="onHlsStreamingNotificationToPublisher";m.RoomEvent.onLiveRecordingNotification=
"onLiveRecordingNotification";m.UserEvent.user_awaited="user-awaited";m.UserEvent.user_joined="user-joined";m.RoomEvent.room_connected="room-connected";m.RoomEvent.room_disconnected="room-disconnected";m.RoomEvent.room_awaited="room-awaited";m.RoomEvent.room_record_on="room-record-on";m.RoomEvent.room_record_off="room-record-off";m.RoomEvent.onRoomLiveRecordingOn="room-live-recording-on";m.RoomEvent.onRoomLiveRecordingOff="room-live-recording-off";m.RoomEvent.onRoomLiveRecordingFailed="room-live-recording-failed";
m.RoomEvent.update_layout="update-layout";m.RoomEvent.change_layout="change-layout";m.RoomEvent.new_active_talker="active-talkers-updated";m.RoomEvent.hard_mute_audio="hardmute-user-audio";m.RoomEvent.hard_unmute_audio="hardunmute-user-audio";m.RoomEvent.hard_mute_video="hardmute-user-video";m.RoomEvent.get_active_talker="getNumberOfTalker";m.RoomEvent.set_active_talker="setNumberOfTalker";m.RoomEvent.get_active_max_talker="getMaxNumberOfTalker";m.RoomEvent.set_adavanced_options="setAdvancedOptions";
m.RoomEvent.get_adavanced_options="getAdvancedOptions";m.RoomEvent.client_stats="clientStats";m.RoomEvent.switch_user_role="switchUserRole";m.RoomEvent.hard_unmute_video="hardunmute-user-video";m.RoomEvent.share_started="shareStarted";m.RoomEvent.share_stopped="shareStopped";m.RoomEvent.screen_share_override="shareOverride";m.RoomEvent.streaming_uri="streamingUri";m.RoomEvent.stop_sharing="stopSharing";m.RoomEvent.share_state_events="shareStateEvents";m.RoomEvent.extend_conference_duration="extendConferenceDuration";
m.RoomEvent.lock_room="lockRoom";m.RoomEvent.drop="drop";m.RoomEvent.subscriber_video_mute="subscriber-video-mute";m.RoomEvent.switch_codec="switch-publish-media-codec";m.RoomEvent.canvas_started="canvasStarted";m.RoomEvent.canvas_stopped="canvasStopped";m.RoomEvent.canvas_state_events="canvasStateEvents";m.RoomEvent.custom_data_saved="CustomDataSaved";m.RoomEvent.custom_data_updated="CustomDataUpdated";m.RoomEvent.transcription_events="transcription-events";m.RoomEvent.invite_breakout_room="invite-breakout-room";
m.RoomEvent.user_joined_breakout_room="user-joined-breakout-room";m.RoomEvent.user_left_breakout_room="breakout-user-disconnected";m.RoomEvent.breakout_room_destroyed="breakout-room-destroyed";m.RoomEvent.generic_events="genericEvents";m.RoomEvent.network_reconnected="network-reconnected";m.RoomEvent.network_disconnected="network-disconnected";m.RoomEvent.network_reconnectiontimeout="network-reconnect-timeout";m.RoomEvent.network_reconnectfailed="network-reconnect-failed";m.RoomEvent.fs_upload_started=
"fs-upload-started";m.RoomEvent.fs_file_uploaded="fs-file-available";m.RoomEvent.fs_download_started="fs-download-started";m.RoomEvent.fs_file_downloaded="fs-upload-success";m.RoomEvent.fs_file_upload_result="fs-upload-result";m.RoomEvent.fs_file_download_result="fs-download-result";m.SocketEvent.floor_management_events="floorManagementEvents";m.SocketEvent.room_management_events="roomManagementEvents";m.UserEvent.user_audio_muted="user-audio-muted";m.UserEvent.user_audio_unmuted="user-audio-unmuted";
m.UserEvent.user_video_muted="user-video-muted";m.UserEvent.user_video_unmuted="user-video-unmuted";m.SocketEvent.hard_mute="hardMute";m.SocketEvent.hard_mute_room="room-muted";m.SocketEvent.hard_unmute_room="room-unmuted";m.SocketEvent.switched_room="roomSwitched";m.constant={};m.constant.H264_CODEC="H264_AND_OPUS";m.constant.default="default";m.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8="12.0";m.constant.SAFARI_VERSION_SUPPORTING_VP8="12.1";m.constant.FIREFOX_VERSION_VIDEO_MUTE_SUPPORT="60.0";m.constant.CHROME_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT=
"72.0";m.constant.FIREFOX_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT="66.0";m.constant.SAFARI_VERSION_SCREEN_SHARE_SUPPORT="13.0.0";m.constant.FIREFOX_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT="64.0";m.constant.SAFARI_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT="13.1.0";m.constant.SAFARI_VERSION_DEVICE_CHANGE_EVENT_SUPPORT="11.0.0";t.a=m},function(m,t,n){t.a={error_000:{result:0,msg:"success"},error_1000:{result:1E3,msg:"Non supported browser"},error_1130:{result:1130,error:"Moderator not present/ wait for Moderator",
desc:""},error_1140:{result:1140,error:"Previous similar request in process",desc:""},error_1141:{result:1141,error:"Remote streams can't be muted",desc:""},error_1142:{result:1142,error:"Invalid Device Id",desc:"OverconstrainedError: Invalid device id provided"},error_1143:{result:1143,error:"Requested device not found",desc:"NotFoundError: Requested device was not found"},error_1144:{result:1144,error:"Permission denied",desc:"NotAllowedError: The request is not allowed by the user agent or the platform in the current context"},
error_1145:{result:1145,error:"Could not start video source",desc:"NotReadableError: Could not start video source"},error_1146:{result:1146,error:"Failed to execute getUserMedia on MediaDevices",desc:"TypeError: At least one of audio and video must be requested"},error_1147:{result:1147,error:"Constraints could be not satisfied",desc:"OverconstrainedError: Video width constraint could not be satisfied"},error_1148:{result:1148,error:"Constraints could be not satisfied",desc:"OverconstrainedError: Video height constraint could not be satisfied"},
error_1149:{result:1149,error:"Constraints could be not satisfied",desc:"One of the constraints (Height, Width, DeviceId) is not satisfied."},error_1150:{result:1150,error:"Reason unknown",desc:"Reason unknown"},error_1151:{result:1151,error:"A screen share is already running",desc:""},error_1152:{result:1152,error:"Audio only calls are allowed with your current browser version",desc:""},error_1153:{result:1153,error:"Unsupported browser",desc:""},error_1154:{result:1154,error:"Given frame rate is not supported",
desc:"Frame rate might be negative or not a number which is not accepted by captureStream method"},error_1155:{result:1155,error:"Invalid options/parameters",desc:"Invalid options parameters "},error_1156:{result:1156,error:"Invalid streamType",desc:" streamType  should be set as canvas for canvas streams and talker for talker streams"},error_1157:{result:1157,error:"The given canvas element does not exist in the DOM",desc:"The canvas element you have provided does not exist in the DOM"},error_1158:{result:1158,
error:"This browser does not support canvas",desc:"This browser does not support canvas"},error_1159:{result:1159,error:"Stream not found",desc:"Stream not found"},error_1160:{result:1160,error:"Media connection failure",desc:"Media connection failure"},error_1161:{result:1161,error:"Server connection failure",desc:"Server connection failure"},error_1162:{result:1162,error:"The DOM element does not exist",desc:"The element with DOM reference provided does not exist"},error_1163:{result:1163,error:"Network disconnected",
desc:"Socket or media connection has failed due to network error"},error_1164:{result:1164,error:"Network reconnected",desc:"Network reconnected"},error_1165:{result:1165,error:"Reconnect attempt exceeded",desc:"Reconnection failed"},error_1166:{result:1166,error:"Reconnection timed out",desc:"Reconnection failed"},error_1167:{result:1167,error:"Publish or subscribe failed",desc:"After reconnection publish or subscibe failed"},error_1168:{result:1168,error:"Not allowed",desc:"Only moderator has rights to excercise this transaction"},
error_1169:{result:1169,msg:"No listener for event",desc:""},error_1170:{result:1170,error:"Not supported",desc:"Feature is not enabled because of room config or no licence "},error_1171:{result:1171,error:"Room not connected",desc:"Room not connected"},error_1172:{result:1172,error:"Room connect failed",desc:"Room connect failed"},error_1173:{result:1173,error:"Floor not granted for participant",desc:"Floor not granted"},error_1174:{result:1174,error:"Local Recording started already",desc:""},error_1175:{result:1175,
error:"Local Recording not started /stream not having media",desc:""},error_1176:{result:1176,error:"Moderator declined right to control media devices ",desc:""},error_1177:{result:1177,error:"MediaDevice state is already in same state",desc:""},error_1178:{result:1178,error:"Reconnection for a single participant in the room is not allowed",desc:"Reconnection not allowed"},error_1179:{result:1179,error:" files to upload input array size is 0",desc:" empty file transfer is not allowed"},error_1180:{result:1180,
error:" room is disconected",desc:" file sharing is not allowed on disconnected rooms"},error_1181:{result:1181,error:" Recieve file operation is not permitted.",desc:" File which you are trying to receive  does not exist."},error_1182:{result:1182,error:"file upload failed",desc:"file upload failed "},error_1183:{result:1183,error:" file download failed ",desc:" file download failed"},error_1184:{result:1184,error:"user video resolution inavlid range",desc:"user video resolution inavlid range"},
error_1185:{result:1185,error:"file upload failed ",desc:"file upload failed because provided file list is empty"},error_1186:{result:1186,error:"file upload failed ",desc:"file size is zero bytes"},error_1187:{result:1187,error:"file upload failed ",desc:"file upload failed because it exceeded max upload limit"},error_1188:{result:1188,error:"current state and requested state are same",desc:"current state and requested state are same"},error_1189:{result:1189,error:"Media device switching not allowed in mute state",
desc:""},error_4121:{result:4121,error:"room already locked / unlocked",desc:" room is already locked/unlocked"},error_7000:{result:7E3,error:"streaming error",desc:" streaming error"},error_7008:{result:7008,error:"streaming error",desc:"only moderator can start streaming"},error_7009:{result:7009,error:"streaming error",desc:"invalid or undefined streaming configuration"},error_7101:{result:7101,error:"streaming error",desc:"rtmpUrl should not exceed more than 3 values"},error_7102:{result:7102,
error:"streaming error",desc:"invalid rtmp or url format"},error_7103:{result:7103,error:"streaming error",desc:"room is disconnecting, cannot start streaming"},error_7044:{result:7044,error:"streaming error",desc:"only moderator can stop streaming"},error_7045:{result:7045,error:"streaming error",desc:"room is disconnecting, streaming will be stopped"},error_7072:{result:7072,error:"streaming params change error",desc:"only moderator can change streaming params"},error_7078:{result:7078,error:"streaming params change error",
desc:"room is disconnecting, cannot change streaming params"},error_7201:{result:7201,error:"live recording error",desc:"only moderator can start live recording"},error_7202:{result:7202,error:"live recording error",desc:"invalid url format"},error_7203:{result:7203,error:"live recording error",desc:"room is disconnecting, cannot start live recording"},error_7204:{result:7204,error:"live recording error",desc:"live recording error"},error_7036:{result:7036,error:"live recording error",desc:"only moderator can stop live recording"},
error_7037:{result:7037,error:"live recording error",desc:"room is disconnecting, live recording will be stopped"},error_7079:{result:7079,error:"room is disconected",desc:"Layout update is not allowed on disconnected rooms"},error_7071:{result:7071,error:"live recording error",desc:"only moderator can change live recording params"},error_8000:{result:8E3,error:"invalidate transcoding error",desc:"Room is disconnecting, invalidate transcoding cannot be performed now"},error_8001:{result:8001,error:"Live transcription is already in progress",
desc:"Live transcription is already in progress"},error_8002:{result:8002,error:"Live transcription is not running",desc:"Live transcription is not started"},CC002:{cause:2002,msg:"unexpected-disconnection"},CC006:{cause:2006,msg:"normal-disconnect"},error_1190:{result:1190,error:"Exception found",desc:"Could not fetch video size"},error_1191:{result:1191,error:"Stream track ended state ",desc:"Stream track is already ended"},error_1192:{result:1192,error:"Invalid parameters",desc:"Invalid value for layout parameter"},
error_1193:{result:1193,error:"Invalid parameters",desc:"Invalid value for service parameter"},error_1194:{result:1194,error:"Invalid parameters",desc:"Invalid value for clients parameter"},error_1195:{result:1195,error:"Large text Data",desc:"Failed to handle larger text-data"}}},function(m,t,n){(function(h){var l=n(37),e=n(38),b=n(39),a=n(0),c=n(26),g=n(6),w=n(5),d=n(8),r=n(9),q=103,m,v=!1,p={deviceList:void 0},u=function(){var a="none";"undefined"!==typeof h&&h.exports?a="fake":null!==window.navigator.userAgent.match("Firefox")?
a="mozilla":null!==window.navigator.userAgent.match("Chrome")?(a="chrome-stable",null!==window.navigator.userAgent.match("Electron")?a="electron":null!==window.navigator.userAgent.match("Edge")&&(a="edge")):null!==window.navigator.userAgent.match("Safari")?a="safari":null!==window.navigator.userAgent.match("AppleWebKit")?a="safari":null!==window.navigator.userAgent.match(".NET")&&(a="IE");return a},C=function(){var a=navigator.userAgent,d=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||
[];if(/trident/i.test(d[1])){var b=/\brv[ :]+(\d+)/g.exec(a)||[];return"IE "+(b[1]||"")}if("Chrome"===d[1]&&(b=a.match(/\b(OPR|Edge)\/(\d+)/),null!=b))return b.slice(1).join(" ").replace("OPR","Opera");d=d[2]?d[2]:navigator.appVersion;null!=(b=a.match(/version\/([^\s]+)/i))&&(d=b[1]);return d},B=function(a){var d=C();if("string"!==typeof a)return!1;d=d.split(".");a=a.split(".");for(var b=Math.min(d.length,a.length),c=0;c<b;++c){d[c]=parseInt(d[c],10);a[c]=parseInt(a[c],10);if(d[c]>a[c])return!1;if(d[c]<
a[c])return!0}return d.length==a.length?!1:!(d.length<a.length)},z=function(a){for(var d={cam:[],mic:[],speaker:[]},b=0;b<a.length;b++)switch(a[b].kind){case "audioinput":d.mic.push(a[b]);break;case "videoinput":d.cam.push(a[b]);break;case "audiooutput":d.speaker.push(a[b])}return d},F=function(a){var d={cam:[],mic:[],speaker:[]},b={cam:[],mic:[],speaker:[]},c={cam:[],mic:[],speaker:[]};if(void 0!==p.deviceList){b=JSON.parse(JSON.stringify(p.deviceList));for(var f in a.cam){var g=!1,e;for(e in b.cam)a.cam[f].deviceId===
b.cam[e].deviceId&&(c.cam.push(b.cam.splice(e,1)[0]),g=!0);!1===g&&d.cam.push(a.cam[f])}for(var h in a.mic){g=!1;for(var q in b.mic)a.mic[h].groupId===b.mic[q].groupId&&(c.mic.push(b.mic.splice(q,1)[0]),g=!0);!1===g&&d.mic.push(a.mic[h])}for(var u in a.speaker){g=!1;for(var r in b.speaker)a.speaker[u].groupId===b.speaker[r].groupId&&(c.speaker.push(b.speaker.splice(r,1)[0]),g=!0);!1===g&&d.speaker.push(a.speaker[u])}p.deviceList=a}return{current:c,added:d,removed:b}},f=function(b,p,k){k=void 0===
k?!0:k;"IE"===u()||"edge"===u()?(r.a.error("agent-event",d.a.event_incompatible_browser,{error:g.a.error_1153}),p(null,g.a.error_1153)):v&&"safari"===u()?p("success",null):navigator.mediaDevices.getUserMedia(b).then(function(a){v=!0;p(a,null)}).catch(function(e){e=Object(c.a)(e);r.a.error("agent-event",d.a.event_gum_failed,{error:e});if(!k||e.result!==g.a.error_1143.result&&e.result!==g.a.error_1144.result)a.a.error("Failed to get media devices : "+JSON.stringify(e)),p(null,e);else if(b.video&&b.audio){var h=
JSON.parse(JSON.stringify(b));h.video=!1;h.videoConfigured=b.video;a.a.warning("getUserMedia() failed with error: "+JSON.stringify(e)+" retry with audio-only");f(h,p)}else b.video||void 0==b.videoConfigured?(a.a.error("Failed to get media devices permission: "+JSON.stringify(e)),p(null,e)):(h=JSON.parse(JSON.stringify(b)),h.video=b.videoConfigured,h.audio=!1,console.log("getUserMedia() failed with error: "+JSON.stringify(e)+" retry with video-only"),f(h,p))})},O=function(a){navigator.mediaDevices.enumerateDevices().then(function(d){a(d)})},
x=function(a,d){void 0==d||"speaker"!=d?f({audio:!0,video:!0},function(d,b){d||b&&b.result===g.a.error_1145.result?O(function(d,c){d?(d=z(d),a({result:0,devices:d})):a(b&&b.result===g.a.error_1145.result?b:c)}):f({audio:!0,video:!0},function(d,b){a(b)},!1)}):O(function(d,b){d&&(d=z(d),a({result:0,devices:d}))})},P=function(){return document.getElementById("WebrtcEverywherePluginId")},I=function(a,d,b,c){a.addEventListener(d,b,c)};t.a={GetUserMedia:function(b,c,f){c=void 0===c?function(){}:c;f=void 0===
f?function(){}:f;var g,k=u();if("chrome-stable"===k||"electron"===k||"mozilla"===k||"safari"===k){var p=function(a,d,b){navigator.mediaDevices.getUserMedia(a).then(d).catch(b)};var e=function(a,d,b){navigator.getDisplayMedia?navigator.getDisplayMedia({video:!0}).then(d).catch(b):navigator.mediaDevices.getDisplayMedia(a).then(d).catch(b)}}else p=navigator.getUserMedia=function(a,d,b){"complete"!==document.readyState?m||(m=!0,I(document,"readystatechange",function(){m&&"complete"==document.readyState&&
(m=!1,P().getUserMedia(a,d,b))})):P().getUserMedia(a,d,b)};k=function(){a.a.debug("Screen access requested");switch(u()){case "electron":a.a.debug("Screen sharing in Electron");g={};g.video=b.video||{};g.video.mandatory=b.video.mandatory||{};g.video.mandatory.chromeMediaSource="screen";p(g,c,f);break;case "mozilla":a.a.debug("Screen sharing in Firefox max fps: 5");g={};void 0!==b.video?(g.video={},g.video.mediaSource="window"):g={audio:b.audio,video:{mediaSource:"window"}};B(w.a.constant.FIREFOX_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT)?
p(g,c,f):(g.video={framerate:{max:b.fps}},e(g,c,f));break;case "safari":B(w.a.constant.SAFARI_VERSION_SCREEN_SHARE_SUPPORT)?(a.a.error("Screen Sharing not supported for safari version: "+C()),r.a.error("agent-event",d.a.event_incompatible_browser,{error:"This safari version does not support ScreenSharing"})):(a.a.debug("Screen sharing  Safari "),e({video:!0},c,f));break;case "chrome-stable":a.a.debug("Screen sharing in Chrome");g={};if(b.desktopStreamId)g.video=b.video||{mandatory:{}},g.video.mandatory=
g.video.mandatory||{},g.video.mandatory.chromeMediaSource="desktop",g.video.mandatory.chromeMediaSourceId=b.desktopStreamId,g.video.mandatory.chromeMediaSourceId=b.desktopStreamId,p(g,c,f);else if(B(w.a.constant.CHROME_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT)){var k="apedaiecomcfkjdjbnkfcdafaikkdkeo";b.extensionId&&(a.a.debug("extensionId supplied, using "+b.extensionId),k=b.extensionId);a.a.debug("Screen access on chrome stable, looking for extension");try{chrome.runtime.sendMessage(k,{getStream:!0},
function(d){void 0===d?(a.a.error("Access to screen denied"),f({code:"Access to screen denied"})):(d=d.streamId,void 0!==b.video.mandatory?(g.video=b.video,g.video.mandatory.chromeMediaSource="desktop",g.video.mandatory.chromeMediaSourceId=d):g={video:{mandatory:{maxFrameRate:b.fps,chromeMediaSource:"desktop",chromeMediaSourceId:d}}},p(g,c,f))})}catch(K){a.a.debug("Screensharing plugin is not accessible "),r.a.error("agent-event",d.a.event_incompatible_browser,{error:"Screensharing plugin is not accessible"}),
f({code:"no_plugin_present"})}}else a.a.debug("Screen sharing in Chrome without extension max Fps:: 3"),g.video={frameRate:{max:b.fps}},void 0!=b.audio&&!1!==b.audio&&(g.audio=!0),e(g,c,f);break;default:a.a.error("This browser does not support ScreenSharing"),r.a.error("agent-event",d.a.event_incompatible_browser,{error:"This browser does not support ScreenSharing"})}};b.screen?k():"undefined"!==typeof h&&h.exports?a.a.error("Video/audio streams not supported in controller yet"):(a.a.debug("Calling getUserMedia with config",
JSON.stringify(b)),p(b,c,f))},buildPair:function(c){var f={};q+=1;c.sessionId=q;f.browser=u();if("fake"===f.browser)a.a.warning("Publish/subscribe video/audio streams not supported in media yet"),r.a.warn("agent-event",d.a.event_incompatible_browser,{error:"Publish/subscribe video/audio streams not supported in media yet"}),f=Object(b.a)(c);else if("mozilla"===f.browser)a.a.debug("Firefox Stack"),f=Object(e.a)(c);else if("safari"===f.browser)a.a.debug("Safari using Chrome Stable Stack"),f=Object(l.a)(c);
else if("chrome-stable"===f.browser||"electron"===f.browser)a.a.debug("Chrome Stable Stack"),f=Object(l.a)(c);else if("IE"===f.browser)a.a.debug("IE using Chrome Stable Stack"),f=Object(l.a)(c);else throw a.a.error("No stack available for this browser"),r.a.error("agent-event",d.a.event_incompatible_browser,{error:"No stack available for this browser"}),Error("WebRTC stack not available");f.updateSpec||(f.updateSpec=function(b,c){c=void 0===c?function(){}:c;a.a.error("Update Configuration not implemented in this browser");
r.a.error("agent-event",d.a.event_incompatible_browser,{error:"Update Configuration not implemented in this browser"});c("unimplemented")});return f},browserEngineCheck:u,getAndroidVersion:function(){var a=navigator.userAgent;return 0<=a.indexOf("Android")?parseFloat(a.slice(a.indexOf("Android")+8)):!1},mediaDeviceUpdate:function(a,d){void 0!=p.changedDevicesCallbacks?(void 0!=d&&1==d&&(p.changedDevicesCallbacks=[]),p.changedDevicesCallbacks.push(a)):(void 0===p.deviceList&&x(function(a){p.deviceList=
a.devices}),p.changedDevicesCallbacks=[],p.changedDevicesCallbacks.push(a),"safari"===u()&&B(w.a.constant.SAFARI_VERSION_DEVICE_CHANGE_EVENT_SUPPORT)?setInterval(function(){x(function(a){if(void 0===p.deviceList)p.deviceList=a.devices;else{var d=F(a.devices);p.changedDevicesCallbacks.forEach(function(a){return a(d)})}})},3E3):navigator.mediaDevices.ondevicechange=function(a){if(void 0==p.receivedDC||1!=p.receivedDC)p.receivedDC=!0,setTimeout(function(){p.receivedDC=!1;x(function(a){if(0==a.result)if(void 0===
p.deviceList)p.deviceList=a.devices;else{var d=F(a.devices);p.changedDevicesCallbacks.forEach(function(a){return a(d)})}else console.log("ondevicechange() getDeviceList failed error: "+JSON.stringify(a))})},500)})},getDeviceList:x,getBrowserVersion:C,GetCanvasStream:function(b,c,f){c=void 0===c?function(){}:c;f=void 0===f?function(){}:f;var k=null,p=null,e=u();if(b.canvas)if("chrome-stable"===e||"mozilla"===e||"safari"===e){if(void 0!==b.canvas.fps&&0<b.canvas.fps)var h=b.canvas.fps;else if(void 0!==
b.canvas.fps){a.a.error("Framerate is invalid is: ",b.canvas.fps);f(g.a.error_1154);r.a.error("agent-event",d.a.event_incompatible_browser,{error:g.a.error_1154});return}b=b.canvas.canvasId;try{(k=document.querySelector("#"+b))&&(k instanceof HTMLMediaElement||k instanceof HTMLCanvasElement)?(p=k.captureStream(k instanceof HTMLCanvasElement?h:void 0))?c(p):(a.a.error("captureStream() failed . canvasFps : ",h),f(g.a.error_1159),r.a.error("agent-event",d.a.event_incompatible_browser,{error:g.a.error_1159})):
(a.a.error("DOM Element does not exists/ not a Media Element. DomId is: ",b),r.a.error("agent-event",d.a.event_incompatible_browser,{error:g.a.error_1157}),f(g.a.error_1157))}catch(R){a.a.error("DOM Element does not exists/ not a Media Element. DomId is: ",b),f(g.a.error_1157),r.a.error("agent-event",d.a.event_incompatible_browser,{error:g.a.error_1157,exception:"Canvas chrome err: "+JSON.stringify(R)})}}else a.a.error(" getCanvasStream() This browser does not support canvas"),f(g.a.error_1158),r.a.error("agent-event",
d.a.event_incompatible_browser,{error:g.a.error_1154});else a.a.error(" getCanvasStream() is called without canvas options"),r.a.error("agent-event",d.a.event_incompatible_browser,{error:"Canvas called without options"}),f(g.a.error_1155)},isCurrentVerLess:B,getSupportedDeviceConstraints:function(){return navigator.mediaDevices.getSupportedConstraints()}}}).call(t,n(36)(m))},function(m,t,n){t.a={event_ice_failed:{event_code:"4000",severity:"critical",event_name:"ice-failed",event_description:"ICE failed"},
event_ice_success:{event_code:"40001",severity:"",event_name:"ice-success",event_description:"ICE success"},event_stream_subscribe_failed:{event_code:"4001",severity:"critical",event_name:"stream-subscribe-failed",event_description:"Failed to subscribe to stream"},event_stream_subscribe_success:{event_code:"40011",severity:"",event_name:"stream-subscribe-success",event_description:"Subscribe to stream successful"},event_stream_unsubscribe_failed:{event_code:"4002",severity:"critical",event_name:"stream-unsubscribe-failed",
event_description:"Failed to unsubscribe from stream"},event_stream_unsubscribe_success:{event_code:"40021",severity:"",event_name:"stream-unsubscribe-success",event_description:"Unsubscribe from stream success"},event_socket_connect_failed:{event_code:"4003",severity:"critical",event_name:"socket-connect-failed",event_description:"Socket connection failed"},event_socket_connect_success:{event_code:"40031",severity:"",event_name:"socket-connect-success",event_description:"Socket connection successful"},
event_stream_publish_failed:{event_code:"4004",severity:"critical",event_name:"stream-publish-failed",event_description:"Failed to publish stream"},event_stream_publish_success:{event_code:"40041",severity:"",event_name:"stream-publish-success",event_description:"stream published successfully"},event_stream_unpublish_failed:{event_code:"4005",severity:"critical",event_name:"stream-unpublish-failed",event_description:"Failed to unpublish stream"},event_stream_unpublish_success:{event_code:"40051",
severity:"",event_name:"stream-unpublish-success",event_description:"Unpublish stream success"},event_start_recording_failed:{event_code:"4006",severity:"critical",event_name:"start-recording-failed",event_description:"Failed to start recording"},event_start_recording_success:{event_code:"40061",severity:"",event_name:"start-recording-success",event_description:"Start recording success"},event_start_local_recording_failed:{event_code:"40062",severity:"critical",event_name:"start-local-recording-failed",
event_description:"Failed to start local recording"},event_start_local_recording_success:{event_code:"40063",severity:"",event_name:"start-local-recording-success",event_description:"Start local recording success"},event_stop_recording_failed:{event_code:"4007",severity:"critical",event_name:"stop-recording-failed",event_description:"Failed to stop recording"},event_stop_recording_success:{event_code:"40071",severity:"",event_name:"stop-recording-success",event_description:"Stop recording success"},
event_stop_local_recording_failed:{event_code:"40072",severity:"critical",event_name:"stop-local-recording-failed",event_description:"Failed to stop local recording"},event_stop_local_recording_success:{event_code:"40073",severity:"",event_name:"stop-local-recording-success",event_description:"Stop local recording success"},event_start_screenshare_failed:{event_code:"4008",severity:"critical",event_name:"start-screenshare-failed",event_description:"Failed to start screenshare"},event_start_screenshare_success:{event_code:"40081",
severity:"",event_name:"start-screenshare-success",event_description:"Screenshare Start successfully"},event_stop_screenshare_failed:{event_code:"4009",severity:"critical",event_name:"stop-screenshare-failed",event_description:"Failed to stop screenshare"},event_stop_screenshare_success:{event_code:"40091",severity:"",event_name:"stop-screenshare-success",event_description:"Screenshare stopped successfully"},event_start_canvas_failed:{event_code:"4010",severity:"critical",event_name:"start-canvas-failed",
event_description:"Failed to start canvas"},event_start_canvas_success:{event_code:"40101",severity:"",event_name:"start-canvas-success",event_description:"Canvas started successfully"},event_stop_canvas_failed:{event_code:"4011",severity:"critical",event_name:"stop-canvas-failed",event_description:"Failed to stop canvas"},event_stop_canvas_success:{event_code:"40111",severity:"",event_name:"stop-canvas-success",event_description:"Canvas stopped successfully"},event_network_reconnect_timeout:{event_code:"4012",
severity:"high",event_name:"network-reconnect-timeout",event_description:"Reconnection timed out"},event_start_annotation_failed:{event_code:"4012",severity:"high",event_name:"start-annotation-failed",event_description:"Start Annotation Failed"},event_start_annotation_success:{event_code:"40121",severity:"high",event_name:"start-annotation-success",event_description:"Start Annotation successful"},event_stop_annotation_failed:{event_code:"4013",severity:"high",event_name:"stop-annotation-failed",event_description:"Stop Annotation Failed"},
event_stop_annotation_success:{event_code:"40131",severity:"high",event_name:"stop-annotation-success",event_description:"Stop Annotation successful"},event_send_message_failed:{event_code:"4013",severity:"high",event_name:"send-message-failed",event_description:"Failed to send message"},event_send_message_success:{event_code:"40131",severity:"",event_name:"send-message-success",event_description:"Send message success"},event_reconnect_socket_failed:{event_code:"4014",severity:"high",event_name:"reconnect-socket-failed",
event_description:"Failed to reconnect socket"},event_reconnect_socket_success:{event_code:"40141",severity:"",event_name:"reconnect-socket-success",event_description:"Socket reconnection success"},event_send_data_failed:{event_code:"4018",severity:"high",event_name:"send-data-failed",event_description:"Failed to send data"},event_send_data_success:{event_code:"40181",severity:"",event_name:"send-data-success",event_description:"Send data success"},event_media_access_denied:{event_code:"4019",severity:"critical",
event_name:"media-access-denied",event_description:"Access to media denied"},event_media_access_success:{event_code:"40191",severity:"",event_name:"media-access-allowed-success",event_description:"User has granted access to local media."},event_agent_media_access_denied:{event_code:"40192",severity:"critical",event_name:"agent-media-access-denied-failed",event_description:"Access to media denied (Agent)"},event_gum_failed:{event_code:"4020",severity:"critical",event_name:"gum-failed",event_description:"Get User Media failed"},
event_gum_success:{event_code:"40201",severity:"",event_name:"gum-success",event_description:"Get User Media success"},event_agent_gum_failed:{event_code:"40201",severity:"critical",event_name:"agent-gum-failed",event_description:"Get User Media failed (Agent)"},event_audio_device_access_failed:{event_code:"4021",severity:"critical",event_name:"audio-device-access-failed",event_description:"Failed to access Audio device"},event_agent_audio_device_access_failed:{event_code:"40211",severity:"critical",
event_name:"agent-audio-device-access-failed",event_description:"Failed to access Audio device (Agent)"},event_video_device_access_failed:{event_code:"4022",severity:"critical",event_name:"video-device-access-failed",event_description:"Failed to access Video device"},event_agent_video_device_access_failed:{event_code:"40221",severity:"critical",event_name:"agent-video-device-access-failed",event_description:"Failed to access Video device (Agent)"},event_remote_canvas_stream_failed:{event_code:"4023",
severity:"high",event_name:"remote-canvas-stream-failed",event_description:"Remote canvas stream failed"},event_capture_canvas_stream_failed:{event_code:"4024",severity:"critical",event_name:"capture-canvas-stream-failed",event_description:"Failed to capture canvas stream"},event_set_local_description:{event_code:"4025",severity:"none",event_name:"set-local-description",event_description:"Local SDP description is set"},event_set_remote_description:{event_code:"4026",severity:"none",event_name:"set-remote-description",
event_description:"Remote SDP description is set"},event_reconnect_subscribe_failed:{event_code:"4027",severity:"high",event_name:"reconnect-subscribe-failed",event_description:"Failed to subscribe while reconnecting"},event_reconnect_publish_failed:{event_code:"4028",severity:"high",event_name:"reconnect-publish-failed",event_description:"Failed to publish while reconnecting"},event_incompatible_browser:{event_code:"4029",severity:"high",event_name:"incompatible-browser",event_description:"Browser is incompatible"},
event_connect_socket_failed:{event_code:"4030",severity:"high",event_name:"connect-socket-failed",event_description:"Socket connection failed"},event_connect_socket_success:{event_code:"40301",severity:"",event_name:"connect-socket-success",event_description:"Socket connection successful"},event_room_reconnection_failed:{event_code:"4031",severity:"high",event_name:"room-reconnection-failed",event_description:"Room reconnection failed"},event_room_reconnection_success:{event_code:"40311",severity:"",
event_name:"room-reconnection- success",event_description:"Room reconnection success"},event_room_disconnection_failed:{event_code:"4032",severity:"high",event_name:"room-disconnection-failed",event_description:"Room disconnection failed"},event_room_disconnection_success:{event_code:"40321",severity:"",event_name:"room-disconnection-success",event_description:"Room disconnection success"},event_mute_self_audio_failed:{event_code:"4033",severity:"high",event_name:"mute-self-audio-failed",event_description:"mute self audio failed"},
event_mute_self_audio_success:{event_code:"40331",severity:"",event_name:"mute-self-audio-success",event_description:"mute self audio success"},event_unmute_self_audio_failed:{event_code:"4034",severity:"high",event_name:"unmute-self-audio-failed",event_description:"unmute self audio failed"},event_unmute_self_audio_success:{event_code:"40341",severity:"",event_name:"unmute-self-audio-success",event_description:"unmute self audio success"},event_room_mute_failed:{event_code:"4035",severity:"high",
event_name:"room-mute-failed",event_description:"room mute failed"},event_room_mute_success:{event_code:"40351",severity:"",event_name:"room-mute-success",event_description:"room mute success"},event_room_unmute_failed:{event_code:"4036",severity:"high",event_name:"room-unmute-failed",event_description:"room unmute failed"},event_room_unmute_success:{event_code:"40361",severity:"",event_name:"room-unmute-success",event_description:"room unmute success"},event_file_shared_failed:{event_code:"4037",
severity:"high",event_name:"file-shared-failed",event_description:"file shared failed"},event_file_shared_success:{event_code:"40371",severity:"",event_name:"file-shared-success",event_description:"file shared success"},event_file_download_failed:{event_code:"4038",severity:"high",event_name:"file-downlod-failed",event_description:"file download failed"},event_file_download_success:{event_code:"40381",severity:"",event_name:"file-downlod-success",event_description:"file downlod success"},event_mute_self_video_failed:{event_code:"4039",
severity:"high",event_name:"mute-self-video-failed",event_description:"mute self video failed"},event_mute_self_video_success:{event_code:"40391",severity:"",event_name:"mute-self-video-success",event_description:"mute self video success"},event_unmute_self_video_failed:{event_code:"4040",severity:"high",event_name:"unmute-self-video-failed",event_description:"unmute self video failed"},event_unmute_self_video_success:{event_code:"40401",severity:"",event_name:"unmute-self-video-success",event_description:"unmute self video failed"},
event_low_bandwidth_update:{event_code:"4041",severity:"",event_name:"low-bandwidth-update",event_description:"low bandwidth update"},event_network_change:{event_code:"4042",severity:"",event_name:"network-change",event_description:"network change"},event_connection_lost:{event_code:"4043",severity:"",event_name:"connection-lost",event_description:"connection lost"},event_make_outbound_call_failed:{event_code:"4044",severity:"high",event_name:"make-outbound-call-failed",event_description:"Outbound call failed"},
event_make_outbound_call_success:{event_code:"40441",severity:"",event_name:"make-outbound-call-success",event_description:"Outbound call success"},event_make_outbound_call_state:{event_code:"4045",severity:"",event_name:"make-outbound-call-state",event_description:"Outbound call state"},event_abwd_mute_video_success:{event_code:"4101",severity:"",event_name:"mute-publisher-video-success",event_description:"Publisher video muted due to low bandwidth"},event_fs_upload_started_success:{event_code:"4102",
severity:"",event_name:"fs-upload-started-success",event_description:"File is being shared"},event_fs_file_available_success:{event_code:"4103",severity:"",event_name:"fs-file-available-success",event_description:"File is being shared"},event_room_user_connect_failed:{event_code:"4104",severity:"",event_name:"room-user-connect-failed",event_description:"User connection to the Room failed"},event_room_user_connect_success:{event_code:"41041",severity:"",event_name:"room-user-connect-success",event_description:"A new user is connected to the Room"},
event_room_user_disconnect_failed:{event_code:"4105",severity:"",event_name:"room-user-disconnect-failed",event_description:"User disconnection to the Room failed"},event_room_user_disconnect_success:{event_code:"41051",severity:"",event_name:"room-user-disconnect-success",event_description:"User is disconnected to the Room"},event_start_live_recording_failed:{event_code:"4046",severity:"critical",event_name:"start-live-recording-failed",event_description:"Failed to start live recording"},event_start_live_recording_success:{event_code:"40461",
severity:"",event_name:"start-live-recording-success",event_description:"Start live recording success"},event_stop_live_recording_failed:{event_code:"4047",severity:"critical",event_name:"stop-live-recording-failed",event_description:"Failed to stop live recording"},event_stop_live_recording_success:{event_code:"40471",severity:"",event_name:"stop-live-recording-success",event_description:"Stop live recording success"},event_live_recording_param_change_failed:{event_code:"40472",severity:"",event_name:"live-recording-param-change-failed",
event_description:"live recording params change failed"},event_live_recording_param_change_success:{event_code:"40473",severity:"",event_name:"live-recording-param-change-success",event_description:"live recording params change success"},event_streaming_param_change_failed:{event_code:"40474",severity:"",event_name:"Streaming-param-change-failed",event_description:"Streaming params change failed"},event_streaming_param_change_success:{event_code:"40475",severity:"",event_name:"Streaming-param-change-success",
event_description:"Streaming params change success"},event_general_failed:{event_code:"4106",severity:"critical",event_name:"general-failed",event_description:"General error"},event_general_success:{event_code:"41061",severity:"",event_name:"general-success",event_description:"General success"}}},function(m,t,n){var h=n(0);m=n(1);var l=n.n(m);n=function(){var e={eventLoggerToken:void 0,eventServer:{},logID:void 0,eventBuffer:[],uniqueSequence:1,clientId:void 0};switch(l.a.eventLogLevel){case "trace":e.logLevel=
2;break;case "debug":e.logLevel=1;break;case "info":e.logLevel=3;break;case "warn":e.logLevel=4;break;case "error":e.logLevel=5;break;default:e.logLevel=6}e.init=function(b){try{b.eventServer&&b.eventServer.url&&(e.eventServer.url=b.eventServer.url,e.logID=b.logId)}catch(a){h.a.error("Error! Failed to send auth request to Event Server. Error: "+a+".")}};e.log=function(b,a){try{if(!(b<e.logLevel)){console.log("EventLogger.log event SENT"+JSON.stringify(a));var c=(new Date).toISOString(),g="info",l=
{};switch(b){case 1:g="debug";break;case 2:g="trace";break;case 3:g="info";break;case 4:g="warning";break;case 5:g="error";break;default:g="info"}l.key={logID:e.logID,endpointType:"client",instanceID:e.logID,uniqueSequence:e.uniqueSequence++};l.severity=a.event?a.event.severity:"none";l.eventLevel=[];l.eventLevel.push(g);l.eventLevel.push(a.source);l.eventMeta={};l.eventMeta.event=a.event;l.eventMeta.meta=a.meta;l.isAnonymousInfo=!0;l.sourceTimeStamp=c;if(e.eventServer.url&&e.eventLoggerToken){var d=
new XMLHttpRequest;d.onreadystatechange=function(){4===this.readyState&&200===this.status?h.a.info(this.responseText):h.a.error("Connection to Event Server did not establish. readyState: "+this.readyState+" Status: "+this.status)};d.open("POST","https://"+e.eventServer.url+"/event",!0);d.setRequestHeader("Content-Type","application/json");d.setRequestHeader("eventToken",e.eventLoggerToken);d.send(JSON.stringify(l))}else e.eventBuffer.push(l)}}catch(r){h.a.error("Error! Failed to post log event to Event Server. Error: "+
r+".")}};e.debug=function(b,a,c){e.log(1,{source:b,event:a,meta:c})};e.trace=function(b,a,c){e.log(2,{source:b,event:a,meta:c})};e.info=function(b,a,c){e.log(3,{source:b,event:a,meta:c})};e.warn=function(b,a,c){e.log(4,{source:b,event:a,meta:c})};e.error=function(b,a,c){void 0!=c.error&&"object"!=typeof c.error&&(c.error={errorDesc:c.error});e.log(5,{source:b,event:a,meta:c})};e.close=function(){};e.revalidate=function(){};e.processBufferEvents=function(){for(var b=0;b<e.eventBuffer.length;b++){var a=
e.eventBuffer[b],c=new XMLHttpRequest;c.onreadystatechange=function(){4==this.readyState&&200==this.status?h.a.info(this.responseText):h.a.error("Connection to Event Server did not establish. Status: "+this.status)};c.open("POST","https://"+e.eventServer.url+"/event",!0);c.setRequestHeader("Content-Type","application/json");c.setRequestHeader("eventToken",e.eventLoggerToken);c.send(JSON.stringify(a))}};e.setClientId=function(b){e.clientId=b};e.setEventLoggerToken=function(b){b&&(e.eventLoggerToken=
b,e.eventLoggerToken&&e.eventServer&&e.eventServer.url&&e.processBufferEvents())};return e}();t.a=n},function(m,t,n){t.a={vcx_player:{width:"inherit",height:"inherit",position:"relative","background-color":"black",overflow:"hidden"},vcx_player_loader:{width:"100%",height:"100%",position:"absolute"},vcx_player_screen_saver:{width:"100%",height:"100%",position:"absolute","z-index":"1"},vcx_stream:{width:"inherit !important",height:"inherit !important",position:"absolute","object-fit":"cover"},default_vcx_bar:{height:"100%",
width:"100%",position:"absolute"},vcx_subbar_bottom:{width:"100%",height:"15%","max-height":"33px",color:"#aaa",position:"absolute",bottom:0,"background-repeat":"repeat-x;","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)",transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"bottom","padding-top":"50px","z-index":2},vcx_subbar_top:{width:"100%",height:"15%","max-height":"30px",color:"#aaa",position:"absolute",
top:0,"background-repeat":"repeat-x",transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"top !important","padding-bottom":"50px","z-index":2},vcx_subbar_left:{width:"15%",height:"100%","max-width":"30px",color:"#aaa",position:"absolute",left:0,"background-repeat":"repeat-x",transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)",
"-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"bottom"},vcx_subbar_right:{width:"15%",height:"100%","max-width":"30px",color:"#aaa",position:"absolute",right:0,transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"bottom"},brand_logo:{"max-width":"30px","max-height":"30px",cursor:"pointer",position:"absolute",right:"0px",
margin:"5px"},theater_view:{width:"100% !important",height:"80% !important"},full_view:{width:"100% !important",height:"100% !important",top:"0px",left:"0px",position:"fixed !important","z-index":3},icon:{margin:"7px","max-width":"30px",cursor:"pointer"},icon_record:{color:"#f00"},icon_volume:{color:"#aaa"},icon_play:{color:"#aaa"},icon_mic:{color:"#aaa"},icon_zoom:{color:"#aaa"},icon_share:{color:"#aaa"}}},function(m,t,n){var h=n(7),l=n(4),e=n(40),b=n(14),a=n(52),c=n(3),g=n(53),w=n(19),d=n(0),r=
n(5),q=n(6);m=n(1);var D=n.n(m),v=n(8),p=n(9),u=n(16),C=n(56),B=n(61),z=n(62),F=n(67),f=["user","owner","room","session"],O=!0,x;window.statsIcon='<svg  viewBox="0 0 16 16" width="16" height="16" xml:space="preserve" fill="green"><rect height="6" width="4" y="10"/><rect height="10" width="4" x="6" y="6"/><rect height="16" width="4" x="12"/></svg>';t.a=function(m,n,t){function P(a){return void 0==a||0==f.includes(a)?!1:!0}if(D.a.is_supported()){var k=Object(l.c)(t),I;k.filesToUpload=[];k.f2rec={};
k.availableFiles=[];var H=new Map,Q=new Map,Y=new Map,R=[],K=10485760,N="",G="";k.showFsUi=!1;k.internetDetectionUrl=D.a.internetDetectionUrl;k.remoteStreams=Object(g.a)();k.remotePendingStreams=Object(g.a)();k.numATSubscribersAdded=0;k.localStreams=Object(g.a)();k.roomID="";k.talkerCount=0;k.userAudioTalkerCount=0;k.userVideoTalkerCount=0;k.state=0;k.allStreamsActive=!1;k.streamsHealthTimerId=0;k.Connection=void 0===n?h.a:n;k.receiveVideoQuality=new Map;k.receiveVideoQuality.set("talker","Auto");
k.receiveVideoQuality.set("canvas","HD");k.mediaStatsMode="disable";k.liveTranscription=!1;var y=Object(e.a)(m);k.socket=y;k.userList=new Map;k.dialOutList=new Map;k.cControlReq=void 0;k.cCrequest=[];k.awaitedParticipants=new Map;k.floorGranted=!1;k.floorInvited=!1;k.floorAccepted=!1;k.roomJson=void 0;k.clientId=void 0;k.mode=void 0;k.activeTalker=!1;k.shareStatus=!1;k.share_override_room=!1;k.shareOverRide=!1;k.shareOverRideCallback=void 0;k.isOverRidingShare=!1;k.ScreenSharelocalStream=null;k.isSharingClient=
!1;k.forcedStopSharing=!1;k.isCanvasSharing=!1;k.isCanvasSharingClient=!1;k.canvasStatus=!1;k.activeTalkerList=new Map;k.audioOnlyMode=!1;k.roomMuted=!1;var Z=JSON.parse(w.a.decodeBase64(t.token));k.reconnectionState=!1;k.reconnectAttempt=0;k.connectAttempt=0;var T=3;k.isStreamingClient=!1;k.sendRecvBitrateStats=!1;k.selectedSpeakerId=void 0!=t&&void 0!=t.speakerId?t.speakerId:void 0;var ba="none",ea=!1,V=!1,M=!1,W=!1,ia=!1,va;t.hasOwnProperty("reconnectInfo")?(d.a.info("reconnect parameter",t.reconnectInfo),
k.reconnectionAllowed=t.reconnectInfo.allow_reconnect,k.reconnectionTimeOutInterval=t.reconnectInfo.timeout_interval,T=t.reconnectInfo.number_of_attempts):(k.reconnectionAllowed=!0,k.reconnectionTimeOutInterval=45E3,T=3);var da=!1,ra=-1;k.localStreamsBeforeReconnect=Object(g.a)();k.oldSpecInfo=void 0;k.mediaConfiguration=Z.roomMeta.settings.media_configuration?Z.roomMeta.settings.media_configuration:"Default";k.maxVideoLayers=0;k.defaultBandwidth=new Map;k.defaultBandwidth.set(1,2E5);k.defaultBandwidth.set(2,
3E5);k.defaultBandwidth.set(3,4E5);k.defaultBandwidth.set(4,6E5);k.defaultBandwidth.set(5,8E5);k.defaultBandwidth.set(6,1E6);k.defaultBandwidth.set(7,12E5);k.videoMutedUsers={};var fa,U=k.remoteStreams,pa=k.remotePendingStreams,la=k.numATSubscribersAdded,S=k.localStreams;k.hardMuteRoom=!1;var Ga=Object(a.a)(null,null);k.breakOutRoom=Ga;k.me={};k.roomSettings={};k.mute=!1;k.muteAudioOnJoin=!1;k.muteVideoOnJoin=!1;k.cCapprovedHands=[];k.externalIp="";k.subscribeSessionStats=!1;k.canvasOptions={width:1280,
height:720,domHandle:""};k.inputContext=null;k.canvasVideoPlayer="";var X=D.a.video_resolution_range[Z.roomMeta.settings.quality],Ha=document.createElement("style");Ha.innerHTML=".stats-container{ \n                         position: absolute;\n                         z-index: 5;\n                         padding: 2px;\n                         top: 2px;\n                         right: 2px;\n                         font-size: 12px;\n                         width: 22px;\n                         height: 22px;\n                         text-align: center;\n                         background: white;\n                         border-radius: 10px;\n                     }\n                     .stats-button{\n                         cursor:pointer;\n                         width: 15px;\n                         height: 15px;\n                         padding: 0 0 0 2px;\n                     }\n                     .stats-detail{ height: 100%;}\n                     .stats-overlay-inner{\n                         display: flex;\n                         flex-direction: row;\n                         justify-content: space-between;\n                         padding: 8px 2px 6px 10px;\n                     }\n                     .stats-right-partition, .stats-left-partition {}\n                     .stats-left-partition {margin-right: 10px;}\n                     .stats-button svg {width: 12px;height: 12px;}\n                         ";
document.createElement("style").innerHTML=".bw-notification{\n                                 position: absolute;\n                                 //z-index: 5;\n                                 top:50%;\n                                 left:50%;\n                                 margin-top:-50px;\n                                 margin-left:-100px;\n                                 padding: 5px;\n                                 color: #fff;\n                                 background: rgba(50,50,50,0.5);\n                                 }";
var ha=!1,za=!1,wa=function(a){console.log(" in Remove stream : stream.stream : "+a.stream);a.stream&&(a.hide(),a.stop(),a.close(),delete a.stream);a.pc&&(a.pc.close(),delete a.pc)},qa=function(a,b){0!==k.socket.state&&!1===k.reconnectionState&&(!a.reconnect&&a.reconnectAttempt<T?(d.a.info(" onStreamFailed() "+(a.local?"publisher":"subscriber")+" streamId: "+a.getID()+" - wait for individual reconnection : num reconnect attempts: "+a.reconnectAttempt),Aa(a,function(d){!1===d&&(console.log("onStreamFailed (): reconnectStream() failed trying global reconnect id : "+
a.getID()),k.socket.disconnect())})):a.reconnect||(d.a.info("onStreamFailed() "+(a.local?"publisher":"subscriber")+" streamId: "+a.getID()+" - reconnect attemt exceeded close socket and reconnection"),p.a.error("room-event",v.a.event_ice_failed,{error:"close the socket and wait for reconnection",stream:a}),a.reconnect=!1,a.reconnectRetries=0,a.local&&(d.a.info("Local stream  failed - close the socket and wait for reconnection"),k.socket.disconnect())));0===k.state||a.reconnect||a.failed||!1!==k.reconnectionAllowed||
(d.a.info("onStreamFailed() failed - unpublishing and unsubscibing the stream"),p.a.error("room-event",v.a.event_ice_failed,{error:"unpublishing and unsubscibing the stream",stream:a}),a.failed=!0,b=Object(l.f)({type:"stream-failed",msg:b||"Stream failed after connection",stream:a}),k.dispatchEvent(b),a.local?k.unpublish(a):k.unsubscribe(a))},Ba=function(a,b){d.a.info("Stream subscribed");b.stream&&(a.initRemoteStream(b.stream),k.remoteStreams.remove(a.getID()),k.remoteStreams.add(a.getID(),a));b=
Object(l.f)({type:"stream-subscribed",stream:a});k.dispatchEvent(b);a.room=k;!0!==a.screen&&!0!==a.canvas||a.updateVideo(a.getID())},Pa=function(a,b,c){var A={callback:function(A){d.a.info("Sending message",A);y.sendSDP("signaling_message",{streamId:a.getID(),msg:A,browser:a.pc.browser},void 0,function(){})},nop2p:!0,audio:b.audio&&a.ifAudio(),video:b.video&&a.ifVideo(),maxAudioBW:b.maxAudioBW,maxVideoBW:b.maxVideoBW,limitMaxAudioBW:t.maxAudioBW,limitMaxVideoBW:t.maxVideoBW,iceServers:k.iceServers,
forceTurn:a.forceTurn};c||(A.simulcast=b.simulcast);return A},Qa=function(){2==k.state&&k.allStreamsActive&&(U.forEach(function(a,d){2==k.state&&0==sa(a)&&(!a.reconnect&&a.reconnectAttempt<T?Aa(a,function(d){!1===d&&(console.log("checkAndProcessStreamsHealth () reconnectStream() failed trying global reconnect id : "+a.getID()),k.socket.disconnect())}):!a.reconnect&&a.reconnectAttempt>=T&&k.reJoinRoom())}),S.forEach(function(a,d){2==k.state&&0==sa(a)&&(!a.reconnect&&a.reconnectAttempt<T?Aa(a,function(d){!1===
d&&(console.log("checkAndProcessStreamsHealth() reconnectStream() failed trying global reconnect id : "+a.getID()),k.socket.disconnect())}):!a.reconnect&&a.reconnectAttempt>=T&&k.socket.disconnect())}))},sa=function(a){var A=!0;if(a){var b=function(a){var A=a.getTracks();a=!0;A=$jscomp.makeIterator(A);for(var b=A.next();!b.done;b=A.next())b=b.value,!0===b.enabled?"live"===b.readyState?d.a.debug("Stream state is ready"):(d.a.info("Track state is not ready State: "+b.readyState),a=!1):d.a.info("Track state not ready ,track not anabled ");
return a};a.audioStream&&(A=b(a.audioStream));A&&a.videoStream&&(A=b(a.videoStream))}return A},qb=function(a,b){a.pc=k.Connection.buildPair(Pa(a,b,!0));d.a.info("Create remote connection for subscribe:-"+JSON.stringify(b));a.pc.onaddstream=Ba.bind(null,a);d.a.info("Registering the peer connection timer for the subscriber stream "+a.getID());setTimeout(sa,1E4,a);var A=function(A,b){console.log(" stream state ICE remote id - "+a.getID()+" : "+A+" source: "+b);"failed"===A||"disconnected"===A&&"pc"==
b?(a.reconnect=!1,d.a.info(b+" connection state failed - streamId: "+a.getID()),console.log(" stream state "+b+" connection remote id - "+a.getID()+" : failed"),qa(a),p.a.error("room-event",v.a.event_ice_failed,{error:{}})):(d.a.info("stream ID",a.getID()),d.a.info("ice connection state",A),"connected"===A&&(console.log(" stream state ICE remote id - "+a.getID()+" : ICE connected"),d.a.info("ice connection state connected - streamId : "+a.getID()),p.a.info("room-event",v.a.event_ice_success,{message:"ICE connected successfully"}),
a.reconnect&&(a.reconnect=!1,a.reconnectAttempt=0,(A=Y.get(a.getID()))?("none"!=A.mediatype&&(b=JSON.parse(JSON.stringify(A)),b.mediatype="none",a.reloadPlayer(b,M)),a.reloadPlayer(A,M)):console.log(" stream state ICE remote id - "+a.getID()+" : ICE reconnected "))))};a.pc.oniceconnectionstatechange=function(a){A(a,"ice")};a.pc.onconnectionstatechange=function(a){A(a,"pc")};a.pc.createOffer(!0)},Aa=function(a,b){b=void 0===b?function(){}:b;var A=a.userRequestOptions,c="none";a.reconnect=!0;a.reconnectAttempt++;
var f=setTimeout(function(){console.log("reconnectStream() fail timeout stream local: "+a.local+" id: "+a.getID()+" cmd: "+c);b(!1)},3E3);a.local?(d.a.info("reconnectStream()  streamId: "+a.getID()+" calling unpublish()"),c="unpublish",k.unpublish(a,function(g,p){d.a.info("reconnectStream()  streamId: "+a.getID()+" unpublish callback calling publish()");c="publish";k.publish(a,A,function(){d.a.info("reconnectStream()  streamId: "+a.getID()+" publish callback");c="publish-done";clearTimeout(f);b(!0)})})):
(d.a.info("reconnectStream()  streamId: "+a.getID()+" calling unsubscribe()"),c="unsubscribe",k.unsubscribe(a,function(g,p){c="subscribe";d.a.info("reconnectStream()  streamId: "+a.getID()+" unsubscribe callback calling publish()");k.subscribe(a,A,function(){c="subscribe-done";d.a.info("reconnectStream()  streamId: "+a.getID()+" subscribe callback");clearTimeout(f);b(!0)})}))};k.reconnectStream=function(a,d){d=void 0===d?function(){}:d;console.log("calling reconnect stream");Aa(a,d)};k.notifyDeviceUpdate=
function(){h.a.mediaDeviceUpdate(function(a){a=Object(l.e)({type:"user-media-device-list-change",message:a.added});k.dispatchEvent(a)})};var rb=function(a,b){a.pc=k.Connection.buildPair(Pa(a,b));if(a.audioStream)for(var A=$jscomp.makeIterator(a.audioStream.getAudioTracks()),c=A.next();!c.done;c=A.next())a.pc.addTrack(c.value);if(a.videoStream)for(A=$jscomp.makeIterator(a.videoStream.getVideoTracks()),c=A.next();!c.done;c=A.next())a.pc.addTrack(c.value);d.a.info("Registering the peer connection timer for the subscriber stream "+
a.getID());setTimeout(sa,1E4,a);var f=function(A,b){var c=a.ifCanvas()?"canvas":a.ifScreen()?"screen":"main";"failed"===A||"disconnected"===A&&"pc"==b?(a.reconnect=!1,console.log(" stream state local  "+c+" : "+A+" source: "+b+" calling onStreamFailed stream.reconnect: "+a.reconnect),qa(a)):"connected"===A&&(a.reconnect=!1,a.reconnectAttempt=0,console.log(" stream state local  "+c+" : "+A+" source: "+b));d.a.info("handleConnectionStateChange state:",A)};a.pc.oniceconnectionstatechange=function(a){f(a,
"ice")};a.pc.onconnectionstatechange=function(a){f(a,"pc")};b.createOffer||a.pc.createOffer()},Ra=function(a){var d=Object(b.a)(k.Connection,{streamID:a.id,local:!1,clientId:a.clientId,audio:a.audio,video:a.video,data:a.data,screen:a.screen,attributes:a.attributes});d.room=k;U.add(a.id,d);a=Object(l.f)({type:"stream-added",stream:d});p.a.info("room-event",v.a.event_general_success,{message:"socketOnAddStream - stream added"});k.dispatchEvent(a)},sb=function(a){a=a.id.streamId;var d=Object(b.a)(k.Connection,
{streamID:a}),A=c.a.getById("screen_saver_"+a);c.a.getByClass("icon_play",A.parentNode).disabled=!0;A&&"none"===A.style.display?A.style.display="block":A&&"block"===A.style.display&&(A.style.display="none");a=Object(l.e)({type:"track-removed",streams:[d],message:"tracked removed from stream: "+a});p.a.info("room-event",v.a.event_general_success,{message:"socketOnRemoveTrack - tracked removed from stream"});k.dispatchEvent(a)},Ta=function(a){var d=a.name,A=a.role,b=a.permissions,c={name:a.name,permissions:a.permissions,
role:a.role,user_ref:a.user_ref,videoMuted:a.videoMuted,audioMuted:a.audioMuted};c.audioEnabled=void 0!=a.audioEnabled?a.audioEnabled:!0;c.videoEnabled=void 0!=a.videoEnabled?a.videoEnabled:!0;void 0!=a.data&&(c.data=a.data);k.userList.set(a.clientId,c);if(k.userList.size>la&&pa.size()){var f=pa.get(la+1);f&&(pa.remove(la+1),U.add(la+1,f),Sa(f,f.userRequestOptions,function(){}),la+=1)}d=Object(l.g)({type:"user-connected",name:d,clientId:a.clientId,role:A,permission:b,user:c});k.awaitedParticipants.get(a.clientId)&&
k.awaitedParticipants.delete(a.clientId);p.a.info("room-event",v.a.event_room_user_connect_success,{message:"userConnect - user connected"});k.dispatchEvent(d)},tb=function(a){var A=k.userList.get(a.clientId);void 0!=A?"media-modes"==a.key?void 0!=a.info&&void 0!=a.info.publish?(A.audioEnabled!=a.info.publish.audio&&(A.audioEnabled=a.info.publish.audio,k.dispatchEvent(Object(l.g)({type:A.audioEnabled?"user-audio-enabled":"user-audio-disabled",clientId:a.clientId}))),A.videoEnabled!=a.info.publish.video&&
(A.videoEnabled=a.info.publish.video,k.dispatchEvent(Object(l.g)({type:A.videoEnabled?"user-video-enabled":"user-video-disabled",clientId:a.clientId})))):d.a.error("userUpdate() failed - filed missing for media-modes : "+JSON.stringify(a)):d.a.error("userUpdate() failed - invalid key : "+JSON.stringify(a)):d.a.error("userUpdate() failed - user not found : "+JSON.stringify(a))},Va=function(a){var A=a.name,b=a.role,c=a.permissions,f=a.clientId;k.userList.delete(a.clientId);!0===k.isStreamingClient&&
0===k.userList.size&&(d.a.info("S.T. Client :true  and all users have disconnected"),Ua("streaming-client-disconnect"));"lecture"===k.mode&&"moderator"===k.me.role&&Ca(f);a=Object(l.g)({type:"user-disconnected",name:A,clientId:f,role:b,permission:c});p.a.info("room-event",v.a.event_room_user_disconnect_success,{message:"userDisConnect - user disconnected"});k.dispatchEvent(a)},Wa=function(a){a=Object(l.d)({type:"user-subscribed",name:a.name,role:a.role,user_ref:a.user_ref,socket:a.socket});p.a.info("room-event",
v.a.event_general_success,{message:"userSubcribe - user subscribed"});k.dispatchEvent(a)},Xa=function(a){a=Object(l.d)({type:"user-subscribed",name:a.name,role:a.role,user_ref:a.user_ref,socket:a.socket});p.a.info("room-event",v.a.event_general_success,{message:"userUnSubcribe - user unsubscribed"});k.dispatchEvent(a)},Ya=function(a){var b;if((b=a.peerId?U.get(a.peerId):S.get(a.streamId))&&!b.failed&&b.pc)if(b.pc.processSignalingMessage(a.msg,k.mediaConfiguration),a.msg&&"object"===typeof a.msg&&
"ready"===a.msg.type)if(b.local){Da(b.ifScreen(),b.ifCanvas());if(b.ifCanvas())d.a.info("canvas ready :: wb: "),console.log(" stream state local canvas: ready");else if(b.ifScreen()||b.ifCanvas())console.log(" stream state local share: ready");else{console.log(" stream state local main: ready");1<k.maxVideoLayers&&(a={0:1E3*D.a.video_bandwidth_range[Z.roomMeta.settings.quality][2].max,1:1E3*D.a.video_bandwidth_range[Z.roomMeta.settings.quality][1].max,2:1E3*D.a.video_bandwidth_range[Z.roomMeta.settings.quality][0].max},
d.a.info("updating simulcast bps for quality: "+Z.roomMeta.settings.quality+" bitrates: "+JSON.stringify(a)),b.updateSimulcastLayersBitrate(a));var A=!0;a={local:!1,hard:!1,eventInfo:void 0};var c={local:!1,hard:!1,eventInfo:void 0};k.mute&&(a.hard|=1);d.a.info("streamId: "+b.getID()+" local cam Publish ready state");void 0!=k.videoMuteOnJoin&&(c.local|=k.videoMuteOnJoin.local,c.hard|=k.videoMuteOnJoin.hard,A=!1,delete k.videoMuteOnJoin);void 0!=k.audioMuteOnJoin&&(a.local|=k.audioMuteOnJoin.local,
a.hard|=k.audioMuteOnJoin.hard,A=!1,delete k.audioMuteOnJoin);a.local|=b.config.audioMuted;c.local|=b.config.videoMuted;0==b.video&&(c={local:!1,hard:!1});0==b.audio&&(a={local:!1,hard:!1});ub(b,a,c,A);b.config.audioMuted&&(b.config.audioMuted=!1);b.config.videoMuted&&(b.config.videoMuted=!1)}b.onStateChanged(!0)}else console.log(" stream state remote id - "+b.getID()+" : ready");else void 0!=k.selectedSpeakerId&&b.setSpeaker(k.selectedSpeakerId)},vb=function(a){var d=S.get(a.streamId);d&&!d.failed?
d.pc.get(a.peerSocket).processSignalingMessage(a.msg):(d=U.get(a.streamId),d.pc.processSignalingMessage(a.msg))},Za=function(a){S.get(a.streamId)},wb=function(a){S.get(a.streamId)},$a=function(a){d.a.info("Received SocketOnSelfBandwidthAlert",JSON.stringify(a));if("SubscriberBandWidth"===a.message){var b=Object(l.e)({type:"room-bandwidth-alert",message:a.bandwidth});k.dispatchEvent(b)}else S.forEach(function(b,A){1===a.bandwidth?(d.a.info("mute publisher video due to low bandwidth"),p.a.info("room-event",
v.a.event_low_bandwidth_update,{message:"socketOnSelfBandwidthAlert - muted publisher video due to low bandwidth"}),b.muteVideo()):"ShareBandwidth"===a.message&&b.screen?b.setVideoParamsRange(a.bandwidth,void 0,void 0,void 0,!0):"PublisherBandwidth"===a.message&&(x=a.bandwidth,b.setVideoParamsRange(a.bandwidth,void 0,void 0,void 0,!0))})},xb=function(a){"bw-alert"===a.id?ab(a.msg):"publisher-bw"===a.id||"share-bw"===a.id?$a(a.msg):(a=Object(l.e)({type:a.id,message:a.msg}),k.dispatchEvent(a))},ab=
function(a){d.a.info("OnbandwidthAlert:",a);for(var b=0;b<a.length;b++){var A=k.remoteStreams.getAll()[a[b].streamId];null==A?d.a.info("Stream not found"):A.setBandwidthAlert(a[b])}},yb=function(a){if(k.activeTalker)if(k.eventsList&&void 0!==k.eventsList&&"message-received"in k.eventsList){var d=Object(l.e)({type:"message-received",message:a.msg});k.dispatchEvent(d)}else d=Object(l.e)({type:"active-talker-data-in",message:a.msg}),k.dispatchEvent(d);else d=U.get(a.id),a=Object(l.f)({type:"stream-data-in",
msg:a.msg,stream:d}),d.dispatchEvent(a)},Ea=function(a,b,c,f){f=document.createElement("div");f.setAttribute("id","fs-notif-id-"+Math.random());f.setAttribute("class","fs-notification");f.setAttribute("style","display:block;position:relative;z-index:3;padding:5px 10px;top:50%;right:50%;transform:translateX(50%);background:rgba(0,0,0,0.29);border-radius:5px;color:rgb(255,255,255)");b.appendChild(f);b=f;switch(c){case "fs-upload-init":c="upload started for file "+a.data[a.data.length-1].name+" of size "+
a.data[a.data.length-1].size/1E3+" KB";f=a.message;a=document.createElement("br");b.appendChild(a);c=document.createTextNode(c);b.appendChild(c);b.appendChild(a);break;case "fs-file-uploaded":c="uploaded 100 % "+a.name+"  of size "+a.size/1E3+" KB";f=a.message;a=document.createElement("br");b.appendChild(a);c=document.createTextNode(c);b.appendChild(c);b.appendChild(a);break;case "fs-upload-started":c=a.sender+" is sharing file "+a.message.data[a.message.data.length-1].name+"  of size "+a.message.data[a.message.data.length-
1].size/1E3+" KB";f=a.message;a=document.createElement("br");b.appendChild(a);c=document.createTextNode(c);b.appendChild(c);b.appendChild(a);break;case "fs-file-available":f=a.message;a=document.createElement("br");b.appendChild(a);var A=document.createElement("BUTTON");c=document.createTextNode(f.name);A.setAttribute("style","color:red;font-size:23px");A.setAttribute("id",R.length-1);A.appendChild(c);b.appendChild(A);A.onclick=function(){k.recvFiles(A.id)};b.appendChild(a);break;default:d.a.info("random data to fantom UI ")}},
zb=function(a,b){d.a.info("socketOnDataStreamToRoom",a.type);switch(a.type){case "chat":var c="message-received";break;case "data-internal-in":c=a.message.type;switch(a.message.type){case "fs-upload-started":a.message.broadcast=a.broadcast;a.message.sender=a.sender;a.message.senderId=a.senderId;d.a.info(" file is being shared with you fs-upload-started",a.message);!0===k.showFsUi&&null!==document.getElementById(G)&&(Ea(a,document.getElementById(G),"fs-upload-started"),p.a.info("room-event",v.a.event_file_download_success,
{error:{}}));break;case "fs-file-available":a.message.broadcast=a.broadcast;a.message.sender=a.sender;a.message.senderId=a.senderId;R.push(a.message);var A={broadcast:a.broadcast,sender:a.sender,senderId:a.senderId,name:a.message.name,size:a.message.size,speed:a.message.speed,createdAt:a.message.createdAt,dlimit:a.message.dlimit,time:a.message.time,expiresAt:a.message.expiresAt,timeLimit:a.message.timeLimit,index:R.length-1};k.availableFiles.push(A);d.a.info("file is available to download fs-file-available",
A);A=Object(l.e)({type:"fs-download-result",message:{messageType:"download-available",result:0,description:"file-available",response:{downloadStatus:"available",jobId:A.index,downloadInfo:A}}});k.dispatchEvent(A);!0===k.showFsUi&&null!==document.getElementById(G)&&Ea(a,document.getElementById(G),"fs-file-available");break;case "fs-upload-cancelled":break;default:d.a.info("unknown internal data type from signaling server ",a.type),p.a.error("room-event",v.a.event_file_download_failed,{error:{}})}break;
default:c="user-data-received"}k.eventsList&&c in k.eventsList?(a=Object(l.e)({type:c,message:a}),k.dispatchEvent(a),b&&b(q.a.error_000)):b&&b(q.a.error_1169)},Ab=function(a){var d=U.get(a.id),b=Object(l.f)({type:"stream-attributes-updated",attrs:a.attrs,stream:d});d.updateLocalAttributes(a.attrs);d.dispatchEvent(b)},bb=function(a){var d=S.get(a.id);if(d)qa(d);else if(d=U.get(a.id))U.remove(a.id),wa(d),a=Object(l.f)({type:"stream-removed",stream:d}),p.a.info("room-event",v.a.event_general_success,
{message:"socketOnRemoveStream - stream removed"}),k.dispatchEvent(a)},Bb=function(){d.a.info("Socket disconnected, lost connection to ClientController, ");0!==k.state&&(k.breakOutRoom.disconnectAll(),ja())},Cb=function(a){if(a.streamId){var b="ICE Connection Failed on "+a.type+" "+a.streamId+" "+k.state;d.a.error(b);p.a.error("room-event",v.a.event_ice_failed,{arg:a});a="publish"===a.type?S.get(a.streamId):U.get(a.streamId);qa(a,b)}},Db=function(a){d.a.error("Cannot connect to client Controller");
a=Object(l.e)({type:"room-error",message:a});p.a.info("room-event",v.a.event_general_success,{message:"socketOnError - Cannot connect to client Controller"});k.dispatchEvent(a)},Ja=function(a){d.a.debug("sendDataSocketFromStreamEvent");var b=a.stream;a=a.msg;b.local?y.sendMessage("sendDataStream",{id:b.getID(),msg:a}):(d.a.error("You can not send data through a remote stream"),p.a.error("room-event",v.a.event_general_failed,{message:"sendDataSocketFromStreamEvent - You can not send data through a remote stream"}))},
Ka=function(a,b,c,f,g){if(a&&void 0!==b&&"boolean"===typeof b&&(!1!==b||c&&Array.isArray(c)&&c.length))if(JSON.stringify(a).length/1024>D.a.senduserDataMaximumLimit)d.a.error("message: large data, failed to handle larger text-data. Max allowed length is "+D.a.senduserDataMaximumLimit+" KB"),g&&g(q.a.error_1195);else{var A={};A.msg=a;A.broadcast=b;A.clients=c;A.type=f;k.socket.emitEvent("sendDataStreamToRoom",A,g)}else d.a.error("message: invalid parameter, msg/broadcast/clients undefined or type mistmatch"),
g&&g(q.a.error_1155)};k.sendUserData=function(a,d,b,c){Ka(a,d,b,"user_data",c)};k.sendFtData=function(a,d,b,c,f){a.type=d;Ka(a,b,c,"data-internal-in",f)};k.sendMessage=function(a,d,b,c){Ka(a,d,b,"chat",c)};var Eb=function(a,b){b=void 0===b?function(){}:b;var c=["grid","talker","presenter"],f=["liveRecording","streaming","screenShare","all"],A=a.service;a=a.layout;void 0==b||"function"!==typeof b?d.a.error("message: invalid value for callback parameter"):"moderator"!==k.me.role?(d.a.warning("User should be a moderator to change layout details."),
b(q.a.error_1168)):0===k.state?(d.a.info("Room is disconnected"),b(q.a.error_7079)):void 0!=a&&"string"===typeof a&&c.includes(a)?void 0!=A&&"string"===typeof A&&f.includes(A)?(c={},c.layout=a,c.service=A,k.socket.sendParamEvent("sendLayoutData",c,function(a,c){d.a.info("sending sendLayoutData");null===a?(d.a.error("Error in layout update: ",c),b(c)):(d.a.info("Layout updated successfully."),b(a))})):(d.a.error("message: invalid value for service parameter"),b&&b(q.a.error_1193)):(d.a.error("message: invalid value for layout parameter"),
b&&b(q.a.error_1192))},ka=function(a){var d=0,b=0,c=0,f=0,A=0,g=0,k="";a&&(Object.keys(a).forEach(function(k){switch(k){case "bitrateCalculated":f=Math.round(a[k]/1E3);break;case "framerateCalculated":A=a[k];break;case "bandwidth":c=Math.round(a[k]/1E3);break;case "packetsLost":g=a[k];break;case "frameHeight":d=a[k];break;case "frameWidth":b=a[k]}}),!D.a.csp_enabled&&(k+='<div> <strong style="color:black;" > '+b+"X"+d+"p"+A+"@"+f+"Kbps</strong>:</div>",c||g))&&(k+='<div> <strong style="color:black;" > AvailBw:'+
c+"Kbps, loss:"+g+"</strong>:</div>");return D.a.csp_enabled?{resHeight:d,resWidth:b,packetsLost:g,bandwidth:c,frameRate:A,bitrate:f}:{displayString:k,resHeight:d,resWidth:b,packetsLost:g,bandwidth:c,frameRate:A,bitrate:f}},Fb=function(a){var b=[],c={},f={},A={};a.statData.stats.forEach(function(a){var g=a.streamType;if("actStat"===g){var p={};if(D.a.csp_enabled)for(void 0==b[a.subscriberStreamId]&&(b[a.subscriberStreamId]={id:a.subscriberStreamId}),p.video=[],Object.keys(a.total).forEach(function(d){"bitrateCalculated"===
d&&(d=Math.round(a.total[d]/1E3),"notify"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)&&(p["total-bitrate-kbps"]=d)}),g=0;g<a.videoStats.length;g++)p.video[g]=ka(a.videoStats[g]);else g=document.querySelectorAll("#stats-left-part-"+a.subscriberStreamId),void 0==b[a.subscriberStreamId]&&(b[a.subscriberStreamId]={id:a.subscriberStreamId}),p.video=[],g.forEach(function(d){if(void 0!==d&&null!==d){var b="";Object.keys(a.total).forEach(function(d){if("bitrateCalculated"===d)if(d=Math.round(a.total[d]/
1E3),"notify"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)p["total-bitrate-kbps"]=d;else if("display"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)b+="<div> <strong>Tx Total:</strong>:  "+d+"Kbps </div>"});for(var c=0;c<a.videoStats.length;c++)if(p.video[c]=ka(a.videoStats[c]),"display"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)b+=p.video[c].displayString,d.innerHTML='<div id="" class="stats-detail"> \n                                    '+b+"\n                                </div>"}});
b[a.subscriberStreamId].publisher=p}else if("selfPcStat"===g){void 0==b[a.subscriberStreamId]&&(b[a.subscriberStreamId]={id:a.subscriberStreamId});var e={video:[]};if(D.a.csp_enabled)for(parseInt(a.streamId),Object.keys(a.total).forEach(function(d){"bitrateCalculated"===d&&(d=Math.round(a.total[d]/1E3),"notify"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)&&(e["total-bitrate-kbps"]=d)}),g=0;g<a.videoStats.length;g++)e.video[g]=ka(a.videoStats[g]);else{var h=parseInt(a.streamId)+1;document.querySelectorAll("#stats-right-part-"+
a.subscriberStreamId).forEach(function(d){if(void 0!==d&&null!==d){var b="";Object.keys(a.total).forEach(function(d){if("bitrateCalculated"===d)if(d=Math.round(a.total[d]/1E3),"notify"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)e["total-bitrate-kbps"]=d;else if("display"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)b+="<div> <strong>Rx ID: "+h+", Total:</strong>:  "+d+"Kbps </div>"});d.innerHTML='<div id="" class="stats-detail"> \n                                        '+b+"\n                                    </div>";
for(var c=0;c<a.videoStats.length;c++)if(e.video[c]=ka(a.videoStats[c]),"display"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)b+=e.video[c].displayString,d.innerHTML='<div id="" class="stats-detail"> \n                                '+b+"\n                                </div>"}})}d.a.debug(" subscriberStreamId: "+a.subscriberStreamId+" substat: "+JSON.stringify(e));b[a.subscriberStreamId].subscriber=e}else if("selfPubStat"===g)if(D.a.csp_enabled)for(Object.keys(a.total).forEach(function(d){"bitrateCalculated"===
d&&(d=Math.round(a.total[d]/1E3),"notify"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)&&(c["total-bitrate-kbps"]=d)}),c.video=[],g=0;g<a.videoStats.length;g++)c.video[g]=ka(a.videoStats[g]);else g=document.querySelectorAll("#stats-left-part-"+a.streamId),g.forEach(function(d){if(void 0!==d&&null!==d){var b="";Object.keys(a.total).forEach(function(d){if("bitrateCalculated"===d)if(d=Math.round(a.total[d]/1E3),"notify"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)c["total-bitrate-kbps"]=
d;else if("display"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)b+="<div> <strong>Tx Total</strong>: "+d+"Kbps</div>"});c.video=[];for(var f=0;f<a.videoStats.length;f++)if(c.video[f]=ka(a.videoStats[f]),"display"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)b+=c.video[f].displayString,d.innerHTML='<div id="" class="stats-detail"> \n                                        '+b+"\n                                    </div>"}});else"canvasStat"===g?D.a.csp_enabled?(Object.keys(a.total).forEach(function(d){"bitrateCalculated"===
d&&(d=Math.round(a.total[d]/1E3),"notify"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)&&(f["total-bitrate-kbps"]=d)}),f.video=ka(a.videoStats)):(g=document.querySelectorAll("#stats-left-part-"+a.subscriberStreamId),g.forEach(function(d){if(void 0!==d&&null!==d){var b="";Object.keys(a.total).forEach(function(d){if("bitrateCalculated"===d)if(d=Math.round(a.total[d]/1E3),"notify"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)f["total-bitrate-kbps"]=d;else if("display"==k.mediaStatsMode||
"notify-display"==k.mediaStatsMode)b+="<div> <strong>Tx Total:</strong>:  "+d+"Kbps </div>"});f.video=ka(a.videoStats);if("display"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)b+=f.video.displayString,d.innerHTML='<div id="" class="stats-detail"> \n                                            '+b+"\n                                        </div>"}})):"shareStat"===g&&(D.a.csp_enabled?(Object.keys(a.total).forEach(function(d){"bitrateCalculated"===d&&(d=Math.round(a.total[d]/1E3),"notify"==
k.mediaStatsMode||"notify-display"==k.mediaStatsMode)&&(A["total-bitrate-kbps"]=d)}),A.video=ka(a.videoStats)):(g=document.querySelectorAll("#stats-left-part-"+a.subscriberStreamId),g.forEach(function(d){if(void 0!==d&&null!==d){var b="";Object.keys(a.total).forEach(function(d){if("bitrateCalculated"===d)if(d=Math.round(a.total[d]/1E3),"notify"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)A["total-bitrate-kbps"]=d;else if("display"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)b+=
"<div> <strong>Tx Total:</strong>:  "+d+"Kbps </div>"});A.video=ka(a.videoStats);if("display"==k.mediaStatsMode||"notify-display"==k.mediaStatsMode)b+=A.video.displayString,d.innerHTML='<div id="" class="stats-detail"> \n                                            '+b+"\n                                        </div>"}})))});d.a.info("that.mediaStatsMode : "+k.mediaStatsMode+" talkers: "+JSON.stringify(b)+" selfPublisherStat: "+JSON.stringify(c));"notify"!=k.mediaStatsMode&&"notify-display"!=k.mediaStatsMode||
k.dispatchEvent({type:"media-stats",talkers:b,publisher:c,share:A,canvas:f})},db=function(a){var b=a.stream;a=a.attrs;b.local?(b.updateLocalAttributes(a),y.sendMessage("updateStreamAttributes",{id:b.getID(),attrs:a}),p.a.info("room-event",v.a.event_general_success,{message:"updateAttributesFromStreamEvent - updateStreamAttributes - success"})):d.a.error("You can not update attributes in a remote stream")},E=function(a,d){d.args?a.apply(null,$jscomp.arrayFromIterable(d.args)):a()},La=function(a,d,
b){return{state:a,data:d.ifData(),audio:d.ifAudio(),video:d.ifVideo(),screen:d.ifScreen(),canvas:d.ifCanvas(),canvasType:b.canvasType,attributes:d.getAttributes(),metadata:b.metadata,createOffer:b.createOffer,muteStream:b.muteStream,shareMetadata:b.shareMetadata}},Ma=function(a,b,c,f){f=void 0===f?function(){}:f;null===a?(d.a.error("Error when publishing the stream",c),p.a.error("room-event",v.a.event_stream_publish_failed,{error:c}),f(void 0,c)):(d.a.info("Stream published"),p.a.info("room-event",
v.a.event_stream_publish_success,{error:{}}),b.setID(a),b.on("internal-send-data",Ja),b.on("internal-set-attributes",db),S.add(a,b),b.room=k,f(a))},Gb=function(a,b,c){c=void 0===c?function(){}:c;if(a.url){var f="url";var A=a.url}else f="recording",A=a.recording;d.a.info("Checking publish options for",a.getID());a.checkOptions(b);y.sendSDP("publish",La(f,a,b),A,function(d,b){Ma(d,a,b,c)})},Hb=function(a,d,b){b=void 0===b?function(){}:b;y.sendSDP("publish",La("data",a,d),void 0,function(d,c){Ma(d,a,
c,b)})},Na=function(a,b,c){c=void 0===c?function(){}:c;if(void 0!==a.screen&&0!=a.screen||void 0!==a.canvas&&0!=a.canvas)void 0!==a.canvas&&1==a.canvas?d.a.info("Publishing Canvas spatiallayers 3 createOffer",b.createOffer):d.a.info("Publishing Share createOffer",b.createOffer);else{var f=b.maxVideoLayers?b.maxVideoLayers:k.maxVideoLayers;1<f&&3>=f&&(b.simulcast={numSpatialLayers:f,spatialLayerBitrates:D.a.video_layer_bitrates});d.a.info("Publishing Main, createOffer",b.createOffer," Max video layers: "+
f)}f=La("media_engine",a,b);f.minVideoBW=b.minVideoBW;f.maxVideoBW=b.maxVideoBW;f.scheme=b.scheme;d.a.info("publishVcxRtc constraints: ",f);y.sendSDP("publish",f,void 0,function(d){d&&0===d.result&&(Ma(d.id,a,void 0,void 0),rb(a,b),a.clientId=k.clientId,a.maxVideoBwKbpsReqByServer=b.maxVideoBW);c(d)});void 0!=fa&&clearTimeout(fa);fa=setTimeout(eb,3E4)},Ib=function(a,d){a=d&&a.ifVideo();var b=d&&d.width,c=d&&d.height;d=d&&d.frameRate;return b||c||d?{width:b,height:c,frameRate:d}:a},Sa=function(a,b,
c){c=void 0===c?function(){}:c;b.maxVideoBW=b.maxVideoBW||t.defaultVideoBW;b.maxVideoBW>t.maxVideoBW&&(b.maxVideoBW=t.maxVideoBW);b.audio=void 0===b.audio?!0:b.audio;b.video=void 0===b.video?!0:b.video;b.data=void 0===b.data?!0:b.data;b.canvas=void 0===b.canvas?!0:b.canvas;a.checkOptions(b);var f={streamId:a.getID(),audio:b.audio&&a.ifAudio(),video:Ib(a,b.video),data:b.data&&a.ifData(),canvas:b.canvas&&a.ifCanvas(),browser:k.Connection.browserEngineCheck(),createOffer:b.createOffer,metadata:b.metadata,
muteStream:b.muteStream,slideShowMode:b.slideShowMode};d.a.info("SOCKET EVENT subscribe:- "+JSON.stringify(f));y.sendSDP("subscribe",f,void 0,function(f,A){null===f?(d.a.error("Error subscribing to stream ",A),p.a.error("room-event",v.a.event_stream_subscribe_failed,{error:A}),c(void 0,A)):(d.a.info("Subscriber added"),d.a.info("stream subscription result",f),qb(a,b),c(!0))})},Jb=function(a,b,c){c=void 0===c?function(){}:c;y.sendSDP("subscribe",{streamId:a.getID(),data:b.data,metadata:b.metadata},
void 0,function(b,f){null===b?(d.a.error("Error subscribing to stream ",f),p.a.error("room-event",v.a.event_stream_subscribe_failed,{error:f}),c(void 0,f)):(d.a.info("Stream subscribed"),b=Object(l.f)({type:"stream-subscribed",stream:a}),k.dispatchEvent(b),c(!0))})},fb=function(){d.a.info("detect doesConnectionExist");if(0===k.state){var a=0,b=new XMLHttpRequest,c=void 0!==k.internetDetectionUrl?k.internetDetectionUrl:D.a.internetDetectionUrl;b.timeout=15E3;b.open("HEAD",c+"?rand="+Math.round(1E4*
Math.random()),!0);b.ontimeout=function(a){d.a.info("xhr timeout---------------")};b.addEventListener("readystatechange",function(c){4===b.readyState?200<=b.status&&304>b.status?(a++,d.a.info("internet is back connection exists !"),Fa(),1===a&&(d.a.info("----------reconnect-rejoin room-----------"),k.reconnectAttempt<T?k.reJoinRoom():(d.a.info(" reconnect attempts exceed then max allowed limit"),k.reconnectionAllowed=!1,Fa(),ja(),c=Object(l.e)({type:"network-reconnect-timeout",error:q.a.error_1165.result,
message:q.a.error_1165.error}),k.dispatchEvent(c),p.a.error("room-event",v.a.event_network_reconnect_timeout,{type:"network-reconnect-timeout",error:q.a.error_1165.result,message:q.a.error_1165.error})))):(d.a.info("internet connection doesn't exist!"),k.reconnectAttempt>=T&&(d.a.info("connection doesn't exist and reconnect attempt exceeded"),k.reconnectionAllowed=!1,Fa(),ja(),c=Object(l.e)({type:"network-reconnect-timeout",error:q.a.error_1165.result,message:q.a.error_1165.error}),k.dispatchEvent(c)),
Date.now()-k.reconStartTime>k.reconnectionTimeOutInterval&&(d.a.info("Internet did not resumed within timeout limits of ",k.reconnectionTimeOutInterval/1E3,"seconds"),k.reconnectionAllowed=!1,Fa(),ja(),c=Object(l.e)({type:"network-reconnect-timeout",error:q.a.error_1166.result,message:q.a.error_1166.error}),k.dispatchEvent(c))):d.a.debug("ajax request readystate is ",b.readyState,"status ",b.status,"timer",I)},!1);b.send()}},Fa=function(){void 0!==I?(d.a.info("stopInternetDetection kill it"),clearInterval(I)):
d.a.info("stopInternetDetection handle is undefined",I)},ja=function(a){d.a.debug("room-disconnected clear all ");if(!1===k.reconnectionAllowed){d.a.debug("room-disconnected ---- reconnection not allowed---- clear all normal closer");U.forEach(function(a,d){wa(a);U.remove(d);a&&!a.failed&&(a=Object(l.f)({type:"stream-removed",stream:a}),k.dispatchEvent(a))});U=Object(g.a)();S.forEach(function(a,d){a.ifCanvas()&&k.stopCanvas(function(){});wa(a);S.remove(d)});S=Object(g.a)();try{d.a.debug("normal socket closure, disconnect socket room state:"+
k.state);var b=function(b){d.a.debug("disconnectSocket() room state: "+k.state+" initiator: "+b);0!=k.state&&(k.state=0,k.allStreamsActive=!1,0!==k.streamsHealthTimerId&&(clearInterval(k.streamsHealthTimerId),k.streamsHealthTimerId=0),y.disconnect(),y.state=y.DISCONNECTED,y=void 0);a&&a(q.a.error_000)};if(2==k.state){k.state=3;k.allStreamsActive=!1;0!==k.streamsHealthTimerId&&(clearInterval(k.streamsHealthTimerId),k.streamsHealthTimerId=0);var c=setTimeout(b,1E3,"timer");k.socket.emitEvent(r.a.RoomEvent.drop,
{self:!0},function(a){clearTimeout(c);b("disc callback")})}else 3!=k.state&&b("direct")}catch(Kc){d.a.debug("Socket already disconnected"),a&&(p.a.error("room-event",v.a.event_general_failed,{message:q.a.error_1163}),a(q.a.error_1163))}}else{d.a.debug("in clear all - unexpected disconnection and the case for reconnect");U.forEach(function(a,b){void 0!==a&&void 0!==a.stream?a.stream.getTracks().forEach(function(a){a.onended=null;a.stop()}):d.a.debug("remote stream or media stream is undefined id: "+
b);a.pc&&(a.pc.close(),delete a.pc);U.remove(b)});S.forEach(function(a,b){a.pc&&(a.pc.close(),delete a.pc);gb(a);a&&a.local&&(d.a.info("stream off for internal send data"),a.off("internal-send-data",Ja));S.remove(b)});y.state=y.DISCONNECTED;k.state=0;k.allStreamsActive=!1;0!==k.streamsHealthTimerId&&(clearInterval(k.streamsHealthTimerId),k.streamsHealthTimerId=0);d.a.info("send network disconnected event");var f=Object(l.e)({type:"network-disconnected",error:q.a.error_1163.result,message:q.a.error_1163.error});
k.dispatchEvent(f);k.reconStartTime=Date.now();fb();I=setInterval(fb,15E3);a&&(p.a.error("room-event",v.a.event_general_failed,{message:q.a.error_1163}),a(q.a.error_1163))}};k.connect=function(a){a=void 0===a?{allow_reconnect:!0,number_of_attempts:3,timeout_interval:45E3}:a;var b=JSON.parse(w.a.decodeBase64(t.token));k.reconnectionAllowed=a.allow_reconnect;k.reconnectionTimeOutInterval=a.timeout_interval;T=a.number_of_attempts;console.log(" connection attempt check :"+k.connectAttempt);if(!0===k.reconnectionState&&
k.reconnectAttempt<T)k.reconnectAttempt++,b.isReconnecting=!0,b.reconnectAttempt=k.reconnectAttempt,b.oldClientIdForReconnect=k.clientId,b.room=k.roomID,b.role=k.me.role,b.name=k.me.name,d.a.info("new token request for the reconnection: ",b);else{if(7<=k.connectAttempt||k.reconnectAttempt>=T){d.a.info("reconnection attempts exceeded, attempted",k.reconnectAttempt,"max allowed",T);console.log(" connection timeout happend ssending network-reconnect-timeout");k.reconnectionAllowed=!1;ja();a=Object(l.e)({type:"network-reconnect-timeout",
error:q.a.error_1165.result,message:q.a.error_1165.error});p.a.error("room-event",v.a.event_general_failed,{message:q.a.error_1165.error});k.dispatchEvent(a);return}d.a.info("not the case of reconnection ")}0!==k.state&&d.a.warning("Room already connected");b.logId&&D.a.setLocalStorageItem("logID",b.logId);k.state=1;k.allStreamsActive=!1;0!==k.streamsHealthTimerId&&(clearInterval(k.streamsHealthTimerId),k.streamsHealthTimerId=0);b.hostType=D.a.browser_info.name;b.hostVersion=D.a.browser_info.version;
b.hostDeviceType=D.a.browser_info.device_type;b.userAgent=D.a.user_agent;b.advancedOptions=t.options;b.version=D.a.product.version;void 0!=t.maxActiveTalkers&&"number"==typeof t.maxActiveTalkers&&(b.maxActiveTalkers=t.maxActiveTalkers);k.connectAttempt++;console.log("calling socket connect that.connectAttempt: "+k.connectAttempt);y.connect(b,function(a){d.a.info("socket response: ",a);if(0===a.result)k.connectAttempt=0,d.a.info("socket.connect token accepted"),k.externalIp=a.connectedIP;else{d.a.info("connect error",
a);if(4119===a.result){d.a.info("Client is trying to reconnect in a room where all participants are gone",k.reconnectAttempt,"max allowed",T);k.reconnectionAllowed=!1;ja();var b=Object(l.e)({type:"network-reconnect-timeout",error:q.a.error_1178.result,message:q.a.error_1178.error});p.a.error("room-event",v.a.event_general_failed,{message:q.a.error_1178.error});k.dispatchEvent(b)}else if(2101===a.result||2102===a.result)console.log("room full response:",a),2101===a.result?d.a.info("Room is full for moderators"):
d.a.info("Room is full for participants"),k.reconnectionAllowed=!1,ja();b=Object(l.e)({type:"room-error",error:a.result,message:a.msg});k.dispatchEvent(b);k.createEventLog("clientConnFailed",{clientId:"",hostType:D.a.browser_info.name,hostVersion:D.a.browser_info.version,error:a.msg,externalIp:k.externalIp})}},function(a){d.a.error("Not Connected! Error: "+a);if("object"==typeof a&&void 0!=a.result){console.log("socket.connect failed with error: "+JSON.stringify(a));k.reconnectionAllowed=!1;ja();
var b=a.result}else b=a;b=Object(l.e)({type:"room-error",error:b,message:a});p.a.error("room-event",v.a.event_general_failed,{message:"clientConnFailed - error"});k.dispatchEvent(b);k.createEventLog("clientConnFailed",{clientId:"",hostType:D.a.browser_info.name,hostVersion:D.a.browser_info.version,error:a,externalIp:k.externalIp})})};k.reJoinRoom=function(){d.a.debug("=========== port of hope--- reconnect");""!=k.externalIp&&(k.reconnectionState=!0);d.a.log("reconnect");void 0===y&&!0===k.reconnectionState?
(d.a.log("reconnect creating a new socket"),k.state=0,k.allStreamsActive=!1,0!==k.streamsHealthTimerId&&(clearInterval(k.streamsHealthTimerId),k.streamsHealthTimerId=0),d.a.info("reconnect force a new socket"),y=Object(e.a)(void 0),k.socket=y):d.a.debug("previous connection is still there or the reconnection state is false");k.userList.clear();k.connect()};k.disconnect=function(a){d.a.debug("that.disconnect() clearing all ");k.reconnectionAllowed=!1;ja(function(b){void 0==a&&(a={cause:q.a.CC006});
b=Object(l.e)({type:"room-disconnected",message:a});d.a.debug("that.disconnect() sending room-disconnected event");k.dispatchEvent(b)})};k.removeTrack=function(a){y.sendSDP("removeTrack",{streamId:a,msg:"track-removed"},void 0,function(){})};k.getWaitingUserList=function(a){k.socket.sendMessage("getAwaitedUser",function(d){if(0===d.result)for(var b in d.awaitedParticipants)k.awaitedParticipants.set(d.awaitedParticipants[b].clientId,{clientId:d.awaitedParticipants[b].clientId,name:d.awaitedParticipants[b].name});
a&&a(d)})};k.updateLayout=function(a,d){Eb(a,d)};var xa=function(a,b){d.a.info("event: "+a+":"+b.clientId+"::::"+b.name);k.cCrequest.push({clientId:b.clientId,name:b.name,type:"raised"});a=Object(l.e)({type:a,users:b});k.dispatchEvent(a)},Ca=function(a){for(var d=0;d<k.cCapprovedHands.length;d++)if(k.cCapprovedHands[d].clientId==a){k.cCapprovedHands.splice(d,1);break}},ya=function(a,b){switch(a){case "floor-granted":b.clientId===k.clientId?k.floorGranted=!0:k.cCapprovedHands.push({clientId:b.clientId,
moderatorId:b.moderatorId});break;case "floor-invited":b.clientId===k.clientId&&(k.floorInvited=!0);break;case "floor-denied":b.clientId===k.clientId&&(k.floorGranted=!1);break;case "floor-cancelled":b.clientId===k.clientId?k.floorInvited=!1:Ca(b.clientId);break;case "floor-released":b.clientId===k.clientId?(k.localStreams.getAll(),S.forEach(function(a,b){d.a.info(a.getID()+"::::"+b);k.unpublish(a,function(b){1==b?(d.a.info("stream has been un-published"),p.a.info("room-event",v.a.event_stream_unpublish_success,
{error:{}})):(d.a.info("error during stream un-publishing"),p.a.error("room-event",v.a.event_stream_unpublish_failed,{stream:a}));k.floorGranted=!1})})):Ca(b.clientId)}"floor-released"==a&&k.dispatchEvent(Object(l.e)({type:"release-floor",users:b}));k.dispatchEvent(Object(l.e)({type:a,users:b}))},Kb=function(a){d.a.info(" onFloorManagementEvents: "+JSON.stringify(a));switch(a.id){case "floorRequested":xa("floor-requested",a);break;case "floorCancelled":xa("floor-cancelled",a);break;case "floorFinished":xa("floor-finished",
a);break;case "floorRejected":k.floorInvited=!1;xa("floor-rejected",a);break;case "floorAccepted":xa("floor-accepted",a);break;case "inviteToFloor":ya("floor-invited",a);break;case "floorGranted":ya("floor-granted",a);break;case "floorDenied":ya("floor-denied",a);break;case "floorReleased":ya("floor-released",a);break;case "cancelFloorInvite":ya("floor-invite-cancelled",a)}},Lb=function(a){d.a.info(a);a=Object(l.e)({type:"hard-mute",users:a});k.dispatchEvent(a)},Mb=function(a,d){ta(!1,!0,!1,!0,d,
!0,{type:"hard-unmute-room",message:a});k.mute=!1},Nb=function(a,d){ta(!0,!0,!1,!0,d,!0,{type:"hard-mute-room",message:a});k.mute=!0};k.enableKnock=function(a,b){void 0!==a&&"boolean"===typeof a?k.socket.emitEvent("enableKnock",a,function(c){d.a.info("enableKnock response"+JSON.stringify(c));0===c.result&&!1===a&&k.awaitedParticipants.clear();b&&b(c)}):b(!1)};k.openFloor=function(a,b){void 0!==a&&"boolean"===typeof a?k.socket.emitEvent("openFloor",a,function(c){d.a.info("openFloor response"+JSON.stringify(c));
0===c.result&&(k.floorOpen=a);b&&b(c)}):b(!1)};var Ob=function(a){a=Object(l.e)({type:"room-awaited",message:"waiting for moderator approval"});k.dispatchEvent(a)},Pb=function(a){var d={clientId:a.clientId,name:a.name};a.data&&(d.data=a.data);k.awaitedParticipants.set(a.clientId,d);a=Object(l.e)({type:"user-awaited",message:{user:d}});k.dispatchEvent(a)};k.approveAwaitedUser=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?k.socket.emitEvent("user-allowed",a,function(c,f){null===c?
d.a.error("Error on knock approve request",f):(k.awaitedParticipants.delete(a),b(c,f))}):d.a.error("approveAwaitedUser() invalid param - callback")};k.denyAwaitedUser=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?k.socket.emitEvent("user-denied",a,function(c,f){null===c?d.a.error("Error on knock deny request",f):(k.awaitedParticipants.delete(a),b(c,f))}):d.a.error("denyAwaitedUser() invalid param - callback")};var Qb=function(a){d.a.info("-----------onRoomConnected-----------");
var c=[],f=a.streams||[],g=a.id,A=a.userList,e=a.room;k.me=a.user||{};k.roomSettings=a.room.settings||{};k.mute=a.room.mute;k.mediaRecord=a.mediaRecord;k.subscription=a.subscription;k.mode=a.room.settings.mode;k.share_override_room=a.room.settings.screen_share_override||!1;D.a.csp_enabled||document.head.append(Ha);"lecture"===k.mode&&"moderator"===a.user.role&&(0<a.raisedHands.length&&a.raisedHands.forEach(function(a){k.cCrequest.push(a)}),0<a.floorInvites.length&&a.floorInvites.forEach(function(a){k.cCrequest.push(a)}),
0<a.approvedHands.length&&a.approvedHands.forEach(function(a){k.cCapprovedHands.push(a)}));k.activeTalker=e.settings.active_talker;for(h in a.awaitedParticipants)k.awaitedParticipants.set(a.awaitedParticipants[h].clientId,{clientId:a.awaitedParticipants[h].clientId,name:a.awaitedParticipants[h].name});k.iceServers=a.iceServers;k.state=2;k.mediaConfiguration=a.mediaConfiguration;a.nonTalkerMediaParams&&(k.nonTalkerMediaParams=a.nonTalkerMediaParams);k.videoMutedUsers=a.videoMutedUsers;t.defaultVideoBW=
a.defaultVideoBW;t.maxVideoBW=a.maxVideoBW;k.clientId=a.clientId;k.maxVideoLayers=a.maxVideoLayers||0;k.maxCanvasRefreshRate=a.maxCanvasRefreshRate||0;k.share=a.room.share;k.locked=a.room.locked||!1;k.waitRoom=a.room.waitRoom||!1;k.knockEnabled=a.room.knockEnabled||!1;k.userAudioTalkerCount=a.numAudioTalkers||0;k.userVideoTalkerCount=a.numVideoTalkers||0;t.minVideoBW=a.minVideoBW;t.maxVideoFps=a.maxVideoFps;k.internetDetectionUrl=void 0!=a.internetDetectionUrl?a.internetDetectionUrl:D.a.internetDetectionUrl;
k.floorOpen=void 0!==a.room.openFloor?a.room.openFloor:!0;D.a.setVideoBwQualityMapper(a.videoBitrateQualityMap);p.a.setClientId(a.clientId);a.utilToken&&p.a.setEventLoggerToken(a.utilToken);if(void 0!==a.room.fileShareService){var h={};h=a.room.fileShareService;var q={};q.call_num=a.clientId;q.room_id=a.id;q.service_id=a.room.service_id;q.conf_num=a.room.conf_num;q.userName=a.user.name||"";K=a.room.fileShareService.maxSize;h.callInfo=q;Object(u.f)(h)}void 0!=a.isStreamingClient?!0===a.isStreamingClient?
(d.a.info("is a streaming client"),k.isStreamingClient=!0):(d.a.debug("NOT A S T Client"),k.isStreamingClient=!1):d.a.info(" server does not support file sharing ",a.room.fileShareService);void 0!=a.room.hls&&(k.hls=a.room.hls);q=A.length?A.length:1;for(var r=Object.keys(f),w=0;w<r.length;w+=1){var v=f[r[w]];h=Object(b.a)(k.Connection,{streamID:v.id,local:!1,audio:v.audio,video:v.video,data:v.data,screen:v.screen,canvas:!("undefined"===typeof v.canvas||!1===v.canvas),attributes:v.attributes});c.push(h);
h.screen||h.canvas||parseInt(v.id)<=q||k.isStreamingClient?U.add(v.id,h):pa.add(v.id,h)}la=q;k.roomID=g;d.a.info("Connected to room "+k.roomID);for(var z in A)k.userList.set(A[z].clientId,A[z]);k.getMaxTalkers(function(a){k.talkerCount=a.maxTalkers});f={conf_num:e.conf_num,name:e.name,owner_ref:e.owner_ref,mode:e.settings.mode,moderators:e.settings.moderators,participants:e.settings.participants,auto_recording:e.settings.auto_recording,canvas:e.settings.canvas,description:e.settings.description,created:e.created,
mute:e.mute,quality:e.settings.quality,screen_share:e.share,locked:e.locked,wait_room:e.wait_room,duration:e.remainingDuration,analyzer:e.analyzer,screen_share_override:e.settings.screen_share_override};k.screenResolutionRange=null!=a.room.screenResolutionRange?a.room.screenResolutionRange:D.a.screen_resolution_range[f.quality];void 0!=k.selectedSpeakerId&&hb(k.selectedSpeakerId,function(a){a||(k.selectedSpeakerId=void 0);d.a.error("selected speaker id valid : "+a)});d.a.debug("room-connected event - room Info : "+
JSON.stringify(f));c=Object(l.e)({type:"room-connected",streams:c,users:A,room:f,me:k.me,mediaRecord:k.mediaRecord});k.dispatchEvent(c);d.a.info("that.externalIp: ",k.externalIp);k.reconnectClientName=a.user.name;k.createEventLog("clientConnSuccess",{clientId:a.clientId,clientName:a.user.name,hostType:D.a.browser_info.name,hostVersion:D.a.browser_info.version,externalIp:k.externalIp})},eb=function(){var a=!0;if(k.allStreamsActive)Qa();else{console.log(" ======== mediaConnectionTimeout() ======= ");
for(var d=U.getAll(),b=Object.keys(d),c=0;c<b.length;c+=1)if(0==sa(d[b[c]])){a=!1;console.log(" mediaConnectionTimeout() BAD subscriber stream health streamId: "+b[c]);break}if(a)for(d=U.getAll(),b=Object.keys(d),c=0;c<b.length;c+=1)if(0==sa(d[b[c]])){a=!1;console.log(" mediaConnectionTimeout() BAD publisher stream health streamId: "+b[c]);break}a||(console.log(" mediaConnectionTimeout() health is bad.. rejoin room  "),k.reJoinRoom())}},Ua=function(a){d.a.info(" onRoomDisconnected() : calling that.disconnect  with msg : "+
JSON.stringify(a));void 0==a&&(a=q.a.CC002);k.disconnect(a)},ta=function(a,b,c,f,g,e,h){var A=!1,u=function(a,b,c,f){d.a.info("hardMuteMediaDevices callback resp : "+JSON.stringify(b));b.result===q.a.error_000.result&&f&&(c?(a=Object(l.e)(f),k.dispatchEvent(a)):(b=Object(l.f)(f),a.dispatchEvent(b)),A=!0)};d.a.info("hardMuteMediaDevices muteOn: "+a+" audio: "+b+" video: "+c+" sendsendServerEvent : "+f);k.localStreams.forEach(function(d,A){b&&d.ifAudio()?a?d.muteAudio(function(a){u(d,a,e,h);g(a)},f,
0,!1):d.unmuteAudio(function(a){u(d,a,e,h);g(a)},f,0,!1):c&&d.ifVideo()&&(a?d.muteVideo(function(a){u(d,a,e,h);g(a)},f,0,!1):d.unmuteVideo(function(a){u(d,a,e,h);g(a)},f,0,!1))});if(!A&&e&&h){var r=Object(l.e)(h);k.dispatchEvent(r)}g&&(p.a.error("room-event",v.a.event_general_failed,{message:q.a.error_1159.error}),g(q.a.error_1159))},ub=function(a,b,c,f){var g=function(a,f){f.result===q.a.error_000.result?d.a.info("mediaDeviceMuteOnJoin() "+a+" audio: "+JSON.stringify(b)+" video: "+JSON.stringify(c)+
" success"):d.a.error("mediaDeviceMuteOnJoin() "+a+" audio: "+JSON.stringify(b)+" video: "+JSON.stringify(c)+" failed. result: "+JSON.stringify(f))};c.local?a.muteVideo(function(a){g("videoSelfMuteCallback",a)},f,1E3,!0):a.selfMuteVideo&&a.unmuteVideo(function(a){g("videoSelfUnmuteCallback",a)},f,1E3,!0);c.hard?a.muteVideo(function(a){g("videoHardMuteCallback",a)},f,1E3,!1):a.hardVideoMuted&&a.unmuteVideo(function(a){g("videoHardUnmuteCallback",a)},f,1E3,!1);b.local?a.muteAudio(function(a){g("AudioSelfMuteCallback",
a)},f,1E3,!0):a.selfMuteAudio&&a.unmuteAudio(function(a){g("AudioSelfUnmuteCallback",a)},f,1E3,!0);b.hard?a.muteAudio(function(a){g("AudioHardMuteCallback",a)},f,1E3,!1):a.hardAudioMuted&&a.unmuteAudio(function(a){g("AudioHardUnmuteCallback",a)},f,1E3,!1)},Rb=function(a,d){ta(!0,!0,!1,!0,d,!0,{type:"hardmute-user-audio",message:a})},Sb=function(a,d){ta(!1,!0,!1,!0,d,!0,{type:"hardunmute-user-audio",message:a})},Tb=function(a,d){ta(!0,!1,!0,!0,d,!0,{type:"hardmute-user-video",message:a})},Ub=function(a,
d){ta(!1,!1,!0,!0,d,!0,{type:"hardunmute-user-video",message:a})},Vb=function(a){na(!0,k.canvasStatus);var b=Object(l.e)({type:"share-started",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,layout:a.layout}});k.shareStatus=!0;k.clientId==a.clientId&&(k.isSharingClient=!0);d.a.debug(" share-started event : "+JSON.stringify(b));k.dispatchEvent(b)},Wb=function(a){0===a.result&&a.mediaConfiguration!==k.mediaConfiguration&&(k.mediaConfiguration=a.mediaConfiguration,k.localStreams.forEach(function(d,
b){d.resetMediaConfiguration(a.mediaConfiguration)}))},Xb=function(a){d.a.info("Stop sharing requested by client: ",a.clientId);k.forcedStopSharing=!0;console.log("that.forcedStopSharing: ",k.forcedStopSharing);k.isSharingClient&&(d.a.info("stopScreenShare for current client"),k.stopScreenShare(function(a){}));1==k.isCanvasSharingClient&&(d.a.info("stopCanvasShare for current client"),k.stopAnnotation(function(a){}))},Yb=function(a){d.a.info("Update Layout requested by client: ",a.clientId);k.clientId!=
a.clientId&&(a=Object(l.e)({type:"layout-updated",message:a}),k.dispatchEvent(a))},Zb=function(a){na(!1,k.canvasStatus);var b={streamType:"share",streamId:a.streamId,negotiatedCodecs:{video:{codec:"default"===k.mediaConfiguration||"Default"===k.mediaConfiguration?"VP8":k.mediaConfiguration},audio:{codec:"OPUS"}},externalIp:k.externalIp};console.log("that.forcedStopSharing: ",k.forcedStopSharing);a=0==k.forcedStopSharing?Object(l.e)({type:"share-stopped",message:{clientId:a.clientId,name:a.name,streamId:a.streamId}}):
Object(l.e)({type:"share-stopped",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,stoppedBy:"moderator"}});k.forcedStopSharing=!1;k.shareStatus=!1;d.a.debug(" share-stopped event : "+JSON.stringify(a));console.log(" share-stopped event : "+JSON.stringify(a));k.dispatchEvent(a);d.a.info("additionalOptions: ",b);k.createEventLog("clientStreamShareStopped",b);k.isSharingClient=!1;k.isOverRidingShare&&(console.log("onShareStopped start sharing for this client"),b=k.startScreenShare(k.shareOverRideCallback),
k.ScreenSharelocalStream=b,b=Object(l.e)({type:"start-new-screen-share",message:{clientId:k.clientId}}),k.dispatchEvent(b),k.isOverRidingShare=!1)},$b=function(a){console.log("onScreenShareOverride");k.isSharingClient&&(k.stopScreenShare(function(a){console.log("stopScreenShare response: ",a)}),a=Object(l.e)({type:"stop-old-screen-share",message:{clientId:k.clientId}}),k.dispatchEvent(a))},ac=function(a){console.log("onStreamingUri");a=Object(l.e)({type:"audience-streaming-uri",message:a});k.dispatchEvent(a)},
bc=function(a){k.userList.get(a.clientId).audioMuted=a.user.audioMuted;k.userList.set(a.clientId,a.user);a=Object(l.g)({type:"user-audio-muted",clientId:a.clientId});k.dispatchEvent(a)},cc=function(a){k.userList.get(a.clientId).audioMuted=a.user.audioMuted;k.userList.set(a.clientId,a.user);a=Object(l.g)({type:"user-audio-unmuted",clientId:a.clientId});k.dispatchEvent(a)},dc=function(a){k.userList.get(a.clientId).videoMuted=a.user.videoMuted;k.userList.set(a.clientId,a.user);a=Object(l.g)({type:"user-video-muted",
clientId:a.clientId});k.dispatchEvent(a)},ec=function(a){k.userList.get(a.clientId).videoMuted=a.user.videoMuted;k.userList.set(a.clientId,a.user);a=Object(l.g)({type:"user-video-unmuted",clientId:a.clientId});k.dispatchEvent(a)},na=function(a,b){k.localStreams.forEach(function(c){if(!c.ifCanvas()&&!c.ifScreen()&&c.video&&c.local&&1<k.maxVideoLayers){var f=a||b?"ND":Z.roomMeta.settings.quality;f={0:1E3*D.a.video_bandwidth_range[f][2].max,1:1E3*D.a.video_bandwidth_range[f][1].max,2:1E3*D.a.video_bandwidth_range[f][0].max};
d.a.info("updating main video simulcast bps: "+JSON.stringify(f));c.updateSimulcastLayersBitrate(f)}})};k.publish=function(a,b,c){b=void 0===b?{}:b;c=void 0===c?function(){}:c;if("function"===typeof c){var f=b;if(k.subscription&&(!k.subscription.audio_video&&a.video||!k.subscription.audio_only&&!k.subscription.audio_video&&a.audio||!k.subscription.audio_video&&a.canvas||!k.subscription.audio_video&&a.share))d.a.error("Licence error : feature not supported subscription - av: "+k.subscription.audio_video+
" audio: "+k.subscription.audio_only+" canvas: "+k.subscription.audio_video+" share: "+k.subscription.audio_video+" req audio: "+a.audio+" video: "+a.video+" share: "+a.share+" canvas: "+a.canvas),p.a.error("room-event",v.a.event_general_failed,{message:q.a.error_1170.error}),c(q.a.error_1170);else{if(a.video&&!a.canvas&&!a.share)if(null==a.videoStream)a.video=!1;else{var g=void 0==a.videoSize?!0:!1,e=ib(a,!0);if(e.result!==q.a.error_000.result){d.a.error(" Failed : room.publish video size invalid video size req: "+
a.videoSize+" default : "+JSON.stringify(X));p.a.error("room-event",v.a.event_general_failed,{message:"room.publish video size invalid video size req: "+a.videoSize+" default : "+JSON.stringify(X)});c(e);return}!g||void 0===a.videoSize||"mobile"===D.a.browser_info.device_type||a.videoSize[0]==D.a.video_resolution_range.Default.min.wdith&&a.videoSize[1]==D.a.video_resolution_range.Default.min.height&&a.videoSize[2]==D.a.video_resolution_range.Default.min.wdith&&a.videoSize[3]==D.a.video_resolution_range.Default.max.height||
a.setVideoQualityParams(a.videoSize[0],a.videoSize[1],a.videoSize[2],a.videoSize[3]);a.maxVideoLayers=k.maxVideoLayers}a.userRequestOptions=JSON.parse(JSON.stringify(b));!a.audio||a.canvas||a.share||null!=a.audioStream||(a.audio=!1);!1===k.reconnectionState?a.ifScreen()?f.forceTurn=W:a.ifCanvas()?(f.forceTurn=ia,va=f.canvasType):(ia=W=ea=f.forceTurn?f.forceTurn:!1,(f.maxVideoBW||f.minVideoBW||f.maxVideoFps)&&a.setVideoParamsRange(f.maxVideoBW,f.minVideoBW,f.maxVideoFps,void 0,!1),(t.maxVideoBW||t.minVideoBW||
t.maxVideoFps)&&a.setVideoParamsRange(t.maxVideoBW,t.minVideoBW,t.maxVideoFps,void 0,!0),d.a.info(" options.maxVideoBW: "+f.maxVideoBW+" spec.maxVideoBW: "+t.maxVideoBW),void 0==f.maxVideoBW&&(f.maxVideoBW=t.maxVideoBW,f.minVideoBW=t.minVideoBW)):a.ifScreen()?f.forceTurn=W:a.ifCanvas()?(f.forceTurn=ia,f.canvasType=va):f.forceTurn=ea;f.maxVideoBW=f.maxVideoBW||t.defaultVideoBW;f.maxVideoBW>t.maxVideoBW&&(f.maxVideoBW=t.maxVideoBW);void 0===f.minVideoBW&&(f.minVideoBW=0);f.minVideoBW>t.defaultVideoBW&&
(f.minVideoBW=t.defaultVideoBW);f.forceTurn&&(a.forceTurn=f.forceTurn);f.simulcast=f.simulcast||!1;f.muteStream={audio:a.ifCanvas()?!0:a.audioMuted,video:a.videoMuted};k.muteAudioOnJoin=!!f.audioMuted;k.muteVideoOnJoin=!!f.videoMuted;d.a.debug("Publish forceTurn: ( "+f.forceTurn+","+ea+" ) reconnect state: "+k.reconnectionState);a&&a.local&&!a.failed?k.waitRoom?(d.a.error("Publish() : failed Moderator not present and  waiting for moderator "),p.a.error("room-event",v.a.event_general_failed,{message:q.a.error_1130.error}),
c(q.a.error_1130)):a.ifMedia()?a.ifExternal()?Gb(a,f,c):(void 0!=k.videoMuteOnJoin&&delete k.videoMuteOnJoin,void 0!=k.audioMuteOnJoin&&delete k.audioMuteOnJoin,!k.reconnectionState&&!a.reconnect||a.ifCanvas()||a.ifScreen()?(d.a.info("Publish stream options : ",f),Na(a,f,c)):(k.audioMuteOnJoin={local:a.selfMuteAudio,hard:a.hardAudioMuted},a.selfMuteVideo||a.hardVideoMuted?(k.videoMuteOnJoin={local:a.selfMuteVideo,hard:a.hardVideoMuted},a.unmuteVideo(function(b){0==b.result?(a.muteVideo(function(){},
!1,0,!0,!0),d.a.info("Publish stream options after unmute video success")):d.a.error("Publish stream options after unmute video failed :"+JSON.stringify(b));Na(a,f,c)},!1,0,!a.hardVideoMuted)):Na(a,f,c))):a.ifData()&&Hb(a,f,c):(d.a.error("Trying to publish invalid stream"),p.a.info("room-event",v.a.event_stream_publish_failed,{stream:a}),c(void 0,"Invalid Stream"),b={streamId:a.getID(),selectedCandidates:{local:"",remote:""},negotiatedCodecs:{video:{codec:"default"===k.mediaConfiguration||"Default"===
k.mediaConfiguration?"VP8":k.mediaConfiguration},audio:{codec:"OPUS"}},selectedCam:a.video.deviceId,selectedMic:a.audio.deviceId,error:"Invalid stream",externalIp:k.externalIp},k.createEventLog("clientStreamPublishFailed",b))}}else d.a.error("publish() invalid param - callback")};var fc=function(a){a=Object(l.e)({type:"room-record-on",message:{moderatorId:a.moderatorId}});k.dispatchEvent(a)},gc=function(a){a=Object(l.e)({type:"room-record-off",message:{moderatorId:a.moderatorId}});k.dispatchEvent(a)},
hc=function(a){a=Object(l.e)({type:"room-live-recording-on",message:{message:"live recording is running"}});k.dispatchEvent(a)},ic=function(a){a=Object(l.e)({type:"room-live-recording-off",message:{message:""}});k.dispatchEvent(a)},jc=function(a){a=Object(l.e)({type:"room-live-recording-failed",message:{error:a.error}});k.dispatchEvent(a)},kc=function(a){a=Object(l.e)({type:"change-layout",message:{layout:a.layout}});k.dispatchEvent(a)},lc=function(a){"safari"===h.a.browserEngineCheck()&&!1===k.sendRecvBitrateStats&&
jb();if(k.nonTalkerMediaParams&&a.active!=O){if(a.active){if(void 0==x&&(x=t.maxVideoBW),void 0!=t.minVideoBW){var b={min:t.minVideoBW,max:x};var c=t.maxVideoFps}}else b={min:k.nonTalkerMediaParams.video.bw,max:k.nonTalkerMediaParams.video.bw},c=k.nonTalkerMediaParams.video.fps;void 0!=b&&(O=a.active,k.localStreams.forEach(function(d,f){!d.ifVideo()||d.ifScreen()||d.ifCanvas()||(console.log("onActiveList (): setting video param for AT: "+a.active+" kbps: "+b.max+" fps:"+c),d.setVideoParamsRange(b.max,
b.min,c,void 0,!0))}))}for(var f=new Map,g=0;g<a.activeList.length;g++)if(k.remoteStreams.getAll()[a.activeList[g].streamId]){"audio"===a.activeList[g].mediatype&&k.videoMutedUsers[a.activeList[g].clientId]?(k.remoteStreams.getAll()[a.activeList[g].streamId].audioOnly=!0,d.a.info("Recieved active talker list, videomuted: "+a.activeList[g].videomuted+" reason: "+a.activeList[g].reason),k.remoteStreams.getAll()[a.activeList[g].streamId].setVideoMutedMessage(a.activeList[g]),delete k.videoMutedUsers[a.activeList[g].clientId]):
"audioOnly"===a.activeList[g].mediatype&&(k.remoteStreams.getAll()[a.activeList[g].streamId].audioOnly=!0);k.remoteStreams.getAll()[a.activeList[g].streamId].audioOnly&&"audiovideo"===a.activeList[g].mediatype&&delete k.remoteStreams.getAll()[a.activeList[g].streamId].audioOnly;k.remoteStreams.getAll()[a.activeList[g].streamId].reloadPlayer(a.activeList[g],M);f.set(a.activeList[g].streamId,a.activeList[g]);var e=Y.get(a.activeList[g].streamId);if(e&&e.mediatype!=a.activeList[g].mediatype){switch(a.activeList[g].mediatype){case "audiovideo":case "video":k.remoteStreams.getAll()[a.activeList[g].streamId].setVideoMutedMessage(a.activeList[g]);
k.remoteStreams.getAll()[a.activeList[g].streamId].blankFrameSet&&delete k.remoteStreams.getAll()[a.activeList[g].streamId].blankFrameSet;break;case "audio":case "audioOnly":k.remoteStreams.getAll()[a.activeList[g].streamId].setVideoMutedMessage(a.activeList[g]);k.remoteStreams.getAll()[a.activeList[g].streamId].blankFrameSet||(k.remoteStreams.getAll()[a.activeList[g].streamId].blankFrameSet=!0);break;default:d.a.info("mediatype not handled entry:",JSON.stringify(a.activeList[g]))}Y.set(a.activeList[g].streamId,
a.activeList[g])}else e||Y.set(a.activeList[g].streamId,a.activeList[g])}else d.a.error("onNewActiveTalker() remote stream undefined streamId: "+a.activeList[g].streamId);k.activeTalkerList=f;f=Object(l.e)({type:"active-talkers-updated",message:{activeList:a.activeList,active:a.active}});k.dispatchEvent(f);k.allStreamsActive||(k.allStreamsActive=!0,0==k.streamsHealthTimerId&&(void 0!=fa&&(clearTimeout(fa),fa=void 0),k.streamsHealthTimerId=setInterval(Qa,1E4)))};k.startRecord=function(a){a=void 0===
a?function(){}:a;"function"===typeof a?k.startRecording(void 0,a):d.a.error("startRecord() invalid param - callback")};k.stopRecord=function(a){a=void 0===a?function(){}:a;"function"===typeof a?k.stopRecording(void 0,a):d.a.error("stopRecord() invalid param - callback")};k.startStreaming=function(a,b){b=void 0===b?function(){}:b;if("function"===typeof b&&"object"===typeof a&&a.hasOwnProperty("rtmpDetails")){d.a.info("start streaming called");var c=!0;if("moderator"!==k.me.role)c=!1,d.a.info("user is trying to start streaming and he is not a moderator"),
p.a.error("room-event",v.a.event_general_failed,{message:"startStreaming - "+q.a.error_7008.desc}),b(q.a.error_7008);else if(void 0===a.rtmpDetails)p.a.error("room-event",v.a.event_general_failed,{message:"startStreaming - "+q.a.error_7009.desc}),b(q.a.error_7009);else if(void 0!==a.rtmpDetails.rtmpUrl&&3<a.rtmpDetails.rtmpUrl.split(",").length)b(q.a.error_7101);else if(/(http|https|rtmp|rtmps):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(a.rtmpDetails.rtmpUrl)){var f={};
0===k.state?(f=q.a.error_7103,d.a.info(" room is disconnected"),b(f)):(b&&"function"===typeof b||(b=function(a){d.a.info("SDK defined callback streaming response ",a)}),d.a.info("start streaming called with callback "),c?y.sendMessage("startStreaming",a,function(a,c){null===a?(d.a.error("Error on start streaming",c),void 0!==c.result?b(c):void 0!==c.status&&b({result:c.status.resultCode,error:"streaming error",desc:c.status.error.errorDesc,status:c.status})):b({result:a.status.resultCode,error:"",
desc:"",status:a.status},c)}):b(q.a.error_7000))}else d.a.info(" invalid rtmp or page input url"),c=!1,p.a.error("room-event",v.a.event_general_failed,{message:"startStreaming - "+q.a.error_7102.desc}),b(q.a.error_7102)}else d.a.error("startStreaming() invalid param - streamingConfig/callback")};k.stopStreaming=function(a,b){var c;void 0!=a&&"function"===typeof a?c=a:void 0!=b&&"function"===typeof b&&(c=b);"function"===typeof c?(d.a.info("stop streaming called"),"moderator"!==k.me.role?(d.a.info("user is trying to stop streaming and he is not a moderator"),
c(q.a.error_7044)):(a={options:{confNum:"12345",roomId:"9876"},rtmpDetails:{rtmpUrl:"rtmp://a.rtmp.youtube.com/live2/4rjb-hprf-7wf5-9923"},urlDetails:{url:"https://vc-manu.vcloudx.com:9074/room/?token=",layOut:{}}},b={},0===k.state?(b=q.a.error_7045,d.a.info(" room is disconnected"),c(b)):(c&&"function"===typeof c||(c=function(a){d.a.info("SDK defined callback streaming response ",a)}),d.a.info("stop called with callback "),y.sendMessage("stopStreaming",a,function(a,b){null===a?(d.a.error("Error on stop streaming",
b),void 0!==b.status&&c({result:b.status.resultCode,error:"streaming error",desc:b.status.error.errorDesc,status:b.status})):(d.a.info("Stop streaming"),c({result:a.status.resultCode,error:"",desc:"",status:a.status},b))})))):d.a.error("stopStreaming() invalid param - streamingConfig/callback")};k.setStreamingParams=function(a,b){d.a.info("set Streaming Params called");if("moderator"!==k.me.role)d.a.warning("User should be a moderator user to change Streaming params"),b(q.a.error_7072);else{var c=
{};0===k.state?(c=q.a.error_7078,d.a.info(" room is disconnected"),b(c)):(b&&"function"===typeof b||(b=function(a){d.a.info("SDK defined callback Streaming params change response ",a)}),d.a.info("Streaming params change called with callback "),y.sendMessage("setStreamingParams",a,function(a,c){null===a?(d.a.error("Error on Streaming param change: ",c),p.a.error("room-event",v.a.event_streaming_param_change_failed,{error:c,message:c.status.error}),b(c)):(d.a.info("Streaming param change Success"),
p.a.info("room-event",v.a.event_streaming_param_change_success,{error:{}}),b(a,c))}))}};k.startLiveRecording=function(a,b){d.a.info("start Live Recording called");var c=!0;if("moderator"!==k.me.role)c=!1,d.a.warning("User should be a moderator to start live recording"),b(q.a.error_7201);else{var f={};0===k.state?(f=q.a.error_7203,d.a.info(" room is disconnected"),b(f)):(b&&"function"===typeof b||(b=function(a){d.a.info("SDK defined callback Live recording response ",a)}),d.a.info("start Live Recording called with callback "),
c?y.sendMessage("startLiveRecording",a,function(a,c){if(null===a&&(d.a.error("Error on start Live Recording",c),p.a.error("room-event",v.a.event_start_live_recording_failed,{error:c,message:c.message}),void 0!==c.status)){b({result:c.status.resultCode,error:"live recording error",desc:c.status.error.errorDesc});return}7014===a.status.resultCode&&(da=!0);p.a.info("room-event",v.a.event_start_live_recording_success,{error:{}});d.a.info("Start Live Recording Success");b({result:a.status.resultCode,error:"",
desc:""},c)}):b(q.a.error_7204))}};k.stopLiveRecording=function(a){a=void 0===a?function(){}:a;d.a.info("stop Live Recording called");if("moderator"!==k.me.role)d.a.warning("User should be a moderator user to start live recording"),a(q.a.error_7036);else{var b={urlDetails:{url:"",layOut:{}}},c={};0===k.state?(c=q.a.error_7037,d.a.info(" room is disconnected"),a(c)):(a&&"function"===typeof a||(a=function(a){d.a.info("SDK defined callback Live Recording response ",a)}),d.a.info("stop Live Recording called with callback "),
y.sendMessage("stopLiveRecording",b,function(b,c){null===b?(d.a.error("Error on stop stop live recording",c),p.a.error("room-event",v.a.event_stop_live_recording_failed,{error:c,message:c.message}),void 0!==c.status&&a({result:c.status.resultCode,error:"live recording error",desc:c.status.error.errorDesc})):(7034===b.status.resultCode&&(da=!1,b.status.resultCode=0),d.a.info("Stop Live Recording Success"),p.a.info("room-event",v.a.event_stop_live_recording_success,{error:{}}),a({result:b.status.resultCode,
error:"",desc:""},c))}))}};k.setLiveRecordingParams=function(a,b){d.a.info("set Live Recording Params called");if("moderator"!==k.me.role)d.a.warning("User should be a moderator user to change live recording params"),q.a.error_7071.desc="Only moderator can change live recording params",b(q.a.error_7071);else{var c={};0===k.state?(c=q.a.error_7079,d.a.info(" room is disconnected"),b(c)):(b&&"function"===typeof b||(b=function(a){d.a.info("SDK defined callback Live Recording params change response ",
a)}),d.a.info("Live Recording params change called with callback "),y.sendMessage("setLiveRecordingParams",a,function(a,c){null===a?(d.a.error("Error on live recording param change: ",c),p.a.error("room-event",v.a.event_live_recording_param_change_failed,{error:c,message:c.status.error}),b(c)):(d.a.info("Live Recording param change Success"),p.a.info("room-event",v.a.event_live_recording_param_change_success,{error:{}}),b(a,c))}))}};k.invalidateTranscoding=function(a,b){d.a.info("Invalidate Transcoding called");
var c={};0===k.state?(c=q.a.error_8000,d.a.info(" room is disconnected"),b(c)):(b&&"function"===typeof b||(b=function(a){d.a.info("SDK defined callback Invalidate Transcoding response ",a)}),d.a.info("Invalidate Transcoding called with callback "),y.sendMessage("invalidateTranscoding",a,function(a,c){null===a?(d.a.error("Error on Invalidate Transcoding",c),b(c)):(d.a.info("Invalidate Transcoding"),b(a,c))}))};k.requestFloor=function(a){a=void 0===a?function(){}:a;"function"===typeof a?ma(k.clientId,
"requestFloor",function(b,d){a(b,d);void 0!==b&&(k.cCrequest=k.cCrequest.filter(function(a){return a.clientId!==options}))}):d.a.error("requestFloor() invalid param - callback")};k.cancelFloor=function(a){a=void 0===a?function(){}:a;"function"===typeof a?ma(k.clientId,"cancelFloor",function(b,d){a(b,d);null!==b&&(k.cCrequest=k.cCrequest.filter(function(a){return a.clientId!==options}))}):d.a.error("cancelFloor() invalid param - callback")};k.finishFloor=function(a){a=void 0===a?function(){}:a;"function"===
typeof a?ma(k.clientId,"finishFloor",function(b,c){S.forEach(function(a,b){d.a.info("finishFloor: unpulish "+a.getID()+"::::"+b);k.unpublish(a,function(a){})});k.floorGranted=!1;a(b,c)}):d.a.error("finishFloor() invalid param - callback")};k.grantFloor=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?ma(a,"grantFloor",function(d,c){null!==d&&(k.cCrequest=k.cCrequest.filter(function(b){return b.clientId!==a}),k.cCapprovedHands.push({clientId:a,moderatorId:k.clientId}));b(d,c)}):d.a.error("grantFloor() invalid param - callback")};
k.denyFloor=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?ma(a,"denyFloor",function(d,c){b(d,c);null!==d&&(k.cCrequest=k.cCrequest.filter(function(b){return b.clientId!==a}))}):d.a.error("denyFloor() invalid param - callback")};k.relaseFloor=function(a,b){k.releaseFloor(a,void 0===b?function(){}:b)};k.releaseFloor=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?ma(a,"releaseFloor",function(d,c){null!==d&&(k.cCrequest=k.cCrequest.filter(function(b){return b.clientId!==
a}),Ca(a));b(d,c)}):d.a.error("releaseFloor() invalid param - callback")};k.inviteToFloor=function(a,b){b=void 0===b?function(){}:b;var d={clientId:a};k.socket.sendMessage("inviteToFloor",d,function(c){0===c.result&&k.cCrequest.push({clientId:d.clientId,name:k.userList.get(a).name,type:"requested"});b(c)})};k.acceptInviteFloorRequest=function(a){a=void 0===a?function(){}:a;ma(k.clientId,"acceptFloor",function(b,d){a(b,d);void 0!==b&&(k.cCrequest=k.cCrequest.filter(function(a){return a.clientId!==
options}))})};k.rejectInviteFloor=function(a){a=void 0===a?function(){}:a;ma(k.clientId,"rejectFloor",function(b,d){k.floorInvited=!1;a(b,d);void 0!==b&&(k.cCrequest=k.cCrequest.filter(function(a){return a.clientId!==options}))})};k.cancelFloorInvite=function(a,b){b=void 0===b?function(){}:b;ma(a,"cancelFloorInvite",function(a,d){b(a,d);void 0!==a&&(k.cCrequest=k.cCrequest.filter(function(a){return a.clientId!==options}))})};k.chairControlMuteAll=function(a){a=void 0===a?function(){}:a;k.socket.sendEvent("room-muted",
function(b,c){null===b?(d.a.error("Error on floor request",c),a(void 0,c)):a(b)})};k.chairControlUnMuteAll=function(a){a=void 0===a?function(){}:a;k.socket.sendEvent("room-unmuted",function(b,c){null===b?(d.a.error("Error on floor request",c),a(void 0,c)):a(b)})};k.muteOne=function(a,b){b=void 0===b?function(){}:b;k.socket.sendParamEvent("muteUser",a,function(a,c){null===a?(d.a.error("Error on floor request",c),b(void 0,c)):b(a)})};k.unMuteOne=function(a,b){b=void 0===b?function(){}:b;k.socket.sendParamEvent("unMuteUser",
a,function(a,c){null===a?(d.a.error("Error on floor request",c),b(void 0,c)):b(a)})};k.muteRoom=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?void 0===a||void 0===a.audio&&void 0===a.video?b(q.a.error_1155):!1===a.video&&!1===a.audio?(d.a.error("at least one of the constraints should be false"),b(q.a.error_1155)):(S.forEach(function(b,c){b.screen||b.canvas||(!0===a.audio&&b.ifAudio()&&!b.selfMuteAudio&&b.muteAudio(function(a){d.a.info("Mute Audio for the call")},!0,0,!1,!0),b.ifVideo()&&
!0===a.video&&!b.selfMuteVideo&&b.muteVideo(function(a){d.a.info("Mute Video for the call")},!0,0,!1,!1,!0))}),k.socket.sendMessage("muteRoom",a,function(a,c){null===a?(d.a.error("Error on mute room request",c),p.a.error("room-event",v.a.event_room_mute_failed,{message:"mute room request failed"}),b(void 0,c)):(k.roomMuted=!0,p.a.info("room-event",v.a.event_room_mute_success,{message:"mute room request succeeded"}),b(a))})):d.a.error("muteRoom() invalid param - callback")};k.unMuteRoom=function(a,
b){b=void 0===b?function(){}:b;"function"===typeof b?void 0===a||void 0===a.audio&&void 0===a.video?b(q.a.error_1155):0!=a.video&&0!=a.audio?(d.a.error("at least one of the constraints should be false"),b(q.a.error_1155)):(S.forEach(function(b,c){b.screen||b.canvas||(d.a.info("SelfMuteAudio: "+b.selfMuteAudio+" hardMutedAudio: "+b.hardAudioMuted),a.audio||!b.ifAudio()||b.hardAudioMuted||b.unmuteAudio(function(a){d.a.info("UnMute Audio for the call")},!0,0,!1,!0),d.a.info("SelfMuteVideo: "+b.selfMuteVideo+
" hardMutedVideo: "+b.hardVideoMuted),a.video||!b.ifVideo()||b.hardVideoMuted||b.unmuteVideo(function(a){d.a.info("UnMute Video for the call")},!0,0,!1,!0))}),k.socket.sendMessage("unMuteRoom",a,function(a,c){null===a?(d.a.error("Error on mute room request",c),p.a.error("room-event",v.a.event_room_unmute_failed,{message:"unmute room request failed"}),b(void 0,c)):(k.roomMuted=!1,p.a.info("room-event",v.a.event_room_unmute_success,{message:"unmute room request succeeded"}),b(a))})):d.a.error("unMuteRoom() invalid param - callback")};
k.pauseRoom=function(a){a=void 0===a?function(){}:a;"function"===typeof a?(d.a.info("Pausing the room"),k.muteRoom({audio:!0,video:!0},function(b){a(b)})):d.a.error("pauseRoom() invalid param - callback")};k.resumeRoom=function(a){a=void 0===a?function(){}:a;"function"===typeof a?(d.a.info("Resuming the room"),k.unMuteRoom({audio:!1,video:!1},function(b){a(b)})):d.a.error("resumeRoom() invalid param - callback")};k.switchRoomMode=function(a,b){b=void 0===b?function(){}:b;k.socket.sendParamEvent("switchRoomMode",
a,function(a,c){null===a?(d.a.error("Error on floor request",c),b(void 0,c)):b(a)})};k.startRecording=function(a,b){b=void 0===b?function(){}:b;d.a.debug("Trying to start recording...");var c,f=!(k.subscription&&!1===k.subscription.recording);f&&(a&&!1===a.local||!a)?(a&&(c=a.getID()),y.sendMessage("startRecord",{to:c},function(a,c){null===a?(d.a.error("Error on start recording",c),p.a.error("room-event",v.a.event_start_recording_failed,{error:c,message:c.msg}),b(c),k.createEventLog("roomRecordingFailed",
{error:c,externalIp:k.externalIp})):(d.a.info("Started recording"),p.a.info("room-event",v.a.event_start_recording_success,{error:{}}),0===a.result&&(da=!0),b(a,c),k.createEventLog("roomRecordingSuccess",{externalIp:k.externalIp}))})):f||(p.a.info("room-event",v.a.event_start_recording_failed,{message:q.a.error_1170.desc}),b(q.a.error_1170))};k.mediaDeviceError=function(a){console.log("mediaDeviceError() errr: "+JSON.stringify(a)+"reconencting");k.socket.disconnect()};k.manageRecordingStatus=function(a){d.a.info("reconnected manage recording status ",
a);"moderator"===k.me.role&&1==da&&0<k.reconnectAttempt&&!0===k.reconnectionAllowed?(d.a.info("room recording was enabled before reconnect"),k.startRecord(function(a,b){null!==a?(d.a.info("reconnected manage recording success "),p.a.info("room-event",v.a.event_start_recording_success,{message:"reconnected manage recording success"})):(d.a.info("Failed to restart recording after reconnection."),p.a.error("room-event",v.a.event_start_recording_failed,{message:"Failed to restart recording after reconnection."}))})):
(d.a.info("reenbling recording for this role is not allowed ",k.me.role),p.a.info("room-event",v.a.event_start_recording_failed,{message:"reenbling recording for role "+k.me.role+" is not allowed"}))};k.stopRecording=function(a,b){b=void 0===b?function(){}:b;k.subscription&&!1===k.subscription.recording?(p.a.info("room-event",v.a.event_stop_recording_failed,{message:q.a.error_1170.desc}),b(q.a.error_1170)):y.sendMessage("stopRecord",{id:a},function(c,f){null===c?(d.a.error("Error on stop recording",
f),p.a.error("room-event",v.a.event_stop_recording_failed,{error:f}),b(f)):(da=!1,d.a.info("Stop recording",a),p.a.info("room-event",v.a.event_stop_recording_success,{error:{}}),b(c,f),k.createEventLog("roomRecordingStopped",{externalIp:k.externalIp}))})};var Da=function(a,b){var d=[];k.localStreamsBeforeReconnect.forEach(function(c,f){(c.canvas&&b||c.screen&&a||!(c.canvas||b||c.screen||a))&&d.push(c)});for(var c=0;c<d.length;c++)k.localStreamsBeforeReconnect.remove(d[c].getID())},gb=function(a){console.log("Inside storeLocalStreamForReconnect() reconnect: "+
a.reconnect+" that.reconnectionState: "+k.reconnectionState+" that.reconnectionAllowed: "+k.reconnectionAllowed+" streamId: "+a.getID()+" canvas: "+a.canvas+" screen: "+a.screen);return a.reconnect||k.reconnectionState||k.reconnectionAllowed?(Da(a.screen,a.canvas),k.localStreamsBeforeReconnect.add(a.getID(),a),!0):!1};k.unpublish=function(a,b){b=void 0===b?function(){}:b;if("function"===typeof b)if(a&&a.local){y.sendMessage("unpublish",a.getID(),function(c,f){null===c?(d.a.error("Error unpublishing stream",
f),p.a.error("room-event",v.a.event_stream_unpublish_failed,{error:f}),b(void 0,f)):(delete a.failed,p.a.error("room-event",v.a.event_stream_unpublish_success,{error:{}}),d.a.info("Stream unpublished"),b(!0))});a.room=void 0;var c=S.get(a.getID());void 0!==c&&(c.hardVideoMuted&&c.unmuteVideo(function(a){d.a.info("videoHardUnmuteCallback: "+JSON.stringify(a))},!1,0,!1),c.hardAudioMuted&&c.unmuteAudio(function(a){d.a.info("audioHardUnmuteCallback: "+JSON.stringify(a))},!1,0,!1),c.pc.close(),c.pc=null,
c.reconnect&&gb(c));S.remove(a.getID());a.setID(0);a.off("internal-send-data",Ja);a.off("internal-set-attributes",db)}else p.a.info("room-event",v.a.event_stream_unpublish_failed,{error:"Cannot unpublish, stream does not exist or is not local"}),d.a.error("Cannot unpublish, stream does not exist or is not local"),b(void 0,"Cannot unpublish, stream does not exist or is not local");else d.a.error("unpublish() invalid param - callback")};k.sendControlMessage=function(a,b,d){a&&a.getID()&&(b={type:"control",
action:d},y.sendSDP("signaling_message",{streamId:a.getID(),msg:b}))};k.subscribe=function(a,b,c){b=void 0===b?{}:b;c=void 0===c?function(){}:c;var f=JSON.parse(JSON.stringify(b));d.a.info("room.subscribe streamId: "+a.getID()+" options: "+JSON.stringify(f));if(!a||a.local||a.failed)b="Error on subscribe",a?a.local?(d.a.warning("Cannot subscribe to local stream, you should subscribe to the remote version of your local stream"),b="Local copy of stream",p.a.error("room-event",v.a.event_stream_subscribe_failed,
{error:b,stream:a})):a.failed&&(d.a.warning("Cannot subscribe to failed stream."),b="Failed stream",p.a.error("room-event",v.a.event_stream_subscribe_failed,{error:b,stream:a})):(d.a.warning("Cannot subscribe to invalid stream"),b="Invalid or undefined stream",p.a.error("room-event",v.a.event_stream_subscribe_failed,{error:b})),c(void 0,b),a={streamType:a.ifScreen()?"share":"main",streamId:a.getID(),selectedCandidates:{local:"",remote:""},negotiatedCodecs:{video:{codec:"default"===k.mediaConfiguration||
"Default"===k.mediaConfiguration?"VP8":k.mediaConfiguration},audio:{codec:"OPUS"}},error:b,externalIp:k.externalIp},k.createEventLog("clientStreamSubscribeFailed",a);else{if(a.ifMedia())a.ifVideo()||a.ifScreen()||(f.video=!1),a.ifAudio()||(f.audio=!1),a.ifCanvas()&&(f.data=!1),a.ifCanvas()||(f.canvas=!1),k.mediaConfiguration!==r.a.constant.H264_CODEC&&"safari"===D.a.browser_info.name&&D.a.browser_info.version<=r.a.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8?(f.video=!1,d.a.info("Stream for subscribe in room.subscribe:- SAFARI - false")):
k.mediaConfiguration!==r.a.constant.H264_CODEC&&"safari"===D.a.browser_info.name&&D.a.browser_info.version>=r.a.constant.SAFARI_VERSION_SUPPORTING_VP8&&(f.video=!0,d.a.info("Stream publish in Init publish:- SAFARI - true")),d.a.info("Stream for subscribe in room.subscribe:- options:: "+JSON.stringify(f)),f.muteStream={audio:a.ifCanvas()?!0:void 0!=a.audioMuted?a.audioMuted:!1,video:a.videoMuted},d.a.info("Stream for subscribe options ::: ",JSON.stringify(f)),!1===k.reconnectionState?(V=f.forceTurn?
f.forceTurn:!1,M=f.imageOnVideoMute?f.imageOnVideoMute:!1):f.forceTurn=V,d.a.debug(" Subscribe forceTurn: ( "+f.forceTurn+","+V+" ) reconnect state: "+k.reconnectionState),a.forceTurn=f.forceTurn,a.userRequestOptions=JSON.parse(JSON.stringify(b)),pa.get(a.getID())?c(q.a.error_000):Sa(a,f,c);else if(a.ifData()&&!1!==f.data)Jb(a,f,c);else{d.a.warning("There's nothing to subscribe to");c(void 0,"Nothing to subscribe to");return}d.a.info("Subscribing to: "+a.getID());p.a.info("room-event",v.a.event_stream_subscribe_success,
{message:"Subscribing to: "+a.getID()});void 0!=fa&&clearTimeout(fa);fa=setTimeout(eb,3E4)}};k.unsubscribe=function(a,b){b=void 0===b?function(){}:b;void 0!==y?a&&!a.local?a.reconnect?(console.log(" in that.unsubscribe() remove stream"),wa(a),delete a.failed,b(q.a.error_000)):y.sendMessage("unsubscribe",a.getID(),function(d,c){null===d?b(q.a.error_1167):(wa(a),delete a.failed,p.a.error("room-event",v.a.event_stream_unsubscribe_success,{message:"Unsubscribe from stream - success"}),b(q.a.error_000))},
function(){d.a.error("Error calling unsubscribe.");p.a.error("room-event",v.a.event_stream_unsubscribe_failed,{stream:a})}):b(q.a.error_1156):b(q.a.error_1163)};k.hardMute=function(a){a=void 0===a?function(){}:a;"function"===typeof a?ua("room-muted",!0,!1,!0,void 0,a):d.a.error("hardMute() invalid param - callback")};k.hardUnmute=function(a){a=void 0===a?function(){}:a;"function"===typeof a?ua("room-unmuted",!0,!1,!0,void 0,a):d.a.error("hardUnmute() invalid param - callback")};k.hardMuteUserAudio=
function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?ua("hardmute-user-audio",!0,!1,!1,a,b):d.a.error("hardMuteUserAudio() invalid param - callback")};k.hardUnmuteUserAudio=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?ua("hardunmute-user-audio",!0,!1,!1,a,b):d.a.error("hardUnmuteUserAudio() invalid param - callback")};k.hardMuteUserVideo=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?ua("hardmute-user-video",!1,!0,!1,a,b):d.a.error("hardMuteUserVideo() invalid param - callback")};
k.hardUnmuteUserVideo=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?ua("hardunmute-user-video",!1,!0,!1,a,b):d.a.error("hardUnmuteUserVideo() invalid param - callback")};k.subscriberVideoMute=function(a,b){k.socket.emitEvent(r.a.RoomEvent.subscriber_video_mute,{streamId:a},function(a){0==a.result&&b(a)})};k.setTalkerCount=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?"undefined"!=typeof a&&"number"===typeof a&&0<=a&&a===parseInt(a)?(ra=a,k.socket.emitEvent(r.a.RoomEvent.set_active_talker,
{numTalkers:a,numAudioTalkers:3>=a?3:a,numVideoTalkers:k.audioOnlyMode?0:a},function(a){0==a.result&&(k.userAudioTalkerCount=a.numAudioTalkers,!1===k.audioOnlyMode&&(k.userVideoTalkerCount=a.numVideoTalkers));b(a)})):b(q.a.error_1155):d.a.error("setTalkerCount() invalid param - callback")};k.getTalkerCount=function(a){"function"===typeof a?k.socket.sendEvent(r.a.RoomEvent.get_active_talker,function(b){a(b)}):d.a.error("getTalkerCount() invalid param - callback")};k.getMaxTalkers=function(a){"function"===
typeof a?k.socket.sendEvent(r.a.RoomEvent.get_active_max_talker,function(b){a(b)}):d.a.error("getMaxTalkers() invalid param - callback")};k.setAdvancedOptions=function(a,b){a&&a.length?k.socket.emitEvent(r.a.RoomEvent.set_adavanced_options,a,function(a){b(a)}):b(q.a.error_1155)};k.getAdvancedOptions=function(a){k.socket.sendEvent(r.a.RoomEvent.get_adavanced_options,function(b){a(b)})};k.switchUserRole=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?"moderator"===k.me.role&&a&&k.clientId&&
a!=k.clientId?k.socket.emitEvent(r.a.RoomEvent.switch_user_role,a,function(a){b(a)}):b("moderator"!==k.me.role?q.a.error_1168:k.clientId?q.a.error_1155:q.a.error_1171):d.a.error("switchUserRole() invalid param - callback")};k.switchSpeaker=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?void 0==a||void 0!=k.selectedSpeakerId&&a==k.selectedSpeakerId||void 0!=b&&"function"!==typeof b||"safari"===h.a.browserEngineCheck()?"function"===typeof b&&b("safari"===h.a.browserEngineCheck()?q.a.error_1153:
void 0==a?q.a.error_1155:q.a.error_1177):hb(a,function(d){d?(U.forEach(function(b){b.setSpeaker(a)}),k.selectedSpeakerId=a,b(q.a.error_000)):b(q.a.error_1142)}):d.a.error("switchSpeaker() invalid param - callback")};k.startLocalRecord=function(a,b,c){a=void 0===a?"remote":a;b=void 0===b?10:b;if("none"===ba){var f=[],g=0;if("remote"===a||"all"===a)U.forEach(function(a){f[g]=new Promise(function(b,d){a.startLocalRecord(respCallback=function(d){b({id:a.getID(),status:d})})});g++}),ba=a;if("local"===
a||"all"===a)S.forEach(function(a){f[g]=new Promise(function(b,d){a.startLocalRecord(respCallback=function(d){b({id:a.getID(),status:d})})});g++}),ba=a;"none"!==ba?(0!==b&&(f[g]=new Promise(function(a,d){setTimeout(function(){k.stopLocalRecord(respCallback=function(b,d){a(d)})},1E3*b)})),Promise.all(f).then(function(a){c&&(p.a.info("room-event",v.a.event_start_recording_success,{error:{}}),c(q.a.error_000,a))})):(d.a.error("invalid param type"),p.a.info("room-event",v.a.event_start_recording_failed,
{error:"invalid param type"}),c&&c(q.a.error_1155))}else d.a.error("recording already in progress"),p.a.info("room-event",v.a.event_start_recording_failed,{error:"recording already in progress"}),c&&c(q.a.error_1174)};k.stopLocalRecord=function(a){if("none"!==ba){var b=0;"remote"!==ba&&"all"!==ba||U.forEach(function(a){new Promise(function(b,d){a.stopLocalRecord(respCallback=function(d){b({id:a.getID(),status:d})})});b++});"local"!==ba&&"all"!==ba||S.forEach(function(a){new Promise(function(b,d){a.stopLocalRecord(respCallback=
function(d){b({id:a.getID(),status:d})})});b++});ba="none";p.a.error("room-event",v.a.event_stop_recording_success,{error:{}})}else d.a.error("recoding not stopped"),p.a.info("room-event",v.a.event_stop_recording_failed,{message:q.a.error_1175.desc}),a&&a(q.a.error_1175)};k.setReceiveVideoQuality=function(a,b){if("[object Object]"===Object.prototype.toString.call(a)&&"function"===typeof b){var c={},f={},g={};g=a.videoQuality;var e=a.streamType;void 0===g&&(g="Auto");void 0===e&&(e="talker");d.a.info("Dumping opts in setReceiveVideoQuality"+
JSON.stringify(a)+" streamType"+e);if("talker"!=e&&"canvas"!=e)d.a.info("setReceiveVideoQuality Failed Invalid Param -StreamType: "+e),b(q.a.error_1155);else{switch(g){case "HD":f.width=1280;f.height=720;break;case "SD":f.width=960;f.height=540;break;case "LD":f.width=640;f.height=360;break;case "Auto":break;default:d.a.info("setReceiveVideoQuality for "+e+". Failed Invalid Param -videoQuality: "+g);b(q.a.error_1155);return}f.frameRate=30;c.video=f;if("talker"==e&&k.receiveVideoQuality.get("talker")!==
g||"canvas"==e&&k.receiveVideoQuality.get("canvas")!==g)U.forEach(function(a){"talker"===e&&!1===a.canvas&&!1===a.screen?a.updateConfiguration(c,function(a){d.a.info("stream.updateConfiguration for talker stream result : "+a)}):"canvas"===e&&!0===a.canvas&&a.updateConfiguration(c,function(a){d.a.info("stream.updateConfiguration for canvas stream result : "+a)})}),k.receiveVideoQuality.set(e,g);g={result:0,msg:"Video quality successfully updated."};b(g)}}else"function"!==typeof b?d.a.error("setReceiveVideoQuality() invalid param - callback() "):
(d.a.error("setReceiveVideoQuality() invalid param - QualityOpt "),b(q.a.error_1155))};k.getReceiveVideoQuality=function(a){return"talker"===a||"canvas"===a?{result:0,videoQuality:k.receiveVideoQuality.get(a)}:q.a.error_1156};k.getStreamStats=function(a,b){b=void 0===b?function(){}:b;if(!y)return"Error getting stats - no socket";if(!a)return"Error getting stats - no stream";y.sendMessage("getStreamStats",a.getID(),function(a){a&&b(a)})};k.getStreamsByAttribute=function(a,b){var d=[];U.forEach(function(c){void 0!==
c.getAttributes()&&c.getAttributes()[a]===b&&d.push(c)});return d};k.installPlugin=function(){if(!document.getElementById("WebrtcEverywherePluginId")){var a=!!(Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window);navigator.userAgent.indexOf("Safari");var b=document.createElement("object");a?b.setAttribute("classid","CLSID:7FD49E23-C8D7-4C4F-93A1-F7EACFA1EC53"):b.setAttribute("type","application/webrtc-everywhere");b.setAttribute("id",
"WebrtcEverywherePluginId");document.body.appendChild(b);b.setAttribute("width","0");b.setAttribute("height","0");b.isWebRtcPlugin||"undefined"!==typeof navigator.plugins&&(navigator.plugins["WebRTC Everywhere"]||navigator.plugins["WebRTC Everywhere Plug-in for Safari"])?(d.a.info("Installed WEBRTC plugin for IE"),p.a.info("room-event",v.a.event_general_success,{message:"Installed WEBRTC plugin for IE"})):(d.a.info("Browser does not appear to be WebRTC-capable"),p.a.warn("room-event",v.a.event_incompatible_browser,
{message:"Browser does not appear to be WebRTC-capable"}),window.open("/assets/plugin/VCXIE_PLUGINS.exe","new"))}};k.sendStoredLogs=function(a,b){k.socket.sendSDP("clientLogPosted",a,d.a.storedBuff,function(a,d){a?a&&(a={result:0,message:"Log posted successfully"},b(a)):(a={result:1340,message:"Error in posing log"},b(a))})};k.postClientLogs=function(a,b){b=void 0===b?function(){}:b;if("function"===typeof b){var c=w.a.decodeBase64(a);a=D.a.getLocalStorageItem("vcxRTCLib-log");null!=a&&(c=JSON.parse(c).logId,
JSON.parse(a),JSON.stringify(a).replace(",",", ").replace("{","").replace("}",""),k.sendStoredLogs(c,b))}else d.a.error("postClientLogs() invalid param - callback")};k.whoAmI=function(a){a=void 0===a?function(a){}:a;var b;k.userList.forEach(function(a,d){d===k.clientId&&(b=a)});a(b)};k.startScreenShare=function(a,b){var c;if(void 0!=a&&"function"===typeof a)var f=a;else void 0!=b&&"function"===typeof b&&(void 0!=a&&(c=a),f=b);if("function"===typeof f){void 0==c?(c={},c.audio="chrome-stable"===D.a.browser_info.name||
"edge"===D.a.browser_info.name?!0:!1):void 0==c.audio&&(c.audio=!1);c.layout=void 0!=c.layout?c.layout:"grid";k.shareOverRide=!1;k.shareOverRide=void 0!=c.shareOverride?c.shareOverride:k.share_override_room;k.shareOverRideCallback=1==k.shareOverRide?f:void 0;if(k&&k.share&&(!k.subscription||k.subscription.audio_video))var g=mc(c,function(a){!0===a?k.publish(g,{share:!0,maxVideoBW:D.a.video_bandwidth_range.share.max,minVideoBW:D.a.video_bandwidth_range.share.min,shareMetadata:{layout:c.layout}},function(a){f(a);
0===a.result?(a={streamId:g.getID(),negotiatedCodecs:{video:{codec:"default"===k.mediaConfiguration||"Default"===k.mediaConfiguration?"VP8":k.mediaConfiguration},audio:{codec:"OPUS"}},externalIp:k.externalIp},d.a.info("additionalOptions:",a),p.a.info("room-event",v.a.event_start_screenshare_success,{error:{}}),na(!0,k.canvasStatus),k.createEventLog("clientStreamShareSuccess",a)):4108===a.result&&(a={streamId:g.getID(),negotiatedCodecs:{video:{codec:"default"===k.mediaConfiguration||"Default"===k.mediaConfiguration?
"VP8":k.mediaConfiguration},audio:{codec:"OPUS"}},externalIp:k.externalIp,error:a.msg},k.createEventLog("clientStreamShareFailed",a),p.a.info("room-event",v.a.event_start_screenshare_failed,{additionalOptions:a}),g.stream.getTracks().forEach(function(a){a.stop()}))}):f(a)});else a=k?q.a.error_1170:q.a.error_1171,d.a.info("Room not connected../ licence error"),p.a.info("room-event",v.a.event_start_screenshare_failed,{error:a}),f(a);return g}d.a.error("startScreenShare() invalid param - callback")};
k.getScreenShareStream=function(){return k.ScreenSharelocalStream};k.stopScreenShare=function(a,b){b=void 0===b?function(){}:b;if("function"===typeof b){var c=q.a.error_1159;if(k&&k.share&&(!k.subscription||k.subscription.audio_video)){var f;k.localStreams.forEach(function(a){a.ifScreen()&&a.local&&(Da(!0,!1),a.close(),f=a,c=q.a.error_000,p.a.error("room-event",v.a.event_stop_screenshare_success,{error:{}}))});na(!1,k.canvasStatus);void 0!=f&&k.localStreams.remove(f.getID())}else c=k?q.a.error_1170:
q.a.error_1171,d.a.info("Room not connected../ licence error"),p.a.info("room-event",v.a.event_stop_screenshare_failed,{error:c});k.ScreenSharelocalStream=null;b?b(c):a&&"function"===typeof a&&a(c)}else d.a.error("stopScreenShare() invalid param - callback")};k.stopAllSharing=function(a){console.log("stopAllSharing");1!=k.shareStatus&&1!=k.isCanvasSharing||k.socket.sendParamEvent("stopAllSharing",k.clientId,function(b){0!=b.result&&(d.a.error(b.msg),b.result=-1);a(b)})};var nc=function(a){a=Object(l.e)({type:"custom-data-saved",
message:{result:a.result,scope:a.scope}});k.dispatchEvent(a)},oc=function(a){a=Object(l.e)({type:"custom-data-updated",message:{result:a.result,scope:a.scope,msg:a.msg}});k.dispatchEvent(a)};k.saveCustomData=function(a,b,c){var f={result:0};if(0==P(a))f.result=1,f.msg="Invalid scope parameter: "+a,c(f);else if(void 0==b||"object"!=typeof b)f.result=1,f.msg="Invalid  data",c(f);else{var g=Object.keys(b);g=$jscomp.makeIterator(g);for(var e=g.next();!e.done;e=g.next())if(""===e.value){f.result=1;f.msg=
"Empty string as key not allowed.";c(f);return}k.socket.sendParamEvent("saveCustomData",{scope:a,data:b},function(a){0!=a.result&&d.a.error(a.msg);c(a)})}};k.setCustomData=function(a,b,c){var f={result:0};if(0==P(a))f.result=1,f.msg="Invalid scope parameter: "+a,c(f);else if(void 0==b||"object"!=typeof b)f.result=1,f.msg="Invalid  data",c(f);else{var g=Object.keys(b);g=$jscomp.makeIterator(g);for(var e=g.next();!e.done;e=g.next())if(""===e.value){f.result=1;f.msg="Empty string as key not allowed.";
c(f);return}k.socket.sendParamEvent("setCustomData",{scope:a,data:b},function(a){0!=a.result&&d.a.error(a.msg);c(a)})}};k.getCustomData=function(a,b){var c={result:0};void 0==a||"object"!=typeof a?(c.result=1,c.msg="Invalid  options",b(c)):0==P(a.scope)?(c.result=1,c.msg="Invalid scope parameter: "+a.scope,b(c)):k.socket.sendParamEvent("getCustomData",{scope:a.scope,options:a},function(a){0!=a.result&&d.a.error(a.msg);b(a)})};k.lock=function(a){kb(!0,a)};k.unlock=function(a){kb(!1,a)};k.dropUser=
function(a,b){b=void 0===b?function(){}:b;if(void 0===a||null===a||Array.isArray(a)&&"function"===typeof b&&"moderator"===k.me.role){var c={all:!1};c.clientIds=void 0===a||null===a?[]:a;k.socket.emitEvent(r.a.RoomEvent.drop,c,b)}else"function"===typeof b?b("moderator"!==k.me.role?q.a.error_1168:q.a.error_1155):d.a.error("dropUser() invalid param - callback")};k.pinUsers=function(a,b){lb(!0,a,void 0===b?function(){}:b)};k.unpinUsers=function(a,b){lb(!1,a,void 0===b?function(){}:b)};k.addSpotlightUsers=
function(a,b){mb(!0,a,void 0===b?function(){}:b)};k.removeSpotlightUsers=function(a,b){mb(!1,a,void 0===b?function(){}:b)};k.destroy=function(a){a=void 0===a?function(){}:a;"function"===typeof a&&"moderator"===k.me.role?k.socket.emitEvent(r.a.RoomEvent.drop,{all:!0,clients:null},function(a){}):"function"===typeof a?(p.a.info("room-event",v.a.event_general_success,{message:"destroy - "+q.a.error_1168}),a(q.a.error_1168)):d.a.error("() invalid param - callback")};k.setAudioOnlyMode=function(a,b){b=
void 0===b?function(){}:b;if(void 0!==a&&"boolean"===typeof a&&a!=k.audioOnlyMode&&"function"===typeof b){var c=[],f={numTalkers:k.userVideoTalkerCount,numAudioTalkers:k.userAudioTalkerCount};c[0]=new Promise(function(b,d){f.numVideoTalkers=a?0:k.userVideoTalkerCount;k.socket.emitEvent(r.a.RoomEvent.set_active_talker,f,function(a){b(a)})});c[1]=new Promise(function(b,d){S.forEach(function(d,c){d&&d.ifVideo()&&(a?d.muteVideo:d.unmuteVideo)(function(a){b(a)})})});Promise.all(c).then(function(d){for(var c=
0;c<d.length;c++)if(0!==d[c].result&&d[c].result!==q.a.error_1177.result){b(d[c].result);return}k.audioOnlyMode=a;b(q.a.error_000)})}else c=void 0===a||"boolean"!==typeof a?q.a.error_1168:q.a.error_1188,"function"===typeof b?b(c):d.a.error("setAudioOnlyMode() invalid param - callback")};var hb=function(a,b){h.a.getDeviceList(function(d){var c=!1;if(0==d.result)for(var f=0;f<d.devices.speaker.length;f++)if(d.devices.speaker[f].deviceId==a){c=!0;break}b(c)})},kb=function(a,b){b=void 0===b?function(){}:
b;"function"===typeof b?"moderator"===k.me.role&&a!=k.locked?k.socket.emitEvent(r.a.RoomEvent.lock_room,a,function(d){0===d.result&&(k.locked=a);b(d)}):b("moderator"!==k.me.role?q.a.error_1168:q.a.error_4121):d.a.error("lockRoom() invalid param - callback")},lb=function(a,b,c){c=void 0===c?function(){}:c;void 0===b||null===b||Array.isArray(b)&&b.length&&"function"===typeof c&&"moderator"===k.me.role?k.setAdvancedOptions([{id:"update-pin-users",request:a?"add":"remove",clientIds:b}],c):"function"===
typeof c?c("moderator"!==k.me.role?q.a.error_1168:q.a.error_1155):d.a.error("pinUsers() invalid param - callback")},mb=function(a,b,c){c=void 0===c?function(){}:c;void 0===b||null===b||Array.isArray(b)&&b.length&&"function"===typeof c&&"moderator"===k.me.role?k.setAdvancedOptions([{id:"spotlight-users",request:a?"add":"remove",clientIds:b}],c):"function"===typeof c?c("moderator"!==k.me.role?q.a.error_1168:q.a.error_1155):d.a.error("spotlightUsers() invalid param - callback")},ma=function(a,b,c){c=
void 0===c?function(){}:c;void 0!==a&&"string"===typeof a?k.socket.sendSDP("processFloorRequest",a,b,function(a,f){null===a?(d.a.error("Error on "+b+" error: "+f),c(void 0,f)):c(a)}):(d.a.error(" Floor Req : "+b+"Invalid params"),c(void 0,q.a.error_1155))};k.sendSocketEvent=function(a,b){b=void 0===b?function(){}:b;k.socket.emitEvent("logClientEvents",a,function(a,d){d?b(d,"error"):b(a,"success")})};k.createEventLog=function(a,b){var c={eventType:a,roomId:k.roomID,logId:Z.logId,timestamp:new Date};
Object.assign(c,b);d.a.info(a+" :",c);k.sendSocketEvent(c,function(b,c){d.a.info("Logging "+a+" response:  "+JSON.stringify(b)+" , "+c+" ")})};var jb=function(){if(!1===k.reconnectionState){k.sendRecvBitrateStats||(k.sendRecvBitrateStats=!0);var a=[],b=0;U.forEach(function(c){c.pc&&c.pc.peerConnection&&(a[b]=c.pc.peerConnection.getStats(null).then(function(a){var b;a.forEach(function(a){"candidate-pair"===a.type&&void 0!==a.availableIncomingBitrate&&(d.a.debug("incoming bitrate: "+a.availableIncomingBitrate),
b={streamId:c.getID(),availableRecvBitrate:parseInt(a.availableIncomingBitrate)})});return b||{streamId:c.getID(),availableRecvBitrate:0}},function(a){console.log(a);return{streamId:c.getID(),availableRecvBitrate:0}}),b++)});Promise.all(a).then(function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].availableRecvBitrate;d.a.info("Bitrates Total:"+b+" streamInfo: "+JSON.stringify(a));k.socket.emitEvent(r.a.RoomEvent.client_stats,{media:{subscribers:{totalAvailableBw:b}}},function(a){})});d.a.debug("Setting timeout again to execute ");
setTimeout(jb,5E3)}else k.sendRecvBitrateStats=!1},ib=function(a,b){if(void 0==a.videoSize)if(b)a.videoSize=[X.min.width,X.min.height,X.max.width,X.max.height];else return d.a.error(" Failed : video size undefined"),q.a.error_1184;else{b=a.videoSize[0]*a.videoSize[1];var c=a.videoSize[2]*a.videoSize[3],f=X.min.width*X.min.height,g=X.max.width*X.max.height;if(b<f||b>g||c>g||c<f||b>c)return d.a.error(" Failed : video size invalid minPixelsSet:"+b+" minPixelsConfig:"+f+" maxPixelsSet: "+c+" maxPixelsConfig: "+
g+" req: min: "+a.videoSize[0]+" X "+a.videoSize[1]+" max: "+a.videoSize[2]+" X "+a.videoSize[3]+" config: min: "+X.min.width+" X "+X.min.height+" max: "+X.max.width+" X "+X.max.height),q.a.error_1184}return q.a.error_000};k.initPublishStream=function(a,b,c,f){if(void 0!==b)if(b.audio||b.video||b.screen||b.canvas){b.video&&k.mediaConfiguration!==r.a.constant.H264_CODEC&&"safari"===D.a.browser_info.name&&D.a.browser_info.version<=r.a.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8&&(b.video=!1,d.a.info("Stream publish in Init publish:- SAFARI - false"));
if(b.video&!b.canvas){var g=ib(b,!0);if(g.result!==q.a.error_000.result){d.a.error(" Failed : initPublishStream(): video size invalid");p.a.error("room-event",v.a.event_general_failed,{message:"initPublishStream - video size invalid"});f(g);return}}console.log("video Size: "+JSON.stringify(X)+" config.video_resolution_range: "+D.a.video_resolution_range+" token.roomMeta.settings.quality: "+Z.roomMeta.settings.quality+" room meta: "+JSON.stringify(Z.roomMeta)+" video Size: "+D.a.video_resolution_range[Z.roomMeta.settings.quality]);
void 0!=b.videoSize&&b.videoSize.length||(b.videoSize=[X.min.width,X.min.height,X.max.width,X.max.height]);var e=EnxRtc.EnxStream(b)}else d.a.error(" Failed : all stream opions (audio/video/screen/canvas)  false/undefined"),p.a.error("room-event",v.a.event_general_failed,{message:"initPublishStream - all stream opions (audio/video/screen/canvas) false/undefined"}),f(q.a.error_1155);else p.a.info("room-event",v.a.event_stream_publish_success,{message:"initPublishStream - success"}),e=EnxRtc.EnxStream({audio:!0,
video:!0,data:!0,videoSize:[X.min.width,X.min.height,X.max.width,X.max.height]});"IE"===h.a.browserEngineCheck()?document.getElementById("WebrtcEverywherePluginId").addEventListener("media-access-allowed",function(b){d.a.info("got media access:- "+JSON.stringify(b));null!==document.getElementById(a)&&e.play(a);c()}):(e.addEventListener("media-access-denied",f),e.addEventListener("media-access-failed",f),e.addEventListener("media-access-allowed",function(d){null!==document.getElementById(a)&&e.play(a,
b.options);c(d.stream)}));e.init();return e};var mc=function(a,b){if(k.shareStatus&&!1===k.reconnectionState)0==k.shareOverRide?b(q.a.error_1151):(k.isOverRidingShare=!0,k.socket.sendParamEvent("screenShareOverRide",k.clientId,function(a,c){null===a&&(d.a.error("Error on stop screen share request",c),b(void 0,c))}));else{var c={video:!0,data:!0,screen:!0,fps:k.screenResolutionRange.fps,attributes:{name:"share"}};k.whoAmI(function(a){c.attributes.name=a.name+"_share"});c.audio=void 0!=a&&void 0!=a.audio?
a.audio:!1;return k.initPublishStream("",c,function(){p.a.info("room-event",v.a.event_start_screenshare_success,{error:{}});b(!0)},function(a){"OverconstrainedError"===a.msg.name&&d.a.info("Resolution selected is not supported by your webcam");p.a.error("room-event",v.a.event_start_screenshare_failed,{event:a});b(a.msg)})}},ob=function(a,b,d){b=void 0===b?null:b;if(a)return a;b.style.position="relative";a=document.createElement("div");a.setAttribute("class","annotate-div");a.setAttribute("style",
"display:flex;justify-content: center;align-items: center;height: 100%;width: 100%;");d=document.querySelector("#player_"+d.getID()).parentElement;var c=document.createElement("canvas"),f=k.canvasVideoPlayer+"_veneer";c.id=f;c.width=b?b.clientWidth:k.canvasOptions.width;c.height=b?b.clientHeight:k.canvasOptions.height;b.style.height=c.height+"px";b.style.width=c.width+"px";c.className=k.canvasVideoPlayer+"_input_veneer";c.setAttribute("style","display:none;");document.body.appendChild(c);if(b){k.canvasOptions.width=
b.clientWidth;k.canvasOptions.height=b.clientHeight;var g=document.createElement("div");g.setAttribute("id","canvas-wrapper");g.setAttribute("class","canvas-wrapper");g.style="position:absolute;top:0;";g.append(c);F.a.appendCustomCanvas(g,c.className,c.width,c.height);document.getElementById(b.id).appendChild(g)}else document.body.appendChild(wrapper);null!=b&&(a.appendChild(b),d.prepend(a));F.a.bindEventListernersForTools();k.inputContext=c.getContext("2d");nb();return f},nb=function(){var a=document.getElementById("draw_veneer2");
if(a){var b=a.toDataURL("image/png"),d=new Image;d.onload=function(){k.inputContext.globalAlpha=1;k.inputContext.drawImage(d,0,0,a.width,a.height)};d.src=b;k.inputContext.globalAlpha=.1;k.inputContext.drawImage(k.canvas_video_player,0,0,a.width,a.height);requestAnimationFrame(nb)}};k.annotateToolAction=function(a,b){F.a.toolBarAction(a,b)};k.startAnnotation=function(a,b){var c=document.getElementById("canvas-wrapper");c&&c.remove();try{if(a){var f=a.getID(),g=document.querySelector("#player_"+f);
if(g){var e=Oa();console.log(e,"status");k.canvas_video_player=document.getElementById("stream"+f);k.canvasVideoPlayer="stream"+f;if(e.result===q.a.error_000.result){var h=ob(null,g,a);k.startCanvas({canvasSelector:h,fps:23,canvasType:"Annotation"},function(a){0==a.result&&b&&b(e)});za=!1;ha=!0;p.a.info("room-event",v.a.event_start_annotation_success,{error:{}});F.a.mouseAnnotate(h,k.inputContext,"player_"+f,a)}else b&&b(e)}}}catch(Ia){console.info(Ia,"error"),d.a.error("incorrect annotate params "+
Ia),p.a.error("room-event",v.a.event_start_annotation_failed,{error:Ia}),b&&b(q.a.error_1155)}};k.stopAnnotation=function(a){ha=!1;k.stopCanvas(a);F.a.stopAnnotation()};k.adjustCanvas=function(){F.a.resize()};k.startCanvas=function(a,b){b=void 0===b?function(){}:b;if("function"===typeof b){var c=a?a.canvasSelector:"";try{var f=Oa();if(f.result===q.a.error_000.result){var g=ob(c);if(a){var e=a.fps?a.fps:k.canvasOptions.fps;var h=a.canvasType?a.canvasType:"default"}else e=k.canvasOptions.fps,h="default";
var u=pc({domHandle:g,fps:23<e?23:e,canvasType:h,refreshFn:a.refreshFn,maxRefreshRate:k.maxCanvasRefreshRate},function(a,c){"success"===c?k.publish(a,{canvas:!0,canvasType:h,maxVideoBW:D.a.video_bandwidth_range.canvas.max,minVideoBW:D.a.video_bandwidth_range.canvas.min},function(a){0===a.result&&(d.a.info("startCanvas response.result:",a),p.a.info("room-event",v.a.event_start_canvas_success,{error:{}}),na(k.shareStatus,!0),b&&b(a))}):b&&b(a)})}else b&&b(f)}catch(cb){d.a.error("incorrect canvas params "+
cb),p.a.error("room-event",v.a.event_start_canvas_failed,{error:cb}),b&&b(q.a.error_1155)}return u}d.a.error("startCanvas() invalid param - callback")};k.playVideo=function(a,b,d){k.canvasVideoPlayer=a;a=document.querySelector("#"+a);void 0===a||null===a?d(q.a.error_1162):(k.canvas_video_player=a,b&&(k.canvasOptions.width=b.width?b.width:k.canvasOptions.width,k.canvasOptions.height=b.height?b.height:k.canvasOptions.height,k.canvasOptions.fps=b.fps?b.fps:23),k.startCanvas({fps:b.fps},d))};k.stopCanvas=
function(a){a=void 0===a?function(){}:a;if("function"===typeof a){var b=Oa();if(b.result===q.a.error_000.result){var c;k.localStreams.forEach(function(b){b&&b.ifCanvas()&&(Da(!1,!0),c=b,b.stream.getTracks().forEach(function(a){a.stop()}),b.onStateChanged(!1),b.close(),p.a.info("room-event",v.a.event_stop_canvas_success,{error:{}}),a({result:0,msg:"Canvas stopped successfully."}))});na(k.shareStatus,!1);void 0!=c&&k.localStreams.remove(c.getID())}else p.a.error("room-event",v.a.event_stop_canvas_failed,
{error:{}}),a(b)}else d.a.error("stopCanvas() invalid param - callback")};k.isModerator=function(){return k.me&&"moderator"===k.me.role};var ua=function(a,b,d,c,f,g){b=qc(b,d,!0);b.result===q.a.error_000.result&&(c||f&&"string"===typeof f)?k.socket.sendMessage(a,{clientId:f},function(a){g(a)}):g(b.result!==q.a.error_000.result?b:q.a.error_1155)},qc=function(a,b,c){a=!k.subscription||(!b||k.subscription.audio_video)&&(!a||k.subscription.audio_only||k.subscription.audio_video);if(k&&a&&(!c||"moderator"===
k.me.role))return q.a.error_000;c=k?a?q.a.error_1168:q.a.error_1170:q.a.error_1171;d.a.error("validateCanvas error code "+c.result);return c},Oa=function(){if(k&&(!k.subscription||k.subscription.audio_video)&&("lecture"!==k.mode||"moderator"===k.me.role||!0===k.floorGranted))return q.a.error_000;var a=k?!k.subscription||k.subscription.audio_video?q.a.error_1173:q.a.error_1170:q.a.error_1171;d.a.error("validateCanvas error code "+a.result);return a},pc=function(a,b){var c=null,f={video:!0,canvas:!0,
attributes:{name:"canvas"}};!1===f.canvas&&(f.canvas=!0);!1===f.video&&(f.video=!0);!0===f.audio&&(f.audio=!1);f.div||(f.div=a.domHandle);f.fps||(f.fps=a.fps);void 0!=a.refreshFn&&(f.refreshFn=a.refreshFn,f.maxCanvasRefreshRate=a.maxRefreshRate);void 0===f.attributes?f.attributes={name:"canvas"}:(void 0===f.attributes.name||"canvas"===f.attributes.name)&&k.whoAmI(function(a){f.attributes.name=a.name+"_canvas"});f.videoSize=[1920,1080,1920,1080];d.a.info("initcanvas config "+JSON.stringify(f));k.initPublishStream("",
f,function(a){c=a;b(c,"success")},function(a){"OverconstrainedError"===a.msg.name&&d.a.info("Resolution selected is not supported by your webcam");b(a.msg,"error")});return c},rc=function(a){var b=null;k.isCanvasSharing=!0;k.clientId==a.clientId&&(k.isCanvasSharingClient=!0);za?b=Object(l.e)({type:"annotation-started-ack",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,canvasType:a.canvasType}}):"Annotation"===a.canvasType?(ha=!0,b=Object(l.e)({type:"canvas-started",message:{clientId:a.clientId,
name:a.name,streamId:a.streamId,canvasType:a.canvasType}})):(k.canvasStatus=!0,ha&&(k.canvasStatus=!1),ha=!1,b=Object(l.e)({type:"canvas-started",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,canvasType:a.canvasType?a.canvasType:"default"}}));na(k.shareStatus,!0);k.dispatchEvent(b);d.a.debug("onCanvasStarted event :",JSON.stringify(b));a.streamId?(a=U.get(a.streamId))&&!a.failed?a._setStaticQualityLayer(2,-1,function(a){d.a.info("stream._setStaticQualityLayer (2/-1) for canvas result : "+
a)}):d.a.error("canvas started:stream is undefined or failed"):d.a.error("canvas arg.streamId is undefined")},sc=function(a){a=Object(l.e)({type:"canvas-stopped",message:{clientId:a.clientId,name:a.name,streamId:a.streamId}});k.canvasStatus=!1;k.isCanvasSharing=!1;na(k.shareStatus,!1);d.a.debug("onCanvasStopped event :",JSON.stringify(a));k.dispatchEvent(a);k.isCanvasSharingClient=!1},tc=function(a){d.a.info("canvasStateEvents");!0===a.videomuted?(a=Object(l.e)({type:"canvas-state-events",message:"Canvas stopped",
reason:"bw"}),k.dispatchEvent(a)):(a=Object(l.e)({type:"canvas-state-events",message:"Canvas resumed",reason:"bw"}),k.dispatchEvent(a))},uc=function(a){d.a.info("shareStateEvents");!0===a.videomuted?(a=Object(l.e)({type:"share-state-events",message:"Share stopped",reason:"bw"}),k.dispatchEvent(a)):(a=Object(l.e)({type:"share-state-events",message:"Share resumed",reason:"bw"}),k.dispatchEvent(a))},vc=function(a){if("speaker_notification"===a.id){a.id="talker-notification";for(var b={},d=$jscomp.makeIterator(a.data),
c=d.next();!c.done;c=d.next())c=c.value,!0===c.speech?b.speech=c.users:!0===c.noise&&(b.noise=c.users);a=Object(l.e)({type:a.id,message:b});k.dispatchEvent(a)}else a=Object(l.e)({type:a.id,message:a.data}),k.dispatchEvent(a)},wc=function(a){d.a.debug("onUserRoleChangedEvent"+JSON.stringify(a)+" ownclientId: "+k.clientId);a.moderator.new===k.clientId?"participant"===k.me.role?(k.me.role="moderator","lecture"===k.mode&&(k.cCrequest=[],k.cCapprovedHands=[],0<a.raisedHands.length&&a.raisedHands.forEach(function(a){k.cCrequest.push(a)}),
0<a.approvedHands.length&&a.approvedHands.forEach(function(a){k.cCapprovedHands.push(a)}))):d.a.info("onUserRoleChangedEvent() Already Moderator - no change"):a.moderator.old===k.clientId&&("moderator"===k.me.role?(k.me.role="participant","lecture"===k.mode&&(k.cCrequest=[],k.cCapprovedHands=[],k.localStreams.getAll(),S.forEach(function(a,b){k.unpublish(a,function(b){1==b?d.a.info("stream has been un-published"):(d.a.info("error during stream un-publishing"),p.a.error("room-event",v.a.event_stream_unpublish_failed,
{stream:a}))})}))):d.a.info("onUserRoleChangedEvent() Already partcipant - no change"));a=Object(l.e)({type:"user-role-changed",message:a});k.dispatchEvent(a)},xc=function(a){d.a.debug("onUserRoleChangedEvent"+JSON.stringify(a)+" ownclientId: "+k.clientId);"lecture"===k.mode?(k.mode="group",k.roomSettings.mode="group",k.cCrequest=[],k.cCapprovedHands=[]):"group"===k.mode&&(k.roomSettings.mode="lecture",k.mode="lecture",k.cCrequest=[],k.cCapprovedHands=[],"participant"===k.me.role?S.forEach(function(a,
b){k.unpublish(a,function(b){1==b?d.a.info("stream has been un-published"):(d.a.info("error during stream un-publishing"),p.a.error("room-event",v.a.event_stream_unpublish_failed,{stream:a}))})}):d.a.info("onUserRoleChangedEvent() Already Moderator - no change"));a=Object(l.e)({type:"room-mode-switched",message:{mode:k.mode,moderator:a.moderator}});k.dispatchEvent(a)},yc=function(a){d.a.info("onRoomManagementEvents:"+JSON.stringify(a));var c={};switch(a.id){case "room-locked":case "room-unlocked":k.locked=
"room-locked"===a.id;c=a.msg;break;case "floor-opened":k.floorOpen=!0;break;case "floor-closed":k.floorOpen=!1;break;case "knock-enabled":k.knockEnabled=!0;break;case "knock-disabled":k.knockEnabled=!1;k.awaitedParticipants.clear();break;case "wait-room-disabled":k.waitRoom&&(k.waitRoom=!1);for(var f=[],g=a.roomData.streams||[],e=Object.keys(g),p=a.roomData.userList,h=0;h<e.length;h+=1){var q=g[e[h]];c=Object(b.a)(k.Connection,{streamID:q.id,local:!1,audio:q.audio,video:q.video,data:q.data,screen:q.screen,
canvas:!("undefined"===typeof q.canvas||!1===q.canvas),attributes:q.attributes});f.push(c);U.add(q.id,c)}for(var u in p)k.userList.set(p[u].clientId,p[u]);k.videoMutedUsers=a.roomData.videoMutedUsers||[];c={streams:f,users:p};break;default:c=a.msg}a=Object(l.e)({type:a.id,message:c});k.dispatchEvent(a)},zc=function(a){d.a.info("Recieved an invite to join breakout room "+JSON.stringify(a));d.a.info("Join Breakout Room event dispatched");if(!0===a.force_join){var b=Object(l.e)({type:"breakout-room-joining",
message:{room_id:a.room_id,requestor:a.requestor}});k.dispatchEvent(b);k.muteRoom({audio:!0,video:!0},function(b){0===b.result?S.forEach(function(b,d){b.screen||b.canvas||!b.ifAudio()&&!b.ifVideo()||k.joinBreakOutRoom({room_id:a.room_id,role:"participant"},{audio:!0,video:!1},function(a,b){a?(a=Object(l.e)({type:"breakout-room-connected",streams:a.streams,room:a.room,roomData:a.roomData,localBreakoutStream:a.localBreakoutStream}),k.dispatchEvent(a)):b&&(a=Object(l.e)({type:"breakout-room-error",message:b}),
k.dispatchEvent(a))})}):(b=Object(l.e)({type:"breakout-room-error"},{message:"mute room request failed"}),k.dispatchEvent(b))})}else b=Object(l.e)({type:"join-breakout-room",message:{room_id:a.room_id,requestor:a.requestor}}),k.dispatchEvent(b)};k.rejectBreakoutRoomInvite=function(a,b){b=void 0===b?function(){}:b;d.a.info("Rejecting the breakout room invite ",a);a?k.socket.sendMessage("reject-breakout-room",a,function(a){a&&(d.a.info("Reject breakout room, result: "+JSON.stringify(a)),b(a))}):(d.a.info("Invalid value room_id"),
b&&b(q.a.error_1155))};var Ac=function(a){d.a.info("Recieved user joined breakout room "+JSON.stringify(a));a=Object(l.e)({type:"user-joined-breakout-room",message:{clientId:a.client}});k.dispatchEvent(a)},Bc=function(a){d.a.info("USER DISCONNECTED BREAKOUT ROOM "+JSON.stringify(a));a=Object(l.e)({type:"user-disconnected-breakout-room",message:{name:a.name,clientId:a.clientId,room:a.room}});k.dispatchEvent(a)},Cc=function(a){d.a.info("BREAKOUT ROOM DESTROYED"+JSON.stringify(a));a=Object(l.e)({type:"breakout-room-destroyed",
message:{room_id:a.room_id}});k.dispatchEvent(a)},Dc=function(a){d.a.info("Received transcription events: "+JSON.stringify(a));a=Object(l.e)({type:"transcription-events",message:{data:a}});k.dispatchEvent(a)};k.extendConferenceDuration=function(a){a=void 0===a?function(){}:a;"function"===typeof a?k.socket.emitEvent(r.a.RoomEvent.extend_conference_duration,{},function(b){a(b)}):d.a.error("extendConferenceDuration() : failed Invalid param. callback is not function")};k.subscribeMediaStats=function(a,
b){b=void 0===b?function(){}:b;if(void 0!==a&&"string"===typeof a&&"function"===typeof b)if(2!==k.state||k.mediaStatsMode==a||"disable"!=a&&"notify"!=a&&"display"!=a&&"notify-display"!=a){var c=2!==k.state?q.a.error_1171:k.mediaStatsMode==a?q.a.error_1188:q.a.error_1155;d.a.error("that.subscribeMediaStats () error: "+JSON.stringify(c));b(c)}else{var f=function(a){var b=document.querySelectorAll(".stats-container"),d=document.querySelectorAll(".stats-overlay");b.forEach(function(b){void 0!==b&&null!==
b&&(b.style.display=a)});d.forEach(function(b){void 0!==b&&null!==b&&(b.style.display=a)})};"disable"==a||"disable"==k.mediaStatsMode?S.forEach(function(b,d){b.ifCanvas()||b.ifScreen()||y.sendMessage("subscribeStreamStatsForClient",{streamId:d,statsEnabled:"disable"!=a},function(b){void 0!=b&&("Success"===b.status&&f("display"==a||"notify-display"==a?"block":"none"),k.mediaStatsMode=a)})}):(f("display"==a||"notify-display"==a?"block":"none"),k.mediaStatsMode=a)}else d.a.error("that.subscribeMediaStats () invalid param "),
"function"===typeof b&&b(q.a.error_1155)};k.subscribeStreamStatsForClient=function(a,b,d){d=void 0===d?function(){}:d;if(!y)return"Error getting stats - no socket";if(!a)return"Error getting stats - no stream";y.sendMessage("subscribeStreamStatsForClient",{streamId:a.getID(),statsEnabled:b},function(a){if(a){var c=document.querySelectorAll(".stats-container"),f=document.querySelectorAll(".stats-overlay");"Success"===a.status&&!0===b?(k.mediaStatsMode="display",k.subscribeSessionStats=!0,c.forEach(function(a){void 0!==
a&&null!==a&&(a.style.display="block")}),f.forEach(function(a){void 0!==a&&null!==a&&(a.style.display="block")})):(k.mediaStatsMode="disable",k.subscribeSessionStats=!1,c.forEach(function(a){void 0!==a&&null!==a&&(a.style.display="none")}),f.forEach(function(a){void 0!==a&&null!==a&&(a.style.display="none")}));d(a)}})};k.subscribeForTalkerNotification=function(a,b){b=void 0===b?function(){}:b;if("function"===typeof b){if(!y)return"Error subscribing - no socket";k.setAdvancedOptions([{id:"speaker-notification",
enable:a}],b)}else d.a.error("subscribeForTalkerNotification() invalid param - Callback")};k.manageStatsSubscription=function(a){"disable"!=k.mediaStatsMode?(a=k.mediaStatsMode,k.mediaStatsMode="disable",k.subscribeMediaStats(a,function(a){})):!0===k.subscribeSessionStats?(d.a.info("resubscribe session stats"),k.subscribeStreamStatsForClient(a,k.subscribeSessionStats)):d.a.info("session stats not subscribed")};k.reconPubSubFailed=function(a){d.a.info("reconnect publish or subscribe failed",a);k.reconnectionAllowed=
!1;ja();a=Object(l.e)({type:"network-reconnect-timeout",error:q.a.error_1167.result,message:a});k.dispatchEvent(a)};k.manageNumTalker=function(){d.a.info("Reset the preferred number of active talkers");-1!==ra?k.setTalkerCount(ra,function(a){d.a.info("reset active talker",a)}):d.a.info("Use default prefrence of number of active talkers")};k.startLiveTranscription=function(a){a=void 0===a?function(){}:a;d.a.info("Starting the live operation");!1===k.liveTranscription?(d.a.info("Sending the socket message"),
k.socket.sendEvent("startLiveTranscription",function(b){b&&0===b.result&&(k.liveTranscription=!0);a(b)})):a(q.a.error_8001)};k.stopLiveTranscription=function(a){a=void 0===a?function(){}:a;!0===k.liveTranscription?(k.liveTranscription=!1,k.socket.sendEvent("stopLiveTranscription",function(b){b&&0===b.result&&a(b)})):a(q.a.error_8002)};k.makeOutboundCall=function(a,b,c,f){f=void 0===f?function(){}:f;if("function"===typeof f){var g=!(k.subscription&&!1===k.subscription.sip_outbound),e={};void 0===c?
e.silent_join=!0:(void 0!==c.name&&(e.name=c.name),void 0!==c.early_media&&"boolean"==typeof c.early_media?e.early_media=c.early_media:e.silent_join=void 0!==c.silent_join&&"boolean"==typeof c.silent_join?c.silent_join:!0);!0===g?null!=a&&(console.log("Options: "+JSON.stringify(e)),k.socket.sendMessage("makeOutboundCall",{number:a,caller_id:b,options:e},function(b){b&&0===b.result?(k.dialOutList.set(a,{initiator:!0,state:"initiated"}),d.a.info("Outbound call initiated for the number: "+a)):b&&1141===
b.result?d.a.error("Outbound call is in progress for the number: "+a):d.a.info("Received "+JSON.stringify(b)+" for outbound number: "+a);f&&f(b)})):!g&&f&&(p.a.error("room-event",v.a.event_general_failed,{message:"makeOutboundCall - not allowed"}),f(q.a.error_1170))}else d.a.error("makeOutboundCall() invalid param - callback")};k.cancelOutboundCall=function(a,b){var c=k.dialOutList.get(a);void 0===c?"moderator"===k.me.role?k.socket.sendMessage("cancelOutboundCall",{number:a},function(a){d.a.info("Cancel outbound call, response received is "+
JSON.stringify(a));p.a.info("room-event",v.a.event_general_success,{message:"cancelOutboundCall - success"});b&&b(a)}):b&&(p.a.error("room-event",v.a.event_general_failed,{message:"cancelOutboundCall - Insufficient Privileges"}),b({result:1705,msg:"Insufficient Privileges"})):"moderator"===k.me.role||!0===c.initiator?k.socket.sendMessage("cancelOutboundCall",{number:a},function(a){d.a.info("Cancel outbound call, response received is "+JSON.stringify(a));p.a.info("room-event",v.a.event_general_success,
{message:"cancelOutboundCall - success"});b&&b(a)}):(d.a.error(" You need to be moderator or the initiator of the oubound call to disconnect the call."),p.a.error("room-event",v.a.event_general_failed,{message:"cancelOutboundCall - Insufficient Privileges"}),b&&b({result:1705,msg:"Insufficient Privileges"}))};var Ec=function(a){d.a.debug("recieved dialStateEvents");var b=k.dialOutList.get(a.number);switch(a.status){case "dialing":void 0===b&&(b={initiator:!1,state:"dialing"},k.dialOutList.set(a.number,
b));break;case "proceeding":case "connected":b.state=a.status;break;case "failed":case "timeout":case "disconnected":k.dialOutList.delete(a.number);break;default:d.a.debug("Unknown response received")}a=Object(l.e)({type:"dial-state-events",message:{number:a.number,state:a.status,description:a.description}});d.a.debug("Dispatching dial state event: "+JSON.stringify(a));k.dispatchEvent(a)};k.pingBack=function(a){k.socket.sendMessage("pingBack",{},function(b){a&&a(b)})};k.startClientUsage=function(a,
b){k.socket.sendMessage("startClientUsage",a,function(a){b&&b(a)})};k.stopClientUsage=function(a,b){k.socket.sendMessage("stopClientUsage",a,function(a){d.a.info("callback received "+JSON.stringify(a));b&&b(a)})};k.createBreakOutRoom=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b&&"object"===typeof a&&a.hasOwnProperty("participants")?a&&0<a.participants?k.socket.sendMessage("create-breakout-room",a,function(a){a&&(d.a.info("Create breakout room, result: "+JSON.stringify(a)),p.a.info("room-event",
v.a.event_general_success,{message:"createBreakOutRoom - success"}),b(a))}):(d.a.info("Invalid value for participants "+JSON.stringify(a)),p.a.error("room-event",v.a.event_general_failed,{message:"createBreakOutRoom - Invalid value for participants "+JSON.stringify(a)}),b&&b(q.a.error_1155)):d.a.error("createBreakOutRoom() invalid param - callback/RoomDefinition")};k.createAndInviteBreakOutRoom=function(a,b){a&&0<a.max_rooms?(a.force_join=!0,k.socket.sendMessage("create-invite-breakout-room",a,function(a){a&&
(d.a.info("Create breakout room, result: "+JSON.stringify(a)),p.a.info("room-event",v.a.event_general_success,{message:"createAndInviteBreakOutRoom - success"}),b(a))})):(d.a.info("Invalid value for participants "+JSON.stringify(a)),p.a.error("room-event",v.a.event_general_failed,{message:"createAndInviteBreakOutRoom - Invalid value for participants "+JSON.stringify(a)}),b&&b(q.a.error_1155))};k.joinBreakOutRoom=function(a,b,c){c=void 0===c?function(){}:c;"function"===typeof c?a&&null!==a.room_id&&
null!==a.role?k.socket.sendMessage("join-breakout-room",a,function(f){f&&0===f.result?k.breakOutRoom.joinRoom(f.token,b,function(a,b){a&&(d.a.info("****Join Breakout Room Success****, sending user-joined-event****"+JSON.stringify(a.roomData)),k.socket.sendMessage("user-joined-breakout-room",{name:a.roomData.name}),p.a.info("room-event",v.a.event_general_success,{message:"joinBreakOutRoom - success"}),c&&c(a,null));b&&(p.a.error("room-event",v.a.event_general_failure,{message:"joinBreakOutRoom - failure"}),
c&&c(null,b))}):(d.a.error("Invalid data, room id not found "+JSON.stringify(a)),p.a.error("room-event",v.a.event_general_failure,{message:"joinBreakOutRoom - Invalid data, room id not found "+JSON.stringify(a)}),c&&c(q.a.error_1155))}):(d.a.error("Invalid data, room id not found"+JSON.stringify(a)),p.a.error("room-event",v.a.event_general_failure,{message:"joinBreakOutRoom - Invalid data, room id not found "+JSON.stringify(a)}),c&&c(q.a.error_1155)):d.a.error("joinBreakoutRoom() invalid param - callback")};
k.inviteToBreakoutRoom=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b&&"object"===typeof a&&a.hasOwnProperty("room_id")?void 0===a||void 0===a.room_id?(d.a.info("Invalid data, room id not found"+JSON.stringify(a)),p.a.error("room-event",v.a.event_general_failure,{message:"inviteToBreakoutRoom - Invalid data, room id not found "+JSON.stringify(a)}),b&&b(q.a.error_1155)):k.socket.sendMessage("invite-breakout-room",a,function(a){a&&(d.a.info("Create breakout room, result:"+JSON.stringify(a)),
p.a.info("room-event",v.a.event_general_success,{message:"inviteToBreakoutRoom - success"}),b&&b(a))}):d.a.error("inviteToBreakoutRoom() invalid param - callback/invitee")};k.clearAllBreakOutSession=function(a){void 0!==a&&"function"===typeof a&&(k.breakOutRoom.disconnectAll(),k.resumeRoom(a))};k.destroyAllBreakOutSession=function(a){"moderator"===k.me.role&&(k.breakOutRoom.destroyAll(),k.resumeRoom(a))};var Fc=function(a,b,c){b=void 0===b?{isMobile:!1,broadcast:!0,clientList:[]}:b;var f,g,e,h,u,
r,w,z,m,D;return $jscomp.asyncExecutePromiseGeneratorProgram(function(F){if(1==F.nextAddress)return d.a.info(" init file upload "),f=H.size,g={messageType:"upload-started",result:0,description:"upload started",response:{uploadStatus:"started",upJobId:f,uploadInfo:{upJobId:f,name:a.name,size:a.size,type:a.type}}},F.setCatchFinallyBlocks(2),e=new C.a,h={sender:e,status:"started"},H.set(f,h),u=Object(l.e)({type:"fs-upload-result",message:g}),k.dispatchEvent(u),F.yield(e.upload(a),4);if(2!=F.nextAddress){r=
F.yieldResult;w=r.toJSON();h.status="completed";H.set(f,h);g.messageType="upload-completed";g.response.uploadStatus=h.status;g.response.upJobId=f;g.description=" upload completed";g.response.uploadInfo={upJobId:f,name:w.name,size:w.size,speed:w.speed,createdAt:w.createdAt,dlimit:w.dlimit,time:w.time,expiresAt:w.expiresAt,timeLimit:w.timeLimit};if(!0===b.isMobile)return d.a.info(" file sharing mobile client "),g.response.uploadInfo=w,g.response.uploadInfo.upJobId=f,u=Object(l.e)({type:"fs-upload-result",
message:g}),k.dispatchEvent(u),c(g),F.return();d.a.info(" is mobile  false ",b.isMobile);!0===k.showFsUi&&null!==document.getElementById(G)&&Ea(w,document.getElementById(G),"fs-file-uploaded");k.sendFtData(w,"fs-file-available",b.broadcast,b.clientList,function(a){g.response.sentStatus=a;d.a.info("sent message to all participants: file is available for download ",a,"fupload result",g);u=Object(l.e)({type:"fs-upload-result",message:g});k.dispatchEvent(u);c(g)});u=Object(l.e)({type:"fs-upload-result",
message:g});k.dispatchEvent(u);p.a.error("room-event",v.a.event_file_shared_success,{error:{}});c(g);return F.leaveTryBlock(0)}z=F.enterCatchBlock();d.a.info("upload to file server failed",z);H.delete(f);g.messageType="upload-failed";g.response.uploadStatus="failed";g.description=" upload failed";g.result=1;m=Object(l.e)({type:"fs-upload-result",message:g});k.dispatchEvent(m);d.a.error("exception in file upload ",z);D=q.a.error_1182;d.a.info(" send file failed",D);p.a.error("room-event",v.a.event_file_shared_failed,
{error:{}});c(D);F.jumpToEnd()})};k.sendFiles=function(a,b,c){a=void 0===a?[]:a;b=void 0===b?{isMobile:!1,broadcast:!0,clientList:[]}:b;d.a.info("Send file called options "+JSON.stringify(b)+" file object "+JSON.stringify(a));if(0===k.state&&!1===b.isMobile)a=q.a.error_1180,d.a.info(" file upload: room is disconnected, file operations are not allowed"),p.a.error("room-event",v.a.event_file_shared_failed,{message:"file upload: room is disconnected, file operations are not allowed"}),c(a);else if(c&&
"function"===typeof c?d.a.info("send file called with callback "):c=function(a){d.a.info("SDK defined callback send file response ",a)},0<a.length){d.a.info("preparing to upload files");k.filesToUpload=a;try{if(0>=k.filesToUpload[k.filesToUpload.length-1].size)d.a.info(" file size is 0 bytes ",k.filesToUpload[k.filesToUpload.length-1].size),c(q.a.error_1186+k.filesToUpload[k.filesToUpload.length-1].size);else{if(!b.isMobile){if(k.filesToUpload[k.filesToUpload.length-1].size>K){d.a.info(" file upload limit exceeded. max allowed limit is ",
K);c(q.a.error_1187+K);return}var f={};f.data=a;!0===k.showFsUi&&null!==document.getElementById(G)&&Ea(f,document.getElementById(G),"fs-upload-init");k.sendFtData(f,"fs-upload-started",b.broadcast,b.clientList,function(a){d.a.info(" file-upload-started sent to all participants",a)})}var g=new B.a(a);Fc(g,b,c);p.a.info("room-event",v.a.event_file_shared_success,{error:{}})}}catch(pb){d.a.error("exception occured in send file ",pb),a=q.a.error_1182,d.a.info(" send file failed",a),p.a.error("room-event",
v.a.event_file_shared_failed,{error:{}}),c(a)}}else b=q.a.error_1185,d.a.info(" input file list to upload is empty",b," length of file array",a.length),c(b)};k.recvFiles=function(a,b,c){b=void 0===b?{isMobile:!1}:b;c=void 0===c?function(){}:c;var f,g,e,h,u,r,w,C,m,D,F,K,B,n,S;return $jscomp.asyncExecutePromiseGeneratorProgram(function(N){switch(N.nextAddress){case 1:if("function"!==typeof c){d.a.error("recvFiles() invalid param - callback");N.jumpTo(0);break}if(0===k.state&&!1===b.isMobile)return f=
q.a.error_1180,d.a.info(" file download: room is disconnected file operations are not allowed"),void 0!=c&&c(f),N.return();if(a>R.length)return g=q.a.error_1181,d.a.info(" file download: file is not available"),void 0!=c&&c(g),N.return();e={messageType:"download-started",result:0,description:"download-started",response:{downloadStatus:"started",jobId:a,downloadInfo:k.availableFiles[a]}};N.setCatchFinallyBlocks(3);h=R[a];u=h.url.split("#")[0];return N.yield(fetch(u),5);case 5:return r=N.yieldResult,
w=r.headers.get("WWW-Authenticate"),C=w.replace("send-v1 ",""),m=new z.a({secretKey:h.secretKey,id:h.id,nonce:C,requiresPassword:!1}),D={receiver:m,status:"started"},Q.set(a,D),F=Object(l.e)({type:"fs-download-result",message:e}),k.dispatchEvent(F),N.yield(m.getMetadata(),6);case 6:return N.yield(m.download(b),7);case 7:K=N.yieldResult;d.a.info(" file downloaded successfully ",K);D.status="completed";Q.set(a,D);e.messageType="download-completed";e.response.downloadStatus=D.status;e.response.jobId=
a;e.description=" upload completed";F=Object(l.e)({type:"fs-download-result",message:e});p.a.info("room-event",v.a.event_file_download_success,{error:{}});k.dispatchEvent(F);void 0!=c&&c(K);N.leaveTryBlock(0);break;case 3:B=N.enterCatchBlock(),d.a.info(" file download failed",B),Q.delete(a),e.messageType="download-failed",e.response.downloadStatus="failed",e.description=" download failed",e.result=1,n=Object(l.e)({type:"fs-download-result",message:e}),k.dispatchEvent(n),S=q.a.error_1183,p.a.error("room-event",
v.a.event_file_download_failed,{error:q.a.error_1183.desc}),void 0!=c&&c(S),N.jumpToEnd()}})};k.mobileSetAvailableFile=function(a,b){d.a.info("mobile sdk wants to set the available file list ",a);"fs-file-available"===a.message.type&&(R.push(a.message),k.availableFiles.push({name:a.message.name,size:a.message.size,speed:a.message.speed,createdAt:a.message.createdAt,dlimit:a.message.dlimit,time:a.message.time,expiresAt:a.message.expiresAt,timeLimit:a.message.timeLimit,index:R.length-1}));b(!0)};k.setFsEndPoint=
function(a){a=void 0===a?{isMobile:!1,fsDetails:{}}:a;!0===a.isMobile&&Object(u.f)(a.fsDetails,a.callInfo)};k.inJectFsUI=function(a){(a=void 0===a?{enable:!0,uploadElToAppend:"",recvElToAppend:""}:a)&&!0===a.enable&&""!==a.uploadElToAppend&&null!==document.getElementById(a.uploadElToAppend)&&""!==a.recvElToAppend&&null!==document.getElementById(a.recvElToAppend)?(d.a.info(" show file sharing UI "),k.showFsUi=!0,N=a.uploadElToAppend,G=a.recvElToAppend,k.testFT()):d.a.info(" file UI injection failed")};
k.testFT=function(){if(!1===k.showFsUi||!0===k.showFsUi&&null===document.getElementById(N))d.a.info(" file upload  UI can not be appended");else{var a=document.createElement("INPUT");a.setAttribute("type","file");a.setAttribute("id","filesID");document.getElementById(N).appendChild(a);document.getElementById("filesID").addEventListener("change",function(a){a=a.target.files;k.sendFiles(a);for(var b=0,d;d=a[b];b++)console.log(d)},!1);document.getElementById("filesID").addEventListener("click",function(a){a.target.value=
null},!1)}};k.cancelUploads=function(a,b,c){a=void 0===a?!1:a;var f={description:"failed",result:1};if(void 0===b&&!1===a){if(d.a.error(" upJobId must be defined for cancelling a particular upload "),f.description="upJobId is undefined.",f.result=1,void 0!==c)return c(f)}else if(!0===a){b=$jscomp.makeIterator(H);for(a=b.next();!a.done;a=b.next())a=$jscomp.makeIterator(a.value),a.next(),a=a.next().value,"started"===a.status?(a.sender.cancel(),d.a.info(" running jobs are",a)):d.a.info(" status is ",
a.status);f.description="Cancelled all uploads";f.result=0;void 0!==c&&c(f)}else void 0!=b&&(d.a.info("cancelling specified upload with id",b),a=H.get(b),void 0!=a?"started"===a.status?(d.a.info("canceled upload",b),a.sender.cancel(),f.description="Cancelled upload "+b,f.result=0,void 0!=c&&c(f)):"completed"===a.status&&(d.a.info("upload can not be cancelled because it is already completed"),f.description="upload is already completed.",f.result=1,void 0!=c&&c(f)):(d.a.info("Uplode id is invalid"),
f.description="Uplode id is invalid. ",f.result=1,void 0!=c&&c(f)))};k.cancelDownloads=function(a,b,c){a=void 0===a?!1:a;var f={description:"failed",result:1};if(void 0===b&&!1===a){if(d.a.error("ID must be defined for cancelling a particular upload "),f.description="ID is undefined.",f.result=1,void 0!==c)return c(f)}else if(!0===a){b=$jscomp.makeIterator(Q);for(a=b.next();!a.done;a=b.next())a=$jscomp.makeIterator(a.value),a.next(),a=a.next().value,"started"===a.status?(a.receiver.cancel(),d.a.info(" running jobs are",
a)):d.a.info(" status is ",a.status);f.description="Cancelled all downloads";f.result=0;void 0!==c&&c(f)}else void 0!=b&&(d.a.info("cancelling specified download with id",b),b=b.toString(),a=Q.get(b),void 0!=a?"started"===a.status?(d.a.info("cancelling download",b),a.receiver.cancel(),f.description="Cancelled download "+b,f.result=0,void 0!=c&&c(f)):"completed"===a.status&&(d.a.info("Download can not be cancelled because it is already completed"),f.description="download is already completed.",f.result=
1,void 0!=c&&c(f)):(d.a.info("download id is invalid"),f.description="Download id is invalid. ",f.result=1,void 0!=c&&c(f)))};k.testFtMobile=function(a){a=void 0===a?!1:a;var b=document.createElement("INPUT");b.setAttribute("type","file");b.setAttribute("id","files-mobile");var c="";c=!1===a?document.getElementById("chat_btn"):document.body;c.appendChild(b);document.getElementById("files-mobile").addEventListener("change",function(a){a=a.target.files;d.a.info("mobile list of files to upload",a[0]);
k.filesToUpload=a;for(var b=0,c;c=a[b];b++)console.log("iterating file list",c)},!1)};var Gc=function(a){d.a.debug("onstreamingnotification events"+JSON.stringify(a));a=Object(l.e)({type:a.type,message:a.data});k.dispatchEvent(a)},Hc=function(a){d.a.debug("socketOnHlsStreamingNotificationToPublisher events"+JSON.stringify(a));a=Object(l.e)({type:a.type,message:a.data});k.dispatchEvent(a)},Ic=function(a){a=Object(l.e)({type:a.type,message:a.data});k.dispatchEvent(a)},Jc=function(a){a=Object(l.e)({type:a.type,
message:a.data});k.dispatchEvent(a)};if("IE"!==h.a.browserEngineCheck())y.on(r.a.SocketEvent.onAddStream,E.bind(null,Ra)),y.on(r.a.SocketEvent.media_engine_connecting,E.bind(null,Ya)),y.on(r.a.SocketEvent.signaling_message_peer,E.bind(null,vb)),y.on(r.a.SocketEvent.publish_me,E.bind(null,Za)),y.on(r.a.SocketEvent.unpublish_me,E.bind(null,wb)),y.on(r.a.SocketEvent.onBandwidthAlert,E.bind(null,ab)),y.on(r.a.SocketEvent.onBandwidthEvents,E.bind(null,xb)),y.on(r.a.SocketEvent.onSelfBandwidthAlert,E.bind(null,
$a)),y.on(r.a.SocketEvent.onDataStream,E.bind(null,yb)),y.on(r.a.SocketEvent.onUpdateAttributeStream,E.bind(null,Ab)),y.on(r.a.SocketEvent.onRemoveStream,E.bind(null,bb)),y.on(r.a.SocketEvent.disconnect,E.bind(null,Bb)),y.on(r.a.SocketEvent.connection_failed,E.bind(null,Cb)),y.on(r.a.SocketEvent.error,E.bind(null,Db)),y.on(r.a.SocketEvent.onRemoveTrack,E.bind(null,sb)),y.on(r.a.SocketEvent.user_connected,E.bind(null,Ta)),y.on(r.a.SocketEvent.user_updated,E.bind(null,tb)),y.on(r.a.SocketEvent.user_disconnected,
E.bind(null,Va)),y.on(r.a.SocketEvent.user_subscribed,E.bind(null,Wa)),y.on(r.a.SocketEvent.user_unsubscribed,E.bind(null,Xa)),y.on(r.a.SocketEvent.floor_management_events,E.bind(null,Kb)),y.on(r.a.SocketEvent.dial_state_events,E.bind(null,Ec)),y.on(r.a.UserEvent.user_awaited,E.bind(null,Pb)),y.on(r.a.SocketEvent.data_stream_room,E.bind(null,zb)),y.on(r.a.RoomEvent.room_awaited,E.bind(null,Ob)),y.on(r.a.RoomEvent.room_connected,E.bind(null,Qb)),y.on(r.a.RoomEvent.room_disconnected,E.bind(null,Ua)),
y.on(r.a.RoomEvent.room_record_on,E.bind(null,fc)),y.on(r.a.RoomEvent.room_record_off,E.bind(null,gc)),y.on(r.a.RoomEvent.change_layout,E.bind(null,kc)),y.on(r.a.RoomEvent.new_active_talker,E.bind(null,lc)),y.on(r.a.RoomEvent.hard_mute_audio,E.bind(null,Rb)),y.on(r.a.RoomEvent.hard_unmute_audio,E.bind(null,Sb)),y.on(r.a.RoomEvent.hard_mute_video,E.bind(null,Tb)),y.on(r.a.RoomEvent.hard_unmute_video,E.bind(null,Ub)),y.on(r.a.RoomEvent.share_started,E.bind(null,Vb)),y.on(r.a.RoomEvent.share_stopped,
E.bind(null,Zb)),y.on(r.a.RoomEvent.screen_share_override,E.bind(null,$b)),y.on(r.a.RoomEvent.stop_sharing,E.bind(null,Xb)),y.on(r.a.RoomEvent.update_layout,E.bind(null,Yb)),y.on(r.a.RoomEvent.share_state_events,E.bind(null,uc)),y.on(r.a.RoomEvent.custom_data_saved,E.bind(null,nc)),y.on(r.a.RoomEvent.custom_data_updated,E.bind(null,oc)),y.on(r.a.RoomEvent.streaming_uri,E.bind(null,ac)),y.on(r.a.RoomEvent.canvas_started,E.bind(null,rc)),y.on(r.a.RoomEvent.canvas_stopped,E.bind(null,sc)),y.on(r.a.RoomEvent.canvas_state_events,
E.bind(null,tc)),y.on(r.a.RoomEvent.generic_events,E.bind(null,vc)),y.on(r.a.RoomEvent.user_role_changed,E.bind(null,wc)),y.on(r.a.RoomEvent.switch_codec,E.bind(null,Wb)),y.on(r.a.RoomEvent.invite_breakout_room,E.bind(null,zc)),y.on(r.a.RoomEvent.user_joined_breakout_room,E.bind(null,Ac)),y.on(r.a.RoomEvent.user_left_breakout_room,E.bind(null,Bc)),y.on(r.a.RoomEvent.breakout_room_destroyed,E.bind(null,Cc)),y.on(r.a.RoomEvent.transcription_events,E.bind(null,Dc)),y.on(r.a.UserEvent.user_audio_muted,
E.bind(null,bc)),y.on(r.a.UserEvent.user_audio_unmuted,E.bind(null,cc)),y.on(r.a.UserEvent.user_video_muted,E.bind(null,dc)),y.on(r.a.UserEvent.user_video_unmuted,E.bind(null,ec)),y.on(r.a.SocketEvent.room_management_events,E.bind(null,yc)),y.on(r.a.SocketEvent.hard_mute,E.bind(null,Lb)),y.on(r.a.SocketEvent.hard_mute_room,E.bind(null,Nb)),y.on(r.a.SocketEvent.hard_unmute_room,E.bind(null,Mb)),y.on(r.a.SocketEvent.onStatSubscription,E.bind(null,Fb)),y.on(r.a.SocketEvent.onStreamingNotification,E.bind(null,
Ic)),y.on(r.a.SocketEvent.onHlsStreamingNotification,E.bind(null,Gc)),y.on(r.a.SocketEvent.onHlsStreamingNotificationToPublisher,E.bind(null,Hc)),y.on(r.a.SocketEvent.onLiveRecordingNotification,E.bind(null,Jc)),y.on(r.a.SocketEvent.onRoomLiveRecordingOn,E.bind(null,hc)),y.on(r.a.SocketEvent.onRoomLiveRecordingOff,E.bind(null,ic)),y.on(r.a.SocketEvent.onRoomLiveRecordingFailed,E.bind(null,jc)),y.on(r.a.SocketEvent.switched_room,E.bind(null,xc));else{null===document.getElementById("WebrtcEverywherePluginId")&&
k.installPlugin();var oa=document.getElementById("WebrtcEverywherePluginId");oa.addEventListener(r.a.SocketEvent.onAddStream,function(a){for(arg in a.data.args)Ra(a.data.args[arg])});oa.addEventListener(r.a.SocketEvent.onRemoveStream,function(a){for(arg in a.data.args)bb(a.data.args[arg])});oa.addEventListener(r.a.SocketEvent.media_engine_connecting,function(a){for(arg in a.data.args)Ya(a.data.args[arg])});oa.addEventListener(r.a.SocketEvent.publish_me,function(a){for(arg in a.data.args)Za(a.data.args[arg])});
oa.addEventListener(r.a.SocketEvent.user_connected,function(a){for(arg in a.data.args)Ta(a.data.args[arg])});oa.addEventListener(r.a.SocketEvent.user_disconnected,function(a){for(arg in a.data.args)Va(a.data.args[arg])});oa.addEventListener(r.a.SocketEvent.user_subscribed,function(a){for(arg in a.data.args)Wa(a.data.args[arg])});oa.addEventListener(r.a.SocketEvent.user_unsubscribed,function(a){for(arg in a.data.args)Xa(a.data.args[arg])})}return k}d.a.info("Failed - Webrtc support is missing ")}},
function(m,t,n){function h(a){a=void 0===a?100:a;return new Promise(function(b){return setTimeout(b,a)})}var l=n(29),e=!("object"!==typeof Intl||!Intl||"function"!==typeof Intl.NumberFormat||"object"!==typeof navigator),b=["bytes","kb","mb","gb"],a=function(){throw Error("uninitialized translate function. call setTranslate first");};m.exports={fadeOut:function(a){a=document.querySelector(a).classList;a.remove("effect--fadeIn");a.add("effect--fadeOut");return h(300)},delay:h,allowedCopy:function(){return document.queryCommandSupported?
document.queryCommandSupported("copy"):!1},bytes:function(c){if(1>c)return"0B";var g=Math.min(Math.floor(Math.log10(c)/3),b.length-1);c=Number(c/Math.pow(1024,g));var h=Math.floor(c)===c?0:1,d=c.toFixed(h);if(e)try{d=c.toLocaleString(locale(),{minimumFractionDigits:h,maximumFractionDigits:h})}catch(r){}return a("fileSize",{num:d,units:a(b[g])})},percent:function(a){if(e)try{return a.toLocaleString(locale(),{style:"percent"})}catch(g){}return Math.floor(100*a)+"%"},number:function(a){return e?a.toLocaleString(locale()):
a.toString()},copyToClipboard:function(a){var b=document.createElement("input");b.setAttribute("value",a);b.contentEditable=!0;b.readOnly=!0;document.body.appendChild(b);if(navigator.userAgent.match(/iphone|ipad|ipod/i)){var c=document.createRange();c.selectNodeContents(b);var d=getSelection();d.removeAllRanges();d.addRange(c);b.setSelectionRange(0,a.length)}else b.select();a=document.execCommand("copy");document.body.removeChild(b);return a},arrayToB64:function(a){return l.fromByteArray(a).replace(/\+/g,
"-").replace(/\//g,"_").replace(/=/g,"")},b64ToArray:function(a){return l.toByteArray(a+"===".slice((a.length+3)%4))},isFile:function(a){return/^[0-9a-fA-F]{10,16}$/.test(a)},openLinksInNewTab:function(a,b){b=void 0===b?!0:b;a=a||Array.from(document.querySelectorAll("a:not([target])"));b?a.forEach(function(a){a.setAttribute("target","_blank");a.setAttribute("rel","noopener noreferrer")}):a.forEach(function(a){a.removeAttribute("target");a.removeAttribute("rel")});return a},browserName:function(){try{return/firefox/i.test(navigator.userAgent)?
"firefox":/edge/i.test(navigator.userAgent)?"edge":/trident/i.test(navigator.userAgent)?"ie":/chrome/i.test(navigator.userAgent)?"chrome":/safari/i.test(navigator.userAgent)?"safari":/send android/i.test(navigator.userAgent)?"android-app":"other"}catch(c){return"unknown"}},streamToArrayBuffer:function(a,b){var c,d,g,e,h,l,p,u,C,m,z;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){switch(q.nextAddress){case 1:return c=a.getReader(),q.yield(c.read(),2);case 2:d=q.yieldResult;if(!b){q.jumpTo(3);
break}g=new Uint8Array(b);e=0;case 4:if(d.done){q.jumpTo(5);break}g.set(d.value,e);e+=d.value.length;return q.yield(c.read(),6);case 6:d=q.yieldResult;q.jumpTo(4);break;case 5:return q.return(g.buffer);case 3:h=[],l=0;case 7:if(d.done){q.jumpTo(8);break}h.push(d.value);l+=d.value.length;return q.yield(c.read(),9);case 9:d=q.yieldResult;q.jumpTo(7);break;case 8:p=0;u=new Uint8Array(l);C=$jscomp.makeIterator(h);for(m=C.next();!m.done;m=C.next())z=m.value,u.set(z,p),p+=z.length;return q.return(u.buffer)}})},
list:function(a,b,e){b=void 0===b?"":b;e=void 0===e?"":e;a=a.map(function(a){return html($jscomp$templatelit$0,e,a)});return html($jscomp$templatelit$1,b,a)},secondsToL10nId:function(a){return 3600>a?{id:"timespanMinutes",num:Math.floor(a/60)}:86400>a?{id:"timespanHours",num:Math.floor(a/3600)}:{id:"timespanDays",num:Math.floor(a/86400)}},timeLeft:function(a){if(1>a)return{id:"linkExpiredAlt"};a=Math.floor(a/1E3/60);var b=Math.floor(a/60),c=Math.floor(b/24);return 1<=c?{id:"expiresDaysHoursMinutes",
days:c,hours:b%24,minutes:a%60}:1<=b?{id:"expiresHoursMinutes",hours:b,minutes:a%60}:0===b?0===a?{id:"expiresMinutes",minutes:"< 1"}:{id:"expiresMinutes",minutes:a}:null},platform:function(){return"object"===typeof Android?"android":"web"},encryptedSize:function(a,b,e){e=(void 0===e?16:e)+1;return 21+a+e*Math.ceil(a/((void 0===b?65536:b)-e))},setTranslate:function(b){a=b}}},function(m,t){function n(h){this.max_=this.count_=this.sum_=this.startTime_=0;this.rampUpThreshold_=h;this.rampUpTime_=Infinity}
var h;n.prototype={add:function(h,e){0===this.startTime_&&(this.startTime_=h);this.sum_+=e;this.max_=Math.max(this.max_,e);Infinity===this.rampUpTime_&&e>this.rampUpThreshold_&&(this.rampUpTime_=h);this.count_+=1},getAverage:function(){return 0===this.count_?0:Math.round(this.sum_/this.count_)},getMax:function(){return this.max_},getRampUpTime:function(){return Math.round(this.rampUpTime_-this.startTime_)}};m.exports={arrayAverage:function(h){for(var e=h.length,b=0,a=0;a<e;a++)b+=h[a];return Math.floor(b/
e)},arrayMax:function(h){return 0===h.length?NaN:Math.max.apply(Math,$jscomp.arrayFromIterable(h))},arrayMin:function(h){return 0===h.length?NaN:Math.min.apply(Math,$jscomp.arrayFromIterable(h))},enumerateStats:function(h,e,b){var a={audio:{local:{audioLevel:0,bytesSent:0,clockRate:0,codecId:"",mimeType:"",packetsSent:0,payloadType:0,timestamp:0,trackId:"",transportId:""},remote:{audioLevel:0,bytesReceived:0,clockRate:0,codecId:"",fractionLost:0,jitter:0,mimeType:"",packetsLost:-1,packetsReceived:0,
payloadType:0,timestamp:0,trackId:"",transportId:""}},video:{local:{bytesSent:0,clockRate:0,codecId:"",firCount:0,framesEncoded:0,frameHeight:0,framesSent:-1,frameWidth:0,nackCount:0,packetsSent:-1,payloadType:0,pliCount:0,qpSum:0,timestamp:0,trackId:"",transportId:""},remote:{bytesReceived:-1,clockRate:0,codecId:"",firCount:-1,fractionLost:0,frameHeight:0,framesDecoded:0,framesDropped:0,framesReceived:0,frameWidth:0,nackCount:-1,packetsLost:-1,packetsReceived:0,payloadType:0,pliCount:-1,qpSum:0,
timestamp:0,trackId:"",transportId:""}},connection:{availableOutgoingBitrate:0,bytesReceived:0,bytesSent:0,consentRequestsSent:0,currentRoundTripTime:0,localCandidateId:"",localCandidateType:"",localIp:"",localPort:0,localPriority:0,localProtocol:"",remoteCandidateId:"",remoteCandidateType:"",remoteIp:"",remotePort:0,remotePriority:0,remoteProtocol:"",requestsReceived:0,requestsSent:0,responsesReceived:0,responsesSent:0,timestamp:0,totalRoundTripTime:0}};h&&(h.forEach(function(c,g){switch(c.type){case "outbound-rtp":c.hasOwnProperty("trackId")&&
(1!==c.trackId.indexOf(e.audio)&""!==e.audio?(a.audio.local.bytesSent=c.bytesSent,a.audio.local.codecId=c.codecId,a.audio.local.packetsSent=c.packetsSent,a.audio.local.timestamp=c.timestamp,a.audio.local.trackId=c.trackId,a.audio.local.transportId=c.transportId):1!==c.trackId.indexOf(e.video)&""!==e.video&&(a.video.local.bytesSent=c.bytesSent,a.video.local.codecId=c.codecId,a.video.local.firCount=c.firCount,a.video.local.framesEncoded=c.framesEncoded,a.video.local.framesSent=c.framesSent,a.video.local.packetsSent=
c.packetsSent,a.video.local.pliCount=c.pliCount,a.video.local.qpSum=c.qpSum,a.video.local.timestamp=c.timestamp,a.video.local.trackId=c.trackId,a.video.local.transportId=c.transportId));break;case "inbound-rtp":c.hasOwnProperty("trackId")&&(1!==c.trackId.indexOf(b.audio)&""!==b.audio&&(a.audio.remote.bytesReceived=c.bytesReceived,a.audio.remote.codecId=c.codecId,a.audio.remote.fractionLost=c.fractionLost,a.audio.remote.jitter=c.jitter,a.audio.remote.packetsLost=c.packetsLost,a.audio.remote.packetsReceived=
c.packetsReceived,a.audio.remote.timestamp=c.timestamp,a.audio.remote.trackId=c.trackId,a.audio.remote.transportId=c.transportId),1!==c.trackId.indexOf(b.video)&""!==b.video&&(a.video.remote.bytesReceived=c.bytesReceived,a.video.remote.codecId=c.codecId,a.video.remote.firCount=c.firCount,a.video.remote.fractionLost=c.fractionLost,a.video.remote.nackCount=c.nackCount,a.video.remote.packetsLost=c.packetsLost,a.video.remote.packetsReceived=c.packetsReceived,a.video.remote.pliCount=c.pliCount,a.video.remote.qpSum=
c.qpSum,a.video.remote.timestamp=c.timestamp,a.video.remote.trackId=c.trackId,a.video.remote.transportId=c.transportId));break;case "candidate-pair":c.hasOwnProperty("availableOutgoingBitrate")&&(a.connection.availableOutgoingBitrate=c.availableOutgoingBitrate,a.connection.bytesReceived=c.bytesReceived,a.connection.bytesSent=c.bytesSent,a.connection.consentRequestsSent=c.consentRequestsSent,a.connection.currentRoundTripTime=c.currentRoundTripTime,a.connection.localCandidateId=c.localCandidateId,a.connection.remoteCandidateId=
c.remoteCandidateId,a.connection.requestsReceived=c.requestsReceived,a.connection.requestsSent=c.requestsSent,a.connection.responsesReceived=c.responsesReceived,a.connection.responsesSent=c.responsesSent,a.connection.timestamp=c.timestamp,a.connection.totalRoundTripTime=c.totalRoundTripTime)}}.bind()),h.forEach(function(c){switch(c.type){case "track":c.hasOwnProperty("trackIdentifier")&&(1!==c.trackIdentifier.indexOf(e.video)&""!==e.video&&(a.video.local.frameHeight=c.frameHeight,a.video.local.framesSent=
c.framesSent,a.video.local.frameWidth=c.frameWidth),1!==c.trackIdentifier.indexOf(b.video)&""!==b.video&&(a.video.remote.frameHeight=c.frameHeight,a.video.remote.framesDecoded=c.framesDecoded,a.video.remote.framesDropped=c.framesDropped,a.video.remote.framesReceived=c.framesReceived,a.video.remote.frameWidth=c.frameWidth),1!==c.trackIdentifier.indexOf(e.audio)&""!==e.audio&&(a.audio.local.audioLevel=c.audioLevel),1!==c.trackIdentifier.indexOf(b.audio)&""!==b.audio&&(a.audio.remote.audioLevel=c.audioLevel));
break;case "codec":c.hasOwnProperty("id")&&(1!==c.id.indexOf(a.audio.local.codecId)&""!==e.audio&&(a.audio.local.clockRate=c.clockRate,a.audio.local.mimeType=c.mimeType,a.audio.local.payloadType=c.payloadType),1!==c.id.indexOf(a.audio.remote.codecId)&""!==b.audio&&(a.audio.remote.clockRate=c.clockRate,a.audio.remote.mimeType=c.mimeType,a.audio.remote.payloadType=c.payloadType),1!==c.id.indexOf(a.video.local.codecId)&""!==e.video&&(a.video.local.clockRate=c.clockRate,a.video.local.mimeType=c.mimeType,
a.video.local.payloadType=c.payloadType),1!==c.id.indexOf(a.video.remote.codecId)&""!==b.video&&(a.video.remote.clockRate=c.clockRate,a.video.remote.mimeType=c.mimeType,a.video.remote.payloadType=c.payloadType));break;case "local-candidate":c.hasOwnProperty("id")&&-1!==c.id.indexOf(a.connection.localCandidateId)&&(a.connection.localIp=c.ip,a.connection.localPort=c.port,a.connection.localPriority=c.priority,a.connection.localProtocol=c.protocol,a.connection.localType=c.candidateType);break;case "remote-candidate":c.hasOwnProperty("id")&&
-1!==c.id.indexOf(a.connection.remoteCandidateId)&&(a.connection.remoteIp=c.ip,a.connection.remotePort=c.port,a.connection.remotePriority=c.priority,a.connection.remoteProtocol=c.protocol,a.connection.remoteType=c.candidateType)}}.bind()));return a},doGetUserMedia:function(h,e,b){try{navigator.mediaDevices.getUserMedia(h).then(function(a){a.onremovetrack=function(){};e(a)}).catch(function(a){b(a)})}catch(a){b(a.message)}},setTimeoutWithProgressBar:function(l,e){var b=window.performance.now(),a=setInterval(function(){var a=
window.performance.now();h.setProgress(100*(a-b)/e)},100),c=function(){clearInterval(a);h.setProgress(100);l()},g=setTimeout(c,e);return function(){clearTimeout(g);c()}},setActiveTest:function(l){h=l},appendSourceId:function(h,e,b){""!==h&&(!0===b[e]?b[e]={optional:[{sourceId:h}]}:"object"===typeof b[e]&&("undefined"===typeof b[e].optional&&(b[e].optional=[]),b[e].optional.push({sourceId:h})))},StatisticsAggregate:n,enumerateStatsFirefox:function(h){var e={audio:{local:{bytesSent:0,packetsSent:0},
remote:{bytesReceived:-1,packetsReceived:0,packetsLost:-1,jitter:0,roundTripTime:0,timestamp:0}},video:{local:{bytesSent:0,packetsSent:-1,bitrateMean:0,bitrateStdDev:0,qpSum:0},remote:{bytesReceived:-1,packetsReceived:0,packetsLost:-1,bitrateMean:0,bitrateStdDev:0,roundTripTime:0,timestamp:0}},connection:{bytesSent:0,bytesReceived:0,timestamp:0}};h&&h.forEach(function(b,a){switch(b.type){case "outbound-rtp":"audio"==b.mediaType?(e.audio.local.bytesSent=b.bytesSent,e.audio.local.packetsSent=b.packetsSent):
"video"==b.mediaType&&(e.video.local.bytesSent=b.bytesSent,e.video.local.packetsSent=b.packetsSent,e.video.local.bitrateMean=b.bitrateMean,e.video.local.bitrateStdDev=b.bitrateStdDev,e.video.local.qpSum=b.qpSum);break;case "remote-outbound-rtp":"audio"==b.mediaType?(e.audio.local.bytesSent=b.bytesSent,e.audio.local.packetsSent=b.packetsSent):"video"==b.mediaType&&(e.video.local.bytesSent=b.bytesSent,e.video.local.packetsSent=b.packetsSent);break;case "inbound-rtp":"audio"==b.mediaType?(e.audio.remote.bytesReceived=
b.bytesReceived,e.audio.remote.packetsLost=b.packetsLost,e.audio.remote.packetsReceived=b.packetsReceived,e.audio.remote.jitter=b.jitter):"video"==b.mediaType&&(e.video.remote.bytesReceived=b.bytesReceived,e.video.remote.packetsLost=b.packetsLost,e.video.remote.packetsReceived=b.packetsReceived,e.video.remote.bitrateMean=b.bitrateMean,e.video.remote.bitrateStdDev=b.bitrateStdDev,e.video.remote.qpSum=b.qpSum);break;case "remote-inbound-rtp":"audio"==b.mediaType?(e.audio.remote.bytesReceived=b.bytesReceived,
e.audio.remote.packetsLost=b.packetsLost,e.audio.remote.packetsReceived=b.packetsReceived,e.audio.remote.jitter=b.jitter,e.audio.remote.roundTripTime=b.roundTripTime,e.audio.remote.timestamp=b.timestamp):"video"==b.mediaType&&(e.video.remote.bytesReceived=b.bytesReceived,e.video.remote.packetsLost=b.packetsLost,e.video.remote.packetsReceived=b.packetsReceived,e.video.remote.roundTripTime=b.roundTripTime,e.video.remote.timestamp=b.timestamp);break;case "candidate-pair":e.connection.bytesReceived=b.bytesReceived,
e.connection.bytesSent=b.bytesSent,e.connection.timestamp=b.timestamp}}.bind());return e}}},function(m,t,n){var h=n(4),l=n(42),e=n(27),b=n(7),a=n(0),c=n(26),g=n(6),w=n(5);n(28);var d=n(8),r=n(9);m=n(1);var q=n.n(m),D=n(51),v=void 0;1==q.a.noise_analysis&&"desktop"==q.a.browser_info.device_type&&function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(a){if(1==a.nextAddress)return a.yield(Object(D.a)(),2);v=a.yieldResult;a.jumpToEnd()})}();t.a=function(p,u){function C(a){return 0<a.length?
a.reduce(function(a,b){return a+b})/a.length:0}function m(a){return a.filter(function(a){return 0<=a})}function z(){if(0<f.scoreArrayVoice.length){if(.6<C(f.scoreArrayVoice).toFixed(2)){a.a.info("Your microphone is muted");var b=Object(h.f)({type:"talking-while-muted",stream:f});f.dispatchEvent(b)}f.scoreArrayVoice.length=0;f.processing_voice_while_mute=!1}}function D(){if(0<f.scoreArrayNoise.length){var b=C(f.scoreArrayNoise),d=C(f.audioLevelArray);.2>b&&.04<d&&(a.a.info("noise-detected"),b=Object(h.f)({type:"noise-detection",
stream:f}),f.dispatchEvent(b));f.scoreArrayNoise.length=0;f.processing_noise_detection=!1}}if(q.a.is_supported()){var f=Object(h.c)(u);f.config=u;f.stream=u.stream;f.url=u.url;f.recording=u.recording;f.recordingId=void 0;f.room=void 0;f.showing=!1;f.local=!1;f.video=u.video;f.audio=u.audio;f.screen=u.screen;f.videoSize=u.videoSize;f.videoFrameRate=u.videoFrameRate;f.extensionId=u.extensionId;f.desktopStreamId=u.desktopStreamId;f.recordingId=u.recordingId;f.clientId=u.clientId;f.videoMutedDueToBw=
!1;f.hardAudioMuted=!1;f.hardVideoMuted=!1;f.softVideoMuted=!1;f.selfMuteVideo=!1;f.selfMuteAudio=!1;f.ATVideoMuted=!1;f.selfPausedVideo=!1;f.selfPausedAudio=!1;f.processingVideoMute=!1;f.attributes=u.attributes;f.Connection=void 0===p?b.a:p;f.playerDivs=[];f.canvas=u.canvas;f.transactions=new Map;f.audioStream=u.audioStream;f.audioStreamClone=void 0;f.videoStream=u.videoStream;f.recordedBlobs=[];var n=void 0!=u.audio,x=void 0!=u.video,t={},I=!1,H=!1,J=!1,k=null,ca=null,aa="self";void 0==f.config.videoMuted&&
(f.config.videoMuted=!1);void 0==f.config.audioMuted&&(f.config.audioMuted=!1);f.abwdEnabled=!0;f.abwdNotification="sdk";f.abwdLanguage="en";var Q="none",Y="none",R=!1,K="none",N;f.maxVideoBwKbpsReqByUser=0;f.maxVideoBwKbpsReqByServer=0;f.maxVideoBwKbpsSet=0;f.reconnect=!1;f.reconnectAttempt=0;f.pcmInputBuf=void 0;f.pcmOutputBuf=void 0;f.pcmInputIndex=void 0;f.rnn=void 0;f.bufferResidue=new Float32Array([]);f.scoreArrayVoice=[];f.scoreArrayNoise=[];f.audioLevelArray=[];f.processing_voice_while_mute=
!1;f.processing_noise_detection=!1;f.audioContext=void 0;var G={videoFps:{set:0,max:{user:0,server:0},min:{user:0,server:0}},videoBw:{set:0,max:{user:0,server:0},min:{user:0,server:0}}};void 0===u.local||!0===u.local?f.local=!0:I=H=!0;f.isAudioMuted=function(){return I};f.isVideoMuted=function(){return H||f.config.videoMuted};f.setID=function(a){(u.streamID=a)&&f.player&&f.player.streamUpdated(a)};f.getID=function(){return f.local&&!u.streamID?"local":u.streamID};f.getAttributes=function(){return u.attributes};
f.setAttributes=function(b){f.local?f.emit(Object(h.f)({type:"internal-set-attributes",stream:f,attrs:b})):a.a.error("Error! Stream Object is not published. Failed to update attributes.")};f.updateLocalAttributes=function(a){u.attributes=a};f.ifAudio=function(){return!1!==u.audio&&void 0!==u.audio?!0:!1};f.ifVideo=function(){return!1!==u.video&&void 0!==u.video?!0:!1};f.ifData=function(){return!1!==u.data&&void 0!==u.data?!0:!1};f.ifScreen=function(){return u.screen};f.ifMedia=function(){return!1!==
u.audio&&void 0!==u.audio||!1!==u.video&&void 0!==u.video||!1!==u.screen?!0:!1};f.ifExternal=function(){return void 0!==f.url||void 0!==f.recording?!0:!1};f.ifCanvas=function(){return u.canvas};f.sendData=function(b){f.local&&f.ifData()?f.emit(Object(h.f)({type:"internal-send-data",stream:f,msg:b})):(a.a.error("Error! Stream Object is not published. Failed to send data."),r.a.error("stream-event",d.a.event_send_data_failed,{error:"Error! Stream Object is not published. Failed to send data."}))};var y=
function(){f.Connection.mediaDeviceUpdate(function(a){var b=a.current,d=a.added;a=a.removed;var c=function(a,b,d,c,f,g){var e=!1,k=!1,p="object"==typeof c?c.deviceId.exact:c.deviceId;c=c.groupId;var h="object"==typeof f?f.deviceId.exact:f.deviceId;f=f.groupId;for(var q in b)"default"!=p&&b[q].deviceId!=p||b[q].groupId!=c||(e=!1),"default"!=h&&b[q].deviceId!=h||b[q].groupId!=f||(k=!1);for(var u in a)"default"!=p&&a[u].deviceId!=p||a[u].groupId!=c||(e=!0),"default"!=h&&a[u].deviceId!=h||a[u].groupId!=
f||(k=!0);if(!e||!k)for(var r in d)"default"!=p&&d[r].deviceId!=p||d[r].groupId!=c||(e=!0),"default"!=h&&d[r].deviceId!=h||d[r].groupId!=f||(k=!0);if((p!=h||c!=f||!g)&&k)return h;if(!e){if(d.length)return d[0].deviceId;if(a.length)return a[0].deviceId}};if(u.params){var e=null,k=null;if(u.params.set.video&&f.videoStream){var p=!1;f.videoStream.getVideoTracks().forEach(function(a){"ended"!=a.readyState&&(p=!0)});e=c(b.cam,a.cam,d.cam,u.params.set.video,u.params.config.video,p)}else console.log("spec.params.set.video not defined");
if(u.params.set.audio&&f.audioStream){var r=!1;f.audioStream.getAudioTracks().forEach(function(a){"ended"!=a.readyState&&(r=!0)});k=c(b.mic,a.mic,d.mic,u.params.set.audio,u.params.config.audio,r)}else console.log("spec.params.set.audio not defined");var l,w;void 0!=k?(f.selfMuteAudio||f.hardAudioMuted||(l=k),f.selectedMicId=k):f.selectedMicId=u.params.set.audio.deviceId;void 0!=e?(f.selfMuteVideo||f.hardVideoMuted||(w={deviceId:e}),f.selectedCam={deviceId:e}):f.selectedCam={deviceId:"object"==typeof u.params.set.video.deviceId?
u.params.set.video.deviceId.exact:u.params.set.video.deviceId};void 0==w&&void 0==l||W(f,l,w,!0,function(a){a.result===g.a.error_000.result?(a={},void 0!=w&&(da(f.videoStream),a.video={deviceId:w.deviceId}),void 0!=l&&(a.audio={deviceId:l}),a=Object(h.f)({type:"media-device-updated",evntDetails:a}),f.dispatchEvent(a)):(console.log("setMediaDevicesTrack() returned failure : "+JSON.stringify(a)),a.result===g.a.error_1145&&"mobile"==q.a.browser_info.device_type&&void 0!==f.room&&f.room.mediaDeviceError(a))})}else console.log("spec.params not defined")},
!0)},Z=function(a){"mobile"!=q.a.browser_info.device_type&&(a.width={},a.height={},void 0!==f.videoSize?(a.width.min=f.videoSize[0],a.height.min=f.videoSize[1],a.width.max=f.videoSize[2],a.height.max=f.videoSize[3]):(a.width.min=q.a.video_resolution_range.Default.min.wdith,a.height.min=q.a.video_resolution_range.Default.min.height,a.width.max=q.a.video_resolution_range.Default.max.width,a.height.max=q.a.video_resolution_range.Default.max.height),"chrome-stable"===b.a.browserEngineCheck()&&(a.width.ideal=
a.width.max,a.height.ideal=a.height.max))};f.init=function(){try{if(a.a.info("requested getUsermedia options: "+JSON.stringify(u)),u.audio||u.video||u.screen||u.canvas||void 0===u.url){a.a.info("Note! Requested access to local media");var c=!1,g=!1,e=!1;u.video&&!1!==u.video&&(void 0!=u.disableGUMOptions&&u.disableGUMOptions?c=!0:(c={},Z(c),void 0!==f.videoFrameRate&&(c.frameRate={min:f.videoFrameRate[0],max:f.videoFrameRate[1]}),"object"===typeof u.video&&(void 0!==u.video.deviceId&&""!==u.video.deviceId&&
(c.deviceId="safari"!==b.a.browserEngineCheck()?{exact:u.video.deviceId}:u.video.deviceId),void 0!==u.video.facingMode&&""!==u.video.facingMode&&"mobile"==q.a.browser_info.device_type&&(c.facingMode=u.video.facingMode))));u.screen&&!1!==u.screen&&(c=!0);u.canvas&&!1!==u.canvas&&(e={},e=void 0===f.videoSize?{width:{min:f.videoSizeForCanvas[0],max:f.videoSizeForCanvas[2]},height:{min:f.videoSizeForCanvas[1],max:f.videoSizeForCanvas[3]},canvasId:u.div,fps:u.fps}:{width:{min:f.videoSize[0],max:f.videoSize[2]},
height:{min:f.videoSize[1],max:f.videoSize[3]},canvasId:u.div,fps:u.fps});u.audio&&!1!==u.audio&&(void 0!=u.disableGUMOptions&&u.disableGUMOptions?g=!0:(g={echoCancellation:{exact:!0},googEchoCancellation:{exact:!0},autoGainControl:{exact:!0},noiseSuppression:{exact:!0},googHighpassFilter:{exact:!0},googExperimentalNoiseSuppression:{exact:!0},googExperimentalEchoCancellation:{exact:!0},googExperimentalAutoGainControl:{exact:!0}},"object"===typeof u.audio&&u.audio.deviceId&&""!==u.audio.deviceId&&
(g.deviceId=u.audio.deviceId)));var k={video:c,audio:g,screen:u.screen,canvas:e,fake:u.fake,extensionId:f.extensionId,desktopStreamId:f.desktopStreamId};u.screen&&!1!==u.screen&&(k.fps=u.fps);u.canvas&&!1!==u.canvas?f.Connection.GetCanvasStream(k,function(b){f.videoStream=b;f.stream=b;console.log("Got stream from canvas opt: "+k+" refreshFn: "+u.refreshFn);f.videoStream.getTracks().forEach(function(b){a.a.info("getTracks canvas: ",b);b.onended=function(){f.videoStream.getTracks().forEach(function(a){a.onended=
null});var a=Object(h.f)({type:"stream-ended",stream:f,msg:b.kind});f.dispatchEvent(a)}});b=Object(h.f)({type:"media-access-allowed",stream:f});f.dispatchEvent(b);r.a.info("stream-event",d.a.event_media_access_success,{error:{}})},function(b){a.a.error("GetCanvasStream: ",b);var c=Object(h.f)({type:"media-access-denied",msg:b});f.dispatchEvent(c);r.a.error("stream-event",d.a.event_media_access_denied,{error:b})}):(a.a.info("Note!! calling getUserMedia "+JSON.stringify(k)),!u.screen&&f.local&&void 0==
u.params&&(u.params={},u.params.config=JSON.parse(JSON.stringify(k)),u.params.set=JSON.parse(JSON.stringify(k))),ba(k,function(c,g){if(!g)void 0==u.params&&(u.params={set:{},config:{}}),a.a.info("Note!!!!! User has granted access to local media."),r.a.info("stream-event",d.a.event_media_access_success,{error:{}}),f.stream=c,v&&(f.audioContext=new (window.AudioContext||window.webkitAudioContext)),f.stream.getTracks().forEach(function(d,g){"video"===d.kind?(ca=f.videoStream=c,console.log(" get user media success video track muted : "+
d.muted+" state: "+d.readyState+" enabled: "+d.enabled),"object"!==typeof u.video&&(u.video={}),u.video.trackIndex=g,d.getSettings().deviceId&&(u.video.deviceId=d.getSettings().deviceId,u.params.set.video={},u.params.config.video={},u.params.config.video.deviceId="safari"!==b.a.browserEngineCheck()?{exact:u.video.deviceId}:u.video.deviceId,u.params.config.video.groupId=d.getSettings().groupId,u.params.set.video=JSON.parse(JSON.stringify(u.params.config.video))),console.log(" Checking and setting soft video muted : "+
f.config.videoMuted+" firstGumcall: "+f.firstGumCall),f.config.videoMuted&&void 0===f.firstGumCall&&(d.enabled=!1,f.softVideoMuted=!0,console.log(" soft muted video "))):"audio"===d.kind&&(f.audioStream=c,v&&(f.audioStreamClone=c.clone()),"object"!==typeof u.audio&&(u.audio={}),u.audio.trackIndex=g,d.getSettings().deviceId&&(u.audio.deviceId=d.getSettings().deviceId,u.params.set.audio={},u.params.config.audio={},u.params.config.audio.deviceId=(b.a.browserEngineCheck(),u.audio.deviceId),u.params.config.audio.groupId=
d.getSettings().groupId,u.params.set.audio=JSON.parse(JSON.stringify(u.params.config.audio))),f.config.audioMuted&&void 0===f.firstGumCall&&(d.enabled=!1,I=!0,f.selfMuteAudio=!0,console.log(" soft muted aduio")));!f.local||f.ifScreen()||f.ifCanvas()||"mobile"==q.a.browser_info.device_type||"safari"==b.a.browserEngineCheck()||y();a.a.info("getTracks",d," kind: ",d.kind);d.onended=function(){f.stream.getTracks().forEach(function(a){a.onended=null});var a=Object(h.f)({type:"stream-ended",stream:f,msg:d.kind});
f.dispatchEvent(a)}}),null==f.videoStream&&(f.video=!1,f.config.videoMuted=!0),null==f.audioStream&&(f.audio=!1,f.config.audioMuted=!0),!0!==u.audio&&!0!==u.video||(!1!==f.audio||f.ifScreen)&&!1!==f.video||(g={},!1===f.video&&(g.video=f.video),!1===f.audio&&(g.audio=f.audio),g=Object(h.f)({type:"media-access-failed",evntDetails:g}),f.dispatchEvent(g)),g=Object(h.f)({type:"media-access-allowed",stream:f}),f.dispatchEvent(g),r.a.info("stream-event",d.a.event_media_access_success,{error:{}});else if(!f.ifScreen()){a.a.error("Error! Failed to get access to local media. Error code was "+
JSON.stringify(g)+".");var e=Object(h.f)({type:"media-access-denied",msg:g});f.dispatchEvent(e);r.a.error("stream-event",d.a.event_media_access_denied,{error:g})}f.fistGumCall=!0}))}else c=Object(h.f)({type:"media-access-allowed"}),f.dispatchEvent(c),r.a.info("stream-event",d.a.event_media_access_success,{error:{}})}catch(ha){a.a.error("Error! Failed to get access to local media. Error was "+ha+"."),c=Object(h.f)({type:"media-access-denied",msg:ha}),f.dispatchEvent(c),r.a.error("stream-event",d.a.event_media_access_denied,
{error:ha})}};f.initRemoteStream=function(a){if(!f.local){f.stream=a;if(f.ifAudio()||f.audioOnly)f.audioStream=new MediaStream,f.stream.getAudioTracks().forEach(function(a){f.audioStream.addTrack(a)});f.mediaStream=new MediaStream;f.stream.getTracks().forEach(function(a){f.mediaStream.addTrack(a)})}};f.close=function(){f.local&&(void 0!==f.room&&f.room.unpublish(f),f.hide(),void 0!==f.videoStream&&(f.videoStream.getVideoTracks().forEach(function(a){a.enabled=!1;a.onended=null;a.stop()}),f.videoStream=
void 0),void 0!==f.audioStream&&(f.audioStream.getAudioTracks().forEach(function(a){a.onended=null;a.stop()}),f.audioStream=void 0),f.pc&&void 0!==f.pc.peerConnection&&f.pc.peerConnection.close(),f.stream=void 0)};f.disableTrack=function(a){f.room.removeTrack(a)};f.attachMediaStream=function(b,d){if(!b)return null;if(b.isWebRtcPlugin)return b.src=d,b;if("video"===b.nodeName.toLowerCase()){a.a.info("Checked element is video");if(!b.pluginObj&&d){a.a.info("Plugins and stream validated");var c=document.createElement("object");
if(Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window){a.a.info("Browser IE validated");var f=document.createElement("param");f.setAttribute("name","windowless");f.setAttribute("value",!0);c.appendChild(f);c.setAttribute("classid","CLSID:7FD49E23-C8D7-4C4F-93A1-F7EACFA1EC53")}else a.a.info("Other browser got"),c.setAttribute("type","application/webrtc-everywhere");b.pluginObj=c;c.setAttribute("className",b.className);c.setAttribute("innerHTML",
b.innerHTML);f=b.getAttribute("width");var g=b.getAttribute("height"),e=b.getBoundingClientRect();f||(f=e.right-e.left);g||(g=e.bottom-e.top);"getComputedStyle"in window&&(a.a.info("computing style"),e=window.getComputedStyle(b,null),f||"auto"==e.width||"0px"==e.width||(f=e.width),g||"auto"==e.height||"0px"==e.height||(g=e.height));f?c.setAttribute("width",f):c.setAttribute("autowidth",!0);g?c.setAttribute("height",g):c.setAttribute("autoheight",!0);document.body.appendChild(c);b.parentNode&&(a.a.info("parent node found"),
b.parentNode.replaceChild(c,b),document.body.appendChild(b),b.style.visibility="hidden")}b.pluginObj&&(a.a.info("plugin object found"),b.pluginObj.bindEventListener("play",function(a){b.pluginObj&&(b.pluginObj.getAttribute("autowidth")&&a.videoWidth&&b.pluginObj.setAttribute("width",a.videoWidth),b.pluginObj.getAttribute("autoheight")&&a.videoHeight&&b.pluginObj.setAttribute("height",a.videoHeight))}),b.pluginObj.src=d);return b.pluginObj}if("audio"===b.nodeName.toLowerCase())return b};var T=1,ba=
function(b,g,e){e=void 0===e?!0:e;var k=JSON.parse(JSON.stringify(b));a.a.info("getusermedia called  opt "+JSON.stringify(k));(b=f.Connection.getSupportedDeviceConstraints())&&k.video&&"object"==typeof k.video&&("mobile"==q.a.browser_info.device_type?(b.hasOwnProperty("facingMode")&&k.video.facingMode?k.video.deviceId&&delete k.video.deviceId:(b.hasOwnProperty("deviceId")&&k.video.deviceId||k.video.deviceId&&delete k.video.deviceId,k.video.facingMode&&delete k.video.facingMode),k.video.height&&delete k.video.height,
k.video.width&&delete k.video.width):b.hasOwnProperty("deviceId")&&k.video.deviceId?k.video.facingMode&&delete k.video.facingMode:b.hasOwnProperty("facingMode")&&k.video.facingMode?k.video.deviceId&&delete k.video.deviceId:(k.video.deviceId&&delete k.video.deviceId,k.video.facingMode&&delete k.video.facingMode),b.hasOwnProperty("frameRate")||void 0==k.video.frameRate||delete k.video.frameRate);console.log("calling gum with options: "+JSON.stringify(k));f.Connection.GetUserMedia(k,function(b){a.a.info("getUserMedia success");
r.a.info("stream-event",d.a.event_gum_success,{error:{}});T=0;g(b)},function(b){a.a.info("Get User Media scren share",f.ifScreen()," Error ",b);b=Object(c.a)(b);k.video.height&&k.video.height.min&&k.video.width&&k.video.width.min&&(a.a.info("getUserMedia failed error: "+b.result+" min Res: "+k.video.height.min+"X"+k.video.width.min),r.a.error("stream-event",d.a.event_gum_failed,{error:b}));var p={};Object.assign(p,k);switch(b.result){case 1143:case 1144:console.log(" ERROR : "+b.result+" newOpt: "+
JSON.stringify(p));!p.screen&&p.video&&p.audio?(console.log("getUserMedia() Failed with device denied/unvailable .. retrying with audio only"),p.video=!1):e=!1;break;case 1147:case 1148:case 1149:switch(p.video.height.min){case 720:p.video.height.min=540;p.video.width.min=960;break;case 540:p.video.height.min=540;p.video.width.min=960;break;case 480:p.video.height.min=360;p.video.width.min=480;break;default:e=!1}break;case 1145:console.log(" ERROR : "+b.result+" Opt: "+JSON.stringify(p)+" check and retry");
break;default:console.log(" ERROR Default : "+b.result+" newOpt: "+JSON.stringify(p)),e=!1}!f.ifScreen()&&!0===e&&5>=T?(T+=1,a.a.info("getUserMedia() failed retry count: "+T),ba(p,g)):(a.a.error("getUserMedia() failed retry count exceeded: "),T=0,g(void 0,b))})};f.setQualityLayers=function(b){f.pc&&f.stream&&f.local&&f.pc.peerConnection&&f.pc.peerConnection.getSenders?(a.a.info(" that.setQulaityLayers numSpatialLayers:"+b),f.pc.peerConnection.getSenders().forEach(function(d){if(d.track&&"video"===
d.track.kind){var c=d.getParameters();if(void 0!=c&&void 0!=c.encodings){for(var f=0;f<c.encodings.length;f++)b>f?(a.a.info(" Layer :"+f+" enabled"),c.encodings[f].active=!0):(a.a.info(" Layer :"+f+" disabled"),c.encodings[f].active=!1);d.setParameters(c)}else a.a.info(" that.setQulaityLayers: no sender params/encodings-  Not in simulcast mod")}})):a.a.info("setQulaityLayers Failed invalid stream :"+f.stream+" local: "+f.local)};f.onStateChanged=function(a){console.log(" that.onStateChanged() active : "+
a+" spec:"+JSON.stringify(u));f.local&&(a?f.ifCanvas()?void 0!==u.refreshFn&&(u.refreshFn(),a=u.fps>u.maxCanvasRefreshRate?1E3/u.maxCanvasRefreshRate:1E3/u.fps,console.log(" that.onStateChanged ()  timerVal : "+a+" spec.fps: "+u.fps),f.refreshTimer=setInterval(function(){console.log("refresh called timer ");u.refreshFn()},a)):f.ifScreen()||(x=void 0!=f.videoStream,n=void 0!=f.audioStream,f.video&&x&&(0>=f.maxVideoLayers?(G.videoBw.set=G.videoFps.set=0,ea(G.videoBw,G.videoFps)):f.videoStream.getVideoTracks().forEach(function(a){var b=
a.getConstraints();b.height.max=f.videoSize[3];b.height.ideal=f.videoSize[3];b.width.max=f.videoSize[2];b.width.ideal=f.videoSize[2];b.frameRate={max:26};a.applyConstraints(b).then(function(){console.log("applying constraints for simulcast video success")}).catch(function(a){console.log(" error in applying constraints for simulcast video error: "+a)})}))):f.ifCanvas()&&void 0!=f.refreshTimer&&(clearInterval(f.refreshTimer),f.refreshTimer=void 0))};f.setVideoParamsRange=function(b,d,c,g,e){1<f.maxVideoLayers||
(e?(void 0!==b&&(G.videoBw.max.server=parseInt(b)),void 0!==c&&(G.videoFps.max.server=parseInt(c)),void 0!==d&&(G.videoBw.min.server=parseInt(d)),void 0!==g&&(G.videoFps.min.server=parseInt(g))):(void 0!==b&&(G.videoBw.max.user=parseInt(b)),void 0!==c&&(G.videoFps.max.user=parseInt(c)),void 0!==d&&(G.videoBw.min.user=parseInt(d)),void 0!==g&&(G.videoFps.min.user=parseInt(g))),a.a.debug("setVideoParamsRange() id: "+f.getID()+" :: "+b+": "+d+":"+c+":"+g+":"+e),ea(G.videoBw,G.videoFps))};var ea=function(c,
g){var e=0,k=0;e=c.max.user&&c.max.user<c.min.user?c.min.user:c.max.user&&(!c.max.server||c.max.user<=c.max.server)?c.max.user:c.max.server&&c.max.server<c.min.user?c.min.user:c.max.server&&c.max.server<c.min.server?c.min.server:c.max.server;k=g.max.user<g.min.user?g.min.user:g.max.user&&(!g.max.server||g.max.user<=g.max.server)?g.max.user:g.max.server&&g.max.server<g.min.user?g.min.user:g.max.server&&g.max.server<g.min.server?g.min.server:g.max.server;if(void 0==f.pc||void 0==f.pc.peerConnection||
void 0==f.room)a.a.error("setVideoParams() not set pc/room not defined "+JSON.stringify(G)+" b2Set: "+e+" fps2Set: "+k);else{if(e&&c.min.server!=e&&c.max.server!=e){var p=[{id:"publisher-video-bw-update",streamId:f.getID(),min:c.min.user,max:c.max.user}];f.room.setAdvancedOptions(p,function(){})}console.log(" setVideoParams: id: "+f.getID()+" b2Set "+e+" fps2Set "+k+" bwrange: "+JSON.stringify(c));if(e&&c.set!=e||k&&g.set!=k)if(p=b.a.browserEngineCheck(),"chrome-stable"===p||"mozilla"===p&&!b.a.isCurrentVerLess(w.a.constant.FIREFOX_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT)||
"safari"===p&&!b.a.isCurrentVerLess(w.a.constant.SAFARI_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT)){f.pc.peerConnection.getSenders().forEach(function(b){if(b.track&&"video"===b.track.kind){var d=b.getParameters();if(void 0!=d){d.encodings||(d.encodings=[{}]);for(var f=0;f<d.encodings.length;f++)e&&(a.a.error(" that.setMaxVideoBitarte: bw: ",e),d.encodings[f].maxBitrate=1E3*e,c.set=e),k&&(a.a.error(" that.setMaxVideoFramerate: fps: ",k),d.encodings[f].maxFramerate=k,g.set=k);b.setParameters(d)}else a.a.error(" that.setMaxVideoBitarte: no sender params/encodings-  ")}});
var h=function(a,b,c,d,f,g,e,k){d<c.length?(b.height&&(b.height.max=c[d].res[f].height),b.width&&(b.width.max=c[d].res[f].width),b.frameRate={max:g},a.applyConstraints(b).then(function(){k(b,e)}).catch(function(p){e.push({res:c[d].res[f],error:p});c[d].res.length<f+1?f++:(d++,f=0,g=30);h(a,b,c,d,f,g,e,k)})):k(null,e)};f.ifScreen()||f.ifCanvas()||"safari"===p||f.videoStream.getVideoTracks().forEach(function(a){var b=q.a.getCamResTableToCheck(c.set),d=a.getConstraints();void 0==b?(console.log("reverting kbps: "+
c.set+" constraints: curr: "+JSON.stringify(d)+" original: "+f.videoSize[3]+" X "+f.videoSize[2]),void 0==d.height||void 0==d.width||void 0!=d.height.max&&void 0!=d.width.max&&f.videoSize[3]==d.height.max&&f.videoSize[2]==d.width.max||(d.height.max=f.videoSize[3],d.height.ideal=f.videoSize[3],d.width.max=f.videoSize[2],d.width.ideal=f.videoSize[2],d.frameRate={max:26},a.applyConstraints(d).then(function(){console.log("apply constraints to original value")}).catch(function(a){console.log("failed  - apply constraints to original value")}))):
(console.log(" setVideoQualityConstraints() quality received: "+JSON.stringify(b)+" constraints: "+JSON.stringify(d)),h(a,d,b.resTable,0,0,b.fps,[],function(a,b){null!=a?console.log("setVideoQualityConstraints() success constraints: "+JSON.stringify(a)+" errors: "+JSON.stringify(b)):console.log("setVideoQualityConstraints() failed errors: "+JSON.stringify(b))}))})}else a.a.error("Setting Max Bw  using sdp reneg videoBwKbps= ",videoBwKbps),p={maxVideoBW:e,Sdp:!0},c.set=e,f.pc.updateSpec(p,function(){a.a.info("that.setMaxVideoBitarte: sdp reneg success")}),
r.a.warn("stream-event",d.a.event_incompatible_browser,{message:"Setting Max Bw  using traditional way of sdp renegotiation videoBwKbps= "+e});else a.a.error("setVideoParams Failed id: "+f.getID()+" b2Set "+e+" bwrange: "+JSON.stringify(c)),r.a.error("stream-event",d.a.event_general_failed,{message:"setVideoParams Failed id: "+f.getID()+" b2Set "+e+" bwrange: "+JSON.stringify(c)})}};f.setVideoQualityParams=function(c,g,e,k,p){f.videoStream.getVideoTracks().forEach(function(f){var h=f.getConstraints();
console.log("RESOLUTION Set track before constariants : "+JSON.stringify(h));null!=c&&null!=g&&(void 0==h.width&&(h.width={}),void 0==h.height&&(h.height={}),h.width.min=c,h.height.min=g);null!=k&&null!=e&&(void 0==h.width&&(h.width={}),void 0==h.height&&(h.height={}),h.height.max=k,h.width.max=e,"chrome-stable"===b.a.browserEngineCheck()&&(h.width.ideal=e,h.height.ideal=k));if(h.width.min&&h.height.min&&h.width.max&&h.height.max&&h.width.min*h.height.min>h.width.max*h.height.max)return a.a.error("setVideoResolution() : constraint mismatch : "+
JSON.stringify(h)),!1;null!=p&&(h.frameRate={max:p});f.applyConstraints(h).then(function(){console.log("RESOLUTION Set track constariants success : "+JSON.stringify(h))}).catch(function(b){a.a.error("RESOLUTION Set trac constraints failed: "+b+" constraints: "+JSON.stringify(h));r.a.error("stream-event",d.a.event_general_failed,{message:"RESOLUTION Set trac constraints failed: "+b+" constraints: "+JSON.stringify(h)})})})};f.switchMicrophone=function(a,b,c,e){e=void 0===e?!0:e;n?0==V("setMicrophoneTrack")?
(r.a.warn("stream-event",d.a.event_general_failed,{message:"switchMicrophone - Previous similar request in process"}),c(g.a.error_1140)):(f.selfMuteAudio||f.hardAudioMuted)&&e?(t.switchMicrophone={newStream:a,deviceInfo:b},M("setMicrophoneTrack"),c({result:0,msg:"set but not active"})):W(a,b,void 0,!0,function(b){M("setMicrophoneTrack");console.log("setMediaDevicesTrack() in switch mic returned failure : "+JSON.stringify(b)+"device type: "+q.a.browser_info.device_type);b.result===g.a.error_1145&&
"mobile"==q.a.browser_info.device_type?void 0!==f.room?f.room.mediaDeviceError(b):c(b):c(0===b.result?a:b)}):(r.a.error("stream-event",d.a.event_general_failed,{message:"switchMicrophone - Stream not found"}),c(g.a.error_1159))};f.switchCamera=function(b,c,e,k,p){e=void 0===e?function(){}:e;k=void 0===k?!0:k;p=void 0===p?!0:p;if("function"===typeof e)if(void 0==f.stream)e(g.a.error_1159);else if(1!==f.stream.getVideoTracks().length)e(g.a.error_1159);else if(x)if(0==V("setCameraTrack"))r.a.warn("stream-event",
d.a.event_general_failed,{message:"switchCamera - Previous similar request in process"}),e(g.a.error_1140);else if((f.selfMuteVideo||f.hardVideoMuted)&&!J&&k)t.switchCamera={newStream:b,deviceInfo:c},e({result:0,msg:"set but not active"}),M("setCameraTrack");else{var h={};if(void 0!=c){if("string"===typeof c)h.deviceId=c;else if("object"===typeof c){if(void 0!=c.deviceId&&"string"===typeof c.deviceId&&(h.deviceId=c.deviceId),void 0!=c.facingMode&&"string"===typeof c.facingMode&&(h.facingMode=c.facingMode),
void 0==h.deviceId&&void 0==h.facingMode){a.a.error("Error switchCamera(), error: invalid camera options "+JSON.stringify(c));r.a.error("stream-event",d.a.event_general_failed,{message:"Error switchCamera(), error: invalid camera options "+JSON.stringify(c)});e(g.a.error_1155);return}}else{a.a.error("Error switchCamera(), error: invalid camera options type "+JSON.stringify(c));r.a.error("stream-event",d.a.event_general_failed,{message:"Error switchCamera(), error: invalid camera options type "+JSON.stringify(c)});
e(g.a.error_1155);M("setCameraTrack");return}f.stream.getVideoTracks().forEach(function(a){a.enabled=!1;a.stop();a.onended=W(b,void 0,h,p,function(a){var c=!1;b.stream.getVideoTracks().forEach(function(a){c=a.readyState});0===a.result?(da(f.videoStream),M("setCameraTrack"),e(0===a.result?b:a)):1150===a.result?"live"==c&&(da(f.videoStream),M("setCameraTrack"),e(b)):(M("setCameraTrack"),console.log("setMediaDevicesTrack() switch cam returned failure : "+JSON.stringify(a)+"device type: "+q.a.browser_info.device_type),
a.result===g.a.error_1145&&"mobile"==q.a.browser_info.device_type?void 0!==f.room?f.room.mediaDeviceError(a):e(a):(M("setCameraTrack"),e(a)))})})}else a.a.error("Error switchCamera(), error: camera options undefined"),r.a.error("stream-event",d.a.event_general_failed,{message:"Error switchCamera(), error: camera options undefined"}),e(g.a.error_1155),M("setCameraTrack")}else r.a.error("stream-event",d.a.event_general_failed,{message:"switchCamera - Stream not found"}),e(g.a.error_1159);else a.a.error("switchCamera() invalid param - callback")};
f.switchMediaDevices=function(b,c,e,k){if(n&&x){if(void 0!==e){if(f.selfMuteVideo||f.hardVideoMuted){r.a.warn("stream-event",d.a.event_general_failed,{message:"switchMediaDevices - Media device switching not allowed in video mute state"});k(g.a.error_1189);return}if(0==V("setCameraTrack")){r.a.warn("stream-event",d.a.event_general_failed,{message:"switchMediaDevices - Previous similar request in process"});k(g.a.error_1140);return}}if(void 0!==c){if(f.selfMuteAudio||f.hardAudioMuted){r.a.warn("stream-event",
d.a.event_general_failed,{message:"switchMediaDevices - Media device switching not allowed in audio mute state"});k(g.a.error_1189);void 0!==e&&M("setCameraTrack");return}if(0==V("setMicrophoneTrack")){void 0!==e&&M("setCameraTrack");k(g.a.error_1140);r.a.warn("stream-event",d.a.event_general_failed,{message:"switchMediaDevices - Previous similar request in process"});return}}var p={};if(void 0!=e)if("string"===typeof e)p.deviceId=e;else if("object"===typeof e){if(void 0!=e.deviceId&&"string"===typeof e.deviceId&&
(p.deviceId=e.deviceId),void 0!=e.facingMode&&"string"===typeof e.facingMode&&(p.facingMode=e.facingMode),void 0==p.deviceId&&void 0==p.facingMode){a.a.error("Error switchMediaDevices(), error: invalid camera options "+JSON.stringify(e));r.a.error("stream-event",d.a.event_general_failed,{message:"Error switchMediaDevices(), error: invalid camera options "+JSON.stringify(e)});k(g.a.error_1155);return}}else{a.a.error("Error switchMediaDevices(), error: invalid camera options type "+JSON.stringify(e));
r.a.error("stream-event",d.a.event_general_failed,{message:"Error switchMediaDevices(), error: invalid camera options type "+JSON.stringify(e)});k(g.a.error_1155);return}else p=void 0;void 0==f.stream?(k(g.a.error_1159),M("setCameraTrack")):f.stream.getVideoTracks().forEach(function(a){a.stop();a.onended=W(b,c,p,!0,function(a){var c=!1;b.stream.getVideoTracks().forEach(function(a){c=a.readyState});0===a.result?(da(f.videoStream),M("setCameraTrack"),M("setMicrophoneTrack"),k(0===a.result?b:a)):1150===
a.result?(da(f.videoStream),k(b),"live"==c?(da(f.videoStream),M("setCameraTrack"),M("setMicrophoneTrack"),k(b)):(M("setCameraTrack"),M("setMicrophoneTrack"),k(a))):(M("setCameraTrack"),M("setMicrophoneTrack"),console.log("setMediaDevicesTrack() switch media dev  failure : "+JSON.stringify(a)+"device type: "+q.a.browser_info.device_type),a.result===g.a.error_1145&&"mobile"==q.a.browser_info.device_type?void 0!==f.room?f.room.mediaDeviceError(a):k(a):k(a))})})}else r.a.error("stream-event",d.a.event_general_failed,
{message:"switchMediaDevices - Stream not found"}),k(g.a.error_1159)};f.setSpeaker=function(a){f.getID();var b=f.getPlayerId();void 0!==document.querySelector("#"+b.stream)&&null!==document.querySelector("#"+b.stream)&&document.querySelectorAll("#"+b.stream).forEach(function(b){"function"===typeof b.setSinkId&&b.setSinkId(a)})};var V=function(b){if(!f.transactions.get(b))return f.transactions.set(b,{state:"inprogress"}),!0;a.a.error("Invalid state: previous request in progress. transId: "+b);r.a.warn("stream-event",
d.a.event_general_failed,{message:"setTrasactionIfNotExists - Invalid state: previous request in progress. transId: "+b});return!1},M=function(a){return f.transactions.delete(a)},W=function(b,c,e,p,h){var q=new MediaStream;if(!b||!0!==b.local||b.ifScreen()||b.ifCanvas())a.a.info("Cannot switch devices over invalid stream"),r.a.error("stream-event",d.a.event_general_failed,{message:"setMediaDevicesTrack - Cannot switch devices over invalid stream"}),h(g.a.error_1155);else{var l={};l.audio=void 0!==
c?"none"!==c?{deviceId:c}:!0:!1;void 0!==e?(l.video={},Z(l.video),void 0!=e.deviceId&&"none"!==e.deviceId&&(l.video={deviceId:{exact:e.deviceId}}),void 0!=e.facingMode&&(l.video={facingMode:{exact:e.facingMode}}),void 0!==f.videoFrameRate&&(l.video.frameRate={min:f.videoFrameRate[0],max:f.videoFrameRate[1]})):l.video=!1;ba(l,function(f,w){void 0==w?(b.pc&&b.pc.peerConnection&&p&&(e?(w="user"===aa?k:f,ca=f):w=f,ia(b,void 0!==c,void 0!==e,w,"self"==aa)),e?(b.videoStream=f,f.getVideoTracks().forEach(function(a,
b){q.addTrack(a);u.params.set.video.groupId=a.getSettings().groupId}),void 0!=e.deviceId?"none"!==e.deviceId&&(u.video.deviceId=e.deviceId,u.params.set.video.deviceId=JSON.parse(JSON.stringify(l.video.deviceId))):f.getVideoTracks().forEach(function(a,b){void 0!=a.getSettings().deviceId&&(u.video.deviceId=a.getSettings().deviceId);q.addTrack(a)}),a.a.log("Got video access from devices:- ",u.video.deviceId),r.a.info("stream-event",d.a.event_gum_success,{message:"Got video access from devices:- "+u.video.deviceId})):
b.videoStream.getVideoTracks().forEach(function(a,b){q.addTrack(a)}),c?(b.audioStream=f,f.getAudioTracks().forEach(function(a,b){q.addTrack(a);u.params.set.audio.groupId=a.getSettings().groupId}),"none"!==c&&(u.audio&&(u.audio.deviceId=c),u.params.set.audio.deviceId=JSON.parse(JSON.stringify(l.audio.deviceId))),a.a.log("Got audio access from devices:- ",c),r.a.info("stream-event",d.a.event_gum_success,{message:"Got audio access from devices:- "+c})):b.audioStream&&b.audioStream.getAudioTracks().forEach(function(a){return q.addTrack(a)}),
h(g.a.error_000)):(f=e?e.deviceId:"null",a.a.info("Error getUserMedia(), error: "+w+" cam: "+f+" mic: ",c),r.a.error("stream-event",d.a.event_gum_failed,{cam_id:f,mic_id:c}),h(w));b.stream=q})}},ia=function(b,c,f,g,e){e=void 0===e?!0:e;var k=!1,p=!1;b.pc&&b.pc.peerConnection?b.pc.peerConnection.getSenders().forEach(function(a,d){a.track&&(f&&"video"===a.track.kind?(u.video.trackIndex=d,p=!0,g?g.getVideoTracks().forEach(function(b){b.enabled=!0;a.replaceTrack(b)}):a.replaceTrack(null),e&&b.videoStream.getVideoTracks().forEach(function(a){a.enabled=
!1;a.onended=null;a.stop()})):c&&"audio"===a.track.kind&&(u.audio.trackIndex=d,k=!0,g?g.getAudioTracks().forEach(function(b){b.enabled=!0;a.replaceTrack(b)}):a.replaceTrack(null),b.audioStream.getAudioTracks().forEach(function(a){a.enabled=!1;a.onended=null;a.stop()})))}):(f&&b.videoStream&&e&&b.videoStream.getVideoTracks().forEach(function(a){console.log("without replace track setting current videotracks to stop");a.enabled=!1;a.onended=null;a.stop()}),c&&b.audioStream&&b.audioStream.getAudioTracks().forEach(function(a){a.enabled=
!1;a.onended=null;a.stop()}));b.pc&&b.pc.peerConnection&&(c&&!k||f&&!p)&&(b.pc.peerConnection.getSenders().forEach(function(a,b){!a.track&&g&&(c&&!k&&void 0!==u.audio.trackIndex&&b===u.audio.trackIndex&&(k=!0,g.getAudioTracks().forEach(function(b){b.enabled=!0;a.replaceTrack(b)})),f&&!p&&void 0!==u.video.trackIndex&&b===u.video.trackIndex&&(p=!0,g.getVideoTracks().forEach(function(b){b.enabled=!0;a.replaceTrack(b)})))}),c&&!k||f&&!p)&&(a.a.error("Error: Not finding sender track::  audio: "+c+" found: "+
k+" index: "+u.audio.trackIndex+" video: "+f+" found: "+p+" index: "+u.video.trackIndex),r.a.error("stream-event",d.a.event_general_failed,{message:"replaceNewMediaStreamTrack - Not finding sender track::  audio: "+c+" found: "+k+" index: "+u.audio.trackIndex+" video: "+f+" found: "+p+" index: "+u.video.trackIndex}),b.pc.peerConnection.getSenders().forEach(function(b,c){a.a.error("index : "+c+" sender.track: "+b.track+" kind : "+(b.track?b.track.kind:"none"))}))},va=function(a,b,c){return a&&(Y==
b||"none"==Y)&&("video"==Q||"audiovideo"==Q||R&&!c)};f.getPlayerId=function(a){a=void 0===a?null:a;var b=f.getID();a=a?a:f.room;a="breakout-room"===(a&&a.roomSettings&&a.roomSettings.room_type?a.roomSettings.room_type:null)?"br_"+a.roomID+"_":"";return{stream:a+"stream"+b,player:a+"player_"+b}};f.reloadPlayer=function(c,g){var e=c.mediatype,k=c.clientId;if(Q!=e||R||g&&"none"!=K&&K!=c.reason){a.a.debug("reloadPlayer() streamId: "+f.getID()+" mediatype:( "+e+" , "+Q+" ), clientId:( "+k+" , "+Y+" ), reason:( "+
c.reason+" , "+K+" )  imageOnVideoMute: "+g);f.getID();var p=f.getPlayerId();if(void 0!==document.querySelector("#"+p.stream)&&null!==document.querySelector("#"+p.stream)){var h=!1;document.querySelectorAll("#"+p.stream).forEach(function(p){try{switch(e){case "audio":if(K=c.reason,va(g,k,"user"==c.reason)){0==f.mediaStream.getAudioTracks().length&&f.stream.getAudioTracks().forEach(function(a){f.mediaStream.addTrack(a)});h=R=!0;I=!1;H=!0;break}case "audioOnly":f.audioStream?(p.srcObject=f.audioStream,
R=!1,h=!0,I=!1,H=!0):a.a.error("reloadPlayer() failed id : "+f.getID()+" audiostream null medtype - curr: "+(Q+" new: "+e));break;case "video":f.mediaStream?("audiovideo"==Q?(0==f.mediaStream.getVideoTracks().length&&f.stream.getVideoTracks().forEach(function(a){f.mediaStream.addTrack(a)}),0!=f.mediaStream.getAudioTracks().length&&f.mediaStream.getAudioTracks().forEach(function(a){f.mediaStream.removeTrack(a)})):p.srcObject=f.mediaStream,R=!1,K="none",I=h=!0,H=!1):(a.a.error("reloadPlayer() failed id : "+
f.getID()+" videostream null, medtype - curr: "+Q+" new: "+e),r.a.error("stream-event",d.a.event_general_failed,{message:"reloadPlayer() failed id : "+f.getID()+" videostream null, medtype - curr: "+Q+" new: "+e}));break;case "audiovideo":if(f.mediaStream){0==f.mediaStream.getAudioTracks().length&&f.stream.getAudioTracks().forEach(function(a){f.mediaStream.addTrack(a)});0==f.mediaStream.getVideoTracks().length&&f.stream.getVideoTracks().forEach(function(a){f.mediaStream.addTrack(a)});if("video"!=
Q||"safari"===b.a.browserEngineCheck())p.srcObject=f.mediaStream;R=!1;K="none";h=!0;I=H=!1}else a.a.error("reloadPlayer() failed id : "+f.getID()+" stream null, medtype - curr: "+Q+" new: "+e),r.a.error("stream-event",d.a.event_general_failed,{message:"reloadPlayer() failed id : "+f.getID()+" stream null, medtype - curr: "+Q+" new: "+e});break;default:K=c.reason,I=H=!0,va(g,k,"user"==c.reason)?R=!0:(p.srcObject=null,R=!1),h=!0}}catch(qa){a.a.error("reloadPlayer() id : "+f.getID()+" NULL set medtype - curr: "+
Q+" new: "+e),r.a.error("stream-event",d.a.event_general_failed,{message:"reloadPlayer() id : "+f.getID()+" NULL set medtype - curr: "+Q+" new: "+e})}});h&&(Q=e,Y=k)}else a.a.error("reloadPlayer() id : "+f.getID()+" ID selector null medtype - curr: "+Q+" new: "+e+" storing AT req"),r.a.error("stream-event",d.a.event_general_failed,{message:"reloadPlayer() id : "+f.getID()+" ID selector null medtype - curr: "+Q+" new: "+e+" storing AT req"})}else{a.a.debug("reloadPlayer() id : "+f.getID()+" no change in media type: "+
e);if("none"===Y)switch(Q){case "audio":case "audioOnly":I=!1;H=!0;break;case "video":I=!0;H=!1;break;case "audiovideo":I=H=!1;break;default:I=H=!0}Y=k}N={talkerInfo:JSON.parse(JSON.stringify(c)),imageOnVideoMute:g}};f.setBandwidthAlert=function(a){f.getID();f.player&&!0===f.abwdEnabled&&("low"===a.bw?"sdk"===f.abwdNotification?f.player.setBwAlert(!0,a.type,a.name):(a=Object(h.f)({type:"bw-alert",stream:f,stream_type:a.type,msg:"subscriber"===a.type?"subscriber low":a.name+" publisher low"}),f.dispatchEvent(a)):
"sdk"===f.abwdNotification?f.player.setBwAlert(!1):(a=Object(h.f)({type:"bw-restored",stream:f}),f.dispatchEvent(a)))};f.setVideoMutedMessage=function(a){null!=f.player&&(!0===a.videomuted&&"bw"===a.reason?(f.videoMutedDueToBw=!0,f.player.setVideoMutedMsg(a)):!0===f.videoMutedDueToBw&&f.player.setVideoMutedMsg(a))};var da=function(b){for(var c=0;c<f.playerDivs.length;c++){var g=document.getElementById(f.playerDivs[c].elementId);g&&(g=g.querySelectorAll("video"),0<g.length&&document.querySelectorAll("#"+
g[0].id).forEach(function(c){try{c.srcObject=b}catch(ha){a.a.error("Exception:: attachStreamOnPlayerDivs() streamId: "+f.getID()+" error: "+ha),r.a.error("stream-event",d.a.event_general_failed,{message:"attachStreamOnPlayerDivs() streamId: "+f.getID()+" error: "+ha})}}))}};f.muteSubscriberStreamVideo=function(a){f.stream&&!f.local&&f.stream.getVideoTracks().forEach(function(b){b.enabled=!a})};f.updateVideo=function(b){b=f.getPlayerId();void 0!==document.querySelector("#"+b.stream)&&null!==document.querySelector("#"+
b.stream)?(a.a.info("Player element exists and playing the video",""+b.stream),f.htmlPlay(""+b.stream)):(a.a.error("Player element does not exist"),r.a.error("stream-event",d.a.event_general_failed,{message:"updateVideo - Player element does not exist"}))};f.play=function(c,d){if("object"===typeof d&&d.hasOwnProperty("player")){a.a.info("Element ID is "+c);var g=d||{};f.elementID=c;d.player&&d.player.abwd&&(void 0!==d.player.abwd.enabled&&(f.abwdEnabled=d.player.abwd.enabled),!0===f.abwdEnabled&&
d.player.abwd.notification&&(f.abwdNotification=d.player.abwd.notification,"sdk"===f.abwdNotification&&void 0!==d.player.abwd.language&&(f.abwdLanguage="en"===d.player.abwd.language||"zh"===d.player.abwd.language?d.player.abwd.language:"en")));if(f.ifVideo()||f.ifScreen()||f.audioOnly||f.ifAudio())if(void 0!==c&&null!==document.getElementById(c)){if("IE"===b.a.browserEngineCheck()){g=document.getElementById(c);var k=document.getElementById(c);"VIDEO"!==g.nodeName&&(a.a.info("not video tag"),k=document.createElement("video"),
k.setAttribute("height",g.getAttribute("height")),k.setAttribute("width",g.getAttribute("width")),g.appendChild(k));f.attachMediaStream(k,f.stream)}else k={autoplay:!0},"safari"===b.a.browserEngineCheck()&&(k.playsinline=!0),g=Object(e.a)({id:f.getID(),stream:f,elementID:c,options:g,extraPlayerOptions:k,vroom:f.room?f.room:null}),f.local?g.video.muted=!0:f.playerDivs=[],f.player=g,f.showing=!0;f.playerDivs.push({elementId:c,options:d});Q="audiovideo";void 0!==N&&(a.a.error("stream.play currentActiveTalkerList : calling reload player()"),
f.reloadPlayer(N.talkerInfo,N.imageOnVideoMute));f.local||void 0==f.room||void 0==f.room.selectedSpeakerId||f.setSpeaker(f.room.selectedSpeakerId)}else a.a.error("Element not found");else if(f.ifAudio()||f.audioOnly)g=Object(l.a)({id:f.getID(),stream:f,elementID:c,options:g,vroom:f.room?f.room:null}),f.local?g.audio.muted=!0:f.playerDivs=[],f.player=g,f.showing=!0,f.playerDivs.push({elementId:c,options:d}),Q="audio";f.reload&&delete f.reload;void 0!==f.room?!0===f.room.subscribeSessionStats?f.ShowSessionStats(!0):
f.ShowSessionStats(!1):a.a.info("room is not allocated to stream , stats UI will not be shown")}else a.a.error("play() invalid param - callback/RoomDefinition")};f.resetMediaConfiguration=function(a){f.pc.resetSDP(a)};f.htmlPlay=function(b,c){f.elementID=b;(f.ifVideo()||f.ifScreen())&&void 0!==b&&document.querySelectorAll("#"+b).forEach(function(b){try{b.srcObject=f.local?f.videoStream:f.stream}catch(Ha){b.src=URL.createObjectURL(f.local?f.videoStream:f.stream)}b.play().then(function(){}).catch(function(b){a.a.error("Error playing video stream: "+
b);r.a.error("stream-event",d.a.event_general_failed,{message:"Error playing video stream: "+b})})})};f.stop=function(a){if(f.showing){if(void 0!=a&&(f.playerDivs=f.playerDivs.filter(function(b){return b.elementId!=a}),!f.playerDivs.length))return;void 0!==f.player&&(f.player.destroy(),f.showing=!1)}};f.show=f.play;f.hide=f.stop;var ra=function(a){if(void 0!==f.player&&void 0!==f.stream){var b=document.defaultView.getComputedStyle(f.player.video),c=parseInt(b.getPropertyValue("width"),10),d=parseInt(b.getPropertyValue("height"),
10);parseInt(b.getPropertyValue("left"),10);parseInt(b.getPropertyValue("top"),10);b="object"===typeof f.elementID&&"function"===typeof f.elementID.appendChild?f.elementID:document.getElementById(f.elementID);var g=document.defaultView.getComputedStyle(b);b=parseInt(g.getPropertyValue("width"),10);g=parseInt(g.getPropertyValue("height"),10);if(document.getElementById(a))var e=document.getElementById(a);else e=document.createElement("canvas"),e.id=a,e.width=b,e.height=g,e.className="canvas_input",
e.setAttribute("style","position: absolute;top: 15%;left: 45%;z-index: 897;"),document.body.appendChild(e);f.inputContext=e.getContext("2d");f.inputContext.drawImage(f.player.video,0,0,c,d);return e}return null};f.getVideoFrameURL=function(a){var b=ra();return null!==b?a?b.toDataURL.apply(b,$jscomp.arrayFromIterable(a)):b.toDataURL():null};f.getVideoFrameImage=function(a){a=ra(a);return null!==a?a.getContext("2d").getImageData(10,10,a.width,a.height):null};f.checkOptions=function(b,c){if(!0===c){if(b.audio||
b.screen)a.a.warning("Error! Cannot update type of subscription"),b.audio=void 0,b.screen=void 0}else!1===f.local&&(!0===b.video&&!1===f.ifVideo()&&(a.a.warning("Error! Stream doesn't have Video Track. Can't subscribe to Video"),b.video=!1),!0===b.audio&&!1===f.ifAudio()&&(a.a.warning("Error! Stream doesn't have Audio Track. Can't subscribe to Audio"),b.audio=!1));!1!==f.local||f.ifVideo()||!0!==b.slideShowMode||(a.a.warning("Error! Stream doesn't have Video Track. Cannot enable slideShowMode. Check parameters"),
b.slideShowMode=!1)};var fa=function(c,e,k){k=void 0===k?function(){}:k;console.log("Muting the stream : enable "+c);if(n)if(c===I)r.a.error("stream-event",d.a.event_general_failed,{message:"muteStreamAudio - MediaDevice state is already in same state"}),k(g.a.error_1177);else if(0==V("setMicrophoneTrack"))r.a.error("stream-event",d.a.event_general_failed,{message:"muteStreamAudio - Previous similar request in process"}),k(g.a.error_1140);else{var p=function(c,e){try{var k=!1;if("safari"===b.a.browserEngineCheck()){var p=
f.pc.peerConnection.getSenders().find(function(a){return a.track&&"audio"===a.track.kind||null===a.track});p&&f.audioStream.getAudioTracks().forEach(function(a){a.enabled=!c;p.replaceTrack(c?null:f.audioStream.getAudioTracks()[0])})}else f.audioStream.getAudioTracks().forEach(function(a){a.enabled=!c;k||"ended"!=a.readyState||(k=!0)});I=c;M("setMicrophoneTrack");!c&&k?void 0!=f.selectedMicId?W(f,f.selectedMicId,void 0,!0,function(a){a.result===g.a.error_000.result&&(I=c);e(a)}):(r.a.error("stream-event",
d.a.event_general_failed,{message:"muteStreamAudio - error - stream ended"}),e(g.a.error_1191)):(I=c,r.a.info("stream-event",d.a.event_general_success,{message:"muteStreamAudio - success"}),e(g.a.error_000))}catch(Ba){a.a.error("Excpetion happend : "+Ba),M("setMicrophoneTrack"),r.a.error("stream-event",d.a.event_general_failed,{message:"muteStreamAudio - error - "+Ba}),e(g.a.error_1150)}};e?setTimeout(p,e,c,k):p(c,k)}else r.a.error("stream-event",d.a.event_general_failed,{message:"muteStreamAudio - Stream not found"}),
k(g.a.error_1159)},U=function(a,b,c){c=void 0===c?function(){}:c;if(x)if(a===H)r.a.error("stream-event",d.a.event_general_failed,{message:"muteStreamVideo - MediaDevice state is already in same state"}),c(g.a.error_1177);else if(0==V("setCameraTrack"))c(g.a.error_1140);else{console.log("muteSTreamVideo() enable: "+a);var e=function(a,b){try{if(a)ia(f,!1,!0,null,"self"==aa&&!J),H=a,M("setCameraTrack"),b(g.a.error_000);else if(J)H=a,f.pc&&f.pc.peerConnection&&ia(f,!1,!0,f.videoStream,!1),M("setCameraTrack"),
b(g.a.error_000);else{var c={};void 0!=u.video.deviceId?c.deviceId=u.video.deviceId:void 0!==u.video.facingMode&&"mobile"==q.a.browser_info.device_type&&(c.facingMode=u.video.facingMode);void 0==c.deviceId&&void 0==c.facingMode&&(c.deviceId="none");W(f,void 0,c,!0,function(c){if(c.result===g.a.error_000.result)H=a;else{var f=q.a.getLocalStorageItem("vcxRTCLib-log");null!=f&&(f=JSON.parse(f),r.a.error("stream-event",a?d.a.event_mute_self_video_failed:d.a.event_unmute_self_video_failed,{message:f}))}M("setCameraTrack");
b(c)})}}catch(qa){console.log("Excpetion happend : "+qa),M("setCameraTrack"),c=q.a.getLocalStorageItem("vcxRTCLib-log"),null!=c&&(c=JSON.parse(c),r.a.error("stream-event",a?d.a.event_mute_self_video_failed:d.a.event_unmute_self_video_failed,{message:c})),b(g.a.error_1150)}};b?setTimeout(e,b,a,c):e(a,c)}else r.a.error("stream-event",d.a.event_general_failed,{message:"muteStreamVideo - Stream not found"}),c(g.a.error_1159)};f.muteAudio=function(b,c,d,e,k){b=void 0===b?function(){}:b;c=void 0===c?!0:
c;d=void 0===d?0:d;e=void 0===e?!0:e;k=void 0===k?!1:k;"function"===typeof b?(console.log("muteAudio() selfSet : "+e+" selfMuteAudio: "+f.selfMuteAudio+" hardAudioMuted: "+f.hardAudioMuted+" audioMuted: "+I+" paused: "+f.selfPausedAudio+" config.audioMuted: "+f.config.audioMuted),e&&f.selfMuteAudio||!e&&(f.hardAudioMuted||f.selfPausedAudio)?(!0===k&&(f.selfPausedAudio=!0),c&&f.sendEvent("user-audio-muted"),b(g.a.error_1177)):void 0!==f.pc&&null!=f.pc||void 0==f.audioStream?fa(!0,d,function(a){if(a.result===
g.a.error_000.result||a.result===g.a.error_1177.result)e?f.selfMuteAudio=!0:k?f.selfPausedAudio=!0:f.hardAudioMuted=!0,a.result===g.a.error_000.result&&c?f.sendEvent("user-audio-muted"):c||(a=g.a.error_000);b(a)}):(f.audioStream.getAudioTracks().forEach(function(a){a.onended=null;a.enabled=!1}),I=!0,e?(f.selfMuteAudio=!0,f.config.audioMuted=!0):k?f.selfPausedAudio=!0:f.hardAudioMuted=!0,b(g.a.error_000))):a.a.error("muteAudio() invalid param - callback")};f.setMediaDeviceMuteState=function(a,b,c,
d,e){try{if(b){if(a===I){e(g.a.error_1177);return}f.audioStream.getAudioTracks().forEach(function(b){b.enabled=!a});I=a;d&&f.sendEvent(I?"user-audio-muted":"user-audio-unmuted")}if(c){if(a===H){e(g.a.error_1177);return}f.stream.getVideoTracks().forEach(function(b){b.enabled=!a});H=a;d&&f.sendEvent(H?"user-video-muted":"user-video-unmuted")}e(g.a.error_000)}catch(za){console.log("Excpetion happend : "+za),e(g.a.error_1150)}};f.muteAudioNotSelf=function(a,b){fa(!0,0,void 0===a?function(){}:a);void 0!==
b&&!1===b||f.sendEvent("user-audio-muted")};var pa=function(a){a.data&&0<a.data.size&&f.recordedBlobs.push(a.data)};f.startLocalRecord=function(b){b=void 0===b?function(){}:b;if(f.mediaRecorder)a.a.error("Recording started already:"),b(g.a.error_1174);else try{f.mediaRecorder=new MediaRecorder(f.stream,{mimeType:"video/webm"}),f.mediaRecorder.ondataavailable=pa,f.recordedBlobs=[],f.mediaRecorder.start(10),b(g.a.error_000)}catch(Ga){a.a.error("Exception while creating MediaRecorder:",Ga),b(g.a.error_000)}};
f.stopLocalRecord=function(a){a=void 0===a?function(){}:a;if(f.mediaRecorder&&0<f.recordedBlobs.length){var b=new Date,c=b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate();b=b.getHours()+":"+b.getMinutes()+":"+b.getSeconds();c="stream_"+f.getID()+"_"+c+"::"+b+".webm";b=new Blob(f.recordedBlobs,{type:"video/webm"});b=window.URL.createObjectURL(b);var d=document.createElement("a");d.style.display="none";d.href=b;d.download=c;d.click();window.URL.revokeObjectURL(b);a(g.a.error_000)}else a(g.a.error_1175);
f.mediaRecorder=void 0;f.recordedBlobs=[]};f.sendEvent=function(a){f.room&&f.room.socket.sendEvent(a,function(a){})};f.sendMessage=function(a,b,c){c=void 0===c?function(){}:c;f.room&&f.room.socket.emitEvent(a,b,function(a){c(a)})};f.unmuteAudio=function(b,c,d,e,k){b=void 0===b?function(){}:b;c=void 0===c?!0:c;d=void 0===d?0:d;e=void 0===e?!0:e;k=void 0===k?!1:k;if("function"===typeof b)if(console.log("unmuteAudio() selfSet : "+e+" selfMuteAudio: "+f.selfMuteAudio+" hardAudioMuted: "+f.hardAudioMuted+
" audioMuted: "+I+" paused: "+f.selfPausedAudio+" config.audioMuted: "+f.config.audioMuted),(!e||f.selfMuteAudio||f.hardAudioMuted||f.selfPausedAudio)&&(e||f.hardAudioMuted||f.selfPausedAudio))if(!e||!f.hardAudioMuted||!f.selfPausedAudio||f.room&&f.room.isModerator())if(!e&&f.selfMuteAudio)f.hardAudioMuted=!1,k&&(f.selfPausedAudio=!1),b(g.a.error_000);else if(void 0!=t.switchMicrophone){var p=t.switchMicrophone;f.switchMicrophone(p.newStream,p.deviceInfo,function(a){delete t.switchMicrophone;void 0==
a.result?b(g.a.error_000):f.unmuteAudio(b,c,d,e,k)},!1)}else void 0!==f.pc&&null!=f.pc||void 0==f.audioStream?fa(!1,d,function(a){if(a.result===g.a.error_000.result||a.result===g.a.error_1177.result)e?f.selfMuteAudio=!1:k?f.selfPausedAudio=!1:f.hardAudioMuted=!1,a.result===g.a.error_000.result&&c?f.sendEvent("user-audio-unmuted"):c||(a=g.a.error_000);b(a)}):(f.audioStream.getAudioTracks().forEach(function(a){a.enabled=!0}),!0===f.config.audioMuted&&(f.config.audioMuted=!1),I=!1,e?f.selfMuteAudio=
!1:k?f.selfPausedAudio=!1:f.hardAudioMuted=!1,b(g.a.error_000));else b(g.a.error_1176);else console.log(" that.unmuteAudio() error177: selfSet: "+e+"  that.selfMuteAudio: "+f.selfMuteAudio+" that.hardAudioMuted: "+f.hardAudioMuted+" that.selfPausedAudio: "+f.selfPausedAudio),!c||f.selfMuteAudio||f.hardAudioMuted||f.sendEvent("user-audio-unmuted"),b(g.a.error_1177);else a.a.error("unmuteAudio() invalid param - callback")};f.hardMuteAudio=function(a){f.room&&!f.local&&f.sendMessage("hardmute-user-audio",
{clientId:f.clientId})};f.hardUnmuteAudio=function(a){f.room&&!f.local&&f.sendMessage("hardunmute-user-audio",{clientId:f.clientId})};f.hardMuteVideo=function(a){f.room&&!f.local&&f.sendMessage("hardmute-user-video",{clientId:f.clientId})};f.hardUnmuteVideo=function(a){f.room&&!f.local&&f.sendMessage("hardunmute-user-video",{clientId:f.clientId})};f.muteNonATPubVideo=function(a){f.videoStream&&(f.ATVideoMuted=!0,f.videoStream.getVideoTracks().forEach(function(a){a.enabled=!1}))};f.unmuteNonATPubVideo=
function(a){f.videoStream&&!1===f.hardAudioMuted&&!1===f.selfMuteVideo&&!0===f.ATVideoMuted&&(f.ATVideoMuted=!1,f.videoStream.getVideoTracks().forEach(function(a){a.enabled=!0}))};f.muteVideo=function(b,c,d,e,k,p){b=void 0===b?function(){}:b;c=void 0===c?!0:c;d=void 0===d?0:d;e=void 0===e?!0:e;k=void 0===k?!1:k;p=void 0===p?!1:p;"function"===typeof b?(console.log("SelfSet:"+e+"selfMuteVideo"+f.selfMuteVideo+"selfPausedVideo:"+f.selfPausedVideo),e&&f.selfMuteVideo||!e&&(f.hardVideoMuted||f.selfPausedVideo)?
(p&&(f.selfPausedVideo=!0),c&&f.sendEvent("user-video-muted"),b(g.a.error_1177)):void 0!==f.pc&&null!=f.pc||void 0==f.room||void 0==f.videoStream?k?(J||f.videoStream.getVideoTracks().forEach(function(a){a.enabled=!1}),f.softVideoMuted=!0,b(g.a.error_000)):U(!0,d,function(a){if(a.result===g.a.error_000.result||a.result===g.a.error_1177.result)e?f.selfMuteVideo=!0:p?f.selfPausedVideo=!0:f.hardVideoMuted=!0,a.result===g.a.error_000.result?(J||da(null),c&&f.sendEvent("user-video-muted")):a=g.a.error_000;
b(a)}):(J||f.videoStream.getVideoTracks().forEach(function(a){a.onended=null;a.enabled=!1}),H=f.config.videoMuted=!0,e?f.selfMuteVideo=!0:p?f.selfPausedVideo=!0:f.hardVideoMuted=!0,b(g.a.error_000))):a.a.error("muteVideo() invalid param - callback")};f.unmuteVideo=function(b,c,d,e,k){b=void 0===b?function(){}:b;c=void 0===c?!0:c;d=void 0===d?0:d;e=void 0===e?!0:e;k=void 0===k?!1:k;if("function"===typeof b)if(console.log("unmuteVideo() selfSet : "+e+" that.selfMuteVideo: "+f.selfMuteVideo+" that.softVideoMuted: "+
f.softVideoMuted+" that.hardVideoMuted: "+f.hardVideoMuted+" paused: "+f.selfPausedAudio),(!e||f.selfMuteVideo||f.softVideoMuted||f.hardVideoMuted||f.selfPausedVideo)&&(e||f.hardVideoMuted||f.selfPausedVideo))if(!e||!f.hardVideoMuted||!f.selfPausedVideo||f.room&&f.room.isModerator())if(!e&&f.selfMuteVideo)f.hardVideoMuted=!1,k&&(f.selfPausedVideo=!1),b(g.a.error_000);else if(void 0!=t.switchCamera){var p=t.switchCamera;f.switchCamera(p.newStream,p.deviceInfo,function(a){delete t.switchCamera;void 0==
a.result?(H=f.softVideoMuted=!1,e?f.selfMuteVideo=!1:k?f.selfPausedVideo=!1:f.hardVideoMuted=!1,console.log("unmuteVideo() switchCamera () NOT attaching playerdivs"),c&&f.sendEvent("user-video-unmuted"),b(g.a.error_000)):f.unmuteVideo(b,c,d,e,k)},!1,!0)}else void 0!==f.pc&&null!=f.pc||!f.room||void 0==f.videoStream?U(!1,d,function(a){if(a.result===g.a.error_000.result||a.result===g.a.error_1177.result)f.softVideoMuted=!1,e?f.selfMuteVideo=!1:k?f.selfPausedVideo=!1:f.hardVideoMuted=!1,a.result===g.a.error_000.result?
(console.log("unmuteVideo() muteStreamVideo() success"),J||da(f.videoStream),c&&f.sendEvent("user-video-unmuted")):a=g.a.error_000;b(a)}):(f.videoStream.getVideoTracks().forEach(function(a){a.enabled=!0}),!0===f.config.videoMuted&&(f.config.videoMuted=!1),H=f.softVideoMuted=!1,e?f.selfMuteVideo=!1:k?f.selfPausedVideo=!1:f.hardVideoMuted=!1,b(g.a.error_000));else b(g.a.error_1176);else!c||f.selfMuteVideo||f.softVideoMuted||f.hardVideoMuted||f.sendEvent("user-video-unmuted"),b(g.a.error_1177);else a.a.error("unmuteVideo() invalid param - callback")};
f.setLocalView=function(b,c){c=void 0===c?function(){}:c;if("function"===typeof c)if(J==b)a.a.error("setLocalVideo() already in same state"),c(g.a.error_1177);else if(0==V("setCameraTrack"))r.a.warn("stream-event",d.a.event_general_failed,{message:"setLocalVideo - Previous similar camera request in process"}),c(g.a.error_1140);else if(console.log("setLocalView() enable : "+b),b)if(f.isVideoMuted()){var e={};u.params&&u.params.set.video&&"object"===typeof u.params.set.video.deviceId&&(e.deviceId=u.params.set.video.deviceId.exact);
if(void 0!=t.switchCamera){var k=t.switchCamera;f.switchCamera(k.newStream,k.deviceInfo,function(a){delete t.switchCamera;void 0==a.result?J=!0:f.setLocalView(b,c)},!1,!1)}else k=JSON.parse(JSON.stringify(u.video)),u.params&&u.params.set&&u.params.set.video&&(u.params.set.video.deviceId?k.deviceId="object"==typeof u.params.set.video.deviceId?u.params.set.video.deviceId.exact:u.params.set.video.deviceId:u.params.set.video.facingMode&&(k.facingMode="object"==typeof u.params.set.video.facingMode?u.params.set.video.facingMode.exact:
u.params.set.video.facingMode)),void 0!=k.deviceId?e.deviceId=k.deviceId:void 0!==k.facingMode&&"mobile"==q.a.browser_info.device_type&&(e.facingMode=k.facingMode),void 0==e.deviceId&&void 0==e.facingMode&&(e.deviceId="none"),W(f,void 0,e,!1,function(b){b.result===g.a.error_000.result?(console.log("setMediaDevicesTrack() success attaching playerdiv "),J=!0,da(f.videoStream)):(console.log("setMediaDevicesTrack() failed "),a.a.info("Error setMediaDevicesTrack(), error: "+JSON.stringify(b)+" cam: "+
e.deviceId));M("setCameraTrack");c(b,J?f.videoStream:null)})}else x&&void 0!=f.videoStream?(J=!0,M("setCameraTrack"),console.log("not muted sending stream "),c(g.a.error_000,f.videoStream)):(M("setCameraTrack"),console.log("error not muted but no video stream"),c(g.a.error_1159));else J=!1,f.isVideoMuted()&&(console.log("muted disabling localview by replace track"),void 0!==f.videoStream&&f.videoStream.getTracks().forEach(function(a){a.enabled=!1;a.onended=null;a.stop()})),console.log("disabling localview detaching player divs"),
da(null),M("setCameraTrack"),c(g.a.error_000);else a.a.error("setLocalView() invalid param - callback")};f._setStaticQualityLayer=function(b,c,d){d=void 0===d?function(){}:d;f.room&&f.room.p2p?(a.a.warning("Error! p2p streams don't support setStaticQualityLayer"),d("error")):(b={qualityLayer:{spatialLayer:b,temporalLayer:c}},f.checkOptions(b,!0),f.pc.updateSpec(b,d))};f._setDynamicQualityLayer=function(b){if(f.room&&f.room.p2p)a.a.warning("Error! p2p streams don't support setDynamicQualityLayer"),
b("error");else{var c={qualityLayer:{spatialLayer:-1,temporalLayer:-1}};f.checkOptions(c,!0);f.pc.updateSpec(c,b)}};var la=function(a,b,c){!0!==b&&(b=!1);a="string"===typeof a?[a]:a;a=a instanceof Array?a:[];0<a.length&&f.room.sendControlMessage(f,"control",{name:"controlhandlers",enable:c,publisherSide:b,handlers:a})};f.disableHandlers=function(a,b){la(a,b,!1)};f.enableHandlers=function(a,b){la(a,b,!0)};f.updateSimulcastLayersBitrate=function(a,b){f.pc&&f.local&&(f.pc.updateSimulcastLayersBitrate(a),
b&&(config.maxVideoLayeredBitrates=a))};f.updateConfiguration=function(a,b){b=void 0===b?function(){}:b;if(void 0!==a)if(f.pc)if(f.checkOptions(a,!0),f.local)if(f.room.p2p)for(var c=0;c<f.pc.length;c+=1)f.pc[c].updateSpec(a,b);else void 0!=a.maxVideoBW||void 0!=a.minVideoBW||void 0!=a.maxVideoFps||void 0!=a.minVideoFps?1>=f.maxVideoLayers&&(console.log("updateConfiguration id: "+f.getID()+" config:: "+JSON.stringify(a)),f.setVideoParamsRange(a.maxVideoBW,a.minVideoBW,a.maxVideoFps,a.minVideoFps,!1)):
f.pc.updateSpec(a,b);else f.pc.updateSpec(a,b);else b("Error! This stream has no peerConnection attached, Skipping")};f.ShowSessionStats=function(b){!0===b?void 0!==f.player?f.player.ShowSessionStats(!0):a.a.info("stream does not have a player to show stats"):void 0!==f.player?f.player.ShowSessionStats(!1):a.a.info("stream does not have a player to hide stats")};f.changeInputMediaSource=function(b,c){c=void 0===c?function(){}:c;"function"!==typeof c?a.a.error("changeInputMediaSource() invalid param - callback"):
!f.local||f.ifCanvas()||f.ifScreen()?(a.a.error("changeInputMediaSource() not supported "),c(g.a.error_1156)):void 0==b||"object"!==typeof b||void 0==b.video&&void 0==b.audio?(a.a.error("changeInputMediaSource() invalid param - options"),c(g.a.error_1155)):b.video&&(!b.stream||b.stream.getVideoTracks()&&b.stream.getVideoTracks().length?0==V("setCameraTrack")?(r.a.warn("stream-event",d.a.event_general_failed,{message:"changeInputMediaSource() - Previous similar camera request in process"}),c(g.a.error_1140)):
(k=void 0!=b.stream&&null!=b.stream?b.stream:null,null!=k?(b=k,c="user"):(b=ca,c="self"),f.isVideoMuted()||aa!=c&&ia(f,!1,!0,b,!1),aa=c,M("setCameraTrack")):(a.a.error("changeInputMediaSource() video tracks not found"),c(g.a.error_1156)))};f.replaceLocalTrack=function(a,b){a.pc.peerConnection.getSenders().forEach(function(c,d){c.track&&("video"===c.track.kind?b&&b.getVideoTracks().forEach(function(a){console.log(a);a.enabled=!0;c.replaceTrack(a)}):"audio"===c.track.kind&&a&&a.audioStream.getAudioTracks().forEach(function(a){console.log(a);
a.enabled=!0;c.replaceTrack(a)}))})};f.startAudioAnalysis=function(){void 0==v?a.a.info("AudioAnalysis feature not enabled"):void 0!=f.rnn?a.a.info("startAudioAnalysis already enabled"):f.audioStreamClone&&(a.a.info("startAudioAnalysis enabled for audio track"),f.audioSource=f.audioContext.createMediaStreamSource(f.audioStreamClone),f.pcmInputBuf=v._malloc(1920),f.pcmOutputBuf=v._malloc(1920),f.pcmInputIndex=f.pcmInputBuf/4,f.rnn=v._rnnoise_create(),f.processor=f.audioContext.createScriptProcessor(512,
1,1),f.processor.onaudioprocess=function(a){a=a.inputBuffer.getChannelData(0);a=[].concat($jscomp.arrayFromIterable(f.bufferResidue),$jscomp.arrayFromIterable(a));for(var b=0;b+480<a.length;b+=480){for(var c=a.slice(b,b+480),d=$jscomp.makeIterator(c.entries()),g=d.next();!g.done;g=d.next()){var e=$jscomp.makeIterator(g.value);g=e.next().value;e=e.next().value;c[g]=32767*e}v.HEAPF32.set(c,f.pcmInputIndex);d=v._rnnoise_process_frame(f.rnn,f.pcmOutputBuf,f.pcmInputBuf);f.isAudioMuted()?f.processing_voice_while_mute?
f.scoreArrayVoice.push(d):.9<d&&(f.processing_voice_while_mute=!0,setTimeout(z,700)):f.processing_noise_detection?(f.scoreArrayNoise.push(d),c=m(c),c=C(c),f.scoreArrayNoise.push(d),f.audioLevelArray.push(c)):.2<d&&(c=m(c),c=C(c),.02<c&&(f.processing_noise_detection=!0,f.scoreArrayNoise.push(d),f.audioLevelArray.push(c),setTimeout(D,1500)))}f.bufferResidue=a.slice(b,a.length)},f.audioSource.connect(f.processor),f.processor.connect(f.audioContext.destination))};f.stopAudioAnalysis=function(){void 0==
v?a.a.info("AudioAnalysis feature not enabled"):void 0==f.rnn?a.a.info("startAudioAnalysis not enabled"):(a.a.info("startAudioAnalysis disabled for audio track"),f.pcmInputBuf&&v._free(f.pcmInputBuf),f.pcmOutputBuf&&v._free(f.pcmOutputBuf),v._rnnoise_destroy(f.rnn),f.pcmInputBuf=void 0,f.pcmOutputBuf=void 0,f.rnn=void 0,f.processor.onaudioprocess=function(){},f.processor.disconnect(),f.audioSource.disconnect())};return f}console.log("Webrtc not supported")}},function(m,t,n){t.a=function(){return{player:{default:{autoplay:"autoplay",
name:"",nameDisplayMode:"",frameFitMode:"bestFit",skin:"default",class:"",height:"240px",width:"320px",minHeight:"200px",minWidth:"250px",aspectRatio:"16:9",volume:5,media:"",loader:{show:!0,style:"default",class:""}}},brand:{default:{display:!0,url:"http://www.vcloudx.com",logo:"/assets/favicon.png",show:!0,target:"_blank",title:"VCloudX Infotech"}},toolbar:{default:{skin:"default",buttons:{play:!0,resize:!0,share:!0,mic:!0,volume:!0,mute:!0,record:!0,playtime:!0,zoom:!0},position:"bottom",class:"",
displayMode:!0,autoDisplayTimeout:0}}}}},function(m,t,n){function h(a,b){var c={"Content-Type":"application/json"};b&&(c.Authentication="Bearer "+b);return{method:"POST",headers:new Headers(c),body:JSON.stringify(a)}}function l(a,b,c){var d,f,g,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(p){if(1==p.nextAddress)return d={},b=b||{},p.yield(c.authHeader(),2);if(3!=p.nextAddress)return f=p.yieldResult,b.headers=new Headers({Authorization:f}),p.yield(fetch(a,b),3);g=p.yieldResult;d.response=
g;d.ok=g.ok;e=(g.headers.get("WWW-Authenticate")||"").split(" ")[1];d.shouldRetry=401===g.status&&e!==c.nonce;c.nonce=e;return p.return(d)})}function e(a,b,c){var d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){if(1==f.nextAddress)return f.yield(l(a,b,c),2);d=f.yieldResult;return d.shouldRetry?f.return(l(a,b,c)):f.return(d)})}function b(a){return new Promise(function(b,c){try{var d=new WebSocket(a);d.addEventListener("open",function(){return b(d)},{once:!0})}catch(x){q.a.info("asyncInitWebSocket exception while creating websocket",
x),c(new u(!1))}})}function a(a,b){return new Promise(function(c,d){function f(c){a.removeEventListener("message",g);d(new u(b.cancelled))}function g(b){a.removeEventListener("close",f);try{var g=JSON.parse(b.data);if(g.error)throw q.a.error(" listenForResponse throw exception ",g.error),Error(g.error);c(g)}catch(J){q.a.error(" listenForResponse exception ",J),d(J)}}a.addEventListener("message",g,{once:!0});a.addEventListener("close",f,{once:!0})})}function c(c,g,f,e,h,u,l,w,m){var k,z,C,F,n,x,K,
N,O,t,P,I,H,J,V;return $jscomp.asyncExecutePromiseGeneratorProgram(function(G){switch(G.nextAddress){case 1:return k=0,z=Date.now(),C="https:"===window.location.protocol?"wss:":"ws:",F="file:"===window.location.protocol?D:C+"//"+v+(p?":":"")+p+"/api/ws",G.yield(b(F),2);case 2:n=G.yieldResult;G.setCatchFinallyBlocks(3,4);x=Object(d.arrayToB64)(new Uint8Array(g));K={};var y=l;y=void 0===y?{}:y;B.file_meta=y;B.trans_dt=Date.now();K=B;N={fileMetadata:x,authorization:"send-v1 "+f,bearer:u,timeLimit:e,
dlimit:h,callInfo:K};O=a(n,m);n.send(JSON.stringify(N));return G.yield(O,6);case 6:return t=G.yieldResult,P=a(n,m),I=c.getReader(),G.yield(I.read(),7);case 7:H=G.yieldResult;case 8:if(H.done){G.jumpTo(9);break}m.cancelled&&(q.a.info(" websocket upload cancelled"),n.close());if(n.readyState!==WebSocket.OPEN){G.jumpTo(9);break}J=H.value;n.send(J);w(k);k+=J.length;return G.yield(I.read(),10);case 10:H=G.yieldResult;case 11:if(!(n.bufferedAmount>2*r.a&&n.readyState===WebSocket.OPEN)||m.cancelled){G.jumpTo(8);
break}return G.yield(Object(d.delay)(),11);case 9:return n.readyState===WebSocket.OPEN&&n.send(new Uint8Array([0])),G.yield(P,14);case 14:return t.duration=Date.now()-z,G.return(t);case 4:G.enterFinallyBlock();[WebSocket.CLOSED,WebSocket.CLOSING].includes(n.readyState)||n.close();G.leaveFinallyBlock(0);break;case 3:throw V=G.enterCatchBlock(),V.size=k,V.duration=Date.now()-z,q.a.info(" websocket upload failed",V),V;}})}function g(a,b,c,d){var f,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==
e.nextAddress)return e.yield(b.authHeader(),2);f=e.yieldResult;g=new XMLHttpRequest;d.oncancel=function(){g.abort()};return e.return(new Promise(function(e,p){g.addEventListener("loadend",function(){d.oncancel=function(){};var a=g.getResponseHeader("WWW-Authenticate");a&&(b.nonce=(a||"").split(" ")[1]);if(200!==g.status)return p(Error(g.status));a=new Blob([g.response]);e(a)});g.addEventListener("progress",function(a){200===a.target.status&&c(a.loaded)});g.open("get",C+("/api/download/blob/"+a));
g.setRequestHeader("Authorization",f);g.responseType="blob";g.send();c(0)}))})}function w(a,b,c,d,e){e=void 0===e?2:e;var f,p;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return h.setCatchFinallyBlocks(2),h.yield(g(a,b,c,d),4);if(2!=h.nextAddress)return f=h.yieldResult,h.return(f);p=h.enterCatchBlock();if("401"===p.message&&0<--e)return h.return(w(a,b,c,d,e));throw p;})}t.d=function(a){return C+a};t.f=function(a){void 0!=a&&void 0!=a.url&&void 0!=a.hostName&&
void 0!=a.port&&(C=a.url,v=a.hostName,p=a.port,D="wss://"+v+":"+p+"/api/ws",a=a.callInfo,q.a.info(" file sharing service call details",a),B.userName=a.userName,B.room_id=a.room_id,B.conf_num=a.conf_num,B.call_num=a.call_num,B.service_id=a.service_id)};t.a=function(a,b){var c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(fetch(C+("/api/delete/"+a),h({owner_token:b})),2);c=d.yieldResult;return d.return(c.ok)})};t.g=function(a,b,c,d){var f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==
g.nextAddress)return g.yield(fetch(C+("/api/params/"+a),h({owner_token:b,dlimit:d.dlimit},c)),2);f=g.yieldResult;return g.return(f.ok)})};t.c=function(a,b){var c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){switch(f.nextAddress){case 1:return f.yield(fetch(C+("/api/info/"+a),h({owner_token:b})),2);case 2:c=f.yieldResult;if(!c.ok){f.jumpTo(3);break}return f.yield(c.json(),4);case 4:return d=f.yieldResult,f.return(d);case 3:throw Error(c.status);}})};t.e=function(a,b){var c,g,p;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){switch(f.nextAddress){case 1:return f.yield(e(C+("/api/metadata/"+a),{method:"GET"},b),2);case 2:c=f.yieldResult;if(!c.ok){f.jumpTo(3);break}return f.yield(c.response.json(),4);case 4:return g=f.yieldResult,f.yield(b.decryptMetadata(Object(d.b64ToArray)(g.metadata)),5);case 5:return p=f.yieldResult,f.return({size:p.size,ttl:g.ttl,iv:p.iv,name:p.name,type:p.type,manifest:p.manifest});case 3:throw Error(c.response.status);}})};t.h=function(a,
b,c){var d,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return g.yield(c.authKeyB64(),2);if(3!=g.nextAddress)return d=g.yieldResult,g.yield(fetch(C+("/api/password/"+a),h({owner_token:b,auth:d})),3);f=g.yieldResult;return g.return(f.ok)})};t.i=function(a,b,d,g,e,p,h,q){var f={cancelled:!1};return{cancel:function(){f.cancelled=!0},result:c(a,b,d,g,e,p,h,q,f)}};t.b=function(a,b,c){var d={oncancel:function(){}};return{cancel:function(){d.oncancel()},result:w(a,
b,c,d)}};var d=n(12);n.n(d);var r=n(30),q=n(0),D=null,v="",p="";D||(D="");var u=function(a,b,c){var d=Error.call(this,a?"0":"connection closed");this.message=d.message;"stack"in d&&(this.stack=d.stack);this.cancelled=a;this.duration=b;this.size=c};$jscomp.inherits(u,Error);var C="",B={}},function(m,t,n){(function(h){function l(){try{var a=new Uint8Array(1);a.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return 42===a.foo()&&"function"===typeof a.subarray&&0===a.subarray(1,1).byteLength}catch(N){return!1}}
function e(a,c){if((b.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<c)throw new RangeError("Invalid typed array length");b.TYPED_ARRAY_SUPPORT?(a=new Uint8Array(c),a.__proto__=b.prototype):(null===a&&(a=new b(c)),a.length=c);return a}function b(c,d,f){if(!(b.TYPED_ARRAY_SUPPORT||this instanceof b))return new b(c,d,f);if("number"===typeof c){if("string"===typeof d)throw Error("If encoding is specified then the first argument must be a string");return g(this,c)}return a(this,c,d,f)}function a(a,c,f,g){if("number"===
typeof c)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&c instanceof ArrayBuffer){c.byteLength;if(0>f||c.byteLength<f)throw new RangeError("'offset' is out of bounds");if(c.byteLength<f+(g||0))throw new RangeError("'length' is out of bounds");c=void 0===f&&void 0===g?new Uint8Array(c):void 0===g?new Uint8Array(c,f):new Uint8Array(c,f,g);b.TYPED_ARRAY_SUPPORT?(a=c,a.__proto__=b.prototype):a=w(a,c);return a}if("string"===typeof c){g=a;a=f;if("string"!==
typeof a||""===a)a="utf8";if(!b.isEncoding(a))throw new TypeError('"encoding" must be a valid string encoding');f=q(c,a)|0;g=e(g,f);c=g.write(c,a);c!==f&&(g=g.slice(0,c));return g}return d(a,c)}function c(a){if("number"!==typeof a)throw new TypeError('"size" argument must be a number');if(0>a)throw new RangeError('"size" argument must not be negative');}function g(a,d){c(d);a=e(a,0>d?0:r(d)|0);if(!b.TYPED_ARRAY_SUPPORT)for(var f=0;f<d;++f)a[f]=0;return a}function w(a,b){var c=0>b.length?0:r(b.length)|
0;a=e(a,c);for(var d=0;d<c;d+=1)a[d]=b[d]&255;return a}function d(a,c){if(b.isBuffer(c)){var d=r(c.length)|0;a=e(a,d);if(0===a.length)return a;c.copy(a,0,0,d);return a}if(c){if("undefined"!==typeof ArrayBuffer&&c.buffer instanceof ArrayBuffer||"length"in c)return(d="number"!==typeof c.length)||(d=c.length,d=d!==d),d?e(a,0):w(a,c);if("Buffer"===c.type&&Q(c.data))return w(a,c.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function r(a){if(a>=
(b.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(b.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return a|0}function q(a,c){if(b.isBuffer(a))return a.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(a)||a instanceof ArrayBuffer))return a.byteLength;"string"!==typeof a&&(a=""+a);var d=a.length;if(0===d)return 0;for(var f=!1;;)switch(c){case "ascii":case "latin1":case "binary":return d;
case "utf8":case "utf-8":case void 0:return H(a).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*d;case "hex":return d>>>1;case "base64":return ca.toByteArray(I(a)).length;default:if(f)return H(a).length;c=(""+c).toLowerCase();f=!0}}function m(a,b,c){var d=!1;if(void 0===b||0>b)b=0;if(b>this.length)return"";if(void 0===c||c>this.length)c=this.length;if(0>=c)return"";c>>>=0;b>>>=0;if(c<=b)return"";for(a||(a="utf8");;)switch(a){case "hex":a=b;b=c;c=this.length;if(!a||0>a)a=0;
if(!b||0>b||b>c)b=c;d="";for(c=a;c<b;++c)a=d,d=this[c],d=16>d?"0"+d.toString(16):d.toString(16),d=a+d;return d;case "utf8":case "utf-8":return C(this,b,c);case "ascii":a="";for(c=Math.min(this.length,c);b<c;++b)a+=String.fromCharCode(this[b]&127);return a;case "latin1":case "binary":a="";for(c=Math.min(this.length,c);b<c;++b)a+=String.fromCharCode(this[b]);return a;case "base64":return b=0===b&&c===this.length?ca.fromByteArray(this):ca.fromByteArray(this.slice(b,c)),b;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":b=
this.slice(b,c);c="";for(a=0;a<b.length;a+=2)c+=String.fromCharCode(b[a]+256*b[a+1]);return c;default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase();d=!0}}function v(a,b,c){var d=a[b];a[b]=a[c];a[c]=d}function p(a,c,d,f,g){if(0===a.length)return-1;"string"===typeof d?(f=d,d=0):2147483647<d?d=2147483647:-2147483648>d&&(d=-2147483648);d=+d;isNaN(d)&&(d=g?0:a.length-1);0>d&&(d=a.length+d);if(d>=a.length){if(g)return-1;d=a.length-1}else if(0>d)if(g)d=0;else return-1;"string"===
typeof c&&(c=b.from(c,f));if(b.isBuffer(c))return 0===c.length?-1:u(a,c,d,f,g);if("number"===typeof c)return c&=255,b.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?g?Uint8Array.prototype.indexOf.call(a,c,d):Uint8Array.prototype.lastIndexOf.call(a,c,d):u(a,[c],d,f,g);throw new TypeError("val must be string, number or Buffer");}function u(a,b,c,d,f){function g(a,b){return 1===e?a[b]:a.readUInt16BE(b*e)}var e=1,k=a.length,p=b.length;if(void 0!==d&&(d=String(d).toLowerCase(),"ucs2"===
d||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(2>a.length||2>b.length)return-1;e=2;k/=2;p/=2;c/=2}if(f)for(d=-1;c<k;c++)if(g(a,c)===g(b,-1===d?0:c-d)){if(-1===d&&(d=c),c-d+1===p)return d*e}else-1!==d&&(c-=c-d),d=-1;else for(c+p>k&&(c=k-p);0<=c;c--){k=!0;for(d=0;d<p;d++)if(g(a,c+d)!==g(b,d)){k=!1;break}if(k)return c}return-1}function C(a,b,c){c=Math.min(a.length,c);for(var d=[];b<c;){var f=a[b],g=null,e=239<f?4:223<f?3:191<f?2:1;if(b+e<=c)switch(e){case 1:128>f&&(g=f);break;case 2:var k=a[b+1];
128===(k&192)&&(f=(f&31)<<6|k&63,127<f&&(g=f));break;case 3:k=a[b+1];var p=a[b+2];128===(k&192)&&128===(p&192)&&(f=(f&15)<<12|(k&63)<<6|p&63,2047<f&&(55296>f||57343<f)&&(g=f));break;case 4:k=a[b+1];p=a[b+2];var h=a[b+3];128===(k&192)&&128===(p&192)&&128===(h&192)&&(f=(f&15)<<18|(k&63)<<12|(p&63)<<6|h&63,65535<f&&1114112>f&&(g=f))}null===g?(g=65533,e=1):65535<g&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|g&1023);d.push(g);b+=e}a=d.length;if(a<=Y)d=String.fromCharCode.apply(String,d);else{c="";for(b=
0;b<a;)c+=String.fromCharCode.apply(String,d.slice(b,b+=Y));d=c}return d}function B(a,b,c){if(0!==a%1||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length");}function z(a,c,d,f,g,e){if(!b.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>g||c<e)throw new RangeError('"value" argument is out of bounds');if(d+f>a.length)throw new RangeError("Index out of range");}function F(a,b,c,d){0>b&&(b=65535+b+1);for(var f=
0,g=Math.min(a.length-c,2);f<g;++f)a[c+f]=(b&255<<8*(d?f:1-f))>>>8*(d?f:1-f)}function f(a,b,c,d){0>b&&(b=4294967295+b+1);for(var f=0,g=Math.min(a.length-c,4);f<g;++f)a[c+f]=b>>>8*(d?f:3-f)&255}function O(a,b,c,d,f,g){if(c+d>a.length)throw new RangeError("Index out of range");if(0>c)throw new RangeError("Index out of range");}function x(a,b,c,d,f){f||O(a,b,c,4,3.4028234663852886E38,-3.4028234663852886E38);aa.write(a,b,c,d,23,4);return c+4}function P(a,b,c,d,f){f||O(a,b,c,8,1.7976931348623157E308,-1.7976931348623157E308);
aa.write(a,b,c,d,52,8);return c+8}function I(a){a=a.trim?a.trim():a.replace(/^\s+|\s+$/g,"");a=a.replace(R,"");if(2>a.length)return"";for(;0!==a.length%4;)a+="=";return a}function H(a,b){b=b||Infinity;for(var c,d=a.length,f=null,g=[],e=0;e<d;++e){c=a.charCodeAt(e);if(55295<c&&57344>c){if(!f){if(56319<c){-1<(b-=3)&&g.push(239,191,189);continue}else if(e+1===d){-1<(b-=3)&&g.push(239,191,189);continue}f=c;continue}if(56320>c){-1<(b-=3)&&g.push(239,191,189);f=c;continue}c=(f-55296<<10|c-56320)+65536}else f&&
-1<(b-=3)&&g.push(239,191,189);f=null;if(128>c){if(0>--b)break;g.push(c)}else if(2048>c){if(0>(b-=2))break;g.push(c>>6|192,c&63|128)}else if(65536>c){if(0>(b-=3))break;g.push(c>>12|224,c>>6&63|128,c&63|128)}else if(1114112>c){if(0>(b-=4))break;g.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw Error("Invalid code point");}return g}function J(a){for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c)&255);return b}function k(a,b,c,d){for(var f=0;f<d&&!(f+c>=b.length||f>=a.length);++f)b[f+
c]=a[f];return f}var ca=n(29),aa=n(54),Q=n(55);t.Buffer=b;t.SlowBuffer=function(a){+a!=a&&(a=0);return b.alloc(+a)};t.INSPECT_MAX_BYTES=50;b.TYPED_ARRAY_SUPPORT=void 0!==h.TYPED_ARRAY_SUPPORT?h.TYPED_ARRAY_SUPPORT:l();t.kMaxLength=b.TYPED_ARRAY_SUPPORT?2147483647:1073741823;b.poolSize=8192;b._augment=function(a){a.__proto__=b.prototype;return a};b.from=function(b,c,d){return a(null,b,c,d)};b.TYPED_ARRAY_SUPPORT&&(b.prototype.__proto__=Uint8Array.prototype,b.__proto__=Uint8Array,$jscomp.initSymbol(),
$jscomp.initSymbol(),$jscomp.initSymbol(),"undefined"!==typeof Symbol&&Symbol.species&&b[Symbol.species]===b&&($jscomp.initSymbol(),Object.defineProperty(b,Symbol.species,{value:null,configurable:!0})));b.alloc=function(a,b,d){c(a);a=0>=a?e(null,a):void 0!==b?"string"===typeof d?e(null,a).fill(b,d):e(null,a).fill(b):e(null,a);return a};b.allocUnsafe=function(a){return g(null,a)};b.allocUnsafeSlow=function(a){return g(null,a)};b.isBuffer=function(a){return!(null==a||!a._isBuffer)};b.compare=function(a,
c){if(!b.isBuffer(a)||!b.isBuffer(c))throw new TypeError("Arguments must be Buffers");if(a===c)return 0;for(var d=a.length,f=c.length,g=0,e=Math.min(d,f);g<e;++g)if(a[g]!==c[g]){d=a[g];f=c[g];break}return d<f?-1:f<d?1:0};b.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};b.concat=function(a,c){if(!Q(a))throw new TypeError('"list" argument must be an Array of Buffers');
if(0===a.length)return b.alloc(0);var d;if(void 0===c)for(d=c=0;d<a.length;++d)c+=a[d].length;c=b.allocUnsafe(c);var f=0;for(d=0;d<a.length;++d){var g=a[d];if(!b.isBuffer(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(c,f);f+=g.length}return c};b.byteLength=q;b.prototype._isBuffer=!0;b.prototype.swap16=function(){var a=this.length;if(0!==a%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<a;b+=2)v(this,b,b+1);return this};b.prototype.swap32=
function(){var a=this.length;if(0!==a%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<a;b+=4)v(this,b,b+3),v(this,b+1,b+2);return this};b.prototype.swap64=function(){var a=this.length;if(0!==a%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<a;b+=8)v(this,b,b+7),v(this,b+1,b+6),v(this,b+2,b+5),v(this,b+3,b+4);return this};b.prototype.toString=function(){var a=this.length|0;return 0===a?"":0===arguments.length?C(this,0,a):m.apply(this,
arguments)};b.prototype.equals=function(a){if(!b.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:0===b.compare(this,a)};b.prototype.inspect=function(){var a="",b=t.INSPECT_MAX_BYTES;0<this.length&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... "));return"<Buffer "+a+">"};b.prototype.compare=function(a,c,d,f,g){if(!b.isBuffer(a))throw new TypeError("Argument must be a Buffer");void 0===c&&(c=0);void 0===d&&(d=a?a.length:0);void 0===f&&
(f=0);void 0===g&&(g=this.length);if(0>c||d>a.length||0>f||g>this.length)throw new RangeError("out of range index");if(f>=g&&c>=d)return 0;if(f>=g)return-1;if(c>=d)return 1;c>>>=0;d>>>=0;f>>>=0;g>>>=0;if(this===a)return 0;var e=g-f,k=d-c,p=Math.min(e,k);f=this.slice(f,g);a=a.slice(c,d);for(c=0;c<p;++c)if(f[c]!==a[c]){e=f[c];k=a[c];break}return e<k?-1:k<e?1:0};b.prototype.includes=function(a,b,c){return-1!==this.indexOf(a,b,c)};b.prototype.indexOf=function(a,b,c){return p(this,a,b,c,!0)};b.prototype.lastIndexOf=
function(a,b,c){return p(this,a,b,c,!1)};b.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"===typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b|=0,isFinite(c)?(c|=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var f=this.length-b;if(void 0===c||c>f)c=f;if(0<a.length&&(0>c||0>b)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");
d||(d="utf8");for(f=!1;;)switch(d){case "hex":a:{b=Number(b)||0;d=this.length-b;c?(c=Number(c),c>d&&(c=d)):c=d;d=a.length;if(0!==d%2)throw new TypeError("Invalid hex string");c>d/2&&(c=d/2);for(d=0;d<c;++d){f=parseInt(a.substr(2*d,2),16);if(isNaN(f)){a=d;break a}this[b+d]=f}a=d}return a;case "utf8":case "utf-8":return k(H(a,this.length-b),this,b,c);case "ascii":return k(J(a),this,b,c);case "latin1":case "binary":return k(J(a),this,b,c);case "base64":return k(ca.toByteArray(I(a)),this,b,c);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":d=
a;f=this.length-b;for(var g=[],e=0;e<d.length&&!(0>(f-=2));++e){var p=d.charCodeAt(e);a=p>>8;p%=256;g.push(p);g.push(a)}return k(g,this,b,c);default:if(f)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase();f=!0}};b.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Y=4096;b.prototype.slice=function(a,c){var d=this.length;a=~~a;c=void 0===c?d:~~c;0>a?(a+=d,0>a&&(a=0)):a>d&&(a=d);0>c?(c+=d,0>c&&(c=0)):c>d&&(c=d);c<a&&(c=a);if(b.TYPED_ARRAY_SUPPORT)c=
this.subarray(a,c),c.__proto__=b.prototype;else{d=c-a;c=new b(d,void 0);for(var f=0;f<d;++f)c[f]=this[f+a]}return c};b.prototype.readUIntLE=function(a,b,c){a|=0;b|=0;c||B(a,b,this.length);c=this[a];for(var d=1,f=0;++f<b&&(d*=256);)c+=this[a+f]*d;return c};b.prototype.readUIntBE=function(a,b,c){a|=0;b|=0;c||B(a,b,this.length);c=this[a+--b];for(var d=1;0<b&&(d*=256);)c+=this[a+--b]*d;return c};b.prototype.readUInt8=function(a,b){b||B(a,1,this.length);return this[a]};b.prototype.readUInt16LE=function(a,
b){b||B(a,2,this.length);return this[a]|this[a+1]<<8};b.prototype.readUInt16BE=function(a,b){b||B(a,2,this.length);return this[a]<<8|this[a+1]};b.prototype.readUInt32LE=function(a,b){b||B(a,4,this.length);return(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]};b.prototype.readUInt32BE=function(a,b){b||B(a,4,this.length);return 16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])};b.prototype.readIntLE=function(a,b,c){a|=0;b|=0;c||B(a,b,this.length);c=this[a];for(var d=1,f=0;++f<b&&(d*=256);)c+=
this[a+f]*d;c>=128*d&&(c-=Math.pow(2,8*b));return c};b.prototype.readIntBE=function(a,b,c){a|=0;b|=0;c||B(a,b,this.length);c=b;for(var d=1,f=this[a+--c];0<c&&(d*=256);)f+=this[a+--c]*d;f>=128*d&&(f-=Math.pow(2,8*b));return f};b.prototype.readInt8=function(a,b){b||B(a,1,this.length);return this[a]&128?-1*(255-this[a]+1):this[a]};b.prototype.readInt16LE=function(a,b){b||B(a,2,this.length);a=this[a]|this[a+1]<<8;return a&32768?a|4294901760:a};b.prototype.readInt16BE=function(a,b){b||B(a,2,this.length);
a=this[a+1]|this[a]<<8;return a&32768?a|4294901760:a};b.prototype.readInt32LE=function(a,b){b||B(a,4,this.length);return this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24};b.prototype.readInt32BE=function(a,b){b||B(a,4,this.length);return this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]};b.prototype.readFloatLE=function(a,b){b||B(a,4,this.length);return aa.read(this,a,!0,23,4)};b.prototype.readFloatBE=function(a,b){b||B(a,4,this.length);return aa.read(this,a,!1,23,4)};b.prototype.readDoubleLE=function(a,
b){b||B(a,8,this.length);return aa.read(this,a,!0,52,8)};b.prototype.readDoubleBE=function(a,b){b||B(a,8,this.length);return aa.read(this,a,!1,52,8)};b.prototype.writeUIntLE=function(a,b,c,d){a=+a;b|=0;c|=0;d||z(this,a,b,c,Math.pow(2,8*c)-1,0);d=1;var f=0;for(this[b]=a&255;++f<c&&(d*=256);)this[b+f]=a/d&255;return b+c};b.prototype.writeUIntBE=function(a,b,c,d){a=+a;b|=0;c|=0;d||z(this,a,b,c,Math.pow(2,8*c)-1,0);d=c-1;var f=1;for(this[b+d]=a&255;0<=--d&&(f*=256);)this[b+d]=a/f&255;return b+c};b.prototype.writeUInt8=
function(a,c,d){a=+a;c|=0;d||z(this,a,c,1,255,0);b.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));this[c]=a&255;return c+1};b.prototype.writeUInt16LE=function(a,c,d){a=+a;c|=0;d||z(this,a,c,2,65535,0);b.TYPED_ARRAY_SUPPORT?(this[c]=a&255,this[c+1]=a>>>8):F(this,a,c,!0);return c+2};b.prototype.writeUInt16BE=function(a,c,d){a=+a;c|=0;d||z(this,a,c,2,65535,0);b.TYPED_ARRAY_SUPPORT?(this[c]=a>>>8,this[c+1]=a&255):F(this,a,c,!1);return c+2};b.prototype.writeUInt32LE=function(a,c,d){a=+a;c|=0;d||z(this,a,c,4,4294967295,
0);b.TYPED_ARRAY_SUPPORT?(this[c+3]=a>>>24,this[c+2]=a>>>16,this[c+1]=a>>>8,this[c]=a&255):f(this,a,c,!0);return c+4};b.prototype.writeUInt32BE=function(a,c,d){a=+a;c|=0;d||z(this,a,c,4,4294967295,0);b.TYPED_ARRAY_SUPPORT?(this[c]=a>>>24,this[c+1]=a>>>16,this[c+2]=a>>>8,this[c+3]=a&255):f(this,a,c,!1);return c+4};b.prototype.writeIntLE=function(a,b,c,d){a=+a;b|=0;d||(d=Math.pow(2,8*c-1),z(this,a,b,c,d-1,-d));d=0;var f=1,g=0;for(this[b]=a&255;++d<c&&(f*=256);)0>a&&0===g&&0!==this[b+d-1]&&(g=1),this[b+
d]=(a/f>>0)-g&255;return b+c};b.prototype.writeIntBE=function(a,b,c,d){a=+a;b|=0;d||(d=Math.pow(2,8*c-1),z(this,a,b,c,d-1,-d));d=c-1;var f=1,g=0;for(this[b+d]=a&255;0<=--d&&(f*=256);)0>a&&0===g&&0!==this[b+d+1]&&(g=1),this[b+d]=(a/f>>0)-g&255;return b+c};b.prototype.writeInt8=function(a,c,d){a=+a;c|=0;d||z(this,a,c,1,127,-128);b.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));0>a&&(a=255+a+1);this[c]=a&255;return c+1};b.prototype.writeInt16LE=function(a,c,d){a=+a;c|=0;d||z(this,a,c,2,32767,-32768);b.TYPED_ARRAY_SUPPORT?
(this[c]=a&255,this[c+1]=a>>>8):F(this,a,c,!0);return c+2};b.prototype.writeInt16BE=function(a,c,d){a=+a;c|=0;d||z(this,a,c,2,32767,-32768);b.TYPED_ARRAY_SUPPORT?(this[c]=a>>>8,this[c+1]=a&255):F(this,a,c,!1);return c+2};b.prototype.writeInt32LE=function(a,c,d){a=+a;c|=0;d||z(this,a,c,4,2147483647,-2147483648);b.TYPED_ARRAY_SUPPORT?(this[c]=a&255,this[c+1]=a>>>8,this[c+2]=a>>>16,this[c+3]=a>>>24):f(this,a,c,!0);return c+4};b.prototype.writeInt32BE=function(a,c,d){a=+a;c|=0;d||z(this,a,c,4,2147483647,
-2147483648);0>a&&(a=4294967295+a+1);b.TYPED_ARRAY_SUPPORT?(this[c]=a>>>24,this[c+1]=a>>>16,this[c+2]=a>>>8,this[c+3]=a&255):f(this,a,c,!1);return c+4};b.prototype.writeFloatLE=function(a,b,c){return x(this,a,b,!0,c)};b.prototype.writeFloatBE=function(a,b,c){return x(this,a,b,!1,c)};b.prototype.writeDoubleLE=function(a,b,c){return P(this,a,b,!0,c)};b.prototype.writeDoubleBE=function(a,b,c){return P(this,a,b,!1,c)};b.prototype.copy=function(a,c,d,f){d||(d=0);f||0===f||(f=this.length);c>=a.length&&
(c=a.length);c||(c=0);0<f&&f<d&&(f=d);if(f===d||0===a.length||0===this.length)return 0;if(0>c)throw new RangeError("targetStart out of bounds");if(0>d||d>=this.length)throw new RangeError("sourceStart out of bounds");if(0>f)throw new RangeError("sourceEnd out of bounds");f>this.length&&(f=this.length);a.length-c<f-d&&(f=a.length-c+d);var g=f-d;if(this===a&&d<c&&c<f)for(f=g-1;0<=f;--f)a[f+c]=this[f+d];else if(1E3>g||!b.TYPED_ARRAY_SUPPORT)for(f=0;f<g;++f)a[f+c]=this[f+d];else Uint8Array.prototype.set.call(a,
this.subarray(d,d+g),c);return g};b.prototype.fill=function(a,c,d,f){if("string"===typeof a){"string"===typeof c?(f=c,c=0,d=this.length):"string"===typeof d&&(f=d,d=this.length);if(1===a.length){var g=a.charCodeAt(0);256>g&&(a=g)}if(void 0!==f&&"string"!==typeof f)throw new TypeError("encoding must be a string");if("string"===typeof f&&!b.isEncoding(f))throw new TypeError("Unknown encoding: "+f);}else"number"===typeof a&&(a&=255);if(0>c||this.length<c||this.length<d)throw new RangeError("Out of range index");
if(d<=c)return this;c>>>=0;d=void 0===d?this.length:d>>>0;a||(a=0);if("number"===typeof a)for(f=c;f<d;++f)this[f]=a;else for(a=b.isBuffer(a)?a:H((new b(a,f)).toString()),g=a.length,f=0;f<d-c;++f)this[f+c]=a[f%g];return this};var R=/[^+\/0-9A-Za-z-_]/g}).call(t,n(31))},function(m,t,n){function h(b,a){this.test=a;this.statsGatheringRunning=!1;this.pc1=new RTCPeerConnection(b);this.pc2=new RTCPeerConnection(b);this.pc1.addEventListener("icecandidate",this.onIceCandidate_.bind(this,this.pc2));this.pc2.addEventListener("icecandidate",
this.onIceCandidate_.bind(this,this.pc1));this.iceCandidateFilter_=h.noFilter}var l=n(13),e=n(1);h.prototype={establishConnection:function(){this.pc1.createOffer().then(this.gotOffer_.bind(this),this.test.reportFatal.bind(this.test))},close:function(){this.pc1.close();this.pc2.close()},setIceCandidateFilter:function(b){this.iceCandidateFilter_=b},constrainVideoBitrate:function(b){this.constrainVideoBitrateKbps_=b},disableVideoFec:function(){this.constrainOfferToRemoveVideoFec_=!0},gatherStats:function(b,
a,c,g){function e(){"closed"===b.signalingState?(u.statsGatheringRunning=!1,g(q,v,m,p)):(b.getStats().then(h).catch(function(a){u.test.reportError("Could not gather stats: "+a);u.statsGatheringRunning=!1;g(q,v)}),a&&a.getStats().then(d))}function d(a){"chrome"===adapter.browserDetails.browser?(a=l.enumerateStats(a,u.localTrackIds,u.remoteTrackIds),m.push(a),p.push(Date.now())):"firefox"===adapter.browserDetails.browser?(a=l.enumerateStatsFirefox(a),m.push(a),p.push(Date.now())):u.test.reportError("Only Firefox and Chrome getStats implementations are supported.")}
function h(a){"chrome"===adapter.browserDetails.browser?(a=l.enumerateStats(a,u.localTrackIds,u.remoteTrackIds),q.push(a),v.push(Date.now())):"firefox"===adapter.browserDetails.browser?(a=l.enumerateStatsFirefox(a),q.push(a),v.push(Date.now())):u.test.reportError("Only Firefox and Chrome getStats implementations are supported.");setTimeout(e,100)}var q=[],m=[],v=[],p=[],u=this;u.localTrackIds={audio:"",video:""};u.remoteTrackIds={audio:"",video:""};b.getSenders().forEach(function(a){"audio"===a.track.kind?
u.localTrackIds.audio=a.track.id:"video"===a.track.kind&&(u.localTrackIds.video=a.track.id)});a&&a.getReceivers().forEach(function(a){"audio"===a.track.kind?u.remoteTrackIds.audio=a.track.id:"video"===a.track.kind&&(u.remoteTrackIds.video=a.track.id)});this.statsGatheringRunning=!0;e()},gotOffer_:function(b){this.constrainOfferToRemoveVideoFec_&&(b.sdp=b.sdp.replace(/(m=video 1 [^\r]+)(116 117)(\r\n)/g,"$1\r\n"),b.sdp=b.sdp.replace(/a=rtpmap:116 red\/90000\r\n/g,""),b.sdp=b.sdp.replace(/a=rtpmap:117 ulpfec\/90000\r\n/g,
""),b.sdp=b.sdp.replace(/a=rtpmap:98 rtx\/90000\r\n/g,""),b.sdp=b.sdp.replace(/a=fmtp:98 apt=116\r\n/g,""));this.pc1.setLocalDescription(b);this.pc2.setRemoteDescription(b);this.pc2.createAnswer().then(this.gotAnswer_.bind(this),this.test.reportFatal.bind(this.test))},gotAnswer_:function(b){this.constrainVideoBitrateKbps_&&(b.sdp=b.sdp.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+this.constrainVideoBitrateKbps_+"\r\n"));this.pc2.setLocalDescription(b);this.pc1.setRemoteDescription(b)},onIceCandidate_:function(b,
a){if(a.candidate){var c=h.parseCandidate(a.candidate.candidate);this.iceCandidateFilter_(c)&&b.addIceCandidate(a.candidate)}}};h.noFilter=function(){return!0};h.isRelay=function(b){return"relay"===b.type};h.isNotHostCandidate=function(b){return"host"!==b.type};h.isReflexive=function(b){return"srflx"===b.type};h.isHost=function(b){return"host"===b.type};h.isIpv6=function(b){return void 0!==b.address&&-1!==b.address.indexOf(":")};h.parseCandidate=function(b){var a=b.indexOf("candidate:")+10;b=b.substr(a).split(" ");
return{type:b[7],protocol:b[2],address:b[4]}};h.cachedIceServers_=null;h.cachedIceConfigFetchTime_=null;h.asyncCreateTurnConfig=function(b,a,c){a=e.ice_servers[c];""!==a.turnURI&&setTimeout(b.bind(null,{iceServers:[{username:a.turnUsername,credential:a.turnCredential,urls:a.turnURI}]}),0)};h.asyncCreateStunConfig=function(b,a,c){a=e.ice_servers[c];""!==a.stunURI&&setTimeout(b.bind(null,{iceServers:[{urls:a.stunURI}]}),0)};m.exports=h},function(m,t,n){m=function(){for(var h,l,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),
b=[],a=0;a<e.length;a+=1)b[e[a]]=a;var c=function(){if(!h||l>=h.length)return-1;var a=h.charCodeAt(l)&255;l+=1;return a},g=function(){if(!h)return-1;for(;;){if(l>=h.length)return-1;var a=h.charAt(l);l+=1;if(b[a])return b[a];if("A"===a)return 0}},w=function(a){a=a.toString(16);1===a.length&&(a="0"+a);return unescape("%"+a)};return{encodeBase64:function(a){var b;h=a;l=0;a="";var d=Array(3);var g=0;for(b=!1;!b&&-1!==(d[0]=c());)d[1]=c(),d[2]=c(),a+=e[d[0]>>2],-1!==d[1]?(a+=e[d[0]<<4&48|d[1]>>4],-1!==
d[2]?(a+=e[d[1]<<2&60|d[2]>>6],a+=e[d[2]&63]):(a+=e[d[1]<<2&60],a+="=",b=!0)):(a+=e[d[0]<<4&48],a+="=",a+="=",b=!0),g+=4,76<=g&&(a+="\n",g=0);return a},decodeBase64:function(a){var b;h=a;l=0;a="";var c=Array(4);for(b=!1;!b&&-1!==(c[0]=g())&&-1!==(c[1]=g());)c[2]=g(),c[3]=g(),a+=w(c[0]<<2&255|c[1]>>4),-1!==c[2]?(a+=w(c[1]<<4&255|c[2]>>2),-1!==c[3]?a+=w(c[2]<<6&255|c[3]):b=!0):b=!0;return a}}}();t.a=m},function(m,t,n){t.c=function(e,b,a){try{return e.pipeThrough(new TransformStream(b))}catch(g){var c=
e.getReader();return new ReadableStream({start:function(a){if(b.start)return b.start(a)},pull:function(a){var d,g,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){switch(h.nextAddress){case 1:d=!1,g={enqueue:function(b){d=!0;a.enqueue(b)}};case 2:if(d){h.jumpTo(0);break}return h.yield(c.read(),4);case 4:e=h.yieldResult;if(!e.done){h.jumpTo(5);break}if(!b.flush){h.jumpTo(6);break}return h.yield(b.flush(a),6);case 6:return h.return(a.close());case 5:return h.yield(b.transform(e.value,
g),2)}})},cancel:function(b){e.cancel(b);a&&a(b)}})}};t.a=function(e,b){return new ReadableStream(new h(e,b))};t.b=function(e){return new ReadableStream(new l(e))};var h=function(e,b){this.blob=e;this.index=0;this.chunkSize=b||65536};h.prototype.pull=function(e){var b=this;return new Promise(function(a,c){var g=b.blob.size-b.index;if(0>=g)return e.close(),a();g=Math.min(b.chunkSize,g);var h=b.blob.slice(b.index,b.index+g),d=new FileReader;d.onload=function(){e.enqueue(new Uint8Array(d.result));a()};
d.onerror=c;d.readAsArrayBuffer(h);b.index+=g})};var l=function(e){this.streams=e;this.index=0;this.reader=null;this.nextReader()};l.prototype.nextReader=function(){var e=this.streams[this.index++];this.reader=e&&e.getReader()};l.prototype.pull=function(e){var b=this,a;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return b.reader?c.yield(b.reader.read(),2):c.return(e.close());a=c.yieldResult;if(a.done)return b.nextReader(),c.return(b.pull(e));e.enqueue(a.value);
c.jumpToEnd()})}},function(m,t){function n(h,l){if(!h)throw Error(l||"AssertionError");}n.notEqual=function(h,l,e){n(h!=l,e)};n.notOk=function(h,l){n(!h,l)};n.equal=function(h,l,e){n(h==l,e)};n.ok=n;m.exports=n},function(m,t,n){var h=n(12);n.n(h);var l=n(30),e=new TextEncoder,b=new TextDecoder;m=function(a,b){this._nonce=b||"yRCdyQ1EMSA3mo4rqSkuNQ==";this.rawSecret=a?Object(h.b64ToArray)(a):crypto.getRandomValues(new Uint8Array(16));this.secretKeyPromise=crypto.subtle.importKey("raw",this.rawSecret,
"HKDF",!1,["deriveKey"]);this.metaKeyPromise=this.secretKeyPromise.then(function(a){return crypto.subtle.deriveKey({name:"HKDF",salt:new Uint8Array,info:e.encode("metadata"),hash:"SHA-256"},a,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"])});this.authKeyPromise=this.secretKeyPromise.then(function(a){return crypto.subtle.deriveKey({name:"HKDF",salt:new Uint8Array,info:e.encode("authentication"),hash:"SHA-256"},a,{name:"HMAC",hash:{name:"SHA-256"}},!0,["sign"])})};m.prototype.setPassword=function(a,
b){this.authKeyPromise=crypto.subtle.importKey("raw",e.encode(a),{name:"PBKDF2"},!1,["deriveKey"]).then(function(a){return crypto.subtle.deriveKey({name:"PBKDF2",salt:e.encode(b),iterations:100,hash:"SHA-256"},a,{name:"HMAC",hash:"SHA-256"},!0,["sign"])})};m.prototype.setAuthKey=function(a){this.authKeyPromise=crypto.subtle.importKey("raw",Object(h.b64ToArray)(a),{name:"HMAC",hash:"SHA-256"},!0,["sign"])};m.prototype.authKeyB64=function(){var a=this,b,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==
c.nextAddress)return c.yield(a.authKeyPromise,2);if(3!=c.nextAddress)return b=c.yieldResult,c.yield(crypto.subtle.exportKey("raw",b),3);g=c.yieldResult;return c.return(Object(h.arrayToB64)(new Uint8Array(g)))})};m.prototype.authHeader=function(){var a=this,b,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return c.yield(a.authKeyPromise,2);if(3!=c.nextAddress)return b=c.yieldResult,c.yield(crypto.subtle.sign({name:"HMAC"},b,Object(h.b64ToArray)(a.nonce)),3);g=
c.yieldResult;return c.return("send-v1 "+Object(h.arrayToB64)(new Uint8Array(g)))})};m.prototype.encryptMetadata=function(a){var b=this,g,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return c.yield(b.metaKeyPromise,2);if(3!=c.nextAddress)return g=c.yieldResult,c.yield(crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(12),tagLength:128},g,e.encode(JSON.stringify({name:a.name,size:a.size,type:a.type||"application/octet-stream",manifest:a.manifest||{},roomMeta:a.roomMeta||
{}}))),3);h=c.yieldResult;return c.return(h)})};m.prototype.encryptStream=function(a){return Object(l.c)(a,this.rawSecret)};m.prototype.decryptStream=function(a){return Object(l.b)(a,this.rawSecret)};m.prototype.decryptMetadata=function(a){var c=this,g,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(c.metaKeyPromise,2);if(3!=d.nextAddress)return g=d.yieldResult,d.yield(crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(12),tagLength:128},g,
a),3);e=d.yieldResult;return d.return(JSON.parse(b.decode(e)))})};$jscomp.global.Object.defineProperties(m.prototype,{nonce:{configurable:!0,enumerable:!0,get:function(){return this._nonce},set:function(a){a&&a!==this._nonce&&(this._nonce=a)}}});t.a=m},function(m,t){function n(){throw Error("setTimeout has not been defined");}function h(){throw Error("clearTimeout has not been defined");}function l(a){if(w===setTimeout)return setTimeout(a,0);if((w===n||!w)&&setTimeout)return w=setTimeout,setTimeout(a,
0);try{return w(a,0)}catch(u){try{return w.call(null,a,0)}catch(C){return w.call(this,a,0)}}}function e(a){if(d===clearTimeout)return clearTimeout(a);if((d===h||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(a);try{return d(a)}catch(u){try{return d.call(null,a)}catch(C){return d.call(this,a)}}}function b(){q&&D&&(q=!1,D.length?r=D.concat(r):v=-1,r.length&&a())}function a(){if(!q){var a=l(b);q=!0;for(var c=r.length;c;){D=r;for(r=[];++v<c;)D&&D[v].run();v=-1;c=r.length}D=null;q=!1;e(a)}}function c(a,
b){this.fun=a;this.array=b}function g(){}m=m.exports={};try{var w="function"===typeof setTimeout?setTimeout:n}catch(p){w=n}try{var d="function"===typeof clearTimeout?clearTimeout:h}catch(p){d=h}var r=[],q=!1,D,v=-1;m.nextTick=function(b){var d=Array(arguments.length-1);if(1<arguments.length)for(var g=1;g<arguments.length;g++)d[g-1]=arguments[g];r.push(new c(b,d));1!==r.length||q||l(a)};c.prototype.run=function(){this.fun.apply(null,this.array)};m.title="browser";m.browser=!0;m.env={};m.argv=[];m.version=
"";m.versions={};m.on=g;m.addListener=g;m.once=g;m.off=g;m.removeListener=g;m.removeAllListeners=g;m.emit=g;m.prependListener=g;m.prependOnceListener=g;m.listeners=function(a){return[]};m.binding=function(a){throw Error("process.binding is not supported");};m.cwd=function(){return"/"};m.chdir=function(a){throw Error("process.chdir is not supported");};m.umask=function(){return 0}},function(m,t,n){var h=n(25),l=n(0),e=n(7),b=n(5);n(8);n(9);m=n(1);var a=n.n(m);t.a=function(c){function g(){return document.getElementById("WebrtcEverywherePluginId")}
function w(a,b,c){a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())if(d=d.value,d.media.toLowerCase()===b.toLowerCase()){d=$jscomp.makeIterator(d.codecs);for(var f=d.next();!f.done;f=d.next())if(f=f.value,f.name.toLowerCase()===c.toLowerCase())return f}}var d={},r;d.remoteDesc=void 0;l.a.info("Starting Base stack",c);d.pcConfig={iceServers:[]};d.con={};void 0!==c.iceServers&&(d.pcConfig.iceServers=c.iceServers);!0===c.forceTurn&&(d.pcConfig.iceTransportPolicy="relay");void 0===c.audio&&
(c.audio=!0);void 0===c.video&&(c.video=!0);c.remoteCandidates=[];c.localCandidates=[];c.remoteDescriptionSet=!1;d.mediaConstraints={offerToReceiveVideo:void 0!==c.video&&!1!==c.video,offerToReceiveAudio:void 0!==c.audio&&!1!==c.audio};var q=function(a){return g().createSessionDescription(a)},m=function(a,b){return g().createPeerConnection(a,b)};"IE"===e.a.browserEngineCheck()?d.peerConnection=m(d.pcConfig,d.con):d.peerConnection=new RTCPeerConnection(d.pcConfig,d.con);var v=function(a){r=a;r.sdp=
r.sdp.replace("a=sendrecv","a=sendonly");C(!1,a)},p=function(a){r=a;C(!0,a)},u=function(a,b,c){l.a.error("message:",c,"in baseStack at",a);void 0!==b&&b("error")},C=function(a,b){r=b;a||(r.sdp=d.enableSimulcast(r.sdp));a||"safari"!==e.a.browserEngineCheck()||(r.sdp=r.sdp.replace("a=sendrecv","a=sendonly"));r.sdp=h.a.setMaxBW(r.sdp,c);c.callback({type:r.type,sdp:r.sdp})},B=function(a,c){var d={};d.sdp=a.sdp;d.type=a.type;if(c===b.a.constant.H264_CODEC)c=w(a.media,"video","vp8"),a=w(a.media,"video",
"h264");else if(c===b.a.constant.default)c=w(a.media,"video","h264"),a=w(a.media,"video","vp8"),void 0!=c&&(d.sdp=d.sdp.replace("a=fmtp:"+c.payload+" level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f\r\n",""));else return d;void 0!=c&&(d.sdp=d.sdp.replace("a=rtpmap:"+c.payload+" "+c.name+"/90000\r\n",""),d.sdp=d.sdp.replace("m=video 1 UDP/TLS/RTP/SAVPF "+a.payload+" "+c.payload+"\r\n","m=video 1 UDP/TLS/RTP/SAVPF "+a.payload+"\r\n"),d.sdp=d.sdp.replace("m=video 1 UDP/TLS/RTP/SAVPF "+
c.payload+" "+a.payload+"\r\n","m=video 1 UDP/TLS/RTP/SAVPF "+a.payload+"\r\n"),d.sdp=d.sdp.replace("a=rtcp-fb:"+c.payload+" ccm fir\r\n",""),d.sdp=d.sdp.replace("a=rtcp-fb:"+c.payload+" nack\r\n",""),d.sdp=d.sdp.replace("a=rtcp-fb:"+c.payload+" nack pli\r\n",""),d.sdp=d.sdp.replace("a=rtcp-fb:"+c.payload+" goog-remb\r\n",""));return d};d.resetSDP=function(a){var b=B(d.remoteDesc,a);d.peerConnection.createOffer({offerToReceiveVideo:!0,offerToReceiveAudio:!0,iceRestart:!1}).then(function(a){l.a.info("OFFER: - \n"+
a.sdp);l.a.info("RECVD ANSWER B4: - \n"+d.remoteDesc.sdp);d.peerConnection.setLocalDescription(a).then(function(){l.a.info("ANSWER: - \n"+b.sdp);d.peerConnection.setRemoteDescription(new RTCSessionDescription(b))}).catch(u.bind(null,"processAnswer",void 0))}).catch(function(a){l.a.info(a)})};var z=function(f,g){var p=f;l.a.info("Set remote and local description");l.a.debug("Remote Description",p.sdp);l.a.debug("Local Description",r.sdp);p.sdp=h.a.setMaxBW(p.sdp,c);d.remoteDesc=JSON.parse(JSON.stringify(p));
if("IE"===e.a.browserEngineCheck()){d.peerConnection.setLocalDescription(r);l.a.info("Remote msg details for sdp:- "+JSON.stringify(p));d.peerConnection.setRemoteDescription(q(p));c.remoteDescriptionSet=!0;for(l.a.info("Candidates to be added: ",c.remoteCandidates.length,c.remoteCandidates);0<c.remoteCandidates.length;)d.peerConnection.addIceCandidate(c.remoteCandidates.shift());for(l.a.info("Local candidates to send:",c.localCandidates.length);0<c.localCandidates.length&&!d.peerConnection;)c.callback({type:"candidate",
candidate:c.localCandidates.shift()})}else l.a.debug("Remote Description",d.remoteDesc.sdp),d.peerConnection.setLocalDescription(r).then(function(){p="safari"===a.a.browser_info.name&&a.a.browser_info.version>=b.a.constant.SAFARI_VERSION_SUPPORTING_VP8&&g!==b.a.constant.H264_CODEC?B(p,b.a.constant.default):"safari"===a.a.browser_info.name&&a.a.browser_info.version<=b.a.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8&&g!==b.a.constant.H264_CODEC?B(p,b.a.constant.H264_CODEC):B(p,b.a.constant.default);l.a.debug("Remote Description",
d.remoteDesc.sdp);d.peerConnection.setRemoteDescription(new RTCSessionDescription(p)).then(function(){c.remoteDescriptionSet=!0;l.a.info("Candidates to be added: ",c.remoteCandidates.length,c.remoteCandidates);for(var a={};0<c.remoteCandidates.length;)a.$jscomp$loop$prop$cand$245=c.remoteCandidates.shift(),d.peerConnection.addIceCandidate(a.$jscomp$loop$prop$cand$245).then(function(a){return function(){l.a.info("process answer adding remote ice cand Success: "+JSON.stringify(a.$jscomp$loop$prop$cand$245))}}(a)).catch(function(a){return function(b){l.a.error("process answer Failed addIceCandidate(): "+
b+" cand: "+JSON.stringify(a.$jscomp$loop$prop$cand$245))}}(a)),a={$jscomp$loop$prop$cand$245:a.$jscomp$loop$prop$cand$245};for(l.a.info("Local candidates to send:",c.localCandidates.length);0<c.localCandidates.length;)c.callback({type:"candidate",candidate:c.localCandidates.shift()})}).catch(u.bind(null,"processAnswer",void 0))}).catch(u.bind(null,"processAnswer",void 0))},F=function(a){try{var b="object"===typeof a.candidate?a.candidate:JSON.parse(a.candidate);if("end"===b.candidate)console.log("end candidates: ignore");
else{b.candidate=b.candidate.replace(/a=/g,"");b.sdpMLineIndex=parseInt(b.sdpMLineIndex,10);b.sdpMid="audio"==b.sdpMid?0:1;var f=new RTCIceCandidate(b);c.remoteDescriptionSet?d.peerConnection.addIceCandidate(f).then(function(){l.a.info("IN adding remote ice candidate Success: "+JSON.stringify(b))}).catch(function(a){l.a.error("addIceCandidate() Failed err: "+a+" cand: "+JSON.stringify(b))}):(l.a.debug("queuing candidates since remote description not set: "+JSON.stringify(b)),c.remoteCandidates.push(f))}}catch(P){l.a.error("Error parsing candidate error: "+
P+" cand:"+a.candidate)}};d.peerConnection.onicecandidate=function(a){(a=a.candidate)?a={sdpMLineIndex:a.sdpMLineIndex,sdpMid:a.sdpMid,candidate:"a="+a.candidate}:(l.a.info("Gathered all candidates. Sending END candidate"),a={sdpMLineIndex:-1,sdpMid:"end",candidate:"end"});c.remoteDescriptionSet?c.callback({type:"candidate",candidate:a}):(c.localCandidates.push(a),l.a.info("Storing candidate: ",c.localCandidates.length,a))};d.peerConnection.onaddstream=function(a){if(d.onaddstream)d.onaddstream(a)};
d.peerConnection.onremovestream=function(a){if(d.onremovestream)d.onremovestream(a)};d.peerConnection.oniceconnectionstatechange=function(a){d.oniceconnectionstatechange&&(l.a.info("ICE connection state changed",a.currentTarget.iceConnectionState),l.a.info("ICE gathering state changed",a.currentTarget.iceGatheringState),d.oniceconnectionstatechange(a.currentTarget.iceConnectionState))};d.peerConnection.onconnectionstatechange=function(a){d.onconnectionstatechange&&(l.a.info("Peer connection state changed",
d.peerConnection.connectionState),d.onconnectionstatechange(d.peerConnection.connectionState))};d.enableSimulcast=function(a){l.a.error("Simulcast not implemented");return a};d.updateSimulcastLayersBitrate=function(a){d.simulcast&&(d.simulcast.spatialLayerBitrates=a,d.setSimulcastLayersBitrate())};d.setSimulcastLayersBitrate=function(){l.a.error("Simulcast not implemented")};d.setSimulcast=function(a){d.simulcast=a};d.close=function(){d.state="closed";d.peerConnection.close()};d.updateSpec=function(a,
b){b=void 0===b?function(){}:b;if(a.maxVideoBW||a.maxAudioBW)a.maxVideoBW&&(l.a.debug("Maxvideo Requested:",a.maxVideoBW,"limit:",c.limitMaxVideoBW),a.maxVideoBW>c.limitMaxVideoBW&&(a.maxVideoBW=c.limitMaxVideoBW),c.maxVideoBW=a.maxVideoBW,l.a.debug("Result",c.maxVideoBW)),a.maxAudioBW&&(a.maxAudioBW>c.limitMaxAudioBW&&(a.maxAudioBW=c.limitMaxAudioBW),c.maxAudioBW=a.maxAudioBW),r.sdp=h.a.setMaxBW(r.sdp,c),a.Sdp||a.maxAudioBW?(l.a.debug("Updating with SDP renegotiation",c.maxVideoBW,c.maxAudioBW),
d.peerConnection.setLocalDescription(r).then(function(){d.remoteDesc.sdp=h.a.setMaxBW(d.remoteDesc.sdp,c);return d.peerConnection.setRemoteDescription(new RTCSessionDescription(d.remoteDesc))}).then(function(){c.remoteDescriptionSet=!0;c.callback({type:"updatestream",sdp:r.sdp})}).catch(u.bind(null,"updateSpec",b))):(l.a.debug("Updating without SDP renegotiation, newVideoBW:",c.maxVideoBW,"newAudioBW:",c.maxAudioBW),c.callback({type:"updatestream",sdp:r.sdp}));if(a.minVideoBW||void 0!==a.slideShowMode||
void 0!==a.muteStream||void 0!==a.qualityLayer||void 0!==a.video)l.a.debug("MinVideo Changed to ",a.minVideoBW),l.a.debug("SlideShowMode Changed to ",a.slideShowMode),l.a.debug("muteStream changed to ",a.muteStream),l.a.debug("Video Constraints",a.video),c.callback({type:"updatestream",config:a})};d.createOffer=function(a,b){!0!==a&&(d.mediaConstraints={offerToReceiveVideo:!1,offerToReceiveAudio:!1});b&&(d.mediaConstraints.iceRestart=b);l.a.debug("Creating offer :-"+JSON.stringify(d.mediaConstraints));
"IE"===e.a.browserEngineCheck()?!0!==a?d.peerConnection.createOffer(v,u):d.peerConnection.createOffer(p,u,{optional:[{OfferToReceiveAudio:!0},{OfferToReceiveVideo:!0}]}):d.peerConnection.createOffer(d.mediaConstraints).then(C.bind(null,a)).catch(u.bind(null,"Create Offer",void 0))};d.addStream=function(a){d.peerConnection.addStream(a)};d.addTrack=function(a){d.peerConnection.addTrack(a)};d.processSignalingMessage=function(a,b){"answer"===a.type?z(a,b):"candidate"===a.type&&F(a)};return d}},function(m,
t,n){t.a={addSim:function(h){var l="a=ssrc-group:SIM";h.forEach(function(e){l+=" "+e});return l+"\r\n"},addGroup:function(h,l){return"a=ssrc-group:FID "+h+" "+l+"\r\n"},addSpatialLayer:function(h,l,e,b,a,c){return"a=ssrc:"+a+" cname:"+h+"\r\na=ssrc:"+(a+" msid:"+l+"\r\na=ssrc:")+(a+" mslabel:"+e+"\r\na=ssrc:")+(a+" label:"+b+"\r\na=ssrc:")+(c+" cname:"+h+"\r\na=ssrc:")+(c+" msid:"+l+"\r\na=ssrc:")+(c+" mslabel:"+e+"\r\na=ssrc:")+(c+" label:"+b+"\r\n")},setMaxBW:function(h,l){var e=h;if(l.video&&l.maxVideoBW){e=
e.replace(/b=AS:.*\r\n/g,"");var b=e.match(/m=video.*\r\n/);null==b&&(b=e.match(/m=video.*\n/));b&&0<b.length&&(h=b[0]+"b=AS:"+l.maxVideoBW+"\r\n",e=e.replace(b[0],h))}l.audio&&l.maxAudioBW&&(b=e.match(/m=audio.*\r\n/),null==b&&(b=e.match(/m=audio.*\n/)),b&&0<b.length&&(h=b[0]+"b=AS:"+l.maxAudioBW+"\r\n",e=e.replace(b[0],h)));return e},enableOpusNacks:function(h){var l=h.match(/a=rtpmap:(.*)opus.*\r\n/);null!==l&&(h=h.replace(l[0],l[0]+"a=rtcp-fb:"+l[1]+"nack\r\n"));return h}}},function(m,t,n){var h=
n(6);t.a=function(l){return"OverconstrainedError"===l.name&&"deviceId"===l.constraint?h.a.error_1142:"OverconstrainedError"!=l.name&&"ConstraintNotSatisfiedError"!=l.name||"width"!==l.constraint?"OverconstrainedError"!=l.name&&"ConstraintNotSatisfiedError"!=l.name||"height"!==l.constraint?"OverconstrainedError"!=l.name&&"ConstraintNotSatisfiedError"!=l.name||l.constraint?"NotFoundError"==l.name||"DevicesNotFoundError"==l.name?h.a.error_1143:"NotReadableError"==l.name||"TrackStartError"==l.name?h.a.error_1145:
"NotAllowedError"==l.name||"PermissionDeniedError"==l.name?h.a.error_1144:"TypeError"==l.name||"TypeError"==l.name?h.a.error_1146:h.a.error_1150:h.a.error_1149:h.a.error_1148:h.a.error_1147}},function(m,t,n){var h=n(2),l=n(15),e=n(3),b=n(28);m=n(1);var a=n.n(m);t.a=function(c){var g=Object(h.a)({}),w=Object(l.a)().player.default;if(e.a.checkParam(c.options)&&e.a.checkParam(c.options.player)){var d=c.options.player;e.a.checkParam(d.autoplay)&&(w.autoplay=d.autoplay);e.a.checkParam(d.name)&&(w.name=
d.name);e.a.checkParam(d.nameDisplayMode)&&(w.nameDisplayMode=d.nameDisplayMode);e.a.checkParam(d.frameFitMode)&&(w.frameFitMode=d.frameFitMode);e.a.checkParam(d.skin)&&(w.skin=d.skin);e.a.checkParam(d.class)&&(w.class=d.class);e.a.checkParam(d.height)&&(w.height=d.height);e.a.checkParam(d.width)&&(w.width=d.width);e.a.checkParam(d.minHeight)&&(w.minHeight=d.minHeight);e.a.checkParam(d.minWidth)&&(w.minWidth=d.minWidth);e.a.checkParam(d.aspectRatio)&&(w.aspectRatio=d.aspectRatio);e.a.checkParam(d.volume)&&
(w.volume=d.volume);e.a.checkParam(d.backgroundImg)&&(w.backgroundImg=d.backgroundImg);e.a.checkParam(d.media)&&(w.media=d.media);e.a.checkParam(d.loader)&&(d=d.loader,e.a.checkParam(d.url)&&(w.loader.url=d.url),w.loader.show=d.show,e.a.checkParam(d.class)&&(w.loader.class=d.class),e.a.checkParam(d.style)&&(w.loader.style=d.style))}g.id=c.id;g.stream=c.stream.stream;g.elementID=c.elementID;g.abwd={};g.abwd.notification=!0;g.abwd.lang="en";e.a.checkParam(c.options)&&e.a.checkParam(c.options.player)&&
e.a.checkParam(c.options.player.abwd)&&(d=c.options.player.abwd,!1===d.enabled?g.abwd.notification=!1:!0===d.enabled&&"sdk"===d.notification?(g.abwd.notification=!0,g.abwd.lang="en"===d.language||"zh"===d.language?d.language:"en"):!0===d.enabled&&"app"===d.notification&&(g.abwd.notification=!1,g.abwd.lang=""));d=e.a.getById(c.elementID);d.style.height=w.height;d.style.width=w.width;d.style.minHeight=w.minHeight;d.style.minWidth=w.minWidth;var r=function(a,b,c,d){(d?1/a*b>c:1/a*b<c)?(g.video.style.width=
b+"px",g.video.style.height=1/a*b+"px",g.video.style.top=-(1/a*b/2-c/2)+"px",g.video.style.left="0px"):(g.video.style.height=c+"px",g.video.style.width=a*c+"px",g.video.style.left=-(a*c/2-b/2)+"px",g.video.style.top="0px")};g.destroy=function(){console.log("video player destroy requested");g.video.pause();if(a.a.csp_enabled)g.parentNode.removeChild(g.div);else{delete g.resizer;try{g.parentNode.removeChild(q),g.parentNode.removeChild(p)}catch(z){console.log("error videoplayer.destroy() removeChild err: "+
z)}}};g.resize=function(){var a=g.container.offsetWidth,b=g.container.offsetHeight;c.stream.screen||!1===c.options.crop||c.stream.canvas?r(16/9,a,b,!1):(a!==g.containerWidth||b!==g.containerHeight)&&r(4/3,a,b,!0);g.containerWidth=a;g.containerHeight=b};d=c.stream.getPlayerId(c.vroom?c.vroom:c.stream.room);g.div=Object(e.a)({name:"div",id:""+d.player,class:"vcx_player "+w.skin+"_vcx_player"});w.loader.url&&(g.loader=Object(e.a)({name:"img",src:w.loader.url,id:"back_"+g.id,class:"vcx_player_loader "+
w.loader.class+" "+w.skin+"_vcx_player_loader"}),w.loader.show||(g.loader.style.display="none"));w.backgroundImg&&(g.screenSaver=Object(e.a)({name:"img",src:w.backgroundImg,id:"screen_saver_"+g.id,class:"vcx_player_screen_saver "+w.skin+"_vcx_player_screen_saver"}),g.screenSaver.style.display="none");w={name:"video",id:""+d.stream,class:"vcx_stream "+w.skin+"_vcx_stream"};c.extraPlayerOptions.autoplay&&(w.autoplay=c.extraPlayerOptions.autoplay);c.extraPlayerOptions.playsinline&&(w.playsinline=c.extraPlayerOptions.playsinline);
g.video=Object(e.a)(w);c.stream.local&&(g.video.volume=0);g.container=void 0!==g.elementID?"object"===typeof g.elementID&&"function"===typeof g.elementID.appendChild?g.elementID:e.a.getById(g.elementID):document.body;g.container.appendChild(g.div);g.parentNode=g.div.parentNode;var q=void 0,m=void 0,v=void 0,p=void 0,u=void 0,C=void 0,B=void 0;a.a.csp_enabled||(m=document.createElement("div"),m.setAttribute("id","stats-container-"+g.id),m.setAttribute("class","stats-container"),m.setAttribute("style",
"display:none;"),q=document.createElement("div"),q.setAttribute("id","bw-notif-"+g.id),q.setAttribute("class","bw-notification"),q.setAttribute("style","display:none;position:absolute;z-index:3;padding:5px 10px;top:50%;right:50%;transform:translateX(50%);background:rgba(0,0,0,0.29);border-radius:5px;color:rgb(255,255,255)"),v=document.createElement("div"),v.setAttribute("id","stats-button-"+g.id),v.setAttribute("class","stats-button"),v.setAttribute("title","Click to see stats"),v.innerHTML=window.statsIcon,
m.appendChild(v),p=document.createElement("div"),p.setAttribute("class","stats-overlay"),p.setAttribute("id","stats-overlay-"+g.id),p.setAttribute("style","display: none;\n            position: absolute;z-index: 3;\n            padding: 5px;top: 0px;right: 0px;\n            background: linear-gradient(90deg,rgb(204 41 42 / 62%),#a20a90b0);\n            border-radius: 5px;color: #fff;width: 100%;"),u=document.createElement("div"),u.setAttribute("class","stats-overlay-inner"),u.setAttribute("id","stats-overlay-inner-"+
g.id),C=document.createElement("div"),B=document.createElement("div"),C.setAttribute("class","stats-left-partition"),C.setAttribute("id","stats-left-part-"+g.id),B.setAttribute("class","stats-right-partition"),B.setAttribute("id","stats-right-part-"+g.id),v.addEventListener("click",function(){p.style.display="none"===p.style.display?"block":"none"}),g.div.parentNode.style.position="relative",g.div.parentNode.appendChild(m),g.div.parentNode.appendChild(p),p.appendChild(u),g.div.parentNode.appendChild(q),
u.appendChild(C),u.appendChild(B));g.loader&&g.div.appendChild(g.loader);g.screenSaver&&g.div.appendChild(g.screenSaver);g.div.appendChild(g.video);g.containerWidth=0;g.containerHeight=0;!a.a.csp_enabled&&c.options&&!1!==c.options.resizer&&(g.resizer=L.ResizeSensor(g.container,g.resize),g.resize());!1===c.options.bar&&(g.media=g.video);g.video.srcObject=g.stream;g.ShowSessionStats=function(b){a.a.csp_enabled||(!0===b?(m.setAttribute("style","display:block;"),p.setAttribute("style","display:block;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);")):
(m.setAttribute("style","display:none;"),p.setAttribute("style","display:none;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);")))};g.streamUpdated=function(a){a!=g.id&&(g.id=a,g.video&&(a=c.stream.getPlayerId(c.vroom?c.vroom:c.stream.room),g.div.setAttribute("id",""+a.player),g.video.setAttribute("id",""+a.stream),void 0!=g.loader&&g.loader.setAttribute("id","back_"+g.id),void 0!=g.screenSaver&&g.screenSaver.setAttribute("id","screen_saver_"+g.id),void 0!=
m&&m.setAttribute("id","stats-container-"+g.id),void 0!=q&&q.setAttribute("id","bw-notif-"+g.id),void 0!=v&&v.setAttribute("id","bw-notif-"+g.id),void 0!=p&&p.setAttribute("id","stats-overlay-"+g.id),void 0!=u&&u.setAttribute("id","stats-overlay-inner-"+g.id),void 0!=C&&C.setAttribute("id","stats-left-part-"+g.id),void 0!=B&&B.setAttribute("id","stats-right-part-"+g.id)))};g.setBwAlert=function(c,d,f){!1===g.abwd.notification||a.a.csp_enabled||(!0===c?(q.innerText="subscriber"===d?b.a.abwd[g.abwd.lang].bw_alert_subscriber:
f+b.a.abwd[g.abwd.lang].bw_alert_publisher,q.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px 10px;top:50%;right:50%;transform:translateX(50%);background:rgba(0,0,0,0.29);border-radius:5px;color:rgb(255,255,255)")):q.setAttribute("style","display:none;position:absolute;z-index:3;padding:5px 10px;top:50%;right:50%;transform:translateX(50%);background:rgba(0,0,0,0.29);border-radius:5px;color:rgb(255,255,255)"))};g.setVideoMutedMsg=function(c){!1===g.abwd.notification||a.a.csp_enabled||
(!0===c.videomuted&&"bw"===c.reason?(q.innerText=c.name+" "+b.a.abwd[g.abwd.lang].video_muted,q.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px 10px;top:50%;right:50%;transform:translateX(50%);background:rgba(0,0,0,0.29);border-radius:5px;color:rgb(255,255,255)")):q.setAttribute("style","display:none;position:absolute;z-index:3;padding:5px 10px;top:50%;right:50%;transform:translateX(50%);background:rgba(0,0,0,0.29);border-radius:5px;color:rgb(255,255,255)"))};return g}},
function(m,t,n){t.a={abwd:{en:{bw_alert_publisher:" Low upload bandwidth",bw_alert_subscriber:" Low Download bandwidth",video_muted:" Video muted due to low bandwidth"},zh:{bw_alert_publisher:" \u7f51\u7edc\u4e0d\u597d",bw_alert_subscriber:"\u4f60\u7684\u4e0b\u8f7d\u5e26\u5bbd\u5f88\u4f4e",video_muted:" \u60a8\u7684\u89c6\u9891\u56e0\u5e26\u5bbd\u800c\u9759\u97f3"}}}},function(m,t,n){function h(a){var b=a.length;if(0<b%4)throw Error("Invalid string. Length must be a multiple of 4");a=a.indexOf("=");
-1===a&&(a=b);return[a,a===b?0:4-a%4]}function l(a,b,h){for(var c=[],g=b;g<h;g+=3)b=(a[g]<<16&16711680)+(a[g+1]<<8&65280)+(a[g+2]&255),c.push(e[b>>18&63]+e[b>>12&63]+e[b>>6&63]+e[b&63]);return c.join("")}t.byteLength=function(a){a=h(a);var b=a[1];return 3*(a[0]+b)/4-b};t.toByteArray=function(c){var g=h(c);var e=g[0];g=g[1];for(var d=new a(3*(e+g)/4-g),r=0,q=0<g?e-4:e,l=0;l<q;l+=4)e=b[c.charCodeAt(l)]<<18|b[c.charCodeAt(l+1)]<<12|b[c.charCodeAt(l+2)]<<6|b[c.charCodeAt(l+3)],d[r++]=e>>16&255,d[r++]=
e>>8&255,d[r++]=e&255;2===g&&(e=b[c.charCodeAt(l)]<<2|b[c.charCodeAt(l+1)]>>4,d[r++]=e&255);1===g&&(e=b[c.charCodeAt(l)]<<10|b[c.charCodeAt(l+1)]<<4|b[c.charCodeAt(l+2)]>>2,d[r++]=e>>8&255,d[r++]=e&255);return d};t.fromByteArray=function(a){for(var b=a.length,c=b%3,d=[],h=0,q=b-c;h<q;h+=16383)d.push(l(a,h,h+16383>q?q:h+16383));1===c?(a=a[b-1],d.push(e[a>>2]+e[a<<4&63]+"==")):2===c&&(a=(a[b-2]<<8)+a[b-1],d.push(e[a>>10]+e[a>>4&63]+e[a<<2&63]+"="));return d.join("")};var e=[],b=[],a="undefined"!==typeof Uint8Array?
Uint8Array:Array;for(m=0;64>m;++m)e[m]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(m)]=m;b[45]=62;b[95]=63},function(m,t,n){(function(h){t.c=function(b,h,d,r){d=void 0===d?65536:d;void 0===r&&(r=new Uint8Array(16),crypto.getRandomValues(r),r=r.buffer);b=Object(e.c)(b,new c(d,"encrypt"));return Object(e.c)(b,new a("encrypt",h,d,r))};t.b=function(b,h,d){d=void 0===d?65536:d;b=Object(e.c)(b,new c(d,
"decrypt"));return Object(e.c)(b,new a("decrypt",h,d))};var l=n(17);n.n(l);var e=n(20);t.a=65536;var b=new TextEncoder,a=function(a,b,c,e){this.mode=a;this.prevChunk;this.seq=0;this.firstchunk=!0;this.rs=c;this.ikm=b.buffer;this.salt=e};a.prototype.generateKey=function(){var a=this,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(crypto.subtle.importKey("raw",a.ikm,"HKDF",!1,["deriveKey"]),2);c=d.yieldResult;return d.return(crypto.subtle.deriveKey({name:"HKDF",
salt:a.salt,info:b.encode("Content-Encoding: aes128gcm\x00"),hash:"SHA-256"},c,{name:"AES-GCM",length:128},!0,["encrypt","decrypt"]))})};a.prototype.generateNonceBase=function(){var a=this,c,d,e,q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return g.yield(crypto.subtle.importKey("raw",a.ikm,"HKDF",!1,["deriveKey"]),2);case 2:return c=g.yieldResult,d=crypto.subtle,e=d.exportKey,g.yield(crypto.subtle.deriveKey({name:"HKDF",salt:a.salt,info:b.encode("Content-Encoding: nonce\x00"),
hash:"SHA-256"},c,{name:"AES-GCM",length:128},!0,["encrypt","decrypt"]),4);case 4:return g.yield(e.call(d,"raw",g.yieldResult),3);case 3:return q=g.yieldResult,g.return(h.from(q.slice(0,12)))}})};a.prototype.generateNonce=function(a){if(4294967295<a)throw Error("record sequence number exceeds limit");var b=h.from(this.nonceBase),c=b.readUIntBE(b.length-4,4);b.writeUIntBE((c^a)>>>0,b.length-4,4);return b};a.prototype.pad=function(a,b){var c=a.length;if(c+16>=this.rs)throw Error("data too large for record size");
if(b)return b=h.alloc(1),b.writeUInt8(2,0),h.concat([a,b]);b=h.alloc(this.rs-c-16);b.fill(0);b.writeUInt8(1,0);return h.concat([a,b])};a.prototype.unpad=function(a,b){for(var c=a.length-1;0<=c;c--)if(a[c]){if(b){if(2!==a[c])throw Error("delimiter of final record is not 2");}else if(1!==a[c])throw Error("delimiter of not final record is not 1");return a.slice(0,c)}throw Error("no delimiter found");};a.prototype.createHeader=function(){var a=h.alloc(5);a.writeUIntBE(this.rs,0,4);a.writeUIntBE(0,4,1);
return h.concat([h.from(this.salt),a])};a.prototype.readHeader=function(a){if(21>a.length)throw Error("chunk too small for reading header");var b={};b.salt=a.buffer.slice(0,16);b.rs=a.readUIntBE(16,4);a=a.readUInt8(20);b.length=a+16+5;return b};a.prototype.encryptRecord=function(a,b,c){var d=this,g,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){if(1==q.nextAddress)return g=d.generateNonce(b),q.yield(crypto.subtle.encrypt({name:"AES-GCM",iv:g},d.key,d.pad(a,c)),2);e=q.yieldResult;
return q.return(h.from(e))})};a.prototype.decryptRecord=function(a,b,c){var d=this,g,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(q){if(1==q.nextAddress)return g=d.generateNonce(b),q.yield(crypto.subtle.decrypt({name:"AES-GCM",iv:g,tagLength:128},d.key,a),2);e=q.yieldResult;return q.return(d.unpad(h.from(e),c))})};a.prototype.start=function(a){var b=this,c,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress){if("encrypt"!==b.mode){if("decrypt"!==b.mode)throw Error("mode must be either encrypt or decrypt");
return d.jumpTo(0)}c=b;return d.yield(b.generateKey(),3)}if(4!=d.nextAddress)return c.key=d.yieldResult,g=b,d.yield(b.generateNonceBase(),4);g.nonceBase=d.yieldResult;a.enqueue(b.createHeader());d.jumpToEnd()})};a.prototype.transformPrevChunk=function(a,b){var c=this,g,e,h,l,p,u,w;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){switch(d.nextAddress){case 1:if("encrypt"===c.mode)return u=b,w=u.enqueue,d.yield(c.encryptRecord(c.prevChunk,c.seq,a),9);if(0===c.seq)return h=c.readHeader(c.prevChunk),
c.salt=h.salt,c.rs=h.rs,l=c,d.yield(c.generateKey(),7);g=b;e=g.enqueue;return d.yield(c.decryptRecord(c.prevChunk,c.seq-1,a),6);case 6:e.call(g,d.yieldResult);d.jumpTo(5);break;case 7:return l.key=d.yieldResult,p=c,d.yield(c.generateNonceBase(),8);case 8:p.nonceBase=d.yieldResult;case 5:c.seq++;d.jumpTo(0);break;case 9:w.call(u,d.yieldResult),c.seq++,d.jumpToEnd()}})};a.prototype.transform=function(a,b){var c=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return c.firstchunk?
d.jumpTo(2):d.yield(c.transformPrevChunk(!1,b),2);c.firstchunk=!1;c.prevChunk=h.from(a.buffer);d.jumpToEnd()})};a.prototype.flush=function(a){var b=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){return b.prevChunk?c.yield(b.transformPrevChunk(!0,a),0):c.jumpTo(0)})};var c=function(a,b){this.mode=b;this.rs=a;this.chunkSize="encrypt"===b?a-17:21;this.partialChunk=new Uint8Array(this.chunkSize);this.offset=0};c.prototype.send=function(a,b){b.enqueue(a);21===this.chunkSize&&"decrypt"===
this.mode&&(this.chunkSize=this.rs);this.partialChunk=new Uint8Array(this.chunkSize);this.offset=0};c.prototype.transform=function(a,b){var c=0;if(0<this.offset){var g=Math.min(a.byteLength,this.chunkSize-this.offset);this.partialChunk.set(a.slice(0,g),this.offset);this.offset+=g;c+=g;this.offset===this.chunkSize&&this.send(this.partialChunk,b)}for(;c<a.byteLength;)g=a.byteLength-c,g>=this.chunkSize?(g=a.slice(c,c+this.chunkSize),c+=this.chunkSize,this.send(g,b)):(g=a.slice(c,c+g),c+=g.byteLength,
this.partialChunk.set(g),this.offset=g.byteLength)};c.prototype.flush=function(a){0<this.offset&&a.enqueue(this.partialChunk.slice(0,this.offset))}}).call(t,n(17).Buffer)},function(m,t){t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(n){"object"===typeof window&&(t=window)}m.exports=t},function(m,t,n){function h(a){if(!(this instanceof h))return new h(a);this._name=a||"nanobus";this._starListeners=[];this._listeners={}}var l=n(57),e=n(58),b=n(21);m.exports=h;
h.prototype.emit=function(a){b.ok("string"===typeof a||"symbol"===typeof a,"nanobus.emit: eventName should be type string or symbol");for(var c=[],g=1,h=arguments.length;g<h;g++)c.push(arguments[g]);g=e(this._name+"('"+a.toString()+"')");(h=this._listeners[a])&&0<h.length&&this._emit(this._listeners[a],c);0<this._starListeners.length&&this._emit(this._starListeners,a,c,g.uuid);g();return this};h.prototype.on=h.prototype.addListener=function(a,c){b.ok("string"===typeof a||"symbol"===typeof a,"nanobus.on: eventName should be type string or symbol");
b.equal(typeof c,"function","nanobus.on: listener should be type function");"*"===a?this._starListeners.push(c):(this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].push(c));return this};h.prototype.prependListener=function(a,c){b.ok("string"===typeof a||"symbol"===typeof a,"nanobus.prependListener: eventName should be type string or symbol");b.equal(typeof c,"function","nanobus.prependListener: listener should be type function");"*"===a?this._starListeners.unshift(c):(this._listeners[a]||
(this._listeners[a]=[]),this._listeners[a].unshift(c));return this};h.prototype.once=function(a,c){function g(){c.apply(e,arguments);e.removeListener(a,g)}b.ok("string"===typeof a||"symbol"===typeof a,"nanobus.once: eventName should be type string or symbol");b.equal(typeof c,"function","nanobus.once: listener should be type function");var e=this;this.on(a,g);return this};h.prototype.prependOnceListener=function(a,c){function g(){c.apply(e,arguments);e.removeListener(a,g)}b.ok("string"===typeof a||
"symbol"===typeof a,"nanobus.prependOnceListener: eventName should be type string or symbol");b.equal(typeof c,"function","nanobus.prependOnceListener: listener should be type function");var e=this;this.prependListener(a,g);return this};h.prototype.removeListener=function(a,c){function g(a,b){if(a&&(b=a.indexOf(b),-1!==b))return l(a,b,1),!0}b.ok("string"===typeof a||"symbol"===typeof a,"nanobus.removeListener: eventName should be type string or symbol");b.equal(typeof c,"function","nanobus.removeListener: listener should be type function");
if("*"===a)return this._starListeners=this._starListeners.slice(),g(this._starListeners,c);"undefined"!==typeof this._listeners[a]&&(this._listeners[a]=this._listeners[a].slice());return g(this._listeners[a],c)};h.prototype.removeAllListeners=function(a){a?"*"===a?this._starListeners=[]:this._listeners[a]=[]:(this._starListeners=[],this._listeners={});return this};h.prototype.listeners=function(a){a="*"!==a?this._listeners[a]:this._starListeners;var b=[];if(a)for(var g=a.length,e=0;e<g;e++)b.push(a[e]);
return b};h.prototype._emit=function(a,b,g,e){if("undefined"!==typeof a&&0!==a.length)for(void 0===g&&(g=b,b=null),b&&(g=void 0!==e?[b].concat(g,e):[b].concat(g)),b=a.length,e=0;e<b;e++){var c=a[e];c.apply(c,g)}}},function(m,t,n){Object.defineProperty(t,"__esModule",{value:!0});m=n(0);var h=n(11),l=n(4),e=n(14),b=n(15),a=n(27),c=n(68),g=n(1);g=n.n(g);var w=n(69),d=n(78),r=n(79);r=n.n(r);n(80);g.a.csp_enabled||n(82);n={Logger:m.a,clientDiagnostics:w.a.clientDiagnostics,clientBitrate:w.a.clientBitrate,
appData:d.a,audience:r.a,EnxRoom:h.a.bind(null,void 0,void 0),Event:l.b,RoomEvent:l.e,StreamEvent:l.f,EnxStream:e.a.bind(null,void 0),VideoPlayer:a.a,ViewProperties:b.a,isSupported:g.a.is_supported,version:g.a.product.version,getDevices:c.a.getDevice,switchMediaDevice:c.a.switchMediaDevice,notifyDeviceUpdate:c.a.notifyDeviceUpdate,joinRoom:c.a.joinRoom,listParticipants:c.a.listParticipants,getRoom:c.a.getRoom};t["default"]=n},function(m,t,n){!function(h,l){m.exports=l()}(this,function(){var h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,
l=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,e=function(a,b,c){var d=String(a);return!d||d.length>=b?a:""+Array(b+1-d.length).join(c)+a},b={s:e,z:function(a){a=-a.utcOffset();var b=Math.abs(a),c=b%60;return(0>=a?"+":"-")+e(Math.floor(b/60),2,"0")+":"+e(c,2,"0")},m:function u(a,b){if(a.date()<b.date())return-u(b,a);var c=12*(b.year()-a.year())+(b.month()-a.month()),d=a.clone().add(c,"month"),g=0>b-d;a=a.clone().add(c+(g?-1:1),"month");return+(-(c+(b-d)/(g?
d-a:a-d))||0)},a:function(a){return 0>a?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:"month",y:"year",w:"week",d:"day",D:"date",h:"hour",m:"minute",s:"second",ms:"millisecond",Q:"quarter"}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return void 0===a}},a="en",c={};c[a]={name:"en",weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),months:"January February March April May June July August September October November December".split(" ")};var g=
function(a){return a instanceof r},w=function B(b,d,g){var e;if(!b)return a;if("string"==typeof b){var p=b.toLowerCase();c[p]&&(e=p);d&&(c[p]=d,e=p);b=b.split("-");if(!e&&1<b.length)return B(b[0])}else e=b.name,c[e]=b;return!g&&e&&(a=e),e||!g&&a},d=function(a,b){if(g(a))return a.clone();var c="object"==typeof b?b:{};return c.date=a,c.args=arguments,new r(c)};b.l=w;b.i=g;b.w=function(a,b){return d(a,{locale:b.$L,utc:b.$u,x:b.$x,$offset:b.$offset})};var r=function(){function a(a){this.$L=w(a.locale,
null,!0);this.parse(a)}var g=a.prototype;return g.parse=function(a){this.$d=function(a){var c=a.date;a=a.utc;if(null===c)return new Date(NaN);if(b.u(c))return new Date;if(c instanceof Date)return new Date(c);if("string"==typeof c&&!/Z$/i.test(c)){var d=c.match(h);if(d){c=d[2]-1||0;var f=(d[7]||"0").substring(0,3);return a?new Date(Date.UTC(d[1],c,d[3]||1,d[4]||0,d[5]||0,d[6]||0,f)):new Date(d[1],c,d[3]||1,d[4]||0,d[5]||0,d[6]||0,f)}}return new Date(c)}(a);this.$x=a.x||{};this.init()},g.init=function(){var a=
this.$d;this.$y=a.getFullYear();this.$M=a.getMonth();this.$D=a.getDate();this.$W=a.getDay();this.$H=a.getHours();this.$m=a.getMinutes();this.$s=a.getSeconds();this.$ms=a.getMilliseconds()},g.$utils=function(){return b},g.isValid=function(){return"Invalid Date"!==this.$d.toString()},g.isSame=function(a,b){a=d(a);return this.startOf(b)<=a&&a<=this.endOf(b)},g.isAfter=function(a,b){return d(a)<this.startOf(b)},g.isBefore=function(a,b){return this.endOf(b)<d(a)},g.$g=function(a,c,d){return b.u(a)?this[c]:
this.set(d,a)},g.unix=function(){return Math.floor(this.valueOf()/1E3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(a,c){var d=this,g=!!b.u(c)||c,f=b.p(a);a=function(a,c){a=b.w(d.$u?Date.UTC(d.$y,c,a):new Date(d.$y,c,a),d);return g?a:a.endOf("day")};var e=function(a,c){return b.w(d.toDate()[a].apply(d.toDate("s"),(g?[0,0,0,0]:[23,59,59,999]).slice(c)),d)},p=this.$W;c=this.$M;var h=this.$D,q="set"+(this.$u?"UTC":"");switch(f){case "year":return g?a(1,0):a(31,11);case "month":return g?
a(1,c):a(0,c+1);case "week":return f=this.$locale().weekStart||0,p=(p<f?p+7:p)-f,a(g?h-p:h+(6-p),c);case "day":case "date":return e(q+"Hours",0);case "hour":return e(q+"Minutes",1);case "minute":return e(q+"Seconds",2);case "second":return e(q+"Milliseconds",3);default:return this.clone()}},g.endOf=function(a){return this.startOf(a,!1)},g.$set=function(a,c){var d;a=b.p(a);var g="set"+(this.$u?"UTC":"");g=(d={},d.day=g+"Date",d.date=g+"Date",d.month=g+"Month",d.year=g+"FullYear",d.hour=g+"Hours",d.minute=
g+"Minutes",d.second=g+"Seconds",d.millisecond=g+"Milliseconds",d)[a];c="day"===a?this.$D+(c-this.$W):c;"month"===a||"year"===a?(d=this.clone().set("date",1),d.$d[g](c),d.init(),this.$d=d.set("date",Math.min(this.$D,d.daysInMonth())).$d):g&&this.$d[g](c);return this.init(),this},g.set=function(a,b){return this.clone().$set(a,b)},g.get=function(a){return this[b.p(a)]()},g.add=function(a,c){var g,e=this;a=Number(a);c=b.p(c);var f=function(c){var f=d(e);return b.w(f.date(f.date()+Math.round(c*a)),e)};
if("month"===c)return this.set("month",this.$M+a);if("year"===c)return this.set("year",this.$y+a);if("day"===c)return f(1);if("week"===c)return f(7);c=(g={},g.minute=6E4,g.hour=36E5,g.second=1E3,g)[c]||1;g=this.$d.getTime()+a*c;return b.w(g,this)},g.subtract=function(a,b){return this.add(-1*a,b)},g.format=function(a){var c=this,d=this.$locale();if(!this.isValid())return d.invalidDate||"Invalid Date";var g=a||"YYYY-MM-DDTHH:mm:ssZ",f=b.z(this);a=this.$H;var e=this.$m,p=this.$M,h=d.weekdays,q=d.months,
u=function(a,b,d,f){return a&&(a[b]||a(c,g))||d[b].slice(0,f)},r=d.meridiem||function(a,b,c){a=12>a?"AM":"PM";return c?a.toLowerCase():a},k={YY:String(this.$y).slice(-2),YYYY:this.$y,M:p+1,MM:b.s(p+1,2,"0"),MMM:u(d.monthsShort,p,q,3),MMMM:u(q,p),D:this.$D,DD:b.s(this.$D,2,"0"),d:String(this.$W),dd:u(d.weekdaysMin,this.$W,h,2),ddd:u(d.weekdaysShort,this.$W,h,3),dddd:h[this.$W],H:String(a),HH:b.s(a,2,"0"),h:b.s(a%12||12,1,"0"),hh:b.s(a%12||12,2,"0"),a:r(a,e,!0),A:r(a,e,!1),m:String(e),mm:b.s(e,2,"0"),
s:String(this.$s),ss:b.s(this.$s,2,"0"),SSS:b.s(this.$ms,3,"0"),Z:f};return g.replace(l,function(a,b){return b||k[a]||f.replace(":","")})},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(a,c,g){var e;c=b.p(c);var f=d(a);a=6E4*(f.utcOffset()-this.utcOffset());var p=this-f;f=b.m(this,f);return f=(e={},e.year=f/12,e.month=f,e.quarter=f/3,e.week=(p-a)/6048E5,e.day=(p-a)/864E5,e.hour=p/36E5,e.minute=p/6E4,e.second=p/1E3,e)[c]||p,g?f:b.a(f)},g.daysInMonth=function(){return this.endOf("month").$D},
g.$locale=function(){return c[this.$L]},g.locale=function(a,b){if(!a)return this.$L;var c=this.clone();a=w(a,b,!0);return a&&(c.$L=a),c},g.clone=function(){return b.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},a}(),q=r.prototype;return d.prototype=q,[["$ms","millisecond"],["$s","second"],["$m","minute"],
["$H","hour"],["$W","day"],["$M","month"],["$y","year"],["$D","date"]].forEach(function(a){q[a[1]]=function(b){return this.$g(b,a[0],a[1])}}),d.extend=function(a,b){return a.$i||(a(b,r,d),a.$i=!0),d},d.locale=w,d.isDayjs=g,d.unix=function(a){return d(1E3*a)},d.en=c[a],d.Ls=c,d.p={},d})},function(m,t,n){(function(h){function l(a,b){for(var c=0,d=a.length-1;0<=d;d--){var g=a[d];"."===g?a.splice(d,1):".."===g?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function e(a,
b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var b=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;t.resolve=function(){for(var a="",b=!1,w=arguments.length-1;-1<=w&&!b;w--){var d=0<=w?arguments[w]:h.cwd();if("string"!==typeof d)throw new TypeError("Arguments to path.resolve must be strings");d&&(a=d+"/"+a,b="/"===d.charAt(0))}a=l(e(a.split("/"),function(a){return!!a}),!b).join("/");return(b?"/":"")+a||"."};t.normalize=function(b){var c=
t.isAbsolute(b),h="/"===a(b,-1);(b=l(e(b.split("/"),function(a){return!!a}),!c).join("/"))||c||(b=".");b&&h&&(b+="/");return(c?"/":"")+b};t.isAbsolute=function(a){return"/"===a.charAt(0)};t.join=function(){var a=Array.prototype.slice.call(arguments,0);return t.normalize(e(a,function(a,b){if("string"!==typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))};t.relative=function(a,b){function c(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;0<=c&&
""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=t.resolve(a).substr(1);b=t.resolve(b).substr(1);a=c(a.split("/"));b=c(b.split("/"));for(var d=Math.min(a.length,b.length),g=d,e=0;e<d;e++)if(a[e]!==b[e]){g=e;break}d=[];for(e=g;e<a.length;e++)d.push("..");d=d.concat(b.slice(g));return d.join("/")};t.sep="/";t.delimiter=":";t.dirname=function(a){var c=b.exec(a).slice(1);a=c[0];c=c[1];if(!a&&!c)return".";c&&(c=c.substr(0,c.length-1));return a+c};t.basename=function(a,g){a=b.exec(a).slice(1)[2];g&&a.substr(-1*
g.length)===g&&(a=a.substr(0,a.length-g.length));return a};t.extname=function(a){return b.exec(a).slice(1)[3]};var a="b"==="ab".substr(-1)?function(a,b,e){return a.substr(b,e)}:function(a,b,e){0>b&&(b=a.length+b);return a.substr(b,e)}}).call(t,n(23))},function(m,t){m.exports=function(m){if(!m.webpackPolyfill){var h=Object.create(m);h.children||(h.children=[]);Object.defineProperty(h,"loaded",{enumerable:!0,get:function(){return h.l}});Object.defineProperty(h,"id",{enumerable:!0,get:function(){return h.i}});
Object.defineProperty(h,"exports",{enumerable:!0});h.webpackPolyfill=1}return h}},function(m,t,n){var h=n(24),l=n(25),e=n(0);t.a=function(b){e.a.info("Starting Chrome stable stack",b);var a=Object(h.a)(b);a.enableSimulcast=function(c){var g=c;if(!b.video||!b.simulcast)return g;a.simulcast=b.simulcast;c=g.match(/a=ssrc-group:FID ([0-9]*) ([0-9]*)\r?\n/);if(!c||0>=c.length)return g;var d=b.simulcast.numSpatialLayers||2;var e=parseInt(c[1],10),h=parseInt(c[2],10),m=g.match(new RegExp("a=ssrc:"+c[1]+
" cname:(.*)\r?\n"))[1],v=g.match(new RegExp("a=ssrc:"+c[1]+" msid:(.*)\r?\n"))[1],p=g.match(new RegExp("a=ssrc:"+c[1]+" mslabel:(.*)\r?\n"))[1],u=g.match(new RegExp("a=ssrc:"+c[1]+" label:(.*)\r?\n"))[1];g.match(new RegExp("a=ssrc:"+c[1]+".*\r?\n","g")).forEach(function(a){g=g.replace(a,"")});g.match(new RegExp("a=ssrc:"+c[2]+".*\r?\n","g")).forEach(function(a){g=g.replace(a,"")});for(var C=[e],n=[h],z=1;z<d;z+=1)C.push(e+1E3*z),n.push(h+1E3*z);d=l.a.addSim(C);for(z=0;z<C.length;z+=1)e=C[z],h=n[z],
d+=l.a.addGroup(e,h);for(z=0;z<C.length;z+=1)e=C[z],h=n[z],d+=l.a.addSpatialLayer(m,v,p,u,e,h);return g.replace(c[0],d+"a=x-google-flag:conference\r\n")};var c=function(b){if("function"!==typeof b.getParameters||"function"!==typeof b.setParameters)e.a.warning("Cannot set simulcast layers bitrate: getParameters or setParameters is not available");else{var c=b.getParameters();Object.keys(a.simulcast.spatialLayerBitrates).forEach(function(b){void 0!==c.encodings[b]&&(e.a.error("Setting bitrate for layer "+
b+", bps: "+a.simulcast.spatialLayerBitrates[b]),c.encodings[b].maxBitrate=a.simulcast.spatialLayerBitrates[b],console.log("setting bitrate for layer "+b+" bitratebps: "+JSON.stringify(a.simulcast.spatialLayerBitrates[b])))});b.setParameters(c).then(function(a){e.a.info("Success setting simulcast layer bitrates",a)}).catch(function(a){e.a.warning("Error setting simulcast layer bitrates",a)})}};a.setSimulcastLayersBitrate=function(){a.simulcast&&a.simulcast.spatialLayerBitrates&&a.peerConnection.getSenders().forEach(function(a){"video"===
a.track.kind&&c(a)})};a.setStartVideoBW=function(c){a.video&&b.startVideoBW&&(e.a.debug("startVideoBW requested: "+b.startVideoBW),l.a.setParamForCodecs(c,"video","x-google-start-bitrate",b.startVideoBW))};a.setHardMinVideoBW=function(c){a.video&&b.hardMinVideoBW&&(e.a.debug("hardMinVideoBW requested: "+b.hardMinVideoBW),l.a.setParamForCodecs(c,"video","x-google-min-bitrate",b.hardMinVideoBW))};return a}},function(m,t,n){var h=n(0),l=n(24);t.a=function(e){h.a.info("Starting Firefox stack");var b=
Object(l.a)(e);b.enableSimulcast=function(a){if(!e.video||!e.simulcast)return a;b.peerConnection.getSenders().forEach(function(a){"video"===a.track.kind&&(a.getParameters(),a.setParameters({encodings:[{rid:"spam",active:!0,priority:"high",maxBitrate:4E4,maxHeight:640,maxWidth:480},{rid:"egg",active:!0,priority:"medium",maxBitrate:1E4,maxHeight:320,maxWidth:240}]}))});return a};return b}},function(m,t,n){var h=n(0);t.a=function(l){var e={pcConfig:{},peerConnection:{},desc:{},signalCallback:void 0,
close:function(){h.a.info("Close FcStack")},createOffer:function(){h.a.debug("FCSTACK: CreateOffer")},addStream:function(b){h.a.debug("FCSTACK: addStream",b)},addTrack:function(b){h.a.debug("FCSTACK: addTrack",stream)},processSignalingMessage:function(b){h.a.debug("FCSTACK: processSignaling",b);void 0!==e.signalCallback&&e.signalCallback(b)},sendSignalingMessage:function(b){h.a.debug("FCSTACK: Sending signaling Message",b);l.callback(b)},setSignalingCallback:function(b){b=void 0===b?function(){}:
b;h.a.debug("FCSTACK: Setting signalling callback");e.signalCallback=b}};return e}},function(m,t,n){n.d(t,"a",function(){return d});var h=n(5);m=n(41);var l=n.n(m),e=n(0),b=n(8),a=n(9),c=n(6),g=n(4),w=function(a,b){a=Object(g.b)({type:a});a.args=b.args;return a},d=function(d){var q=Object(g.c)(),r=function(){},v=[];$jscomp.initSymbol();q.CONNECTED=Symbol("connected");$jscomp.initSymbol();q.RECONNECTING=Symbol("reconnecting");$jscomp.initSymbol();q.DISCONNECTED=Symbol("disconnected");q.state=q.DISCONNECTED;
q.IO=void 0===d?l.a:d;var p,u=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];q.emit(w(a,{args:c}))},m=function(){e.a.info("execute buffer");q.state===q.CONNECTED&&v.forEach(function(a){q.sendMessage.apply(q,$jscomp.arrayFromIterable(a))})};q.connect=function(c,d,g){d=void 0===d?r:d;g=void 0===g?r:g;var f={reconnection:!1,secure:c.secure,forceNew:!0,transports:["websocket"],rejectUnauthorized:!0},l="https:"==window.location.protocol?"wss://":"ws://",v=c.host;void 0==c.gateway||
null==c.gateway||""==c.gateway?v=c.host:(v=c.gateway,f.query="X-Forwarded-Host="+c.host);e.a.info("Connecting socket with option:- "+JSON.stringify(f));console.log("Connecting socket with host:- "+v);p=q.IO.connect(l+v,f);var w=p.io.engine.transport.ws.onclose;p.io.engine.transport.ws.onclose=function(a){e.a.warning("WebSocket closed, code:",a.code);w(a)};p.io.engine.transport.ws.onerror=function(a){};q.socket=p;p.on(h.a.UserEvent.user_awaited,u.bind(q,h.a.UserEvent.user_awaited));p.on(h.a.UserEvent.user_joined,
u.bind(q,h.a.UserEvent.user_joined));p.on(h.a.RoomEvent.room_connected,u.bind(q,h.a.RoomEvent.room_connected));p.on(h.a.RoomEvent.room_disconnected,u.bind(q,h.a.RoomEvent.room_disconnected));p.on(h.a.RoomEvent.new_active_talker,u.bind(q,h.a.RoomEvent.new_active_talker));p.on(h.a.SocketEvent.onAddStream,u.bind(q,h.a.SocketEvent.onAddStream));p.on(h.a.SocketEvent.signaling_message_peer,u.bind(q,h.a.SocketEvent.signaling_message_peer));p.on(h.a.SocketEvent.publish_me,u.bind(q,h.a.SocketEvent.publish_me));
p.on(h.a.SocketEvent.unpublish_me,u.bind(q,h.a.SocketEvent.unpublish_me));p.on(h.a.SocketEvent.onBandwidthAlert,u.bind(q,h.a.SocketEvent.onBandwidthAlert));p.on(h.a.SocketEvent.onBandwidthEvents,u.bind(q,h.a.SocketEvent.onBandwidthEvents));p.on(h.a.SocketEvent.onSelfBandwidthAlert,u.bind(q,h.a.SocketEvent.onSelfBandwidthAlert));p.on(h.a.SocketEvent.onRemoveTrack,u.bind(q,h.a.SocketEvent.onRemoveTrack));p.on(h.a.SocketEvent.onDataStream,u.bind(q,h.a.SocketEvent.onDataStream));p.on(h.a.RoomEvent.room_awaited,
u.bind(q,h.a.RoomEvent.room_awaited));p.on(h.a.RoomEvent.room_record_on,u.bind(q,h.a.RoomEvent.room_record_on));p.on(h.a.RoomEvent.room_record_off,u.bind(q,h.a.RoomEvent.room_record_off));p.on(h.a.RoomEvent.hard_mute_audio,u.bind(q,h.a.RoomEvent.hard_mute_audio));p.on(h.a.RoomEvent.hard_unmute_audio,u.bind(q,h.a.RoomEvent.hard_unmute_audio));p.on(h.a.RoomEvent.hard_mute_video,u.bind(q,h.a.RoomEvent.hard_mute_video));p.on(h.a.RoomEvent.hard_unmute_video,u.bind(q,h.a.RoomEvent.hard_unmute_video));p.on(h.a.RoomEvent.share_started,
u.bind(q,h.a.RoomEvent.share_started));p.on(h.a.RoomEvent.share_stopped,u.bind(q,h.a.RoomEvent.share_stopped));p.on(h.a.RoomEvent.screen_share_override,u.bind(q,h.a.RoomEvent.screen_share_override));p.on(h.a.RoomEvent.stop_sharing,u.bind(q,h.a.RoomEvent.stop_sharing));p.on(h.a.RoomEvent.update_layout,u.bind(q,h.a.RoomEvent.update_layout));p.on(h.a.RoomEvent.custom_data_saved,u.bind(q,h.a.RoomEvent.custom_data_saved));p.on(h.a.RoomEvent.custom_data_updated,u.bind(q,h.a.RoomEvent.custom_data_updated));
p.on(h.a.RoomEvent.streaming_uri,u.bind(q,h.a.RoomEvent.streaming_uri));p.on(h.a.RoomEvent.canvas_started,u.bind(q,h.a.RoomEvent.canvas_started));p.on(h.a.RoomEvent.canvas_stopped,u.bind(q,h.a.RoomEvent.canvas_stopped));p.on(h.a.RoomEvent.invite_breakout_room,u.bind(q,h.a.RoomEvent.invite_breakout_room));p.on(h.a.RoomEvent.user_joined_breakout_room,u.bind(q,h.a.RoomEvent.user_joined_breakout_room));p.on(h.a.RoomEvent.user_left_breakout_room,u.bind(q,h.a.RoomEvent.user_left_breakout_room));p.on(h.a.RoomEvent.breakout_room_destroyed,
u.bind(q,h.a.RoomEvent.breakout_room_destroyed));p.on(h.a.RoomEvent.transcription_events,u.bind(q,h.a.RoomEvent.transcription_events));p.on(h.a.SocketEvent.dial_state_events,u.bind(q,h.a.SocketEvent.dial_state_events));p.on(h.a.UserEvent.user_audio_muted,u.bind(q,h.a.UserEvent.user_audio_muted));p.on(h.a.UserEvent.user_audio_unmuted,u.bind(q,h.a.UserEvent.user_audio_unmuted));p.on(h.a.UserEvent.user_video_muted,u.bind(q,h.a.UserEvent.user_video_muted));p.on(h.a.UserEvent.user_video_unmuted,u.bind(q,
h.a.UserEvent.user_video_unmuted));p.on(h.a.SocketEvent.media_engine_connecting,u.bind(q,h.a.SocketEvent.media_engine_connecting));p.on(h.a.SocketEvent.onUpdateAttributeStream,u.bind(q,h.a.SocketEvent.onUpdateAttributeStream));p.on(h.a.SocketEvent.onRemoveStream,u.bind(q,h.a.SocketEvent.onRemoveStream));p.on(h.a.SocketEvent.user_connected,u.bind(q,h.a.SocketEvent.user_connected));p.on(h.a.SocketEvent.user_updated,u.bind(q,h.a.SocketEvent.user_updated));p.on(h.a.SocketEvent.user_disconnected,u.bind(q,
h.a.SocketEvent.user_disconnected));p.on(h.a.SocketEvent.user_subscribed,u.bind(q,h.a.SocketEvent.user_subscribed));p.on(h.a.SocketEvent.floor_requested,u.bind(q,h.a.SocketEvent.floor_requested));p.on(h.a.SocketEvent.floor_granted,u.bind(q,h.a.SocketEvent.floor_granted));p.on(h.a.SocketEvent.floor_not_granted,u.bind(q,h.a.SocketEvent.floor_not_granted));p.on(h.a.SocketEvent.floor_released,u.bind(q,h.a.SocketEvent.floor_released));p.on(h.a.SocketEvent.hard_mute,u.bind(q,h.a.SocketEvent.hard_mute));
p.on(h.a.SocketEvent.hard_mute_room,u.bind(q,h.a.SocketEvent.hard_mute_room));p.on(h.a.SocketEvent.hard_unmute_room,u.bind(q,h.a.SocketEvent.hard_unmute_room));p.on(h.a.SocketEvent.switched_room,u.bind(q,h.a.SocketEvent.switched_room));p.on(h.a.SocketEvent.data_stream_room,u.bind(q,h.a.SocketEvent.data_stream_room));p.on(h.a.RoomEvent.user_role_changed,u.bind(q,h.a.RoomEvent.user_role_changed));p.on(h.a.SocketEvent.onStatSubscription,u.bind(q,h.a.SocketEvent.onStatSubscription));p.on(h.a.SocketEvent.onStreamingNotification,
u.bind(q,h.a.SocketEvent.onStreamingNotification));p.on(h.a.SocketEvent.onHlsStreamingNotification,u.bind(q,h.a.SocketEvent.onHlsStreamingNotification));p.on(h.a.SocketEvent.onHlsStreamingNotificationToPublisher,u.bind(q,h.a.SocketEvent.onHlsStreamingNotificationToPublisher));p.on(h.a.SocketEvent.onLiveRecordingNotification,u.bind(q,h.a.SocketEvent.onLiveRecordingNotification));p.on(h.a.SocketEvent.onRoomLiveRecordingOn,u.bind(q,h.a.SocketEvent.onRoomLiveRecordingOn));p.on(h.a.SocketEvent.onRoomLiveRecordingOff,
u.bind(q,h.a.SocketEvent.onRoomLiveRecordingOff));p.on(h.a.SocketEvent.onRoomLiveRecordingFailed,u.bind(q,h.a.SocketEvent.onRoomLiveRecordingFailed));p.on(h.a.RoomEvent.switch_codec,u.bind(q,h.a.RoomEvent.switch_codec));p.on(h.a.RoomEvent.generic_events,u.bind(q,h.a.RoomEvent.generic_events));p.on(h.a.SocketEvent.room_management_events,u.bind(q,h.a.SocketEvent.room_management_events));p.on(h.a.SocketEvent.floor_management_events,u.bind(q,h.a.SocketEvent.floor_management_events));p.on(h.a.SocketEvent.disconnect,
function(a){e.a.debug(h.a.SocketEvent.disconnect,q.id,a);p.close();u(h.a.SocketEvent.disconnect,a)});p.on(h.a.SocketEvent.connect_timeout,function(a){e.a.warning(h.a.SocketEvent.connect_timeout+", id:",q.id,", error:",a.message);p.close();u(h.a.SocketEvent.disconnect,a.message)});p.on(h.a.SocketEvent.connection_failed,function(){e.a.error(h.a.SocketEvent.connection_failed+", id:",q.id);u(h.a.SocketEvent.connection_failed,{streamId:q.id})});p.on(h.a.SocketEvent.connect_error,function(a){e.a.warning(h.a.SocketEvent.connect_error+
", id:",q.id,", error:",a.message)});p.on(h.a.SocketEvent.error,function(a){e.a.warning(h.a.SocketEvent.error+", id:",q.id,", error:",a.message);u(h.a.SocketEvent.error)});p.on(h.a.SocketEvent.reconnecting,function(a){e.a.debug(h.a.SocketEvent.reconnecting+", id:",q.id,", attempt:",a)});p.on(h.a.SocketEvent.reconnect,function(c){e.a.debug(h.a.SocketEvent.reconnected+", id:",q.id,", attempt:",c);q.state=q.CONNECTED;p.emit(h.a.SocketEvent.reconnected,q.id);a.a.info("socket-event",b.a.event_reconnect_socket_success,
{error:{}});m()});p.on(h.a.SocketEvent.reconnect_attempt,function(a){e.a.debug(h.a.SocketEvent.reconnect_attempt+", id:",q.id,", attempt:",a)});p.on(h.a.SocketEvent.reconnect_failed,function(){e.a.warning(h.a.SocketEvent.reconnect_failed+", id:",q.id);q.state=q.DISCONNECTED;u(h.a.SocketEvent.disconnect,h.a.SocketEvent.reconnect_failed);a.a.error("socket-event",b.a.event_reconnect_socket_failed,{error:{}})});p.on(h.a.SocketEvent.reconnect_error,function(a){e.a.debug(h.a.SocketEvent.reconnect_error+
", id:",q.id,", error:",a.message)});q.sendMessage("token",c,function(a){q.state=q.CONNECTED;q.id=a.clientId;d(a)},g)};q.disconnect=function(){e.a.debug("socket js disconnect the socket");q.state=q.DISCONNECTED;p.disconnect()};q.sendMessage=function(d,g,h,f){h=void 0===h?r:h;f=void 0===f?r:f;q.state===q.DISCONNECTED&&"token"!==d?(e.a.error("Trying to send a message over a disconnected Socket"),h(c.a.error_1163)):q.state===q.RECONNECTING?(e.a.debug("sendmessage socket state is reconnecting"),v.push([d,
g,h,f]),h(c.a.error_1164)):g?p.emit(d,g,function(g,p){"success"===g?h(p):"error"===g?(a.a.error("socket-event",b.a.event_send_message_failed,{type:d,respType:g,resp:p}),f(p)):void 0!=p&&null!=p||void 0==g||!0!==g&&("object"!=typeof g||void 0==g.result||g.result!=c.a.error_000.result)&&void 0==g.status?(e.a.debug(" sendMessage() not sucess : respType: "+JSON.stringify(g)+" resp: "+JSON.stringify(p)),f(void 0==p?g:p)):(e.a.debug(" sendMessage() resp undefined but respType has result with sucees: "+
JSON.stringify(g)),h(g))}):f(c.a.error_1155)};q.sendSDP=function(c,d,g,f){f=void 0===f?r:f;q.state===q.DISCONNECTED?(e.a.error("Trying to send a message over a disconnected Socket"),a.a.info("socket-event",b.a.event_send_message_failed,{error:"Trying to send a message over a disconnected Socket"})):p.emit(c,d,g,function(a,b){f(a,b)})};q.emitEvent=function(c,d,g){g=void 0===g?r:g;q.state===q.DISCONNECTED?(e.a.error("Trying to send a message over a disconnected Socket"),a.a.info("socket-event",b.a.event_send_message_failed,
{error:"Trying to send a message over a disconnected Socket"})):p.emit(c,d,function(a,b){g(a,b)})};q.sendEvent=function(c,d){d=void 0===d?r:d;q.state===q.DISCONNECTED?(e.a.error("Trying to send a message over a disconnected Socket"),a.a.info("socket-event",b.a.event_send_message_failed,{error:"Trying to send a message over a disconnected Socket"})):p.emit(c,function(a){d(a)})};q.sendParamEvent=function(c,d,g){g=void 0===g?r:g;q.state===q.DISCONNECTED?(e.a.error("Trying to send a message over a disconnected Socket"),
a.a.info("socket-event",b.a.event_send_message_failed,{error:"Trying to send a message over a disconnected Socket"})):p.emit(c,d,function(a){g(a)})};return q}},function(m,t,n){!function(h,l){m.exports=l()}(this,function(){return function(h){function l(b){if(e[b])return e[b].exports;var a=e[b]={exports:{},id:b,loaded:!1};return h[b].call(a.exports,a,a.exports,l),a.loaded=!0,a.exports}var e={};return l.m=h,l.c=e,l.p="",l(0)}([function(h,l,e){function b(b,g){"object"===("undefined"===typeof b?"undefined":
a(b))&&(g=b,b=void 0);g=g||{};var e;b=c(b);var h=b.source,q=b.id,l=b.path;l=r[q]&&l in r[q].nsps;return g.forceNew||g["force new connection"]||!1===g.multiplex||l?(d("ignoring socket cache for %s",h),e=w(h,g)):(r[q]||(d("new io instance for %s",h),r[q]=w(h,g)),e=r[q]),b.query&&!g.query&&(g.query=b.query),e.socket(b.path,g)}$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();
$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},c=e(1),g=e(7),w=e(13),d=e(3)("socket.io-client");h.exports=l=b;var r=l.managers={};l.protocol=g.protocol;l.connect=b;l.Manager=e(13);l.Socket=e(39)},function(h,l,e){(function(b){var a=e(2),c=e(3)("socket.io-client:url");h.exports=function(g,e){var d=g;e=e||b.location;null==g&&(g=e.protocol+"//"+e.host);"string"===typeof g&&("/"===g.charAt(0)&&(g="/"===g.charAt(1)?
e.protocol+g:e.host+g),/^(https?|wss?):\/\//.test(g)||(c("protocol-less url %s",g),g="undefined"!==typeof e?e.protocol+"//"+g:"https://"+g),c("parse %s",g),d=a(g));d.port||(/^(http|ws)$/.test(d.protocol)?d.port="80":/^(http|ws)s$/.test(d.protocol)&&(d.port="443"));d.path=d.path||"/";g=-1!==d.host.indexOf(":")?"["+d.host+"]":d.host;return d.id=d.protocol+"://"+g+":"+d.port,d.href=d.protocol+"://"+g+(e&&e.port===d.port?"":":"+d.port),d}}).call(l,function(){return this}())},function(h,l){var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
b="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");h.exports=function(a){var c=a,g=a.indexOf("["),h=a.indexOf("]");-1!=g&&-1!=h&&(a=a.substring(0,g)+a.substring(g,h).replace(/:/g,";")+a.substring(h,a.length));a=e.exec(a||"");for(var d={},r=14;r--;)d[b[r]]=a[r]||"";return-1!=g&&-1!=h&&(d.source=c,d.host=d.host.substring(1,d.host.length-1).replace(/;/g,":"),d.authority=d.authority.replace("[","").replace("]","").replace(/;/g,":"),d.ipv6uri=
!0),d}},function(h,l,e){(function(b){function a(){try{var a=l.storage.debug}catch(d){}return!a&&"undefined"!==typeof b&&"env"in b&&(a=b.env.DEBUG),a}l=h.exports=e(5);l.log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};l.formatArgs=function(a){var b=this.useColors;if(a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+l.humanize(this.diff),b){b="color: "+this.color;a.splice(1,0,b,"color: inherit");var c=0,g=0;
a[0].replace(/%[a-zA-Z%]/g,function(a){"%%"!==a&&(c++,"%c"===a&&(g=c))});a.splice(g,0,b)}};l.save=function(a){try{null==a?l.storage.removeItem("debug"):l.storage.debug=a}catch(d){}};l.load=a;l.useColors=function(){return!("undefined"===typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||
window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};var c=l;if("undefined"!==typeof chrome&&"undefined"!==typeof chrome.storage)var g=chrome.storage.local;else a:{try{g=window.localStorage;break a}catch(w){}g=void 0}c.storage=g;l.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");
l.formatters.j=function(a){try{return JSON.stringify(a)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}};l.enable(a())}).call(l,e(4))},function(h,l){function e(){throw Error("setTimeout has not been defined");}function b(){throw Error("clearTimeout has not been defined");}function a(a){if(q===setTimeout)return setTimeout(a,0);if((q===e||!q)&&setTimeout)return q=setTimeout,setTimeout(a,0);try{return q(a,0)}catch(z){try{return q.call(null,a,0)}catch(F){return q.call(this,a,0)}}}function c(a){if(n===
clearTimeout)return clearTimeout(a);if((n===b||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(a);try{return n(a)}catch(z){try{return n.call(null,a)}catch(F){return n.call(this,a)}}}function g(){u&&v&&(u=!1,v.length?p=v.concat(p):C=-1,p.length&&m())}function m(){if(!u){var b=a(g);u=!0;for(var d=p.length;d;){v=p;for(p=[];++C<d;)v&&v[C].run();C=-1;d=p.length}v=null;u=!1;c(b)}}function d(a,b){this.fun=a;this.array=b}function r(){}h=h.exports={};try{var q="function"===typeof setTimeout?setTimeout:
e}catch(B){q=e}try{var n="function"===typeof clearTimeout?clearTimeout:b}catch(B){n=b}!0;var v,p=[],u=!1,C=-1;h.nextTick=function(b){var c=Array(arguments.length-1);if(1<arguments.length)for(var g=1;g<arguments.length;g++)c[g-1]=arguments[g];p.push(new d(b,c));1!==p.length||u||a(m)};d.prototype.run=function(){this.fun.apply(null,this.array)};h.title="browser";h.browser=!0;h.env={};h.argv=[];h.version="";h.versions={};h.on=r;h.addListener=r;h.once=r;h.off=r;h.removeListener=r;h.removeAllListeners=
r;h.emit=r;h.prependListener=r;h.prependOnceListener=r;h.listeners=function(a){return[]};h.binding=function(a){throw Error("process.binding is not supported");};h.cwd=function(){return"/"};h.chdir=function(a){throw Error("process.chdir is not supported");};h.umask=function(){return 0}},function(h,l,e){function b(a){var b,c=0;for(b in a)c=(c<<5)-c+a.charCodeAt(b),c|=0;return l.colors[Math.abs(c)%l.colors.length]}function a(a){function g(){if(g.enabled){var a=+new Date;g.diff=a-(c||a);g.prev=c;c=g.curr=
a;var b=Array(arguments.length);for(a=0;a<b.length;a++)b[a]=arguments[a];b[0]=l.coerce(b[0]);"string"!==typeof b[0]&&b.unshift("%O");var e=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,function(a,c){if("%%"===a)return a;e++;c=l.formatters[c];"function"===typeof c&&(a=c.call(g,b[e]),b.splice(e,1),e--);return a});l.formatArgs.call(g,b);(g.log||l.log||console.log.bind(console)).apply(g,b)}}return g.namespace=a,g.enabled=l.enabled(a),g.useColors=l.useColors(),g.color=b(a),"function"===typeof l.init&&l.init(g),
g}l=h.exports=a.debug=a.default=a;l.coerce=function(a){return a instanceof Error?a.stack||a.message:a};l.disable=function(){l.enable("")};l.enable=function(a){l.save(a);l.names=[];l.skips=[];for(var b=("string"===typeof a?a:"").split(/[\s,]+/),c=b.length,g=0;g<c;g++)b[g]&&(a=b[g].replace(/\*/g,".*?"),"-"===a[0]?l.skips.push(new RegExp("^"+a.substr(1)+"$")):l.names.push(new RegExp("^"+a+"$")))};l.enabled=function(a){var b;var c=0;for(b=l.skips.length;c<b;c++)if(l.skips[c].test(a))return!1;c=0;for(b=
l.names.length;c<b;c++)if(l.names[c].test(a))return!0;return!1};l.humanize=e(6);l.names=[];l.skips=[];l.formatters={};var c},function(h,l){function e(b){if(b=String(b),!(100<b.length))if(b=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(b)){var e=parseFloat(b[1]);switch((b[2]||"ms").toLowerCase()){case "years":case "year":case "yrs":case "yr":case "y":return e*d;case "days":case "day":case "d":return e*m;case "hours":case "hour":case "hrs":case "hr":case "h":return e*
g;case "minutes":case "minute":case "mins":case "min":case "m":return e*c;case "seconds":case "second":case "secs":case "sec":case "s":return e*a;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":return e}}}function b(a,b,c){if(!(a<b))return a<1.5*b?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var a=1E3,c=60*a,g=60*c,m=24*g,d=365.25*m;h.exports=function(d,h){h=h||{};var q=typeof d;if("string"===q&&0<d.length)return e(d);if("number"===q&&!1===isNaN(d))return h.long?b(d,m,
"day")||b(d,g,"hour")||b(d,c,"minute")||b(d,a,"second")||d+" ms":d>=m?Math.round(d/m)+"d":d>=g?Math.round(d/g)+"h":d>=c?Math.round(d/c)+"m":d>=a?Math.round(d/a)+"s":d+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d));}},function(h,l,e){function b(){}function a(a){var b=""+a.type;return l.BINARY_EVENT!==a.type&&l.BINARY_ACK!==a.type||(b+=a.attachments+"-"),a.nsp&&"/"!==a.nsp&&(b+=a.nsp+","),null!=a.id&&(b+=a.id),null!=a.data&&(b+=JSON.stringify(a.data)),r("encoded %j as %s",
a,b),b}function c(b,c){n.removeBlobs(b,function(b){var d=n.deconstructPacket(b);b=a(d.packet);d=d.buffers;d.unshift(b);c(d)})}function g(){this.reconstructor=null}function m(a){this.reconPack=a;this.buffers=[]}function d(){return{type:l.ERROR,data:"parser error"}}var r=e(3)("socket.io-parser");h=e(8);var q=e(9),n=e(11),v=e(12);l.protocol=4;l.types="CONNECT DISCONNECT EVENT ACK ERROR BINARY_EVENT BINARY_ACK".split(" ");l.CONNECT=0;l.DISCONNECT=1;l.EVENT=2;l.ACK=3;l.ERROR=4;l.BINARY_EVENT=5;l.BINARY_ACK=
6;l.Encoder=b;l.Decoder=g;b.prototype.encode=function(b,d){(b.type!==l.EVENT&&b.type!==l.ACK||!q(b.data)||(b.type=b.type===l.EVENT?l.BINARY_EVENT:l.BINARY_ACK),r("encoding packet %j",b),l.BINARY_EVENT===b.type||l.BINARY_ACK===b.type)?c(b,d):(b=a(b),d([b]))};h(g.prototype);g.prototype.add=function(a){if("string"===typeof a){var b=0,c={type:Number(a.charAt(0))};if(null==l.types[c.type])a=d();else{if(l.BINARY_EVENT===c.type||l.BINARY_ACK===c.type){for(var g="";"-"!==a.charAt(++b)&&(g+=a.charAt(b),b!=
a.length););if(g!=Number(g)||"-"!==a.charAt(b))throw Error("Illegal attachments");c.attachments=Number(g)}if("/"===a.charAt(b+1))for(c.nsp="";++b;){g=a.charAt(b);if(","===g)break;if(c.nsp+=g,b===a.length)break}else c.nsp="/";g=a.charAt(b+1);if(""!==g&&Number(g)==g){for(c.id="";++b;){g=a.charAt(b);if(null==g||Number(g)!=g){--b;break}if(c.id+=a.charAt(b),b===a.length)break}c.id=Number(c.id)}if(a.charAt(++b)){b:{b=a.substr(b);try{c.data=JSON.parse(b)}catch(z){b=d();break b}b=c}c=b}a=(r("decoded %s as %j",
a,c),c)}l.BINARY_EVENT===a.type||l.BINARY_ACK===a.type?(this.reconstructor=new m(a),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",a)):this.emit("decoded",a)}else{if(!v(a)&&!a.base64)throw Error("Unknown type: "+a);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");(a=this.reconstructor.takeBinaryData(a))&&(this.reconstructor=null,this.emit("decoded",a))}};g.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};
m.prototype.takeBinaryData=function(a){return(this.buffers.push(a),this.buffers.length===this.reconPack.attachments)?(a=n.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),a):null};m.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},function(h,l,e){function b(a){if(a){for(var c in b.prototype)a[c]=b.prototype[c];return a}}h.exports=b;b.prototype.on=b.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks["$"+
a]=this._callbacks["$"+a]||[]).push(b),this};b.prototype.once=function(a,b){function c(){this.off(a,c);b.apply(this,arguments)}return c.fn=b,this.on(a,c),this};b.prototype.off=b.prototype.removeListener=b.prototype.removeAllListeners=b.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c=this._callbacks["$"+a];if(!c)return this;if(1==arguments.length)return delete this._callbacks["$"+a],this;for(var e,d=0;d<c.length;d++)if(e=
c[d],e===b||e.fn===b){c.splice(d,1);break}return this};b.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),g=this._callbacks["$"+a];if(g){g=g.slice(0);for(var e=0,d=g.length;e<d;++e)g[e].apply(this,b)}return this};b.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks["$"+a]||[]};b.prototype.hasListeners=function(a){return!!this.listeners(a).length}},function(h,l,e){(function(b){function a(g){if(!g||"object"!==typeof g)return!1;
if(c(g)){for(var e=0,h=g.length;e<h;e++)if(a(g[e]))return!0;return!1}if("function"===typeof b.Buffer&&b.Buffer.isBuffer&&b.Buffer.isBuffer(g)||"function"===typeof b.ArrayBuffer&&g instanceof ArrayBuffer||l&&g instanceof Blob||d&&g instanceof File)return!0;if(g.toJSON&&"function"===typeof g.toJSON&&1===arguments.length)return a(g.toJSON(),!0);for(e in g)if(Object.prototype.hasOwnProperty.call(g,e)&&a(g[e]))return!0;return!1}var c=e(10),g=Object.prototype.toString,l="function"===typeof b.Blob||"[object BlobConstructor]"===
g.call(b.Blob),d="function"===typeof b.File||"[object FileConstructor]"===g.call(b.File);h.exports=a}).call(l,function(){return this}())},function(h,l){var e={}.toString;h.exports=Array.isArray||function(b){return"[object Array]"==e.call(b)}},function(h,l,e){(function(b){function a(b,c){if(!b)return b;if(h(b)){var d={_placeholder:!0,num:c.length};return c.push(b),d}if(g(b)){d=Array(b.length);for(var e=0;e<b.length;e++)d[e]=a(b[e],c);return d}if("object"===typeof b&&!(b instanceof Date)){d={};for(e in b)d[e]=
a(b[e],c);return d}return b}function c(a,b){if(!a)return a;if(a&&a._placeholder)return b[a.num];if(g(a))for(var d=0;d<a.length;d++)a[d]=c(a[d],b);else if("object"===typeof a)for(d in a)a[d]=c(a[d],b);return a}var g=e(10),h=e(12),d=Object.prototype.toString,r="function"===typeof b.Blob||"[object BlobConstructor]"===d.call(b.Blob),q="function"===typeof b.File||"[object FileConstructor]"===d.call(b.File);l.deconstructPacket=function(b){var c=[];return b.data=a(b.data,c),b.attachments=c.length,{packet:b,
buffers:c}};l.reconstructPacket=function(a,b){return a.data=c(a.data,b),a.attachments=void 0,a};l.removeBlobs=function(a,b){function c(a,p,u){if(!a)return a;if(r&&a instanceof Blob||q&&a instanceof File){d++;var f=new FileReader;f.onload=function(){u?u[p]=this.result:e=this.result;--d||b(e)};f.readAsArrayBuffer(a)}else if(g(a))for(f=0;f<a.length;f++)c(a[f],f,a);else if("object"===typeof a&&!h(a))for(f in a)c(a[f],f,a)}var d=0,e=a;c(e);d||b(e)}}).call(l,function(){return this}())},function(h,l){(function(e){h.exports=
function(b){return e.Buffer&&e.Buffer.isBuffer(b)||e.ArrayBuffer&&b instanceof ArrayBuffer}}).call(l,function(){return this}())},function(h,l,e){function b(c,d){if(!(this instanceof b))return new b(c,d);c&&"object"===("undefined"===typeof c?"undefined":a(c))&&(d=c,c=void 0);d=d||{};d.path=d.path||"/socket.io";this.nsps={};this.subs=[];this.opts=d;this.reconnection(!1!==d.reconnection);this.reconnectionAttempts(d.reconnectionAttempts||1/0);this.reconnectionDelay(d.reconnectionDelay||1E3);this.reconnectionDelayMax(d.reconnectionDelayMax||
5E3);this.randomizationFactor(d.randomizationFactor||.5);this.backoff=new v({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==d.timeout?2E4:d.timeout);this.readyState="closed";this.uri=c;this.connecting=[];this.lastPing=null;this.encoding=!1;this.packetBuffer=[];c=d.parser||m;this.encoder=new c.Encoder;this.decoder=new c.Decoder;(this.autoConnect=!1!==d.autoConnect)&&this.open()}$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();
var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},c=e(14),g=e(39);l=e(8);var m=e(7),d=e(41),r=e(42),q=e(3)("socket.io-client:manager"),n=e(37),v=e(43),p=Object.prototype.hasOwnProperty;h.exports=b;b.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var a in this.nsps)p.call(this.nsps,
a)&&this.nsps[a].emit.apply(this.nsps[a],arguments)};b.prototype.updateSocketIds=function(){for(var a in this.nsps)p.call(this.nsps,a)&&(this.nsps[a].id=this.generateId(a))};b.prototype.generateId=function(a){return("/"===a?"":a+"#")+this.engine.id};l(b.prototype);b.prototype.reconnection=function(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection};b.prototype.reconnectionAttempts=function(a){return arguments.length?(this._reconnectionAttempts=a,this):this._reconnectionAttempts};
b.prototype.reconnectionDelay=function(a){return arguments.length?(this._reconnectionDelay=a,this.backoff&&this.backoff.setMin(a),this):this._reconnectionDelay};b.prototype.randomizationFactor=function(a){return arguments.length?(this._randomizationFactor=a,this.backoff&&this.backoff.setJitter(a),this):this._randomizationFactor};b.prototype.reconnectionDelayMax=function(a){return arguments.length?(this._reconnectionDelayMax=a,this.backoff&&this.backoff.setMax(a),this):this._reconnectionDelayMax};
b.prototype.timeout=function(a){return arguments.length?(this._timeout=a,this):this._timeout};b.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};b.prototype.open=b.prototype.connect=function(a,b){if(q("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;q("opening %s",this.uri);var g=this.engine=c(this.uri,this.opts),e=this;this.readyState="opening";this.skipReconnect=!1;var h=d(g,"open",function(){e.onopen();
a&&a()});b=d(g,"error",function(b){if(q("connect_error"),e.cleanup(),e.readyState="closed",e.emitAll("connect_error",b),a){var c=Error("Connection error");c.data=b;a(c)}else e.maybeReconnectOnOpen()});if(!1!==this._timeout){var f=this._timeout;q("connect attempt will timeout after %d",f);var p=setTimeout(function(){q("connect attempt timed out after %d",f);h.destroy();g.close();g.emit("error","timeout");e.emitAll("connect_timeout",f)},f);this.subs.push({destroy:function(){clearTimeout(p)}})}return this.subs.push(h),
this.subs.push(b),this};b.prototype.onopen=function(){q("open");this.cleanup();this.readyState="open";this.emit("open");var a=this.engine;this.subs.push(d(a,"data",r(this,"ondata")));this.subs.push(d(a,"ping",r(this,"onping")));this.subs.push(d(a,"pong",r(this,"onpong")));this.subs.push(d(a,"error",r(this,"onerror")));this.subs.push(d(a,"close",r(this,"onclose")));this.subs.push(d(this.decoder,"decoded",r(this,"ondecoded")))};b.prototype.onping=function(){this.lastPing=new Date;this.emitAll("ping")};
b.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)};b.prototype.ondata=function(a){this.decoder.add(a)};b.prototype.ondecoded=function(a){this.emit("packet",a)};b.prototype.onerror=function(a){q("error",a);this.emitAll("error",a)};b.prototype.socket=function(a,b){function c(){~n(e.connecting,d)||e.connecting.push(d)}var d=this.nsps[a];if(!d){d=new g(this,a,b);this.nsps[a]=d;var e=this;d.on("connecting",c);d.on("connect",function(){d.id=e.generateId(a)});this.autoConnect&&c()}return d};
b.prototype.destroy=function(a){a=n(this.connecting,a);~a&&this.connecting.splice(a,1);this.connecting.length||this.close()};b.prototype.packet=function(a){q("writing packet %j",a);var b=this;a.query&&0===a.type&&(a.nsp+="?"+a.query);b.encoding?b.packetBuffer.push(a):(b.encoding=!0,this.encoder.encode(a,function(c){for(var d=0;d<c.length;d++)b.engine.write(c[d],a.options);b.encoding=!1;b.processPacketQueue()}))};b.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var a=
this.packetBuffer.shift();this.packet(a)}};b.prototype.cleanup=function(){q("cleanup");for(var a=this.subs.length,b=0;b<a;b++)this.subs.shift().destroy();this.packetBuffer=[];this.encoding=!1;this.lastPing=null;this.decoder.destroy()};b.prototype.close=b.prototype.disconnect=function(){q("disconnect");this.skipReconnect=!0;this.reconnecting=!1;"opening"===this.readyState&&this.cleanup();this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};b.prototype.onclose=function(a){q("onclose");
this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",a);this._reconnection&&!this.skipReconnect&&this.reconnect()};b.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)q("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();q("will wait %dms before reconnect attempt",b);this.reconnecting=!0;var c=setTimeout(function(){a.skipReconnect||
(q("attempting reconnect"),a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),a.skipReconnect||a.open(function(b){b?(q("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",b.data)):(q("reconnect success"),a.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(c)}})}};b.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",
a)}},function(h,l,e){h.exports=e(15)},function(h,l,e){h.exports=e(16);h.exports.parser=e(23)},function(h,l,e){(function(b){function a(c,d){if(!(this instanceof a))return new a(c,d);d=d||{};c&&"object"===typeof c&&(d=c,c=null);c?(c=q(c),d.hostname=c.host,d.secure="https"===c.protocol||"wss"===c.protocol,d.port=c.port,c.query&&(d.query=c.query)):d.host&&(d.hostname=q(d.host).host);this.secure=null!=d.secure?d.secure:b.location&&"https:"===location.protocol;d.hostname&&!d.port&&(d.port=this.secure?"443":
"80");this.agent=d.agent||!1;this.hostname=d.hostname||(b.location?location.hostname:"localhost");this.port=d.port||(b.location&&location.port?location.port:this.secure?443:80);this.query=d.query||{};"string"===typeof this.query&&(this.query=v.decode(this.query));this.upgrade=!1!==d.upgrade;this.path=(d.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!d.forceJSONP;this.jsonp=!1!==d.jsonp;this.forceBase64=!!d.forceBase64;this.enablesXDR=!!d.enablesXDR;this.timestampParam=d.timestampParam||
"t";this.timestampRequests=d.timestampRequests;this.transports=d.transports||["polling","websocket"];this.transportOptions=d.transportOptions||{};this.readyState="";this.writeBuffer=[];this.prevBufferLen=0;this.policyPort=d.policyPort||843;this.rememberUpgrade=d.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=d.onlyBinaryUpgrades;this.perMessageDeflate=!1!==d.perMessageDeflate&&(d.perMessageDeflate||{});!0===this.perMessageDeflate&&(this.perMessageDeflate={});this.perMessageDeflate&&
null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024);this.pfx=d.pfx||null;this.key=d.key||null;this.passphrase=d.passphrase||null;this.cert=d.cert||null;this.ca=d.ca||null;this.ciphers=d.ciphers||null;this.rejectUnauthorized=void 0===d.rejectUnauthorized||d.rejectUnauthorized;this.forceNode=!!d.forceNode;c="object"===typeof b&&b;c.global===c&&(d.extraHeaders&&0<Object.keys(d.extraHeaders).length&&(this.extraHeaders=d.extraHeaders),d.localAddress&&(this.localAddress=d.localAddress));
this.pingTimeoutTimer=this.pingIntervalTimer=this.pingTimeout=this.pingInterval=this.upgrades=this.id=null;this.open()}var c=e(17),g=e(8),l=e(3)("engine.io-client:socket"),d=e(37),r=e(23),q=e(2),m=e(38),v=e(31);h.exports=a;a.priorWebsocketSuccess=!1;g(a.prototype);a.protocol=r.protocol;a.Socket=a;a.Transport=e(22);a.transports=e(17);a.parser=e(23);a.prototype.createTransport=function(a){l('creating transport "%s"',a);var b=this.query,d={},g;for(g in b)b.hasOwnProperty(g)&&(d[g]=b[g]);d.EIO=r.protocol;
d.transport=a;b=this.transportOptions[a]||{};this.id&&(d.sid=this.id);return new c[a]({query:d,socket:this,agent:b.agent||this.agent,hostname:b.hostname||this.hostname,port:b.port||this.port,secure:b.secure||this.secure,path:b.path||this.path,forceJSONP:b.forceJSONP||this.forceJSONP,jsonp:b.jsonp||this.jsonp,forceBase64:b.forceBase64||this.forceBase64,enablesXDR:b.enablesXDR||this.enablesXDR,timestampRequests:b.timestampRequests||this.timestampRequests,timestampParam:b.timestampParam||this.timestampParam,
policyPort:b.policyPort||this.policyPort,pfx:b.pfx||this.pfx,key:b.key||this.key,passphrase:b.passphrase||this.passphrase,cert:b.cert||this.cert,ca:b.ca||this.ca,ciphers:b.ciphers||this.ciphers,rejectUnauthorized:b.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:b.perMessageDeflate||this.perMessageDeflate,extraHeaders:b.extraHeaders||this.extraHeaders,forceNode:b.forceNode||this.forceNode,localAddress:b.localAddress||this.localAddress,requestTimeout:b.requestTimeout||this.requestTimeout,
protocols:b.protocols||void 0})};a.prototype.open=function(){if(this.rememberUpgrade&&a.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))var b="websocket";else{if(0===this.transports.length){var c=this;return void setTimeout(function(){c.emit("error","No transports available")},0)}b=this.transports[0]}this.readyState="opening";try{b=this.createTransport(b)}catch(C){return this.transports.shift(),void this.open()}b.open();this.setTransport(b)};a.prototype.setTransport=function(a){l("setting transport %s",
a.name);var b=this;this.transport&&(l("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=a;a.on("drain",function(){b.onDrain()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})};a.prototype.probe=function(b){function c(){if(v.onlyBinaryUpgrades){var c=!this.supportsBinary&&v.transport.supportsBinary;r=r||c}r||(l('probe transport "%s" opened',b),q.send([{type:"ping",
data:"probe"}]),q.once("packet",function(c){if(!r)if("pong"===c.type&&"probe"===c.data){if(l('probe transport "%s" pong',b),v.upgrading=!0,v.emit("upgrading",q),q)a.priorWebsocketSuccess="websocket"===q.name,l('pausing current transport "%s"',v.transport.name),v.transport.pause(function(){r||"closed"!==v.readyState&&(l("changing transport and sending upgrade packet"),p(),v.setTransport(q),q.send([{type:"upgrade"}]),v.emit("upgrade",q),q=null,v.upgrading=!1,v.flush())})}else l('probe transport "%s" failed',
b),c=Error("probe error"),c.transport=q.name,v.emit("upgradeError",c)}))}function d(){r||(r=!0,p(),q.close(),q=null)}function g(a){var c=Error("probe error: "+a);c.transport=q.name;d();l('probe transport "%s" failed because of error: %s',b,a);v.emit("upgradeError",c)}function e(){g("transport closed")}function h(){g("socket closed")}function f(a){q&&a.name!==q.name&&(l('"%s" works - aborting "%s"',a.name,q.name),d())}function p(){q.removeListener("open",c);q.removeListener("error",g);q.removeListener("close",
e);v.removeListener("close",h);v.removeListener("upgrading",f)}l('probing transport "%s"',b);var q=this.createTransport(b,{probe:1}),r=!1,v=this;a.priorWebsocketSuccess=!1;q.once("open",c);q.once("error",g);q.once("close",e);this.once("close",h);this.once("upgrading",f);q.open()};a.prototype.onOpen=function(){if(l("socket open"),this.readyState="open",a.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){l("starting upgrade probes");
for(var b=0,c=this.upgrades.length;b<c;b++)this.probe(this.upgrades[b])}};a.prototype.onPacket=function(a){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(l('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",a),this.emit("heartbeat"),a.type){case "open":this.onHandshake(m(a.data));break;case "pong":this.setPing();this.emit("pong");break;case "error":var b=Error("server error");b.code=a.data;this.onError(b);break;case "message":this.emit("data",
a.data),this.emit("message",a.data)}else l('packet received with socket readyState "%s"',this.readyState)};a.prototype.onHandshake=function(a){this.emit("handshake",a);this.id=a.sid;this.transport.query.sid=a.sid;this.upgrades=this.filterUpgrades(a.upgrades);this.pingInterval=a.pingInterval;this.pingTimeout=a.pingTimeout;this.onOpen();"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};a.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);
var b=this;b.pingTimeoutTimer=setTimeout(function(){"closed"!==b.readyState&&b.onClose("ping timeout")},a||b.pingInterval+b.pingTimeout)};a.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer);a.pingIntervalTimer=setTimeout(function(){l("writing ping packet - expecting pong within %sms",a.pingTimeout);a.ping();a.onHeartbeat(a.pingTimeout)},a.pingInterval)};a.prototype.ping=function(){var a=this;this.sendPacket("ping",function(){a.emit("ping")})};a.prototype.onDrain=function(){this.writeBuffer.splice(0,
this.prevBufferLen);this.prevBufferLen=0;0===this.writeBuffer.length?this.emit("drain"):this.flush()};a.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(l("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};a.prototype.write=a.prototype.send=function(a,b,c){return this.sendPacket("message",a,b,c),this};a.prototype.sendPacket=
function(a,b,c,d){if("function"===typeof b&&(d=b,b=void 0),"function"===typeof c&&(d=c,c=null),"closing"!==this.readyState&&"closed"!==this.readyState)c=c||{},c.compress=!1!==c.compress,a={type:a,data:b,options:c},this.emit("packetCreate",a),this.writeBuffer.push(a),d&&this.once("flush",d),this.flush()};a.prototype.close=function(){function a(){d.onClose("forced close");l("socket closing - telling transport to close");d.transport.close()}function b(){d.removeListener("upgrade",b);d.removeListener("upgradeError",
b);a()}function c(){d.once("upgrade",b);d.once("upgradeError",b)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var d=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?c():a()}):this.upgrading?c():a()}return this};a.prototype.onError=function(b){l("socket error %j",b);a.priorWebsocketSuccess=!1;this.emit("error",b);this.onClose("transport error",b)};a.prototype.onClose=function(a,b){if("opening"===this.readyState||"open"===this.readyState||
"closing"===this.readyState)l('socket close with reason: "%s"',a),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",a,b),this.writeBuffer=[],this.prevBufferLen=0};a.prototype.filterUpgrades=function(a){for(var b=[],c=0,g=a.length;c<g;c++)~d(this.transports,a[c])&&b.push(a[c]);return b}}).call(l,function(){return this}())},
function(h,l,e){(function(b){var a=e(18),c=e(20),g=e(34),h=e(35);l.polling=function(d){var e,h=!1,l=!1,v=!1!==d.jsonp;b.location&&(l="https:"===location.protocol,(h=location.port)||(h=l?443:80),h=d.hostname!==location.hostname||h!==d.port,l=d.secure!==l);if(d.xdomain=h,d.xscheme=l,e=new a(d),"open"in e&&!d.forceJSONP)return new c(d);if(!v)throw Error("JSONP disabled");return new g(d)};l.websocket=h}).call(l,function(){return this}())},function(h,l,e){(function(b){var a=e(19);h.exports=function(c){var g=
c.xdomain,e=c.xscheme;c=c.enablesXDR;try{if("undefined"!==typeof XMLHttpRequest&&(!g||a))return new XMLHttpRequest}catch(d){}try{if("undefined"!==typeof XDomainRequest&&!e&&c)return new XDomainRequest}catch(d){}if(!g)try{return new (b[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(d){}}}).call(l,function(){return this}())},function(h,l){try{h.exports="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){h.exports=!1}},function(h,l,e){(function(b){function a(){}
function c(a){if(r.call(this,a),this.requestTimeout=a.requestTimeout,this.extraHeaders=a.extraHeaders,b.location){var c="https:"===location.protocol,d=location.port;d||(d=c?443:80);this.xd=a.hostname!==b.location.hostname||d!==a.port;this.xs=a.secure!==c}}function g(a){this.method=a.method||"GET";this.uri=a.uri;this.xd=!!a.xd;this.xs=!!a.xs;this.async=!1!==a.async;this.data=void 0!==a.data?a.data:null;this.agent=a.agent;this.isBinary=a.isBinary;this.supportsBinary=a.supportsBinary;this.enablesXDR=
a.enablesXDR;this.requestTimeout=a.requestTimeout;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.extraHeaders=a.extraHeaders;this.create()}function l(){for(var a in g.requests)g.requests.hasOwnProperty(a)&&g.requests[a].abort()}var d=e(18),r=e(21),q=e(8),m=e(32),v=e(3)("engine.io-client:polling-xhr");h.exports=c;h.exports.Request=g;m(c,r);c.prototype.supportsBinary=!0;c.prototype.request=
function(a){return a=a||{},a.uri=this.uri(),a.xd=this.xd,a.xs=this.xs,a.agent=this.agent||!1,a.supportsBinary=this.supportsBinary,a.enablesXDR=this.enablesXDR,a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized,a.requestTimeout=this.requestTimeout,a.extraHeaders=this.extraHeaders,new g(a)};c.prototype.doWrite=function(a,b){a=this.request({method:"POST",data:a,isBinary:"string"!==typeof a&&void 0!==
a});var c=this;a.on("success",b);a.on("error",function(a){c.onError("xhr post error",a)});this.sendXhr=a};c.prototype.doPoll=function(){v("xhr poll");var a=this.request(),b=this;a.on("data",function(a){b.onData(a)});a.on("error",function(a){b.onError("xhr poll error",a)});this.pollXhr=a};q(g.prototype);g.prototype.create=function(){var a={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};a.pfx=this.pfx;a.key=this.key;a.passphrase=this.passphrase;a.cert=this.cert;a.ca=this.ca;
a.ciphers=this.ciphers;a.rejectUnauthorized=this.rejectUnauthorized;var c=this.xhr=new d(a),e=this;try{v("xhr open %s: %s",this.method,this.uri);c.open(this.method,this.uri,this.async);try{if(this.extraHeaders){c.setDisableHeaderCheck&&c.setDisableHeaderCheck(!0);for(var h in this.extraHeaders)this.extraHeaders.hasOwnProperty(h)&&c.setRequestHeader(h,this.extraHeaders[h])}}catch(z){}if("POST"===this.method)try{this.isBinary?c.setRequestHeader("Content-type","application/octet-stream"):c.setRequestHeader("Content-type",
"text/plain;charset=UTF-8")}catch(z){}try{c.setRequestHeader("Accept","*/*")}catch(z){}"withCredentials"in c&&(c.withCredentials=!0);this.requestTimeout&&(c.timeout=this.requestTimeout);this.hasXDR()?(c.onload=function(){e.onLoad()},c.onerror=function(){e.onError(c.responseText)}):c.onreadystatechange=function(){if(2===c.readyState){try{var a=c.getResponseHeader("Content-Type")}catch(F){}"application/octet-stream"===a&&(c.responseType="arraybuffer")}4===c.readyState&&(200===c.status||1223===c.status?
e.onLoad():setTimeout(function(){e.onError(c.status)},0))};v("xhr data %s",this.data);c.send(this.data)}catch(z){return void setTimeout(function(){e.onError(z)},0)}b.document&&(this.index=g.requestsCount++,g.requests[this.index]=this)};g.prototype.onSuccess=function(){this.emit("success");this.cleanup()};g.prototype.onData=function(a){this.emit("data",a);this.onSuccess()};g.prototype.onError=function(a){this.emit("error",a);this.cleanup(!0)};g.prototype.cleanup=function(c){if("undefined"!==typeof this.xhr&&
null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=a:this.xhr.onreadystatechange=a,c)try{this.xhr.abort()}catch(u){}b.document&&delete g.requests[this.index];this.xhr=null}};g.prototype.onLoad=function(){try{try{var a=this.xhr.getResponseHeader("Content-Type")}catch(C){}var b="application/octet-stream"===a?this.xhr.response||this.xhr.responseText:this.xhr.responseText}catch(C){this.onError(C)}null!=b&&this.onData(b)};g.prototype.hasXDR=function(){return"undefined"!==typeof b.XDomainRequest&&
!this.xs&&this.enablesXDR};g.prototype.abort=function(){this.cleanup()};g.requestsCount=0;g.requests={};b.document&&(b.attachEvent?b.attachEvent("onunload",l):b.addEventListener&&b.addEventListener("beforeunload",l,!1))}).call(l,function(){return this}())},function(h,l,e){function b(b){var c=b&&b.forceBase64;r&&!c||(this.supportsBinary=!1);a.call(this,b)}var a=e(22),c=e(31),g=e(23);l=e(32);var m=e(33),d=e(3)("engine.io-client:polling");h.exports=b;var r=null!=(new (e(18))({xdomain:!1})).responseType;
l(b,a);b.prototype.name="polling";b.prototype.doOpen=function(){this.poll()};b.prototype.pause=function(a){function b(){d("paused");c.readyState="paused";a()}var c=this;if(this.readyState="pausing",this.polling||!this.writable){var g=0;this.polling&&(d("we are currently polling - waiting to pause"),g++,this.once("pollComplete",function(){d("pre-pause polling complete");--g||b()}));this.writable||(d("we are currently writing - waiting to pause"),g++,this.once("drain",function(){d("pre-pause writing complete");
--g||b()}))}else b()};b.prototype.poll=function(){d("polling");this.polling=!0;this.doPoll();this.emit("poll")};b.prototype.onData=function(a){var b=this;d("polling got data %s",a);g.decodePayload(a,this.socket.binaryType,function(a,c,d){return"opening"===b.readyState&&b.onOpen(),"close"===a.type?(b.onClose(),!1):void b.onPacket(a)});"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():d('ignoring poll - transport state "%s"',this.readyState))};
b.prototype.doClose=function(){function a(){d("writing close packet");b.write([{type:"close"}])}var b=this;"open"===this.readyState?(d("transport open - closing"),a()):(d("transport not open - deferring close"),this.once("open",a))};b.prototype.write=function(a){var b=this;this.writable=!1;var c=function(){b.writable=!0;b.emit("drain")};g.encodePayload(a,this.supportsBinary,function(a){b.doWrite(a,c)})};b.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",d="";!1!==this.timestampRequests&&
(a[this.timestampParam]=m());this.supportsBinary||a.sid||(a.b64=1);a=c.encode(a);this.port&&("https"===b&&443!==Number(this.port)||"http"===b&&80!==Number(this.port))&&(d=":"+this.port);a.length&&(a="?"+a);var g=-1!==this.hostname.indexOf(":");return b+"://"+(g?"["+this.hostname+"]":this.hostname)+d+this.path+a}},function(h,l,e){function b(a){this.path=a.path;this.hostname=a.hostname;this.port=a.port;this.secure=a.secure;this.query=a.query;this.timestampParam=a.timestampParam;this.timestampRequests=
a.timestampRequests;this.readyState="";this.agent=a.agent||!1;this.socket=a.socket;this.enablesXDR=a.enablesXDR;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.forceNode=a.forceNode;this.extraHeaders=a.extraHeaders;this.localAddress=a.localAddress}var a=e(23);l=e(8);h.exports=b;l(b.prototype);b.prototype.onError=function(a,b){a=Error(a);return a.type="TransportError",a.description=b,this.emit("error",
a),this};b.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this};b.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this};b.prototype.send=function(a){if("open"!==this.readyState)throw Error("Transport not open");this.write(a)};b.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};b.prototype.onData=function(b){b=a.decodePacket(b,
this.socket.binaryType);this.onPacket(b)};b.prototype.onPacket=function(a){this.emit("packet",a)};b.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},function(h,l,e){(function(b){function a(a,b,c){if(!b)return l.encodeBase64Packet(a,c);var d=new FileReader;return d.onload=function(){a.data=d.result;l.encodePacket(a,b,!0,c)},d.readAsArrayBuffer(a.data)}function c(a,b,c){var d=Array(a.length);c=q(a.length,c);for(var f=function(a,c,f){b(c,function(b,c){d[a]=c;f(b,d)})},g=0;g<
a.length;g++)f(g,a[g],c)}var g,h=e(24),d=e(9),r=e(25),q=e(26),m=e(27);b&&b.ArrayBuffer&&(g=e(29));var v="undefined"!==typeof navigator&&/Android/i.test(navigator.userAgent),p="undefined"!==typeof navigator&&/PhantomJS/i.test(navigator.userAgent),u=v||p;l.protocol=3;var n=l.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},t=h(n),z={type:"error",data:"parser error"},F=e(30);l.encodePacket=function(c,d,g,e){"function"===typeof d&&(e=d,d=!1);"function"===typeof g&&(e=g,g=null);var f=
void 0===c.data?void 0:c.data.buffer||c.data;if(b.ArrayBuffer&&f instanceof ArrayBuffer){if(d){g=c.data;d=new Uint8Array(g);g=new Uint8Array(1+g.byteLength);g[0]=n[c.type];for(c=0;c<d.length;c++)g[c+1]=d[c];c=e(g.buffer)}else c=l.encodeBase64Packet(c,e);return c}if(F&&f instanceof b.Blob)return d?u?c=a(c,d,e):(d=new Uint8Array(1),d[0]=n[c.type],c=new F([d.buffer,c.data]),c=e(c)):c=l.encodeBase64Packet(c,e),c;if(f&&f.base64)return e("b"+l.packets[c.type]+c.data.data);d=n[c.type];return void 0!==c.data&&
(d+=g?m.encode(String(c.data),{strict:!1}):String(c.data)),e(""+d)};l.encodeBase64Packet=function(a,c){var d="b"+l.packets[a.type];if(F&&a.data instanceof b.Blob){var f=new FileReader;return f.onload=function(){var a=f.result.split(",")[1];c(d+a)},f.readAsDataURL(a.data)}try{var g=String.fromCharCode.apply(null,new Uint8Array(a.data))}catch(J){a=new Uint8Array(a.data);g=Array(a.length);for(var e=0;e<a.length;e++)g[e]=a[e];g=String.fromCharCode.apply(null,g)}return d+=b.btoa(g),c(d)};l.decodePacket=
function(a,b,c){if(void 0===a)return z;if("string"===typeof a){if("b"===a.charAt(0))return l.decodeBase64Packet(a.substr(1),b);if(b=c){b=a;try{b=m.decode(b,{strict:!1})}catch(P){b=!1}b=(a=b,!1===a)}if(b)return z;c=a.charAt(0);return Number(c)==c&&t[c]?1<a.length?{type:t[c],data:a.substring(1)}:{type:t[c]}:z}c=(new Uint8Array(a))[0];a=r(a,1);return F&&"blob"===b&&(a=new F([a])),{type:t[c],data:a}};l.decodeBase64Packet=function(a,b){var c=t[a.charAt(0)];if(!g)return{type:c,data:{base64:!0,data:a.substr(1)}};
a=g.decode(a.substr(1));return"blob"===b&&F&&(a=new F([a])),{type:c,data:a}};l.encodePayload=function(a,b,g){function f(a,c){l.encodePacket(a,!!e&&b,!1,function(a){c(null,a.length+":"+a)})}"function"===typeof b&&(g=b,b=null);var e=d(a);return b&&e?F&&!u?l.encodePayloadAsBlob(a,g):l.encodePayloadAsArrayBuffer(a,g):a.length?void c(a,f,function(a,b){return g(b.join(""))}):g("0:")};l.decodePayload=function(a,b,c){if("string"!==typeof a)return l.decodePayloadAsBinary(a,b,c);"function"===typeof b&&(c=b,
b=null);var d;if(""===a)return c(z,0,1);for(var f,g,e="",k=0,h=a.length;k<h;k++){var p=a.charAt(k);if(":"===p){if(""===e||e!=(f=Number(e))||(g=a.substr(k+1,f),e!=g.length))return c(z,0,1);if(g.length){if(d=l.decodePacket(g,b,!1),z.type===d.type&&z.data===d.data)return c(z,0,1);if(!1===c(d,k+f,h))return}k+=f;e=""}else e+=p}return""!==e?c(z,0,1):void 0};l.encodePayloadAsArrayBuffer=function(a,b){function d(a,b){l.encodePacket(a,!0,!0,function(a){return b(null,a)})}return a.length?void c(a,d,function(a,
c){a=c.reduce(function(a,b){var c;return c="string"===typeof b?b.length:b.byteLength,a+c.toString().length+c+2},0);var d=new Uint8Array(a),f=0;return c.forEach(function(a){var b="string"===typeof a,c=a;if(b){c=new Uint8Array(a.length);for(var g=0;g<a.length;g++)c[g]=a.charCodeAt(g);c=c.buffer}b?d[f++]=0:d[f++]=1;a=c.byteLength.toString();for(g=0;g<a.length;g++)d[f++]=parseInt(a[g]);d[f++]=255;c=new Uint8Array(c);for(g=0;g<c.length;g++)d[f++]=c[g]}),b(d.buffer)}):b(new ArrayBuffer(0))};l.encodePayloadAsBlob=
function(a,b){c(a,function(a,b){l.encodePacket(a,!0,!0,function(a){var c=new Uint8Array(1);if(c[0]=1,"string"===typeof a){for(var d=new Uint8Array(a.length),f=0;f<a.length;f++)d[f]=a.charCodeAt(f);a=d.buffer;c[0]=0}d=(a instanceof ArrayBuffer?a.byteLength:a.size).toString();var g=new Uint8Array(d.length+1);for(f=0;f<d.length;f++)g[f]=parseInt(d[f]);if(g[d.length]=255,F)a=new F([c.buffer,g.buffer,a]),b(null,a)})},function(a,c){return b(new F(c))})};l.decodePayloadAsBinary=function(a,b,c){"function"===
typeof b&&(c=b,b=null);for(var d=[];0<a.byteLength;){for(var f=new Uint8Array(a),g=0===f[0],e="",k=1;255!==f[k];k++){if(310<e.length)return c(z,0,1);e+=f[k]}a=r(a,2+e.length);e=parseInt(e);f=r(a,0,e);if(g)try{f=String.fromCharCode.apply(null,new Uint8Array(f))}catch(aa){for(g=new Uint8Array(f),f="",k=0;k<g.length;k++)f+=String.fromCharCode(g[k])}d.push(f);a=r(a,e)}var h=d.length;d.forEach(function(a,d){c(l.decodePacket(a,b,!0),d,h)})}}).call(l,function(){return this}())},function(h,l){h.exports=Object.keys||
function(e){var b=[],a=Object.prototype.hasOwnProperty,c;for(c in e)a.call(e,c)&&b.push(c);return b}},function(h,l){h.exports=function(e,b,a){var c=e.byteLength;if(b=b||0,a=a||c,e.slice)return e.slice(b,a);if(0>b&&(b+=c),0>a&&(a+=c),a>c&&(a=c),b>=c||b>=a||0===c)return new ArrayBuffer(0);e=new Uint8Array(e);c=new Uint8Array(a-b);for(var g=0;b<a;b++,g++)c[g]=e[b];return c.buffer}},function(h,l){function e(){}h.exports=function(b,a,c){function g(b,e){if(0>=g.count)throw Error("after called too many times");
--g.count;b?(h=!0,a(b),a=c):0!==g.count||h||a(null,e)}var h=!1;return c=c||e,g.count=b,0===b?a():g}},function(h,l,e){var b;(function(a,c){!function(c){function g(a){for(var b,c,d=[],f=0,g=a.length;f<g;)b=a.charCodeAt(f++),55296<=b&&56319>=b&&f<g?(c=a.charCodeAt(f++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),f--)):d.push(b);return d}function d(a,b){if(55296<=a&&57343>=a){if(b)throw Error("Lone surrogate U+"+a.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}
function e(){if(p>=v)throw Error("Invalid byte index");var a=255&m[p];if(p++,128==(192&a))return 63&a;throw Error("Invalid continuation byte");}function h(a){var b,c,g,f,h;if(p>v)throw Error("Invalid byte index");if(p==v)return!1;if(b=255&m[p],p++,0==(128&b))return b;if(192==(224&b)){if(c=e(),h=(31&b)<<6|c,128<=h)return h;throw Error("Invalid continuation byte");}if(224==(240&b)){if(c=e(),g=e(),h=(15&b)<<12|c<<6|g,2048<=h)return d(h,a)?h:65533;throw Error("Invalid continuation byte");}if(240==(248&
b)&&(c=e(),g=e(),f=e(),h=(7&b)<<18|c<<12|g<<6|f,65536<=h&&1114111>=h))return h;throw Error("Invalid UTF-8 detected");}c="object"===typeof l&&l;"object"===typeof a&&a&&a.exports==c&&a;var m,v,p,u=String.fromCharCode;b={version:"2.1.2",encode:function(a,b){b=b||{};b=!1!==b.strict;a=g(a);for(var c=a.length,e=-1,f="";++e<c;){var h=a[e];var p=b;if(0==(4294967168&h))p=u(h);else{var q="";p=(0==(4294965248&h)?q=u(h>>6&31|192):0==(4294901760&h)?(d(h,p)||(h=65533),q=u(h>>12&15|224),q+=u(h>>6&63|128)):0==(4292870144&
h)&&(q=u(h>>18&7|240),q+=u(h>>12&63|128),q+=u(h>>6&63|128)),q+u(63&h|128))}f+=p}return f},decode:function(a,b){b=b||{};b=!1!==b.strict;m=g(a);v=m.length;p=0;var c;for(a=[];!1!==(c=h(b));)a.push(c);c=a.length;for(var d=-1,f="";++d<c;)b=a[d],65535<b&&(b-=65536,f+=u(b>>>10&1023|55296),b=56320|1023&b),f+=u(b);return f}};!(void 0!==b&&(a.exports=b))}(this)}).call(l,e(28)(h),function(){return this}())},function(h,l){h.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=
[],e.webpackPolyfill=1),e}},function(h,l){!function(){for(var e=new Uint8Array(256),b=0;64>b;b++)e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(b)]=b;l.encode=function(a){var b=new Uint8Array(a),g=b.length,e="";for(a=0;a<g;a+=3)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[b[a]>>2],e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&b[a])<<4|b[a+1]>>4],e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&
b[a+1])<<2|b[a+2]>>6],e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&b[a+2]];return 2===g%3?e=e.substring(0,e.length-1)+"=":1===g%3&&(e=e.substring(0,e.length-2)+"=="),e};l.decode=function(a){var b=.75*a.length;var g=a.length,h=0;"="===a[a.length-1]&&(b--,"="===a[a.length-2]&&b--);var d=new ArrayBuffer(b),l=new Uint8Array(d);for(b=0;b<g;b+=4){var q=e[a.charCodeAt(b)];var m=e[a.charCodeAt(b+1)];var v=e[a.charCodeAt(b+2)];var p=e[a.charCodeAt(b+3)];l[h++]=q<<2|m>>4;l[h++]=
(15&m)<<4|v>>2;l[h++]=(3&v)<<6|63&p}return d}}()},function(h,l){(function(e){function b(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.buffer instanceof ArrayBuffer){var d=c.buffer;if(c.byteLength!==d.byteLength){var g=new Uint8Array(c.byteLength);g.set(new Uint8Array(d,c.byteOffset,c.byteLength));d=g.buffer}a[b]=d}}}function a(a,c){c=c||{};var d=new g;b(a);for(var e=0;e<a.length;e++)d.append(a[e]);return c.type?d.getBlob(c.type):d.getBlob()}function c(a,c){return b(a),new Blob(a,c||{})}var g=e.BlobBuilder||
e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder;try{var l=2===(new Blob(["hi"])).size}catch(q){l=!1}var d;if(d=l)try{d=2===(new Blob([new Uint8Array([1,2])])).size}catch(q){d=!1}var r=g&&g.prototype.append&&g.prototype.getBlob;h.exports=l?d?e.Blob:c:r?a:void 0}).call(l,function(){return this}())},function(h,l){l.encode=function(e){var b="",a;for(a in e)e.hasOwnProperty(a)&&(b.length&&(b+="&"),b+=encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return b};l.decode=function(e){var b={};e=e.split("&");
for(var a=0,c=e.length;a<c;a++){var g=e[a].split("=");b[decodeURIComponent(g[0])]=decodeURIComponent(g[1])}return b}},function(h,l){h.exports=function(e,b){var a=function(){};a.prototype=b.prototype;e.prototype=new a;e.prototype.constructor=e}},function(h,l){function e(a){var b="";do b=c[a%g]+b,a=Math.floor(a/g);while(0<a);return b}function b(){var b=e(+new Date);return b!==a?(d=0,a=b):b+"."+e(d++)}for(var a,c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),g=64,m={},
d=0,r=0;r<g;r++)m[c[r]]=r;b.encode=e;b.decode=function(a){var b=0;for(r=0;r<a.length;r++)b=b*g+m[a.charAt(r)];return b};h.exports=b},function(h,l,e){(function(b){function a(){}function c(c){g.call(this,c);this.query=this.query||{};d||(b.___eio||(b.___eio=[]),d=b.___eio);this.index=d.length;var e=this;d.push(function(a){e.onData(a)});this.query.j=this.index;b.document&&b.addEventListener&&b.addEventListener("beforeunload",function(){e.script&&(e.script.onerror=a)},!1)}var g=e(21),l=e(32);h.exports=
c;var d,r=/\n/g,q=/\\n/g;l(c,g);c.prototype.supportsBinary=!1;c.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null);g.prototype.doClose.call(this)};c.prototype.doPoll=function(){var a=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);b.async=!0;b.src=this.uri();b.onerror=function(b){a.onError("jsonp poll error",
b)};var c=document.getElementsByTagName("script")[0];c?c.parentNode.insertBefore(b,c):(document.head||document.body).appendChild(b);this.script=b;"undefined"!==typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a);document.body.removeChild(a)},100)};c.prototype.doWrite=function(a,b){function c(){d();b()}function d(){if(g.iframe)try{g.form.removeChild(g.iframe)}catch(O){g.onError("jsonp polling iframe removal error",
O)}try{e=document.createElement('<iframe src="javascript:0" name="'+g.iframeId+'">')}catch(O){e=document.createElement("iframe"),e.name=g.iframeId,e.src="javascript:0"}e.id=g.iframeId;g.form.appendChild(e);g.iframe=e}var g=this;if(!this.form){var e,h=document.createElement("form"),l=document.createElement("textarea"),f=this.iframeId="eio_iframe_"+this.index;h.className="socketio";h.style.position="absolute";h.style.top="-1000px";h.style.left="-1000px";h.target=f;h.method="POST";h.setAttribute("accept-charset",
"utf-8");l.name="d";h.appendChild(l);document.body.appendChild(h);this.form=h;this.area=l}this.form.action=this.uri();d();a=a.replace(q,"\\\n");this.area.value=a.replace(r,"\\n");try{this.form.submit()}catch(O){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===g.iframe.readyState&&c()}:this.iframe.onload=c}}).call(l,function(){return this}())},function(h,l,e){(function(b){function a(a){a&&a.forceBase64&&(this.supportsBinary=!1);this.perMessageDeflate=a.perMessageDeflate;
this.usingBrowserWebSocket=m&&!a.forceNode;this.protocols=a.protocols;this.usingBrowserWebSocket||(p=v);c.call(this,a)}var c=e(22),g=e(23),l=e(31),d=e(32),r=e(33),q=e(3)("engine.io-client:websocket"),m=b.WebSocket||b.MozWebSocket;if("undefined"===typeof window)try{var v=e(36)}catch(u){}var p=m;p||"undefined"!==typeof window||(p=v);h.exports=a;d(a,c);a.prototype.name="websocket";a.prototype.supportsBinary=!0;a.prototype.doOpen=function(){if(this.check()){var a=this.uri(),b=this.protocols,c={agent:this.agent,
perMessageDeflate:this.perMessageDeflate};c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;this.extraHeaders&&(c.headers=this.extraHeaders);this.localAddress&&(c.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?b?new p(a,b):new p(a):new p(a,b,c)}catch(z){return this.emit("error",z)}void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.supports&&this.ws.supports.binary?
(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer";this.addEventListeners()}};a.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()};this.ws.onclose=function(){a.onClose()};this.ws.onmessage=function(b){a.onData(b.data)};this.ws.onerror=function(b){a.onError("websocket error",b)}};a.prototype.write=function(a){function c(){d.emit("flush");setTimeout(function(){d.writable=!0;d.emit("drain")},0)}var d=this;this.writable=!1;for(var e=
a.length,h=0,f=e;h<f;h++)!function(a){g.encodePacket(a,d.supportsBinary,function(g){if(!d.usingBrowserWebSocket){var f={};(a.options&&(f.compress=a.options.compress),d.perMessageDeflate)&&("string"===typeof g?b.Buffer.byteLength(g):g.length)<d.perMessageDeflate.threshold&&(f.compress=!1)}try{d.usingBrowserWebSocket?d.ws.send(g):d.ws.send(g,f)}catch(I){q("websocket closed before onclose event")}--e||c()})}(a[h])};a.prototype.onClose=function(){c.prototype.onClose.call(this)};a.prototype.doClose=function(){"undefined"!==
typeof this.ws&&this.ws.close()};a.prototype.uri=function(){var a=this.query||{},b=this.secure?"wss":"ws",c="";this.port&&("wss"===b&&443!==Number(this.port)||"ws"===b&&80!==Number(this.port))&&(c=":"+this.port);this.timestampRequests&&(a[this.timestampParam]=r());this.supportsBinary||(a.b64=1);a=l.encode(a);a.length&&(a="?"+a);var d=-1!==this.hostname.indexOf(":");return b+"://"+(d?"["+this.hostname+"]":this.hostname)+c+this.path+a};a.prototype.check=function(){return!(!p||"__initialize"in p&&this.name===
a.prototype.name)}}).call(l,function(){return this}())},function(h,l){},function(h,l){var e=[].indexOf;h.exports=function(b,a){if(e)return b.indexOf(a);for(var c=0;c<b.length;++c)if(b[c]===a)return c;return-1}},function(h,l){(function(e){var b=/^[\],:{}\s]*$/,a=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,c=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,g=/(?:^|:|,)(?:\s*\[)+/g,l=/^\s+/,d=/\s+$/;h.exports=function(h){return"string"===typeof h&&h?(h=h.replace(l,"").replace(d,""),e.JSON&&
JSON.parse?JSON.parse(h):b.test(h.replace(a,"@").replace(c,"]").replace(g,""))?(new Function("return "+h))():void 0):null}}).call(l,function(){return this}())},function(h,l,e){function b(a,b,c){this.io=a;this.nsp=b;this.json=this;this.ids=0;this.acks={};this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0;c&&c.query&&(this.query=c.query);this.io.autoConnect&&this.open()}$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&
"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},c=e(7);l=e(8);var g=e(40),m=e(41),d=e(42),r=e(3)("socket.io-client:socket"),q=e(31);h.exports=b;var n={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,
ping:1,pong:1},v=l.prototype.emit;l(b.prototype);b.prototype.subEvents=function(){if(!this.subs){var a=this.io;this.subs=[m(a,"open",d(this,"onopen")),m(a,"packet",d(this,"onpacket")),m(a,"close",d(this,"onclose"))]}};b.prototype.open=b.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)};b.prototype.send=function(){var a=g(arguments);return a.unshift("message"),this.emit.apply(this,a),this};
b.prototype.emit=function(a){if(n.hasOwnProperty(a))return v.apply(this,arguments),this;var b=g(arguments),d={type:c.EVENT,data:b};return d.options={},d.options.compress=!this.flags||!1!==this.flags.compress,"function"===typeof b[b.length-1]&&(r("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),d.id=this.ids++),this.connected?this.packet(d):this.sendBuffer.push(d),delete this.flags,this};b.prototype.packet=function(a){a.nsp=this.nsp;this.io.packet(a)};b.prototype.onopen=function(){if(r("transport is open - connecting"),
"/"!==this.nsp)if(this.query){var b="object"===a(this.query)?q.encode(this.query):this.query;r("sending connect packet with query %s",b);this.packet({type:c.CONNECT,query:b})}else this.packet({type:c.CONNECT})};b.prototype.onclose=function(a){r("close (%s)",a);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",a)};b.prototype.onpacket=function(a){if(a.nsp===this.nsp)switch(a.type){case c.CONNECT:this.onconnect();break;case c.EVENT:this.onevent(a);break;case c.BINARY_EVENT:this.onevent(a);
break;case c.ACK:this.onack(a);break;case c.BINARY_ACK:this.onack(a);break;case c.DISCONNECT:this.ondisconnect();break;case c.ERROR:this.emit("error",a.data)}};b.prototype.onevent=function(a){var b=a.data||[];r("emitting event %j",b);null!=a.id&&(r("attaching ack callback to event"),b.push(this.ack(a.id)));this.connected?v.apply(this,b):this.receiveBuffer.push(b)};b.prototype.ack=function(a){var b=this,d=!1;return function(){if(!d){d=!0;var e=g(arguments);r("sending ack %j",e);b.packet({type:c.ACK,
id:a,data:e})}}};b.prototype.onack=function(a){var b=this.acks[a.id];"function"===typeof b?(r("calling ack %s with %j",a.id,a.data),b.apply(this,a.data),delete this.acks[a.id]):r("bad ack %s",a.id)};b.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};b.prototype.emitBuffered=function(){var a;for(a=0;a<this.receiveBuffer.length;a++)v.apply(this,this.receiveBuffer[a]);this.receiveBuffer=[];for(a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);
this.sendBuffer=[]};b.prototype.ondisconnect=function(){r("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};b.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)};b.prototype.close=b.prototype.disconnect=function(){return this.connected&&(r("performing disconnect (%s)",this.nsp),this.packet({type:c.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),
this};b.prototype.compress=function(a){return this.flags=this.flags||{},this.flags.compress=a,this}},function(h,l){h.exports=function(e,b){for(var a=[],c=(b=b||0)||0;c<e.length;c++)a[c-b]=e[c];return a}},function(h,l){h.exports=function(e,b,a){return e.on(b,a),{destroy:function(){e.removeListener(b,a)}}}},function(h,l){var e=[].slice;h.exports=function(b,a){if("string"===typeof a&&(a=b[a]),"function"!==typeof a)throw Error("bind() requires a function");var c=e.call(arguments,2);return function(){return a.apply(b,
c.concat(e.call(arguments)))}}},function(h,l){function e(b){b=b||{};this.ms=b.min||100;this.max=b.max||1E4;this.factor=b.factor||2;this.jitter=0<b.jitter&&1>=b.jitter?b.jitter:0;this.attempts=0}h.exports=e;e.prototype.duration=function(){var b=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var a=Math.random(),c=Math.floor(a*this.jitter*b);b=0==(1&Math.floor(10*a))?b-c:b+c}return 0|Math.min(b,this.max)};e.prototype.reset=function(){this.attempts=0};e.prototype.setMin=function(b){this.ms=
b};e.prototype.setMax=function(b){this.max=b};e.prototype.setJitter=function(b){this.jitter=b}}])})},function(m,t,n){var h=n(2),l=n(43);m=n(1);var e=n.n(m);t.a=function(b){var a=Object(h.a)({});a.id=b.id;a.stream=b.stream.stream;a.elementID=b.elementID;var c=b.stream.getPlayerId(b.vroom?b.vroom:b.stream.room);a.audio=document.createElement("audio");a.audio.setAttribute("id",""+c.stream);a.audio.setAttribute("class","vcx_stream");a.audio.setAttribute("style","width: 100%; height: 100%; position: absolute");
a.audio.setAttribute("autoplay","autoplay");b.stream.local&&(a.audio.volume=0);void 0!==a.elementID?(a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.div)},a.div=document.createElement("div"),a.div.setAttribute("id",""+c.player),a.div.setAttribute("class","vcx_player"),a.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),a.container="object"===typeof a.elementID&&"function"===typeof a.elementID.appendChild?a.elementID:document.getElementById(a.elementID),
a.container.appendChild(a.div),a.parentNode=a.div.parentNode,a.div.appendChild(a.audio),!1!==b.options.bar?(a.bar=Object(l.a)({elementID:""+c.player,id:a.id,stream:b.stream,media:a.audio,options:b.options}),a.div.onmouseover=void 0,a.div.onmouseout=void 0):a.media=a.audio):(a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.audio)},document.body.appendChild(a.audio),a.parentNode=document.body);var g=void 0,m=b=void 0,d=c=void 0,r=void 0;e.a.csp_enabled||(g=document.createElement("div"),
g.setAttribute("id","stats-container-"+a.id),g.setAttribute("class","stats-container"),g.setAttribute("style","display:none;"),b=document.createElement("div"),b.setAttribute("id","stats-button-"+a.id),b.setAttribute("class","stats-button"),b.setAttribute("title","Click to see stats"),b.innerHTML=window.statsIcon,g.appendChild(b),m=document.createElement("div"),m.setAttribute("class","stats-overlay"),m.setAttribute("id","stats-overlay-"+a.id),m.setAttribute("style","display:none;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);"),
c=document.createElement("div"),c.setAttribute("class","stats-overlay-inner"),c.setAttribute("id","stats-overlay-inner-"+a.id),d=document.createElement("div"),r=document.createElement("div"),d.setAttribute("class","stats-left-partition"),d.setAttribute("id","stats-left-part-"+a.id),r.setAttribute("class","stats-right-partition"),r.setAttribute("id","stats-right-part-"+a.id),b.addEventListener("click",function(){m.style.display="none"===m.style.display?"block":"none"}),a.div.parentNode.style.position=
"relative",a.div.parentNode.appendChild(g),a.div.parentNode.appendChild(m),m.appendChild(c),c.appendChild(d),c.appendChild(r));a.audio.srcObject=a.stream;a.ShowSessionStats=function(a){a?(g.setAttribute("style","display:block;"),m.setAttribute("style","display:block;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);")):(g.setAttribute("style","display:none;"),m.setAttribute("style","display:none;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);"))};
return a}},function(m,t,n){var h=n(15),l=n(2),e=n(3),b=n(44),a=n(45),c=n(46),g=n(47),w=n(48),d=n(49),r=n(50),q=n(10);t.a=function(m){var v=Object(l.a)({});var p=Object(h.a)().toolbar.default;var u=!1;void 0!==m.options&&void 0!==m.options.player&&(v.playerProperties=m.options.player);if(m.options.toolbar){var n=m.options.toolbar;e.a.checkParam(n.position)&&(p.position=n.position);e.a.checkParam(n.class)&&(p.class=n.class);e.a.checkParam(n.skin)&&(p.skin=n.skin,u="default"===p.skin);e.a.checkParam(n.displayMode);
p.displayMode=n.displayMode;e.a.checkParam(n.autoDisplayTimeout)&&(p.autoDisplayTimeout=n.autoDisplayTimeout);n.buttons&&(p.buttons=n.buttons)}v.elementID=m.elementID;v.id=m.id;v.div=u?Object(e.a)({name:"div",id:"bar_"+v.id,class:"vcx_bar",style:q.a.vcx_bar}):Object(e.a)({name:"div",id:"bar_"+v.id,class:"vcx_bar "+p.skin+"_vcx_bar"});e.a.getById(v.elementID).appendChild(v.div);v.bar=u?Object(e.a)({name:"div",id:"subbar_"+v.id,class:"vcx_subbar "+p.class,style:q.a["vcx_subbar_"+p.position]}):Object(e.a)({name:"div",
id:"subbar_"+v.id,class:"vcx_subbar "+p.skin+"_vcx_subbar_"+p.position+" "+p.class});v.div.appendChild(v.bar);(function(a){function b(a){a=a||window.event;h=a.clientX;l=a.clientY;document.onmouseup=d;document.onmousemove=c}function c(b){b=b||window.event;g=h-b.clientX;e=l-b.clientY;h=b.clientX;l=b.clientY;a.style.top=a.offsetTop-e+"px";a.style.left=a.offsetLeft-g+"px"}function d(){document.onmouseup=null;document.onmousemove=null}var g=0,e=0,h=0,l=0;document.getElementById(a.id)?document.getElementById(a.id).onmousedown=
b:a.onmousedown=b})(v.bar);p.buttons.play&&(v.playIcon=Object(d.a)({stream:m.stream,skin:p.skin}),v.bar.appendChild(v.playIcon));p.buttons.zoom&&(v.zoomIcon=Object(a.a)({skin:p.skin,player:v.playerProperties}),v.bar.appendChild(v.zoomIcon));p.buttons.record&&(v.recIcon=Object(g.a)({skin:p.skin,stream:m.stream}),v.bar.appendChild(v.recIcon));p.buttons.share&&(v.shareIcon=Object(w.a)({skin:p.skin,stream:m.stream}),v.bar.appendChild(v.shareIcon));p.buttons.mic&&(v.micIcon=Object(r.a)({skin:p.skin,stream:m.stream}),
v.bar.appendChild(v.micIcon));u={};m.options&&m.options.toolbar&&m.options.toolbar.branding&&(u=m.options.toolbar.branding);u.skin=p.skin;v.brand=Object(c.a)(u);v.bar.appendChild(v.brand);!p.buttons.volume||m.stream.screen||void 0!==m.options&&void 0!==m.options.speaker&&!0!==m.options.speaker||(v.speaker=Object(b.a)({elementID:"subbar_"+v.id,id:v.id,stream:m.stream,media:m.media,position:p.position,skin:p.skin}));p.displayMode?"auto"==p.displayMode?(v.div.onmouseover=function(a){var b=a.currentTarget;
setTimeout(function(){e.a.getByClass("vcx_subbar",b).style.display="block"},1E3*parseInt(p.autoDisplayTimeout))},v.div.onmouseout=function(a){var b=a.currentTarget;setTimeout(function(){e.a.getByClass("vcx_subbar",b).style.display="none"},1E3*parseInt(p.autoDisplayTimeout))},e.a.getByClass("vcx_subbar",v.div).style.display="none"):e.a.getByClass("vcx_subbar",v.div).style.display="block":e.a.getByClass("vcx_subbar",v.div).style.display="none";return v}},function(m,t,n){var h=n(3),l=n(2),e=n(10);t.a=
function(b){var a=Object(l.a)({}),c=50,g="default"===b.skin;a.elementID=b.elementID;a.media=b.media;a.id=b.id;a.stream=b.stream;a.div=g?Object(h.a)({name:"i",class:"fa fa-volume-up fa-fw fa-lg",style:Object.assign(e.a.icon,e.a.icon_volume),id:"volume_"+a.id}):Object(h.a)({name:"i",class:"fa fa-volume-up fa-fw fa-lg "+b.skin+"_icon "+b.skin+"_icon_volume",id:"volume_"+a.id});h.a.setStyle(a.div,b.position,"0");a.div.onclick=function(){a.media.muted?(a.media.muted=!1,a.div.classList.remove("fa-volume-off"),
a.div.classList.add("fa-volume-up"),a.stream.local?a.stream.stream.getAudioTracks()[0].enabled=!0:(a.picker.value=c,a.media.volume=a.picker.value/100)):(a.media.muted=!0,a.div.classList.remove("fa-volume-up"),a.div.classList.add("fa-volume-off"),a.stream.local?a.stream.stream.getAudioTracks()[0].enabled=!1:(c=a.picker.value,a.picker.value=0,a.media.volume=0))};if(!a.stream.local){a.picker=document.createElement("input");a.picker.setAttribute("id","picker_"+a.id);a.picker.setAttribute("style","position: absolute;max-width: 50px;margin: 1.1%;top:0;");
a.picker.type="range";a.picker.min=0;a.picker.max=1;a.picker.step=.1;a.picker.value=c;a.picker.setAttribute("orient","vertical");a.div.appendChild(a.picker);a.media.volume=a.picker.value;a.media.muted=!1;a.picker.onclick=function(){0<a.picker.value?(a.media.muted=!1,a.div.classList.remove("fa-volume-off"),a.div.classList.add("fa-volume-up")):(a.media.muted=!0,a.div.classList.remove("fa-volume-up"),a.div.classList.add("fa-volume-off"));a.media.volume=a.picker.value};var m=function(b){a.picker.setAttribute("style",
"position: absolute;max-width: 50px;margin: 1.1%;margin-left:32px;top:0;display: "+b)};a.div.onmouseover=function(){m("block")};a.picker.onmouseout=function(){m("none")};m("none")}document.getElementById(a.elementID).appendChild(a.div);return a}},function(m,t,n){var h=n(3);n(2);var l=n(10),e=!1,b=function(a){var c=(e="default"===a.skin)?Object(h.a)({name:"i",title:"zoom",class:"fa fa-expand  fa-lg icon_zoom ",style:Object.assign(l.a.icon,l.a.icon_zoom)}):Object(h.a)({name:"i",title:"zoom",class:"fa fa-expand icon_zoom "+
a.skin+"_icon fa-lg "+a.skin+"_icon_zoom"});c.onclick=function(c){c.stopPropagation();b.click(c,a)};return c};b.click=function(a,b){var c=b.skin;b={height:b.player.height,width:b.player.width,position:"relative"};var m=a.currentTarget.classList;m.contains("fa-expand")?(a.currentTarget.classList.remove("fa-expand"),a.currentTarget.classList.add("fa-arrows-alt"),e?a.currentTarget.parentNode.parentNode.parentNode.parentNode.setAttribute("style",h.a.getStyle(l.a.full_view)):a.currentTarget.parentNode.parentNode.parentNode.classList.add(c+
"_theater_view")):m.contains("fa-arrows-alt")?(a.currentTarget.classList.remove("fa-arrows-alt"),a.currentTarget.classList.add("fa-compress"),e?(a.currentTarget.parentNode.parentNode.parentNode.parentNode.removeAttribute("style"),a.currentTarget.parentNode.parentNode.parentNode.parentNode.setAttribute("style",h.a.getStyle(l.a.full_view))):(a.currentTarget.parentNode.parentNode.parentNode.parentNode.classList.remove(c+"_theater_view"),a.currentTarget.parentNode.parentNode.parentNode.parentNode.classList.add(c+
"_full_view"))):m.contains("fa-compress")&&(a.currentTarget.classList.remove("fa-compress"),a.currentTarget.classList.add("fa-expand"),e?(a.currentTarget.parentNode.parentNode.parentNode.parentNode.removeAttribute("style"),a.currentTarget.parentNode.parentNode.parentNode.parentNode.setAttribute("style",h.a.getStyle(b))):a.currentTarget.parentNode.parentNode.parentNode.classList.remove(c+"_full_view"))};t.a=b},function(m,t,n){var h=n(15),l=n(3),e=n(2),b=n(10);t.a=function(a){Object(e.a)({});var c=
!1,g=Object(h.a)().brand.default;a&&(l.a.checkParam(a.clickthru)&&(g.url=a.clickthru),a.target&&"current"==a.target&&(g.target="_self"),l.a.checkParam(a.logo)&&(g.logo=a.logo),l.a.checkParam(a.title)&&(g.title=a.title),void 0!==a.display&&(g.display=a.display),c="default"===a.skin);var m=Object(l.a)({name:"a",title:g.title,href:g.url,target:g.target});a=c?Object(l.a)({name:"img",src:g.logo,style:b.a.brand_logo}):Object(l.a)({name:"img",class:a.skin+"_brand_logo",src:g.logo});m.appendChild(a);l.a.checkParam(g.display)||
(m.style.display="none");return m}},function(m,t,n){var h=n(3),l=n(2),e=function(b){Object(l.a)({});var a=Object(h.a)({name:"i",title:"record",class:"fa fa-circle fa-fw fa-lg icon_record "+b.skin+"_icon "+b.skin+"_icon_record"});a.onclick=function(a){e.click(a,b.stream)};return a};e.click=function(b,a){var c=b.currentTarget.classList;c.contains("fa-circle")?(b.currentTarget.classList.remove("fa-circle"),b.currentTarget.classList.add("fa-stop-circle"),a.local||a.room.startRecording(a,function(a){})):
c.contains("fa-stop-circle")&&(b.currentTarget.classList.remove("fa-stop-circle"),b.currentTarget.classList.add("fa-circle"),a.recordingId&&a.room.stopRecording(a.recordingId,function(b){b&&(a.recordingId=void 0)}))};t.a=e},function(m,t,n){var h=n(3),l=n(2),e=function(b){Object(l.a)({});var a=b.stream;b=Object(h.a)({name:"i",title:"share screen",class:"fa fa-share-alt fa-fw fa-lg icon_share "+b.skin+"_icon "+b.skin+"_icon_share"});b.onclick=function(b){e.click(b,a)};return b};e.click=function(b,a){var c=
VcxRtc.Stream({screen:!0,data:!0,attributes:{name:"shareStream"}});c.init();c.addEventListener("media-access-allowed",function(){a.room.publish(c,{maxVideoBW:300},function(a,b){})});c.addEventListener("media-access-denied",function(a){})};t.a=e},function(m,t,n){var h=n(3),l=n(2);n(11);var e=n(10),b=function(a){Object(l.a)({});a="default"===a.skin?Object(h.a)({name:"i",title:"pause",class:"fa fa-pause fa-lg icon_play",style:Object.assign(e.a.icon,e.a.icon_play)}):Object(h.a)({name:"i",title:"pause",
class:"fa fa-pause fa-lg "+a.skin+"_icon icon_play "+a.skin+"_icon_play"});a.onclick=function(a){b.click(a)};return a};b.toggleVideo=function(a){a.srcObject.getTracks().forEach(function(a){return a.enabled=!a.enabled})};b.click=function(a){var c=a.currentTarget.classList;c.contains("fa-pause")?(a.currentTarget.classList.remove("fa-pause"),a.currentTarget.classList.add("fa-play"),c=a.currentTarget.parentNode.parentNode.parentNode,a=h.a.getById("stream"+c.id.split("_")[1]),c=h.a.getById("screen_saver_"+
c.id.split("_")[1]),b.toggleVideo(a),""!==c.src?c.style.display="block":a.pause()):c.contains("fa-play")&&(a.currentTarget.classList.remove("fa-play"),a.currentTarget.classList.add("fa-pause"),c=a.currentTarget.parentNode.parentNode.parentNode,a=h.a.getById("stream"+c.id.split("_")[1]),c=h.a.getById("screen_saver_"+c.id.split("_")[1]),b.toggleVideo(a),""!==c.src?c.style.display="none":a.play())};t.a=b},function(m,t,n){var h=n(3),l=n(2),e=n(10),b=function(a){Object(l.a)({});var c="default"===a.skin;
var g=a.stream;a=c?Object(h.a)({name:"i",title:"microphone",class:"fa fa-microphone fa-fw fa-lg icon_mic",style:Object.assign(e.a.icon,e.a.icon_mic)}):Object(h.a)({name:"i",title:"microphone",class:"fa fa-microphone fa-fw fa-lg icon_mic "+a.skin+"_icon "+a.skin+"_icon_mic"});a.onclick=function(a){b.click(a,g)};return a};b.click=function(a,b){var c=a.currentTarget.classList;c.contains("fa-microphone")?(b.muteAudio(),a.currentTarget.classList.remove("fa-microphone"),a.currentTarget.classList.add("fa-microphone-slash")):
c.contains("fa-microphone-slash")&&(b.unmuteAudio(),a.currentTarget.classList.remove("fa-microphone-slash"),a.currentTarget.classList.add("fa-microphone"))};t.a=b},function(m,t,n){(function(h){h=function(){var h="undefined"!==typeof document&&document.currentScript?document.currentScript.src:void 0;return function(e){function b(a){return e.locateFile?e.locateFile(a,t):t+a}function a(a,b){0<a%b&&(a+=b-a%b);return a}function c(a){k=a;e.HEAP8=new Int8Array(a);e.HEAP16=new Int16Array(a);e.HEAP32=H=new Int32Array(a);
e.HEAPU8=I=new Uint8Array(a);e.HEAPU16=new Uint16Array(a);e.HEAPU32=new Uint32Array(a);e.HEAPF32=new Float32Array(a);e.HEAPF64=new Float64Array(a)}function g(a){for(;0<a.length;){var b=a.shift();if("function"==typeof b)b(e);else{var c=b.func;"number"===typeof c?void 0===b.arg?e.dynCall_v(c):e.dynCall_vi(c,b.arg):c(void 0===b.arg?null:b.arg)}}}function l(a){if(e.onAbort)e.onAbort(a);a+="";F(a);f(a);P=!0;throw new WebAssembly.RuntimeError("abort("+a+"). Build with -s ASSERTIONS=1 for more info.");}
function d(a,b){return String.prototype.startsWith?a.startsWith(b):0===a.indexOf(b)}function r(){try{if(O)return new Uint8Array(O);if(z)return z(G);throw"both async and sync fetching of the wasm failed";}catch(ba){l(ba)}}function q(){return O||!u&&!n||"function"!==typeof fetch?new Promise(function(a,b){a(r())}):fetch(G,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at '"+G+"'";return a.arrayBuffer()}).catch(function(){return r()})}function m(a){function b(){if(!T&&
(T=!0,e.calledRun=!0,!P)){g(aa);g(Q);v(e);if(e.onRuntimeInitialized)e.onRuntimeInitialized();if(e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)Y.unshift(e.postRun.shift());g(Y)}}if(!(0<R)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)ca.unshift(e.preRun.shift());g(ca);0<R||(e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1);b()},1)):b())}}e=e||{};null;e="undefined"!==typeof e?
e:{};var v;e.ready=new Promise(function(a,b){v=a});var p={};for(J in e)e.hasOwnProperty(J)&&(p[J]=e[J]);var u=!1,n=!1;u="object"===typeof window;n="function"===typeof importScripts;var t="",z;if(u||n)n?t=self.location.href:document.currentScript&&(t=document.currentScript.src),h&&(t=h),t=0!==t.indexOf("blob:")?t.substr(0,t.lastIndexOf("/")+1):"",n&&(z=function(a){var b=new XMLHttpRequest;b.open("GET",a,!1);b.responseType="arraybuffer";b.send(null);return new Uint8Array(b.response)});var F=e.print||
console.log.bind(console),f=e.printErr||console.warn.bind(console);for(J in p)p.hasOwnProperty(J)&&(e[J]=p[J]);p=null;var O;e.wasmBinary&&(O=e.wasmBinary);"object"!==typeof WebAssembly&&f("no native wasm support detected");var x;p=new WebAssembly.Table({initial:1,maximum:1,element:"anyfunc"});var P=!1,I,H;var J=e.INITIAL_MEMORY||16777216;if(x=e.wasmMemory?e.wasmMemory:new WebAssembly.Memory({initial:J/65536,maximum:32768}))var k=x.buffer;J=k.byteLength;c(k);H[24364]=5340496;var ca=[],aa=[],Q=[],Y=
[],R=0,K=null,N=null;e.preloadedImages={};e.preloadedAudios={};var G="rnnoise.wasm";d(G,"data:application/octet-stream;base64,")||(G=b(G));aa.push({func:function(){Z()}});var y={a:function(a,b,c){I.copyWithin(a,b,b+c)},b:function(b){b>>>=0;var d=I.length;if(2147483648<b)return!1;for(var g=1;4>=g;g*=2){var f=d*(1+.2/g);f=Math.min(f,b+100663296);f=Math.min(2147483648,a(Math.max(16777216,b,f),65536));a:{try{x.grow(f-k.byteLength+65535>>>16);c(x.buffer);var e=1;break a}catch(ia){}e=void 0}if(e)return!0}return!1},
memory:x,table:p};(function(){function a(a,b){e.asm=a.exports;R--;e.monitorRunDependencies&&e.monitorRunDependencies(R);0==R&&(null!==K&&(clearInterval(K),K=null),N&&(a=N,N=null,a()))}function b(b){a(b.instance)}function c(a){return q().then(function(a){return WebAssembly.instantiate(a,g)}).then(a,function(a){f("failed to asynchronously prepare wasm: "+a);l(a)})}var g={a:y};R++;e.monitorRunDependencies&&e.monitorRunDependencies(R);if(e.instantiateWasm)try{return e.instantiateWasm(g,a)}catch(W){return f("Module.instantiateWasm callback failed with error: "+
W),!1}(function(){if(O||"function"!==typeof WebAssembly.instantiateStreaming||d(G,"data:application/octet-stream;base64,")||"function"!==typeof fetch)return c(b);fetch(G,{credentials:"same-origin"}).then(function(a){return WebAssembly.instantiateStreaming(a,g).then(b,function(a){f("wasm streaming compile failed: "+a);f("falling back to ArrayBuffer instantiation");return c(b)})})})();return{}})();var Z=e.___wasm_call_ctors=function(){return(Z=e.___wasm_call_ctors=e.asm.c).apply(null,arguments)};e._rnnoise_init=
function(){return(e._rnnoise_init=e.asm.d).apply(null,arguments)};e._rnnoise_create=function(){return(e._rnnoise_create=e.asm.e).apply(null,arguments)};e._malloc=function(){return(e._malloc=e.asm.f).apply(null,arguments)};e._rnnoise_destroy=function(){return(e._rnnoise_destroy=e.asm.g).apply(null,arguments)};e._free=function(){return(e._free=e.asm.h).apply(null,arguments)};e._rnnoise_process_frame=function(){return(e._rnnoise_process_frame=e.asm.i).apply(null,arguments)};var T;N=function ea(){T||
m();T||(N=ea)};e.run=m;if(e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();m();return e.ready}}();t.a=h}).call(t,n(23))},function(m,t,n){var h=n(0),l=n(7),e=n(11),b=n(19);n(14);m=n(1);var a=n.n(m),c=n(4);n(6);n(5);t.a=function(g,m){var d=Object(c.c)(m);d.rooms=new Map;d.currentBreakOutRoom=null;d.joinRoom=function(g,q,m,v){v=void 0===v?{allow_reconnect:!0,number_of_attempts:3,timeout_interval:45E3}:v;var p=null,r=null;h.a.info("SDK version is: ",
a.a.product.version);if(null!=g){h.a.info("=========== port of hope");g=JSON.parse(window.atob(g));g.version=a.a.product.version;var n=Object(e.a)(void 0,void 0,{token:b.a.encodeBase64(JSON.stringify(g)),reconnectInfo:v});g=function(){if("IE"===l.a.browserEngineCheck()){q.video=!1;var a=document.getElementById("WebrtcEverywherePluginId");a.addEventListener("room-connected",function(a){d.rooms.set(n.roomID,n);r={streams:a.data.streams,room:n,roomData:a.data.room,localStream:z};n.publish(z,function(a){0===
a.result?(r.publishId=a.id,m(r,null)):m(null,a)})});a.addEventListener("room-error",function(a){m(r,a.data)});a.addEventListener("stream-added",function(a){n.subscribe(a.data.stream)})}else n.addEventListener("room-connected",function(a){q.video=!1;h.a.info("-----------BreakoutRoom-Connected--------");r={streams:a.streams,room:n,roomData:a.room,localStream:z};m(r,null);n.publish(z,function(a){0===a.result?r.publishId=a.id:n.dispatchEvent(Object(c.e)({type:"room-error",message:a}))});for(a=0;a<r.streams.length;a++)n.subscribe(r.streams[a],
{},function(a){!0===a?h.a.info("breakout room-subscribe callback success"):(h.a.info("breakout room-subscribe callback failed, could not subscribe streams",a),n.dispatchEvent(Object(c.e)({type:"room-error",message:a})))});d.rooms.set(n.roomID,n);a=Object(c.e)({type:"breakout-room-connected",success:r});d.dispatchEvent(a)}),n.addEventListener("room-error",function(a){m(null,a)}),n.addEventListener("stream-added",function(a){n.subscribe(a.stream)}),n.addEventListener("room-disconnected",d.onBreakOutRoomDisconnect.bind(n));
!1===n.reconnectionState&&0==n.reconnectAttempt?(h.a.info("-----------BreakoutRoom-Connecting--------"),n.connect(v)):h.a.debug(" Reconnection case in join room public api")};var w=function(a){p=a;m(r,p)};if(q.audio||q.video)var z=n.initPublishStream(q.div,q,g,w);else h.a.info(" No publish stream. audio and video are disabled.."),g()}return z};d.endBreakOutRoom=function(a){h.a.info("Breakout Room ended, Disconnecting the room");d.rooms.get(a).disconnect()};d.onBreakOutRoomDisconnect=function(a){var b=
Object(c.e)({type:"breakout-room-disconnect",message:{room_id:a.id}});d.rooms.delete(a.roomID);d.dispatchEvent(b)};d.onUserLeft=function(a,b){a=UserEvent({type:"user-disconnected",room_id:a.roomID,name:b.name,clientId:b.clientId,role:b.role,permission:b.permissions});d.dispatchEvent(a)};d.onUserJoined=function(a,b){a=b.name;var c=b.role,g=b.permissions,e={name:b.name,permissions:b.permissions,role:b.role,user_ref:b.user_ref,videoMuted:b.videoMuted,audioMuted:b.audioMuted};d.userList.set(b.clientId,
e);b=UserEvent({type:"user-connected",name:a,clientId:b.clientId,role:c,permission:g,user:e});d.dispatchEvent(b)};d.disconnectAll=function(){d.rooms.forEach(function(a,b){a&&a.disconnect()})};return d}},function(m,t,n){t.a=function(){var h={},l={};h.add=function(e,b){l[e]=b};h.get=function(e){return l[e]};h.getAll=function(){return l};h.has=function(e){return void 0!==l[e]};h.forEach=function(e){for(var b=Object.keys(l),a=0;a<b.length;a+=1){var c=b[a];e(l[c],c)}};h.keys=function(){return Object.keys(l)};
h.remove=function(e){delete l[e]};h.size=function(){var e=0,b;for(b in l)l.hasOwnProperty(b)&&e++;return e};return h}},function(m,t){t.read=function(m,h,l,e,b){var a=8*b-e-1;var c=(1<<a)-1,g=c>>1,n=-7;b=l?b-1:0;var d=l?-1:1,r=m[h+b];b+=d;l=r&(1<<-n)-1;r>>=-n;for(n+=a;0<n;l=256*l+m[h+b],b+=d,n-=8);a=l&(1<<-n)-1;l>>=-n;for(n+=e;0<n;a=256*a+m[h+b],b+=d,n-=8);if(0===l)l=1-g;else{if(l===c)return a?NaN:Infinity*(r?-1:1);a+=Math.pow(2,e);l-=g}return(r?-1:1)*a*Math.pow(2,l-e)};t.write=function(m,h,l,e,b,
a){var c,g=8*a-b-1,n=(1<<g)-1,d=n>>1,r=23===b?Math.pow(2,-24)-Math.pow(2,-77):0;a=e?0:a-1;var q=e?1:-1,t=0>h||0===h&&0>1/h?1:0;h=Math.abs(h);isNaN(h)||Infinity===h?(h=isNaN(h)?1:0,e=n):(e=Math.floor(Math.log(h)/Math.LN2),1>h*(c=Math.pow(2,-e))&&(e--,c*=2),h=1<=e+d?h+r/c:h+r*Math.pow(2,1-d),2<=h*c&&(e++,c/=2),e+d>=n?(h=0,e=n):1<=e+d?(h=(h*c-1)*Math.pow(2,b),e+=d):(h=h*Math.pow(2,d-1)*Math.pow(2,b),e=0));for(;8<=b;m[l+a]=h&255,a+=q,h/=256,b-=8);e=e<<b|h;for(g+=b;0<g;m[l+a]=e&255,a+=q,e/=256,g-=8);m[l+
a-q]|=128*t}},function(m,t){var n={}.toString;m.exports=Array.isArray||function(h){return"[object Array]"==n.call(h)}},function(m,t,n){m=n(32);var h=n.n(m),l=n(60),e=n(22),b=n(12);n.n(b);var a=n(16),c=n(0);n=function(){var a=h.a.call(this,"FileSender")||this;a.keychain=new e.a;a.reset();return a};$jscomp.inherits(n,h.a);n.prototype.reset=function(){this.uploadRequest=null;this.msg="importingFile";this.progress=[0,1];this.cancelled=!1};n.prototype.cancel=function(){this.cancelled=!0;this.uploadRequest&&
this.uploadRequest.cancel()};n.prototype.upload=function(g,e){var d=this,h,q,m,v,p,u,n,w,z;return $jscomp.asyncExecutePromiseGeneratorProgram(function(r){switch(r.nextAddress){case 1:if(d.cancelled)throw Error(0);d.msg="encryptingFile";d.emit("encrypting");h=Object(b.encryptedSize)(g.size);return r.yield(d.keychain.encryptStream(g.stream),2);case 2:return q=r.yieldResult,r.yield(d.keychain.encryptMetadata(g),3);case 3:return m=r.yieldResult,r.yield(d.keychain.authKeyB64(),4);case 4:v=r.yieldResult;
p={name:g.name,plainSize:g.size,type:g.type,totalSize:h};d.uploadRequest=Object(a.i)(q,m,v,g.timeLimit,g.dlimit,e,p,function(a){d.progress=[a,h];d.emit("progress")});if(d.cancelled)throw Error(0);d.msg="fileSizeProgress";d.emit("progress");r.setCatchFinallyBlocks(5);return r.yield(d.uploadRequest.result,7);case 7:return u=r.yieldResult,d.msg="notifyUploadEncryptDone",d.uploadRequest=null,d.progress=[1,1],n=Object(b.arrayToB64)(d.keychain.rawSecret),w=new l.a({id:u.id,url:u.url+"#"+n,name:g.name,size:g.size,
manifest:g.manifest,time:u.duration,speed:g.size/(u.duration/1E3),createdAt:Date.now(),expiresAt:Date.now()+1E3*g.timeLimit,secretKey:n,nonce:d.keychain.nonce,ownerToken:u.ownerToken,dlimit:g.dlimit,timeLimit:g.timeLimit,mnounce:u.mnounce}),r.return(w);case 5:throw z=r.enterCatchBlock(),c.a.info("upload request failed",z),d.msg="errorPageHeader",d.uploadRequest=null,z;}})};$jscomp.global.Object.defineProperties(n.prototype,{progressRatio:{configurable:!0,enumerable:!0,get:function(){return this.progress[0]/
this.progress[1]}},progressIndefinite:{configurable:!0,enumerable:!0,get:function(){return-1===["fileSizeProgress","notifyUploadEncryptDone"].indexOf(this.msg)}},sizes:{configurable:!0,enumerable:!0,get:function(){return{partialSize:Object(b.bytes)(this.progress[0]),totalSize:Object(b.bytes)(this.progress[1])}}}});t.a=n},function(m,t,n){m.exports=function(h,l,e){var b=h.length;if(!(l>=b||0===e)){e=l+e>b?b-l:e;for(b-=e;l<b;++l)h[l]=h[l+e];h.length=b}}},function(m,t,n){function h(c){function g(b){var g=
"end-"+m+"-"+c;a.mark(g);e.push(function(){var e=null;try{a.measure(c+" ["+m+"]",d,g),a.clearMarks(d),a.clearMarks(g)}catch(v){e=v}b&&b(e,c)})}b.equal(typeof c,"string","nanotiming: name should be type string");if(h.disabled)return l;var m=(1E4*a.now()).toFixed()%Number.MAX_SAFE_INTEGER,d="start-"+m+"-"+c;a.mark(d);g.uuid=m;return g}function l(a){a&&e.push(function(){a(Error("nanotiming: performance API unavailable"))})}var e=n(59)(),b=n(21);h.disabled=!0;try{var a=window.performance;h.disabled="true"===
window.localStorage.DISABLE_NANOTIMING||!a.mark}catch(c){}m.exports=h},function(m,t,n){function h(b){this.method=(this.hasIdle=(this.hasWindow=b)&&window.requestIdleCallback)?window.requestIdleCallback.bind(window):this.setTimeout;this.scheduled=!1;this.queue=[]}var l=n(21),e="undefined"!==typeof window;h.prototype.push=function(b){l.equal(typeof b,"function","nanoscheduler.push: cb should be type function");this.queue.push(b);this.schedule()};h.prototype.schedule=function(){if(!this.scheduled){this.scheduled=
!0;var b=this;this.method(function(a){for(var c;b.queue.length&&0<a.timeRemaining();)c=b.queue.shift(),c(a);b.scheduled=!1;b.queue.length&&b.schedule()})}};h.prototype.setTimeout=function(b){setTimeout(b,0,{timeRemaining:function(){return 1}})};m.exports=function(){if(e){window._nanoScheduler||(window._nanoScheduler=new h(!0));var b=window._nanoScheduler}else b=new h;return b}},function(m,t,n){var h=n(22),l=n(12);n.n(l);var e=n(16);m=function(b){if(!b.manifest)throw Error("invalid file object");this.id=
b.id;this.url=b.url;this.name=b.name;this.size=b.size;this.manifest=b.manifest;this.time=b.time;this.speed=b.speed;this.createdAt=b.createdAt;this.expiresAt=b.expiresAt;this.ownerToken=b.ownerToken;this.dlimit=b.dlimit||1;this.dtotal=b.dtotal||0;this.keychain=new h.a(b.secretKey,b.nonce);this._hasPassword=!!b.hasPassword;this.timeLimit=b.timeLimit;this.mnounce=b.mnounce};m.prototype.setPassword=function(b){var a=this,c,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return h.setCatchFinallyBlocks(2),
a.password=b,a._hasPassword=!0,a.keychain.setPassword(b,a.url),h.yield(Object(e.h)(a.id,a.ownerToken,a.keychain),4);if(2!=h.nextAddress)return c=h.yieldResult,h.return(c);g=h.enterCatchBlock();a.password=null;a._hasPassword=!1;throw g;})};m.prototype.del=function(){return Object(e.a)(this.id,this.ownerToken)};m.prototype.changeLimit=function(b,a){a=void 0===a?{}:a;return this.dlimit!==b?(this.dlimit=b,Object(e.g)(this.id,this.ownerToken,a.bearerToken,{dlimit:b})):Promise.resolve(!0)};m.prototype.updateDownloadCount=
function(){var b=this,a,c,g,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){switch(d.nextAddress){case 1:return a=b.dtotal,c=b.dlimit,d.setCatchFinallyBlocks(2),d.yield(Object(e.c)(b.id,b.ownerToken),4);case 4:g=d.yieldResult;b.dtotal=g.dtotal;b.dlimit=g.dlimit;d.leaveTryBlock(3);break;case 2:h=d.enterCatchBlock(),"404"===h.message&&(b.dtotal=b.dlimit);case 3:return d.return(a!==b.dtotal||c!==b.dlimit)}})};m.prototype.toJSON=function(){return{id:this.id,url:this.url,name:this.name,
size:this.size,manifest:this.manifest,time:this.time,speed:this.speed,createdAt:this.createdAt,expiresAt:this.expiresAt,secretKey:Object(l.arrayToB64)(this.keychain.rawSecret),ownerToken:this.ownerToken,dlimit:this.dlimit,dtotal:this.dtotal,hasPassword:this.hasPassword,timeLimit:this.timeLimit,mnounce:this.mnounce}};$jscomp.global.Object.defineProperties(m.prototype,{hasPassword:{configurable:!0,enumerable:!0,get:function(){return!!this._hasPassword}},expired:{configurable:!0,enumerable:!0,get:function(){return this.dlimit===
this.dtotal||Date.now()>this.expiresAt}}});t.a=m},function(m,t,n){var h=n(20);m=function(h,e,b){h=void 0===h?[]:h;e=void 0===e?86400:e;b=void 0===b?{}:b;this.files=Array.from(h);this.timeLimit=this.defaultTimeLimit=e;this.dlimit=10;this.password=null;this.roomMeta=b};m.prototype.addFiles=function(h,e,b){var a=this;if(this.files.length+h.length>b)throw Error("tooManyFiles");h=h.filter(function(b){var c;if(c=0<b.size){a:{c=$jscomp.makeIterator(a.files);for(var e=c.next();!e.done;e=c.next())if(e=e.value,
b.name===e.name&&b.size===e.size&&b.lastModified===e.lastModified){b=!0;break a}b=!1}c=!b}return c});b=h.reduce(function(a,b){return a+b.size},0);if(this.size+b>e)throw Error("fileTooBig");this.files=this.files.concat(h);return!0};m.prototype.remove=function(h){h=this.files.indexOf(h);-1<h&&this.files.splice(h,1)};m.prototype.clear=function(){this.files=[];this.dlimit=1;this.timeLimit=this.defaultTimeLimit;this.password=null;this.roomMeta={}};$jscomp.global.Object.defineProperties(m.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return 1<this.files.length?"Send-Archive.zip":this.files[0].name}},type:{configurable:!0,enumerable:!0,get:function(){return 1<this.files.length?"send-archive":this.files[0].type}},size:{configurable:!0,enumerable:!0,get:function(){return this.files.reduce(function(h,e){return h+e.size},0)}},numFiles:{configurable:!0,enumerable:!0,get:function(){return this.files.length}},manifest:{configurable:!0,enumerable:!0,get:function(){return{files:this.files.map(function(h){return{name:h.name,
size:h.size,type:h.type}})}}},stream:{configurable:!0,enumerable:!0,get:function(){return Object(h.b)(this.files.map(function(l){return Object(h.a)(l)}))}}});t.a=m},function(m,t,n){function h(a,b){b=void 0===b?!1:b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){return c.return(new Promise(function(c,d){var g={};g=new DataView(a.plaintext);g=new Blob([g],{type:a.type});if(!0===b)return w.a.info(" download file mobile device",b),g={messageType:"download-success",result:0,description:"download-success",
response:{downloadStatus:"success",name:a.name,type:a.type,size:a.size,blob:g}},c(g);if(navigator.msSaveBlob)return console.log("nagivator service worker is present"),navigator.msSaveBlob(g,a.name),c();if(/iPhone|fxios/i.test(navigator.userAgent)){var e=new FileReader;e.addEventListener("loadend",function(){if(e.error)return d(e.error);if(e.result){var b=document.createElement("a");b.href=e.result;b.download=a.name;document.body.appendChild(b);b.click()}c()});e.readAsDataURL(g)}else{g=URL.createObjectURL(g);
var h=document.createElement("a");h.href=g;h.download=a.name;document.body.appendChild(h);h.click();URL.revokeObjectURL(g);g={messageType:"download-success",result:0,description:"download-success",response:{downloadStatus:"success",name:a.name,type:a.type,size:a.size}};setTimeout(c(g),100)}}))})}m=n(32);var l=n.n(m),e=n(22),b=n(12);n.n(b);var a=n(16),c=n(20),g=n(63),w=n(0);n=function(a){var b=l.a.call(this,"FileReceiver")||this;b.keychain=new e.a(a.secretKey,a.nonce);a.requiresPassword&&b.keychain.setPassword(a.password,
a.url);b.fileInfo=a;b.reset();return b};$jscomp.inherits(n,l.a);n.prototype.cancel=function(){this.downloadRequest&&this.downloadRequest.cancel()};n.prototype.reset=function(){this.msg="fileSizeProgress";this.state="initialized";this.progress=[0,1]};n.prototype.getMetadata=function(){var b=this,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(Object(a.e)(b.fileInfo.id,b.keychain),2);c=d.yieldResult;b.fileInfo.name=c.name;b.fileInfo.type=c.type;b.fileInfo.iv=
c.iv;b.fileInfo.size=+c.size;b.fileInfo.manifest=c.manifest;b.state="ready";d.jumpToEnd()})};n.prototype.sendMessageToSw=function(a){return new Promise(function(b,c){var d=new MessageChannel;d.port1.onmessage=function(a){void 0===a.data?c("bad response from serviceWorker"):void 0!==a.data.error?c(a.data.error):b(a.data)};navigator.serviceWorker.controller.postMessage(a,[d.port2])})};n.prototype.downloadBlob=function(d,e){d=void 0===d?!1:d;e=void 0===e?!1:e;var l=this,r,m,p,u,n,w,z,t;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){switch(f.nextAddress){case 1:return l.state=
"downloading",r=l,f.yield(Object(a.b)(l.fileInfo.id,l.keychain,function(a){l.progress=[a,l.fileInfo.size];l.emit("progress")}),2);case 2:return r.downloadRequest=f.yieldResult,f.setCatchFinallyBlocks(3),f.yield(l.downloadRequest.result,5);case 5:return m=f.yieldResult,l.downloadRequest=null,l.msg="decryptingFile",l.state="decrypting",l.emit("decrypting"),p=l.fileInfo.size,u=l.keychain.decryptStream(Object(c.a)(m)),"send-archive"===l.fileInfo.type&&(n=new g.a(l.fileInfo.manifest,u),u=n.stream,p=n.size),
f.yield(Object(b.streamToArrayBuffer)(u,p),6);case 6:w=f.yieldResult;z={};if(d){f.jumpTo(7);break}return f.yield(h({plaintext:w,name:decodeURIComponent(l.fileInfo.name),type:l.fileInfo.type},e),8);case 8:z=f.yieldResult;case 7:return l.msg="downloadFinish",l.emit("complete"),l.state="complete",f.return(z);case 3:throw t=f.enterCatchBlock(),l.downloadRequest=null,t;}})};n.prototype.downloadStream=function(c){c=void 0===c?!1:c;var d=this,g,e,h,l,m,n,w,z,t,f,O,x;return $jscomp.asyncExecutePromiseGeneratorProgram(function(p){switch(p.nextAddress){case 1:return g=
Date.now(),e=function(a){d.progress=[a,d.fileInfo.size];d.emit("progress")},d.downloadRequest={cancel:function(){d.sendMessageToSw({request:"cancel",id:d.fileInfo.id})}},p.setCatchFinallyBlocks(2),d.state="downloading",h={request:"init",id:d.fileInfo.id,filename:d.fileInfo.name,type:d.fileInfo.type,manifest:d.fileInfo.manifest,key:d.fileInfo.secretKey,requiresPassword:d.fileInfo.requiresPassword,password:d.fileInfo.password,url:d.fileInfo.url,size:d.fileInfo.size,nonce:d.keychain.nonce,noSave:c},
p.yield(d.sendMessageToSw(h),4);case 4:e(0);if(!c){l="/api/download/"+d.fileInfo.id;m=Object(a.d)(l);m===l&&(m=location.protocol+"//"+location.host+l);n=document.createElement("a");n.href=m;document.body.appendChild(n);n.click();p.jumpTo(5);break}return p.yield(fetch(Object(a.d)("/api/download/"+d.fileInfo.id)),6);case 6:if(w=p.yieldResult,200!==w.status)throw Error(w.status);case 5:t=z=0;case 7:if(!(z<d.fileInfo.size)){d.downloadRequest=null;d.msg="downloadFinish";d.emit("complete");d.state="complete";
p.leaveTryBlock(0);break}return p.yield(d.sendMessageToSw({request:"progress",id:d.fileInfo.id}),9);case 9:f=p.yieldResult;f.progress===z?t++:t=0;if(30<t)throw O=Error("hung download"),O.duration=Date.now()-g,O.size=d.fileInfo.size,O.progress=z,O;z=f.progress;e(z);return p.yield(Object(b.delay)(1E3),7);case 2:x=p.enterCatchBlock();d.downloadRequest=null;if("cancelled"===x||"400"===x.message)throw Error(0);throw x;}})};n.prototype.download=function(a){return a.stream?this.downloadStream(a.noSave):
this.downloadBlob(a.noSave,a.isMobile)};$jscomp.global.Object.defineProperties(n.prototype,{progressRatio:{configurable:!0,enumerable:!0,get:function(){return this.progress[0]/this.progress[1]}},progressIndefinite:{configurable:!0,enumerable:!0,get:function(){return"downloading"!==this.state}},sizes:{configurable:!0,enumerable:!0,get:function(){return{partialSize:Object(b.bytes)(this.progress[0]),totalSize:Object(b.bytes)(this.progress[1])}}}});t.a=n},function(m,t,n){function h(a,b,e){var c=new ArrayBuffer(22),
g=new DataView(c);g.setUint32(0,101010256,!0);g.setUint16(4,0,!0);g.setUint16(6,0,!0);g.setUint16(8,a,!0);g.setUint16(10,a,!0);g.setUint32(12,b,!0);g.setUint32(16,e,!0);g.setUint16(20,0,!0);return new Uint8Array(c)}var l=n(64),e=new TextEncoder,b=function(a){this.name=e.encode(a.name);this.size=a.size;this.bytesRead=0;this.crc=null;a=void 0;a=void 0===a?new Date:a;var b=a.getFullYear()-1980<<9,c=a.getMonth()+1<<5,d=a.getDate();b=b|c|d;c=a.getHours()<<11;d=a.getMinutes()<<5;a=Math.floor(a.getSeconds()/
2);this.dateTime={date:b,time:c|d|a}};b.prototype.directoryRecord=function(a){var b=new ArrayBuffer(46+this.name.byteLength),c=new DataView(b);c.setUint32(0,33639248,!0);c.setUint16(4,20,!0);c.setUint16(6,20,!0);c.setUint16(8,8,!0);c.setUint16(10,0,!0);c.setUint16(12,this.dateTime.time,!0);c.setUint16(14,this.dateTime.date,!0);c.setUint32(16,this.crc,!0);c.setUint32(20,this.size,!0);c.setUint32(24,this.size,!0);c.setUint16(28,this.name.byteLength,!0);c.setUint16(30,0,!0);c.setUint16(32,0,!0);c.setUint16(34,
0,!0);c.setUint16(36,0,!0);c.setUint32(38,0,!0);c.setUint32(42,a,!0);for(a=0;a<this.name.byteLength;a++)c.setUint8(46+a,this.name[a]);return new Uint8Array(b)};b.prototype.append=function(a,b){this.bytesRead+=a.byteLength;var c=a.byteLength-Math.max(this.bytesRead-this.size,0),d=a.slice(0,c);this.crc=Object(l.a)(d,this.crc);b.enqueue(d);if(c<a.byteLength)return a.slice(c,a.byteLength)};$jscomp.global.Object.defineProperties(b.prototype,{header:{configurable:!0,enumerable:!0,get:function(){var a=new ArrayBuffer(30+
this.name.byteLength),b=new DataView(a);b.setUint32(0,67324752,!0);b.setUint16(4,20,!0);b.setUint16(6,8,!0);b.setUint16(8,0,!0);b.setUint16(10,this.dateTime.time,!0);b.setUint16(12,this.dateTime.date,!0);b.setUint32(14,0,!0);b.setUint32(18,0,!0);b.setUint32(22,0,!0);b.setUint16(26,this.name.byteLength,!0);b.setUint16(28,0,!0);for(var e=0;e<this.name.byteLength;e++)b.setUint8(30+e,this.name[e]);return new Uint8Array(a)}},dataDescriptor:{configurable:!0,enumerable:!0,get:function(){var a=new ArrayBuffer(16),
b=new DataView(a);b.setUint32(0,134695760,!0);b.setUint32(4,this.crc,!0);b.setUint32(8,this.size,!0);b.setUint32(12,this.size,!0);return new Uint8Array(a)}},byteLength:{configurable:!0,enumerable:!0,get:function(){return this.size+this.name.byteLength+30+16}}});var a=function(a,b){this.files=a;this.fileIndex=0;this.file=null;this.reader=b.getReader();this.nextFile();this.extra=null};a.prototype.nextFile=function(){this.file=this.files[this.fileIndex++]};a.prototype.pull=function(a){var b=this,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==
d.nextAddress){if(!b.file){for(var g=b.files,e=0,l=0,m=0;m<g.length;m++){var p=g[m],u=p.directoryRecord(e);e+=p.byteLength;a.enqueue(u);l+=u.byteLength}a.enqueue(h(g.length,l,e));return d.return(a.close())}0===b.file.bytesRead&&(a.enqueue(b.file.header),b.extra&&(b.extra=b.file.append(b.extra,a)));return b.file.bytesRead>=b.file.size?(a.enqueue(b.file.dataDescriptor),b.nextFile(),d.return(b.pull(a))):d.yield(b.reader.read(),2)}c=d.yieldResult;if(c.done)return b.nextFile(),d.return(b.pull(a));b.extra=
b.file.append(c.value,a);d.jumpToEnd()})};m=function(a,g){this.files=a.files.map(function(a){return new b(a)});this.source=g};$jscomp.global.Object.defineProperties(m.prototype,{stream:{configurable:!0,enumerable:!0,get:function(){return new ReadableStream(new a(this.files,this.source))}},size:{configurable:!0,enumerable:!0,get:function(){return this.files.reduce(function(a,b){return a+2*b.byteLength-b.size},0)+22}}});t.a=m},function(m,t,n){var h=n(17);n.n(h);var l=n(65);m=n(66);var e=[0,1996959894,
3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,
1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,
1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,
2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,
752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,
3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!==typeof Int32Array&&(e=new Int32Array(e));m=Object(m.a)("crc-32",function(b,a){h.Buffer.isBuffer(b)||(b=Object(l.a)(b));a=0===a?0:~~a^-1;for(var c=0;c<b.length;c++)a=e[(a^b[c])&255]^a>>>8;return a^-1});t.a=m},function(m,t,n){var h=n(17);n.n(h);t.a=h.Buffer.from&&h.Buffer.alloc&&h.Buffer.allocUnsafe&&
h.Buffer.allocUnsafeSlow?h.Buffer.from:function(l){return new h.Buffer(l)}},function(m,t,n){t.a=function(h,l){var e=function(b,a){return l(b,a)>>>0};e.signed=l;e.unsigned=e;e.model=h;return e}},function(m,t,n){t.a={isAnnotationStarted:!1,canvasOptions:{width:0,height:0},annotationConfig:{toolType:"draw",isErase:!1,drawMethod:"pencil",strokeColor:"#ff0000",lineWidth:3,hasInput:!1,lastMouseX:0,lastMouseY:0,canvasX:0,canvasY:0,mouseX:0,mouseY:0,mouseDown:!1,drawElement:null,drawCtx:null,canvasDomID:null,
canvasVideoPlayerID:null,customCanvasID:"draw_veneer2"},setupAnnotationToolbar:function(){var h=document.createElement("div");h.setAttribute("id","annotationToolbarContainer");h.style="position: absolute;bottom: 0; z-index: 98;";var l=document.createElement("div");l.setAttribute("id","toolbar");l.innerHTML='<div class="atn-btns">\n      <button id="annotate-draw">Draw</button>\n      <select id="selDrawMethod">\n        <option value="pencil" selected="selected">Pencil</option>\n        <option value="text">Text</option>\n      </select>\n      <input\n      type="color"\n      id="favcolor"\n      name="favcolor"\n      value="#ff0000"\n      \n    />\n    <select id="selWidth" >\n      <option value="1">1</option>\n      <option value="3" selected="selected">3</option>\n      <option value="5">5</option>\n      <option value="7">7</option>\n      <option value="9">9</option>\n      <option value="11">11</option>\n    </select>\n    <input type="button" id="eraseBtn" value="Erase"  />\n    <input type="button" id="clearBtn" value="Clear"  />\n      </div>';
h.append(l);return{toolbarCont:h,toolbar:l}},_QS:function(h,l){return(void 0===l?0:l)?document.querySelectorAll(""+h)?document.querySelectorAll(""+h):!1:document.querySelector(""+h)?document.querySelector(""+h):!1},bindEventListernersForTools:function(){var h=this;h._QS("#annotate-draw")&&h._QS("#annotate-draw").addEventListener("click",function(l){h.annotateToolAction("tool","draw")});h._QS("#selDrawMethod")&&h._QS("#selDrawMethod").addEventListener("change",function(l){h.annotateToolAction("drawMethod",
l.target.value)});h._QS("#selWidth")&&h._QS("#selWidth").addEventListener("change",function(l){h.annotateToolAction("lineWidth",l.target.value)});h._QS("#favcolor")&&h._QS("#favcolor").addEventListener("change",function(l){h.annotateToolAction("strokeColor",l.target.value)});h._QS("#eraseBtn")&&h._QS("#eraseBtn").addEventListener("click",function(l){h.annotateToolAction("erase")});h._QS("#clearBtn")&&h._QS("#clearBtn").addEventListener("click",function(l){h.annotateToolAction("clear")})},annotateAddInput:function(h,
l){var e=this,b=document.createElement("input");b.className="annotate-text";b.type="text";b.style.position="fixed";b.style.zIndex=50;b.style.left=h-4+"px";b.style.top=l-4+"px";b.onkeydown=function(a){var b=a.keyCode;13===b?(e.annotateDrawText(a.target.value),document.body.removeChild(a.target),e.annotationConfig.hasInput=!1):27===b&&(document.body.removeChild(a.target),e.annotationConfig.hasInput=!1)};document.body.appendChild(b);b.focus();this.annotationConfig.hasInput=!0},handleEnter:function(h){var l=
h.keyCode;13===l?(this.annotateDrawText(h.target.value),document.body.removeChild(h.target),this.annotationConfig.hasInput=!1):27===l&&(document.body.removeChild(h.target),this.annotationConfig.hasInput=!1)},annotateDrawText:function(h){this.annotationConfig.drawCtx.textBaseline="top";this.annotationConfig.drawCtx.textAlign="left";this.annotationConfig.drawCtx.fillStyle=this.annotationConfig.strokeColor;this.annotationConfig.drawCtx.font="14px sans-serif";this.annotationConfig.drawCtx.fillText(h,
this.annotationConfig.lastMouseX-4,this.annotationConfig.lastMouseY-4)},reOffset:function(h){h=h.getBoundingClientRect();this.annotationConfig.canvasX=h.left;this.annotationConfig.canvasY=h.top},toolBarAction:function(h,l){if("tool"===h)this.annotationConfig.toolType=l,this.annotationConfig.isErase=!1;else if("erase"===h)this.annotationConfig.toolType=h,this.annotationConfig.isErase=!0;else if("strokeColor"===h)this.annotationConfig.strokeColor=l;else if("lineWidth"===h)this.annotationConfig.lineWidth=
l;else if("drawMethod"===h)this.annotationConfig.drawMethod=l;else if("clear"===h){for(h=document.getElementsByClassName("annotate-text");0<h.length;)h[0].remove();this.annotationConfig.drawCtx.clearRect(0,0,this.canvasOptions.width,this.canvasOptions.height)}},appendCustomCanvas:function(h,l,e,b){this.canvasOptions.width=e;this.canvasOptions.height=b;var a=document.createElement("canvas");a.id=this.annotationConfig.customCanvasID;a.width=e;a.height=b;a.className=l;a.setAttribute("style","display:block; user-select: none;z-index:5000;");
h.append(a);l=this.setupAnnotationToolbar();h.append(l.toolbarCont)},onDown:function(h,l){h.preventDefault();if("touchstart"==h.type||"touchmove"==h.type||"touchend"==h.type||"touchcancel"==h.type){h="undefined"===typeof h.originalEvent?h:h.originalEvent;l=h.touches[0]||h.changedTouches[0];var e=l.pageX;var b=l.pageY}else if("mousedown"==h.type||"mouseup"==h.type||"mousemove"==h.type||"mouseover"==h.type||"mouseout"==h.type||"mouseenter"==h.type||"mouseleave"==h.type)e=h.clientX,b=h.clientY;this.reOffset(this.annotationConfig.drawElement);
this.annotationConfig.lastMouseX=this.annotationConfig.mouseX=parseInt(e-this.annotationConfig.canvasX);this.annotationConfig.lastMouseY=this.annotationConfig.mouseY=parseInt(b-this.annotationConfig.canvasY);this.annotationConfig.mouseDown=!0;"text"===this.annotationConfig.drawMethod&&"draw"===this.annotationConfig.toolType&&this.annotateAddInput(e,b)},onMove:function(h,l,e){h.preventDefault();if("touchstart"==h.type||"touchmove"==h.type||"touchend"==h.type||"touchcancel"==h.type){h="undefined"===
typeof h.originalEvent?h:h.originalEvent;e=h.touches[0]||h.changedTouches[0];var b=e.pageX;var a=e.pageY}else if("mousedown"==h.type||"mouseup"==h.type||"mousemove"==h.type||"mouseover"==h.type||"mouseout"==h.type||"mouseenter"==h.type||"mouseleave"==h.type)b=h.clientX,a=h.clientY;this.annotationConfig.mouseX=parseInt(b-this.annotationConfig.canvasX);this.annotationConfig.mouseY=parseInt(a-this.annotationConfig.canvasY);this.annotationConfig.mouseDown&&"pencil"===this.annotationConfig.drawMethod&&
(this.annotationConfig.drawCtx.beginPath(),"draw"===this.annotationConfig.toolType?(this.annotationConfig.drawCtx.globalCompositeOperation="source-over",this.annotationConfig.drawCtx.strokeStyle=this.annotationConfig.strokeColor,this.annotationConfig.drawCtx.lineWidth=this.annotationConfig.lineWidth):(this.annotationConfig.drawCtx.globalCompositeOperation="destination-out",this.annotationConfig.drawCtx.lineWidth=10),this.annotationConfig.drawCtx.moveTo(this.annotationConfig.lastMouseX,this.annotationConfig.lastMouseY),
this.annotationConfig.drawCtx.lineTo(this.annotationConfig.mouseX,this.annotationConfig.mouseY),this.annotationConfig.drawCtx.lineJoin=l.lineCap="round",this.annotationConfig.drawCtx.stroke());this.annotationConfig.lastMouseX=this.annotationConfig.mouseX;this.annotationConfig.lastMouseY=this.annotationConfig.mouseY},onUp:function(h){h.preventDefault();this.annotationConfig.mouseDown=!1},annotateToolAction:function(h,l){this.toolBarAction(h,l)},mouseAnnotate:function(h,l,e,b){b=void 0===b?null:b;var a=
this;b&&(a.stream=b);a.isAnnotationStarted=!0;a.annotationConfig.drawElement=document.getElementById(a.annotationConfig.customCanvasID);a.annotationConfig.drawCtx=a.annotationConfig.drawElement.getContext("2d");a.annotationConfig.canvasDomID=h;a.annotationConfig.canvasVideoPlayerID=e;a.annotationConfig.drawElement.addEventListener("mousedown",function(b){a.onDown(b,!1)});a.annotationConfig.drawElement.addEventListener("touchstart",function(b){a.onDown(b,!0)});a.annotationConfig.drawElement.addEventListener("mousemove",
function(b){a.onMove(b,l,!1)});a.annotationConfig.drawElement.addEventListener("touchmove",function(b){a.onMove(b,l,!0)});a.annotationConfig.drawElement.addEventListener("mouseup",function(b){a.onUp(b)});a.annotationConfig.drawElement.addEventListener("touchcancel",function(b){a.onUp(b)});return a.annotationConfig.drawElement},stopAnnotation:function(){this.isAnnotationStarted=!1;var h=document.getElementById("canvas-wrapper");h&&h.remove();for(h=document.getElementsByClassName("annotate-text");0<
h.length;)h[0].remove();h=document.querySelector(".annotate-div");var l=h.parentElement;l.prepend(h.firstElementChild);l.firstChild.style.height="100%";l.firstChild.style.width="100%";h.remove();this.annotationConfig.toolType="draw";this.annotationConfig.isErase=!1;this.annotationConfig.drawMethod="pencil";this.annotationConfig.strokeColor="#ff0000";this.annotationConfig.lineWidth=3},resize:function(){var h=this;h.isAnnotationStarted&&setTimeout(function(){var l=h.stream;if(l){var e=l.getID(),b=document.getElementById("stream"+
e+"_veneer"),a=document.getElementById("draw_veneer2");if(a){var c=a.getContext("2d"),g=c.getImageData(0,0,a.width,a.height);l=l.stream.getVideoTracks()[0];l=l.getSettings()?l.getSettings():l.getConstraints();var m=l.height,d=l.width,r=document.querySelector(".annotate-div");e=document.querySelector("#player_"+e);l=r.clientHeight;r=r.clientWidth;if(l<r){var q=l/m,n=m*q;q*=d;q>r?(q=r/d,m*=q,d*=q):(m=n,d=q)}else q=r/d,n=m*q,q*=d,n>l?(q=l/m,m*=q,d*=q):(m=n,d=q);e.style.height=m+"px";e.style.width=d+
"px";b.width=d;b.height=m;a.width=d;a.height=m;createImageBitmap(g).then(function(a){c.drawImage(a,0,0,d,m)});h.canvasOptions.width=d;h.canvasOptions.height=m;h.reOffset(h.annotationConfig.drawElement)}}},100)}}},function(m,t,n){var h=n(0),l=n(7),e=n(11),b=n(19);n(14);m=n(1);var a=n.n(m),c=n(4),g=n(6);m=n(5);var w=n(9),d=n(8),r=m.a.constant,q=void 0,D={default:{minVideoBW:80,maxVideoBW:1500,scheme:"notify-break-recover"},disconnectRoom:function(a){q=void 0;a&&a.disconnect()},getDevice:function(b){"function"===
typeof b?a.a.is_supported()?l.a.getDeviceList(b):(h.a.info("Failed Webrtc support is missing "),b(g.a.error_1000)):h.a.error("getDevice() invalid param - callback")},notifyDeviceUpdate:function(b){a.a.is_supported()?b.notifyDeviceUpdate():h.a.info("Failed Webrtc support is missing ")},switchMediaDevice:function(b,c,d,e){e=void 0===e?function(){}:e;"function"===typeof e?a.a.is_supported()?c&&"string"===typeof c&&d&&"string"===typeof d?b.switchMediaDevices(b,c,d,e):(h.a.info("Invalid Device Id"),e(!1)):
(h.a.info("Failed Webrtc support is missing "),e(g.a.error_1000)):h.a.error("switchMediaDevice() invalid param - callback")},joinRoom:function(m,p,u,n){var v={},z={allow_reconnect:!0,number_of_attempts:3,timeout_interval:45E3};if(void 0==u&&void 0==n)h.a.error("joinRoom() failed, callback is missing. invalid parameters");else{if(void 0!=u&&"function"===typeof u){var t=u;void 0!=n&&(z=n)}else if(void 0!=n&&"function"===typeof n)if(t=n,void 0!=u)v=u;else{h.a.error("joinRoom() failed, callback is missing. invalid parameters");
return}if(a.a.is_supported())if(void 0==m||void 0==p)h.a.error("joinRoom() failed, token/streamInfo is missing. invalid parameters"),t(null,g.a.error_1155);else{var f=null,C=null;h.a.info("SDK version: "+a.a.product.version+" browser name: "+a.a.browser_type+" browser version: "+a.a.browser_info.version+" device type: "+a.a.browser_info.device_type);if(null!=m){m=JSON.parse(b.a.decodeBase64(m));w.a.init(m);m.version=a.a.product.version;v.reconnectInfo=z;v.token=b.a.encodeBase64(JSON.stringify(m));
var x=Object(e.a)(void 0,void 0,v);v=function(){"IE"!==l.a.browserEngineCheck()&&(x.addEventListener("room-connected",function(b){C={streams:b.streams,room:x,roomData:b.room,localStream:P};q=x;if(void 0!==b.me&&null!==b.me&&("lecture"!==x.mode||"participant"!==b.me.role||x.floorGranted)&&(p.audio||p.video)){var f={};p.maxVideoBW&&(f.maxVideoBW=p.maxVideoBW);p.minVideoBW&&(f.minVideoBW=p.minVideoBW);p.maxVideoFps&&(f.maxVideoFps=p.maxVideoFps);p.maxVideoFps&&(f.maxVideoFps=p.maxVideoFps);p.audioMuted&&
(f.audioMuted=p.audioMuted);p.videoMuted&&(f.videoMuted=p.videoMuted);f.scheme=p.scheme?p.scheme:D.default.scheme;f.maxVideoLayers=x.maxVideoLayers;f.forceTurn=p.forceTurn}if("audience"===x.me.role&&x.subscription&&!x.subscription.hls)h.a.error("Licence error :  HLS not supported !!");else if(!1===x.reconnectionState){p.video&&x.subscription&&!x.subscription.audio_video&&(h.a.error("Licence error : video not supported, ignoring video option"),p.video=!1);p.audio&&x.subscription&&!x.subscription.audio_only&&
!x.subscription.audio_video&&(h.a.error("Licence error : audio not supported, ignoring audio option"),p.audio=!1);var e=function(d,f){x.publish(P,d,function(d){0===d.result?(C.publishId=d.id,x.mediaConfiguration!==r.H264_CODEC&&"safari"===a.a.browser_info.name&&a.a.browser_info.version<=r.SAFARI_VERSION_NOT_SUPPORTING_VP8?f(C,g.a.error_1152):f(C,null),b.mediaRecord&&x.dispatchEvent(Object(c.e)({type:"room-record-on",message:{}})),b.room.mute&&x.dispatchEvent(Object(c.e)({type:"room-muted",message:{}}))):
d.result===g.a.error_1130.result?f(C,d):f(null,d)})};void 0!=f&&!1===x.waitRoom&&"viewer"!=x.me.role&&"audience"!=x.me.role?e(f,t):"viewer"!=x.me.role&&"audience"!=x.me.role&&x.waitRoom?(t(C,null),x.addEventListener("wait-room-disabled",function(a){x.dispatchEvent(Object(c.e)({type:"room-allowed",message:a.message}));"lecture"!==x.mode&&e(f,t)})):(h.a.info("no audio&video"),P&&(p.audioMuted&&P.muteAudio(function(a){a.result==g.a.error_000.result&&x.dispatchEvent(Object(c.g)({type:"user-audio-muted",
clientId:x.clientId}));h.a.info("audioSelfMuteCallback: "+JSON.stringify(a))},!1,0,!0),p.videoMuted&&P.muteVideo(function(a){a.result!==g.a.error_000.result&&x.dispatchEvent(Object(c.g)({type:"user-video-muted",clientId:x.clientId}));h.a.info("videoSelfMuteCallback: "+JSON.stringify(a))},!1,0,!0)),t(C,null))}else{h.a.info("handle reconnection: for room-connected ");C={streams:b.streams,room:x,roomData:b.room,localStream:P};for(var k=0;k<C.streams.length;k++)x.subscribe(C.streams[k],{},function(a){!0===
a||"object"===typeof a&&0==a.result?h.a.info("reconnect subscriber callback success"):(h.a.info("reconnect subscriber callback failed, could not reconnect",a),x.reconPubSubFailed(a),x.dispatchEvent(Object(c.e)({type:"room-error",message:a})),w.a.error("api-event",d.a.event_reconnect_subscribe_failed,{error:"reconnect subscriber callback failed, couldnt reconnect",message:a}))});var l=function(a){x.localStreamsBeforeReconnect.forEach(function(a,g){void 0===a.canvas&&void 0===a.screen&&(h.a.info(" reconnect publish, audio video data stream"),
x.localStreamsBeforeReconnect.remove(g),x.publish(a,f,function(f){0===f.result?(C.publishId=f.id,h.a.info("reconnected and stream published successfully"),x.manageStatsSubscription(a),x.manageRecordingStatus(),b.mediaRecord&&x.dispatchEvent(Object(c.e)({type:"room-record-on",message:{}})),b.room.mute&&x.dispatchEvent({type:"room-muted",message:{}}),!0===a.selfMuteAudio&&a.sendEvent("user-audio-muted"),1==a.selfMuteVideo&&a.sendEvent("user-video-muted"),x.localStreamsBeforeReconnect.forEach(function(a,
b){!0===a.canvas?(h.a.info(" reconnect publish, canvas stream"),x.localStreamsBeforeReconnect.remove(b),x.publish(a,{maxVideoBW:4096,minVideoBW:1024},function(a){0===a.result?C.publishId=a.id:(h.a.info(" reconnect publish failed forcanvas stream failed",a),x.reconPubSubFailed(a),x.dispatchEvent(Object(c.e)({type:"room-error",message:a})),w.a.error("api-event",d.a.event_reconnect_publish_failed,{error:"reconnect publish for canvas stream failed",message:a}))})):!0===a.screen?(h.a.info(" reconnect publish, share stream"),
x.localStreamsBeforeReconnect.remove(b),x.publish(a,{share:!0},function(a){h.a.info(" reconnect publish response for share stream",a);0===a.result?(h.a.info(" reconnect publish share successful",a),x.localStreams.forEach(function(a,b){a&&a.ifVideo()&&a.setQualityLayers(2)})):(h.a.info(" reconnect publish share failed with reason",a),x.reconPubSubFailed(a),x.dispatchEvent(Object(c.e)({type:"room-error",message:a})),w.a.error("api-event",d.a.event_reconnect_publish_failed,{error:"reconnect publish share failed with reason",
message:a}))})):h.a.info(" unknown stream type ????????????")})):(h.a.info(" reconnect publishing failed, response for publish",f),x.reconPubSubFailed(f),x.dispatchEvent(Object(c.e)({type:"room-error",message:f})),w.a.error("api-event",d.a.event_reconnect_publish_failed,{error:"reconnect publishing failed, response for publish",message:f}))}))})};void 0==f||!1!==x.waitRoom||"viewer"==x.me.role||"audience"==x.me.role||"lecture"===x.mode&&"moderator"!==x.me.role?"viewer"!=x.me.role&&"audience"!=x.me.role&&
x.waitRoom?(h.a.info("Reconnect WaitRoom on no publish"),x.addEventListener("wait-room-disabled",function(a){"lecture"!==x.mode&&l(f)})):"viewer"!=x.me.role&&"audience"!=x.me.role||"lecture"===x.mode&&"moderator"!==x.me.role?("viewer"!=x.me.role&&"audience"!=x.me.role?h.a.info(" No publish - participant is viewer/audience"):h.a.info(" reconnection:: No publish - participant in lecture mode"),x.floorGranted&&(x.floorGranted=!1,x.dispatchEvent(Object(c.e)({type:"release-floor",users:{clientId:x.clientId}})))):
h.a.info("no audio&video"):l(f);h.a.debug(" setting reconnection state as false ");x.reconnectionState=!1;x.manageNumTalker();h.a.info("send network reconnected event");k=Object(c.e)({type:"network-reconnected",error:g.a.error_1164.result,message:g.a.error_1164.error});x.dispatchEvent(k)}}),x.addEventListener("room-error",function(a){t(C,a)}),x.addEventListener("stream-added",function(a){x.subscribe(a.stream)}),x.addEventListener("active-talkers-updated",function(a){a=a.message.activeList;var b=a.length;
if(0<b)for(var d=0;d<b;d++)if("audio"===a[d].mediatype&&!0===a[d].muteDueToBw){x.remoteStreams.getAll()[a[d].streamId].audioOnly=!0;var f=Object(c.e)({type:"user-muted-due-to-bw-crunch",message:{streamId:a[d].streamId,clientId:a[d].clientId,name:a[d].name}});x.dispatchEvent(f)}}));!1===x.reconnectionState&&0==x.reconnectAttempt?x.connect(z):h.a.debug(" Reconnection case in join room public api")};m=function(a){f=a;t(C,f)};if(p.audio||p.video)var P=x.initPublishStream(p.div,p,v,m);else h.a.info(" No publish stream. audio and video are disabled.."),
v()}return P}else h.a.info("Failed Webrtc support is missing "),t(null,g.a.error_1000)}},listParticipants:function(b){if(a.a.is_supported()){var c=[];b&&(c=b.userList);return c}console.log("Failed Webrtc support is missing ")},ReceiveMessage:function(a,b){a&&a.addEventListener("stream-data",function(a){})},sendMessage:function(a,b){a&&a.sendData(b)},getRoom:function(){return q}};t.a=D},function(m,t,n){function h(){x=0;P.splice(0,P.length);I={};H={};J={};k={};ca={};aa={};Q={};Y=R="";K=F.a.default_region;
Z=F.a.proxy_api_url;T=F.a.proxy_api_port;G=ba=!1;ea=F.a.data_throughput_duration;V=F.a.video_bandwidth_duration;M=F.a.audio_bandwidth_duration}function l(){if(!1===N)r();else if(x<P.length){var a=P[x];f.setActiveTest(a);var b={test_group:a.test_group,test_case:a.test_title,status:"started"};if("network"===a.test_group||"connectivity"===a.test_group||"throughput"===a.test_group||"bandwidth"===a.test_group||"signalling"===a.test_group)b.test_region=a.region,b.test_server=a.server;a.start_time=new Date;
b=Object(z.a)({type:"client-diagnosis-status",message:b});!0===W?window.webkit.messageHandlers.callbackHandler.postMessage(b):y.dispatchEvent(b);switch(a.test_title){case "audio_capture":Object(q.a)(a,Y);break;case "check_resolution_240":case "check_resolution_480":case "check_resolution_720":case "check_supported_resolutions":Object(D.a)(a,R);break;case "udp_enabled":case "tcp_enabled":case "ipv6_enabled":Object(v.a)(a);break;case "relay_connectivity":case "reflexive_connectivity":case "host_connectivity":Object(p.a)(a);
break;case "data_throughput":Object(u.a)(a,null,ea);break;case "audio_bandwidth":Object(u.a)(a,Y,M);break;case "video_bandwidth":Object(u.a)(a,R,V);break;case "signalling_connectivity":Object(C.a)(a,Z,T)}x+=1}else a={},Object.keys(I).length&&(a.microphone=I),Object.keys(H).length&&(a.camera=H),Object.keys(J).length&&(a.network=J),Object.keys(k).length&&(a.connectivity=k),Object.keys(ca).length&&(a.throughput=ca),Object.keys(aa).length&&(a.bandwidth=aa),Object.keys(Q).length&&(a.signalling=Q),N=!1,
B.a.info("All test case executed"),a=Object(z.a)({type:"client-diagnosis-finished",message:a}),!0===W?window.webkit.messageHandlers.callbackHandler.postMessage(a):y.dispatchEvent(a),h()}function e(a,b,c,d,f){c=void 0===c?null:c;d=void 0===d?null:d;f=void 0===f?!1:f;a=new ia(a,b,l);a.region=c;a.server=d;a.bitrate_only=f;P.push(a)}function b(){for(var a in K)O.includes(K[a])&&(e("udp_enabled","network",K[a],"TURN"),e("tcp_enabled","network",K[a],"TURN"),e("ipv6_enabled","network",K[a],"TURN"))}function a(){for(var a in K)O.includes(K[a])&&
(e("relay_connectivity","connectivity",K[a],"TURN"),e("reflexive_connectivity","connectivity",K[a],"TURN"),e("host_connectivity","connectivity",K[a],"TURN"))}function c(){for(var a in K)O.includes(K[a])&&e("data_throughput","throughput",K[a],"TURN")}function g(){for(var a in K)O.includes(K[a])&&(e("video_bandwidth","bandwidth",K[a],"TURN",G),e("audio_bandwidth","bandwidth",K[a],"TURN",G))}function w(){for(var a in K)O.includes(K[a])&&e("signalling_connectivity","signalling",K[a],"TURN")}function d(){var a=
Object(z.a)({type:"client-diagnosis-failed",message:{msg:"Invalid arguments"}});!0===W?window.webkit.messageHandlers.callbackHandler.postMessage(a):y.dispatchEvent(a);h();B.a.error("Invalid argument")}function r(){var a=Object(z.a)({type:"client-diagnosis-stopped",message:{msg:"Diagnosis stopped."}});!0===W?window.webkit.messageHandlers.callbackHandler.postMessage(a):y.dispatchEvent(a);h();B.a.error("diagnosis stopped")}var q=n(70),D=n(71),v=n(73),p=n(74),u=n(75),C=n(76),B=n(0),z=n(4);m=n(1);var F=
n.n(m),f=n(13),O=["IN","US","SG","DE"];n={};var x=0,P=[],I={},H={},J={},k={},ca={},aa={},Q={},Y="",R="",K=[],N=!1,G=!1,y=null,Z="",T="",ba=!1,ea=0,V=0,M=0,W=!1,ia=function(a,b,c){this.test_title=a;this.test_group=b;this.started=!1;this.success_count=this.warning_count=this.error_count=0;this.finished_cb=c;this.region="IN";this.server="TURN";this.uri="";this.progress_value=0;this.state="not_tested";this.start_time=0;this.bitrate_only=!1;this.json_response={result:this.state,execution_time:"not_set",
success:[],error:[],warning:[],info:[]};this.done=function(){this.state=0===this.error_count+this.warning_count&&0<this.success_count?"success":0<this.warning_count&&0===this.error_count?"warning":this.isDisabled?"disabled":"failure";this.json_response.result=this.state;this.json_response.execution_time=new Date-this.start_time+" ms";var a={};switch(this.test_group){case "microphone":I[this.test_title]=this.json_response;a[this.test_title]=I[this.test_title];break;case "camera":H[this.test_title]=
this.json_response;a[this.test_title]=H[this.test_title];break;case "network":this.setServer();a=this.fillResponse(J);break;case "connectivity":this.setServer();a=this.fillResponse(k);break;case "throughput":this.setServer();a=this.fillResponse(ca);break;case "bandwidth":this.setServer();a=this.fillResponse(aa);break;case "signalling":this.setServer(),a=this.fillResponse(Q)}a={test_group:this.test_group,test_case:this.test_title,status:"finished",output:a};if("network"===this.test_group||"connectivity"===
this.test_group||"throughput"===this.test_group||"bandwidth"===this.test_group||"signalling"===this.test_group)a.test_region=this.region,a.test_server=this.server;a=Object(z.a)({type:"client-diagnosis-status",message:a});!0===W?window.webkit.messageHandlers.callbackHandler.postMessage(a):y.dispatchEvent(a);this.finished_cb()};this.fillResponse=function(a){var b={};a.hasOwnProperty(this.test_title)||(a[this.test_title]={});a[this.test_title].hasOwnProperty(this.region)||(a[this.test_title][this.region]=
{});a[this.test_title][this.region].hasOwnProperty(this.server)||(a[this.test_title][this.region][this.server]={});a[this.test_title][this.region][this.server]=this.json_response;b[this.test_title]=this.json_response;return b};this.reportFatal=function(a){this.reportError(a);this.done()};this.reportSuccess=function(a){this.success_count+=1;B.a.info("[ OK ]"+a);this.json_response.success.push({message:a})};this.setServer=function(){this.json_response.server={};this.json_response.server.region=this.region;
this.json_response.server.url="TURN"===this.server?F.a.ice_servers[this.region].turnURI:F.a.ice_servers[this.region].stunURI};this.reportError=function(a){this.error_count+=1;B.a.error("[ FAILED ]"+a);this.json_response.error.push({message:a})};this.reportWarning=function(a){this.warning_count+=1;B.a.warning("[ WARN ]"+a);this.json_response.warning.push({message:a})};this.reportInfo=function(a){B.a.info("[ INFO ]"+a);this.json_response.info.push({message:a})};this.fillBandwidth=function(a){this.json_response.bandwidth_bps=
a};this.fillPacketsLost=function(a){this.json_response.packets_lost_percentage=a};this.setProgress=function(a){this.progress_value=a};this.fillData=function(a,b){};this.reportByState=function(a,b){switch(b){case "poor":this.error_count+=1;B.a.error("[ POOR ]"+a);this.json_response.error.push({message:a+" [BAD]"});break;case "moderate":this.warning_count+=1;B.a.warning("[ MODERATE ]"+a);this.json_response.warning.push({message:a+" [ACCEPTABLE]"});break;case "good":this.success_count+=1,B.a.info("[ GOOD ]"+
a),this.json_response.success.push({message:a+" [GOOD]"})}}};n.clientDiagnostics=function(f){W=!1;f.hasOwnProperty("forIosVersion13")&&!0===f.forIosVersion13&&(W=!0);if(f.hasOwnProperty("stop")&&!0===f.stop&&null!==y)return!1===N&&0===P.length&&r(),N=!1,y;if(N||P.length)return B.a.error("Diagnosis is already in progress. Few resources are in use and may not be accessible."),y;y=Object(z.c)();if(!f.hasOwnProperty("testNames")||!Array.isArray(f.testNames))return setTimeout(d,1),y;N=!0;h();f.hasOwnProperty("audioDeviceId")&&
(Y=f.audioDeviceId);f.hasOwnProperty("videoDeviceId")&&(R=f.videoDeviceId);f.hasOwnProperty("testServerApiHost")&&(Z=f.testServerApiHost);f.hasOwnProperty("testServerApiPort")&&(T=f.testServerApiPort);if(f.hasOwnProperty("regionId"))if(Array.isArray(f.regionId))K=f.regionId||F.a.default_region;else return N=!1,setTimeout(d,1),y;f.hasOwnProperty("forMobile")&&!0===f.forMobile&&(ba=!0);f.hasOwnProperty("bitrateOnly")&&!0===f.bitrateOnly&&(G=!0);f.hasOwnProperty("testDurationDataThroughput")&&0<f.testDurationDataThroughput&&
(ea=f.testDurationDataThroughput);60<ea&&(ea=60);f.hasOwnProperty("testDurationVideoBandwidth")&&0<f.testDurationVideoBandwidth&&(V=f.testDurationVideoBandwidth);60<V&&(V=60);f.hasOwnProperty("testDurationAudioBandwidth")&&0<f.testDurationAudioBandwidth&&(M=f.testDurationAudioBandwidth);60<M&&(M=60);var k=f.testNames.map(function(a){a=a.toString();return a.toLowerCase()}),p=new Set;if(k.includes("all"))p.add("microphone"),p.add("camera"),p.add("network"),p.add("connectivity"),p.add("throughput"),
p.add("bandwidth"),p.add("signalling");else for(var q in f.testNames)p.add(k[q]);f=$jscomp.makeIterator(p);for(k=f.next();!k.done;k=f.next())switch(k.value){case "microphone":e("audio_capture","microphone");break;case "camera":!0!==ba&&(e("check_resolution_240","camera"),e("check_resolution_480","camera"),e("check_resolution_720","camera"));e("check_supported_resolutions","camera");break;case "network":b();break;case "connectivity":a();break;case "throughput":c();break;case "bandwidth":g();break;
case "signalling":w()}0<P.length?setTimeout(l,1):(N=!1,setTimeout(d,1));return y};n.clientBitrate=function(a){var b=Object(z.c)(),c="DE";void 0!==a&&a.hasOwnProperty("region")&&(a=a.region,O.includes(a)&&(c=a));c=EnxRtc.clientDiagnostics({testNames:["bandwidth"],regionId:[c],testDurationVideoBandwidth:40,testDurationAudioBandwidth:20,bitrateOnly:!0,stop:!1});var d={video:{bitrate_bps:"NA",connection:"NA"},audio:{bitrate_bps:"NA",connection:"NA"}};c.addEventListener("client-diagnosis-status",function(a){var c=
Object(z.a)({type:"client-bitrate-status",message:a.message});a.message.hasOwnProperty("output")&&(a.message.output.hasOwnProperty("video_bandwidth")&&(a.message.output.video_bandwidth.hasOwnProperty("bandwidth_bps")&&(d.video.bitrate_bps=a.message.output.video_bandwidth.bandwidth_bps),a.message.output.video_bandwidth.hasOwnProperty("packets_lost_percentage")&&(d.video.connection=5<a.message.output.video_bandwidth.packets_lost_percentage?"unstable":"stable")),a.message.output.hasOwnProperty("audio_bandwidth")&&
(a.message.output.audio_bandwidth.hasOwnProperty("bandwidth_bps")&&(d.audio.bitrate_bps=a.message.output.audio_bandwidth.bandwidth_bps),a.message.output.audio_bandwidth.hasOwnProperty("packets_lost_percentage")&&(d.audio.connection=5<a.message.output.audio_bandwidth.packets_lost_percentage?"unstable":"stable")));!0===W?window.webkit.messageHandlers.callbackHandler.postMessage(c):b.dispatchEvent(c)});c.addEventListener("client-diagnosis-finished",function(a){a=Object(z.a)({type:"client-bitrate-finished",
message:d});!0===W?window.webkit.messageHandlers.callbackHandler.postMessage(a):b.dispatchEvent(a)});return b};t.a=n},function(m,t,n){function h(e,b){this.test=e;this.inputChannelCount=6;this.outputChannelCount=2;this.bufferSize=0;this.deviceId=b;this.constraints={audio:{optional:[{echoCancellation:!1}]}};this.collectSeconds=2;this.silentThreshold=1/32767;this.lowVolumeThreshold=-60;this.monoDetectThreshold=1/65536;this.clipCountThreshold=6;this.clipThreshold=1;this.collectedAudio=[];for(e=this.collectedSampleCount=
0;e<this.inputChannelCount;++e)this.collectedAudio[e]=[];this.audioContext=new (window.AudioContext||window.webkitAudioContext)}t.a=function(e,b){(new h(e,b)).run()};var l=n(13);h.prototype={run:function(){var e=this;this.audioContext.resume().then(function(){l.appendSourceId(e.deviceId,"audio",e.constraints);l.doGetUserMedia(e.constraints,e.gotStream.bind(e),e.onFail.bind(e))}).catch(function(b){e.test.reportError("WebAudio run failure: "+b);e.test.done()})},onFail:function(e){this.test.reportError("getUserMedia failed with error: "+
e);this.test.done()},gotStream:function(e){this.checkAudioTracks(e)?this.createAudioBuffer(e):this.test.done()},checkAudioTracks:function(e){this.stream=e;e=e.getAudioTracks();if(1>e.length)return this.test.reportError("No audio track in returned stream."),!1;this.test.reportSuccess("Audio track created using device="+e[0].label);return!0},createAudioBuffer:function(){this.audioSource=this.audioContext.createMediaStreamSource(this.stream);this.scriptNode=this.audioContext.createScriptProcessor(this.bufferSize,
this.inputChannelCount,this.outputChannelCount);this.audioSource.connect(this.scriptNode);this.scriptNode.connect(this.audioContext.destination);this.scriptNode.onaudioprocess=this.collectAudio.bind(this);this.stopCollectingAudio=l.setTimeoutWithProgressBar(this.onStopCollectingAudio.bind(this),5E3)},collectAudio:function(e){for(var b=e.inputBuffer.length,a=!0,c=0;c<e.inputBuffer.numberOfChannels;c++){var g=e.inputBuffer.getChannelData(c),h=Math.abs(g[b-1]);Math.abs(g[0])>this.silentThreshold||h>
this.silentThreshold?(h=new Float32Array(b),h.set(g),a=!1):h=new Float32Array;this.collectedAudio[c].push(h)}a||(this.collectedSampleCount+=b,this.collectedSampleCount/e.inputBuffer.sampleRate>=this.collectSeconds&&this.stopCollectingAudio())},onStopCollectingAudio:function(){this.stream.getAudioTracks()[0].stop();this.audioSource.disconnect(this.scriptNode);this.scriptNode.disconnect(this.audioContext.destination);this.analyzeAudio(this.collectedAudio);this.test.done()},analyzeAudio:function(e){for(var b=
[],a=0;a<e.length;a++)this.channelStats(a,e[a])&&b.push(a);0===b.length?this.test.reportError("No active input channels detected. Microphone is most likely muted or broken, please check if muted in the sound settings or physically on the device. Then rerun the test."):this.test.reportSuccess("Active audio input channels: "+b.length);2===b.length&&this.detectMono(e[b[0]],e[b[1]])},channelStats:function(e,b){for(var a=0,c=0,g=0,h=0,d=0;d<b.length;d++){var l=b[d];if(0<l.length){for(var q,m=0,v=0;v<l.length;v++)q=
Math.abs(l[v]),a=Math.max(a,q),m+=q*q,a>=this.clipThreshold?(g+=1,h=Math.max(h,g)):g=0;m=Math.sqrt(m/l.length);c=Math.max(c,m)}}return a>this.silentThreshold?(b=this.dBFS(a),c=this.dBFS(c),this.test.reportInfo("Channel "+e+" levels: "+b.toFixed(1)+" dB (peak), "+c.toFixed(1)+" dB (RMS)"),c<this.lowVolumeThreshold&&this.test.reportError("Microphone input level is low, increase input volume or move closer to the microphone."),h>this.clipCountThreshold&&this.test.reportWarning("Clipping detected! Microphone input level is high. Decrease input volume or move away from the microphone."),
!0):!1},detectMono:function(e,b){for(var a=0,c=0;c<e.length;c++){var g=e[c],h=b[c];if(g.length===h.length)for(var d,l=0;l<g.length;l++)d=Math.abs(g[l]-h[l]),d>this.monoDetectThreshold&&(a+=1);else a+=1}0<a?this.test.reportInfo("Stereo microphone detected."):this.test.reportInfo("Mono microphone detected.")},dBFS:function(e){return Math.round(Math.log(e)/Math.log(10)*200)/10}}},function(m,t,n){function h(a,b,g){this.test=a;this.resolutions=b;this.currentResolution=0;this.isShuttingDown=this.isMuted=
!1;this.deviceId=g}t.a=function(a,b){switch(a.test_title){case "check_resolution_240":(new h(a,[[320,240]],b)).run();break;case "check_resolution_480":(new h(a,[[640,480]],b)).run();break;case "check_resolution_720":(new h(a,[[1280,720]],b)).run();break;case "check_supported_resolutions":(new h(a,[[160,120],[320,180],[320,240],[640,360],[640,480],[768,576],[1024,576],[1280,720],[1280,768],[1280,800],[1920,1080],[1920,1200],[3840,2160],[4096,2160]],b)).run()}};m=n(72);var l=n.n(m);m=n(18);var e=n.n(m),
b=n(13);h.prototype={run:function(){this.startGetUserMedia(this.resolutions[this.currentResolution],this.deviceId);this.currentResolution+=1},startGetUserMedia:function(a,b){var c=this;navigator.mediaDevices.getUserMedia({audio:!1,video:{width:{exact:a[0]},height:{exact:a[1]},deviceId:b}}).then(function(b){1<c.resolutions.length?(c.test.reportSuccess("Supported resolution: "+a[0]+"x"+a[1]),b.getTracks().forEach(function(a){a.stop()}),c.maybeContinueGetUserMedia()):c.collectAndAnalyzeStats(b,a)}).catch(function(b){1<
c.resolutions.length?c.test.reportInfo(a[0]+"x"+a[1]+" not supported"):c.test.reportError("getUserMedia failed with error: "+b.name);c.maybeContinueGetUserMedia()})},maybeContinueGetUserMedia:function(){this.currentResolution===this.resolutions.length?this.test.done():(this.startGetUserMedia(this.resolutions[this.currentResolution]),this.currentResolution+=1)},collectAndAnalyzeStats:function(a,c){var g=this,h=a.getVideoTracks();if(1>h.length)this.test.reportError("No video track in returned stream."),
this.maybeContinueGetUserMedia();else{h=h[0];"function"===typeof h.addEventListener&&(h.addEventListener("ended",function(){g.isShuttingDown||g.test.reportError("Video track ended, camera stopped working")}),h.addEventListener("mute",function(){g.isShuttingDown||(g.test.reportWarning("Your camera reported itself as muted."),g.isMuted=!0)}),h.addEventListener("unmute",function(){g.isShuttingDown||(g.test.reportInfo("Your camera reported itself as unmuted."),g.isMuted=!1)}));h=document.createElement("video");
h.setAttribute("autoplay","");h.setAttribute("muted","");h.width=c[0];h.height=c[1];h.srcObject=a;var d=new l.a(h),m=new e.a(null,this.test);m.pc1.addStream(a);m.establishConnection();m.gatherStats(m.pc1,null,a,this.onCallEnded.bind(this,c,h,a,d),100);b.setTimeoutWithProgressBar(this.endCall.bind(this,m,a),8E3)}},onCallEnded:function(a,b,g,e,d,h){this.analyzeStats(a,b,g,e,d,h);e.stop();this.test.done()},analyzeStats:function(a,c,g,e,d,h){var l=[],m=[],r=[],p={};e=e.frameStats;for(var n in d)"ssrc"===
d[n].type&&0<parseInt(d[n].googFrameRateInput)&&(l.push(parseInt(d[n].googAvgEncodeMs)),m.push(parseInt(d[n].googFrameRateInput)),r.push(parseInt(d[n].googFrameRateSent)));p.cameraName=g.getVideoTracks()[0].label||NaN;p.actualVideoWidth=c.videoWidth;p.actualVideoHeight=c.videoHeight;p.mandatoryWidth=a[0];p.mandatoryHeight=a[1];p.encodeSetupTimeMs=this.extractEncoderSetupTime(d,h);p.avgEncodeTimeMs=b.arrayAverage(l);p.minEncodeTimeMs=b.arrayMin(l);p.maxEncodeTimeMs=b.arrayMax(l);p.avgInputFps=b.arrayAverage(m);
p.minInputFps=b.arrayMin(m);p.maxInputFps=b.arrayMax(m);p.avgSentFps=b.arrayAverage(r);p.minSentFps=b.arrayMin(r);p.maxSentFps=b.arrayMax(r);p.isMuted=this.isMuted;p.testedFrames=e.numFrames;p.blackFrames=e.numBlackFrames;p.frozenFrames=e.numFrozenFrames;this.testExpectations(p)},endCall:function(a,b){this.isShuttingDown=!0;b.getTracks().forEach(function(a){a.stop()});a.close()},extractEncoderSetupTime:function(a,b){for(var c=0;c!==a.length;c++)if("ssrc"===a[c].type&&0<parseInt(a[c].googFrameRateInput))return JSON.stringify(b[c]-
b[0]);return NaN},resolutionMatchesIndependentOfRotationOrCrop:function(a,b,e,h){var c=Math.min(e,h);return a===e&&b===h||a===h&&b===e||a===c&&h===c},testExpectations:function(a){var b=[],e;for(e in a)a.hasOwnProperty(e)&&("number"===typeof a[e]&&isNaN(a[e])?b.push(e):this.test.reportInfo(e+": "+a[e]));0!==b.length&&this.test.reportInfo("Not available: "+b.join(", "));isNaN(a.avgSentFps)?this.test.reportInfo("Cannot verify sent FPS."):5>a.avgSentFps?this.test.reportError("Low average sent FPS: "+
a.avgSentFps):this.test.reportSuccess("Average FPS above threshold");this.resolutionMatchesIndependentOfRotationOrCrop(a.actualVideoWidth,a.actualVideoHeight,a.mandatoryWidth,a.mandatoryHeight)?this.test.reportSuccess("Captured video using expected resolution."):this.test.reportError("Incorrect captured resolution.");0===a.testedFrames?this.test.reportError("Could not analyze any video frame."):(a.blackFrames>a.testedFrames/3&&this.test.reportError("Camera delivering lots of black frames."),a.frozenFrames>
a.testedFrames/3&&this.test.reportError("Camera delivering lots of frozen frames."))}}},function(m,t,n){function h(e){this.frameStats={numFrozenFrames:0,numBlackFrames:0,numFrames:0};this.running_=!0;this.nonBlackPixelLumaThreshold=20;this.previousFrame_=[];this.identicalFrameSsimThreshold=.985;this.frameComparator=new l;this.canvas_=document.createElement("canvas");this.videoElement_=e;this.listener_=this.checkVideoFrame_.bind(this);this.videoElement_.addEventListener("play",this.listener_,!1)}function l(){}
h.prototype={stop:function(){this.videoElement_.removeEventListener("play",this.listener_);this.running_=!1},getCurrentImageData_:function(){this.canvas_.width=this.videoElement_.width;this.canvas_.height=this.videoElement_.height;var e=this.canvas_.getContext("2d");e.drawImage(this.videoElement_,0,0,this.canvas_.width,this.canvas_.height);return e.getImageData(0,0,this.canvas_.width,this.canvas_.height)},checkVideoFrame_:function(){if(this.running_&&!this.videoElement_.ended){var e=this.getCurrentImageData_();
this.isBlackFrame_(e.data,e.data.length)&&(this.frameStats.numBlackFrames+=1);this.frameComparator.calculate(this.previousFrame_,e.data)>this.identicalFrameSsimThreshold&&(this.frameStats.numFrozenFrames+=1);this.previousFrame_=e.data;this.frameStats.numFrames+=1;setTimeout(this.checkVideoFrame_.bind(this),20)}},isBlackFrame_:function(e,b){for(var a=this.nonBlackPixelLumaThreshold,c=0,g=4;g<b;g+=4)if(c+=.21*e[g]+.72*e[g+1]+.07*e[g+2],c>a*g/4)return!1;return!0}};l.prototype={statistics:function(e){var b=
0,a;for(a=0;a<e.length;++a)b+=e[a];var c=b/(e.length-1);for(a=1;a<e.length;++a){var g=e[a-1]-c;b+=e[a]+g*g}return{mean:c,variance:b/e.length}},covariance:function(e,b,a,c){for(var g=0,h=0;h<e.length;h+=1)g+=(e[h]-a)*(b[h]-c);return g/e.length},calculate:function(e,b){if(e.length!==b.length)return 0;var a=6.5025,c=58.5225,g=c/2,h=this.statistics(e),d=h.mean;h=h.variance;var l=Math.sqrt(h),q=this.statistics(b),m=q.mean;q=q.variance;var v=Math.sqrt(q);e=this.covariance(e,b,d,m);return(2*d*m+a)/(d*d+
m*m+a)*((2*l*v+c)/(h+q+c))*((e+g)/(l*v+g))}};m.exports=h},function(m,t,n){function h(e,b,a,c){this.test=e;this.protocol=b;this.params=a;this.iceCandidateFilter=c}t.a=function(e){switch(e.test_title){case "udp_enabled":(new h(e,"udp",null,l.a.isRelay)).run();break;case "tcp_enabled":(new h(e,"tcp",null,l.a.isRelay)).run();break;case "ipv6_enabled":(new h(e,null,{optional:[{googIPv6:!0}]},l.a.isIpv6)).run()}};m=n(18);var l=n.n(m);h.prototype={run:function(){this.iceCandidateFilter.toString()===l.a.isIpv6.toString()?
this.gatherCandidates(null,this.params,this.iceCandidateFilter):"TURN"===this.test.server?l.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):l.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(e){this.filterConfig(e,this.protocol);this.gatherCandidates(e,this.params,this.iceCandidateFilter)},filterConfig:function(e,b){var a=[],c=e.iceServers[0],g=[];b="transport="+b;b=c.urls.startsWith("turns")?
c.urls+"?"+b:c.urls;g.push(b);c.urls=g;a.push(c);e.iceServers=a},gatherCandidates:function(e,b,a){var c=this;try{var g=new RTCPeerConnection(e,b)}catch(w){null!==b&&b.optional[0].googIPv6?this.test.reportError("Failed to create peer connection, IPv6 might not be setup/supported on the network."):this.test.reportError("Failed to create peer connection: "+w);this.test.done();return}g.addEventListener("icecandidate",function(e){"closed"!==e.currentTarget.signalingState&&(e.candidate?(e=l.a.parseCandidate(e.candidate.candidate),
a(e)&&(c.test.reportSuccess("Gathered candidate of Type: "+e.type+" Protocol: "+e.protocol+" Address: "+e.address),g.close(),g=null,c.test.done())):(g.close(),g=null,null!==b&&b.optional[0].googIPv6?c.test.reportError("Failed to gather IPv6 candidates, it might not be setup/supported on the network."):c.test.reportError("Failed to gather specified candidates"),c.test.done()))});this.createAudioOnlyReceiveOffer(g)},createAudioOnlyReceiveOffer:function(e){function b(){}e.createOffer({offerToReceiveAudio:1}).then(function(a){e.setLocalDescription(a).then(b,
b)},b)}}},function(m,t,n){function h(e,b){this.test=e;this.iceCandidateFilter=b;this.timeout=null;this.parsedCandidates=[];this.call=null}t.a=function(e){switch(e.test_title){case "relay_connectivity":(new h(e,l.a.isRelay)).run();break;case "reflexive_connectivity":(new h(e,l.a.isReflexive)).run();break;case "host_connectivity":(new h(e,l.a.isHost)).start()}};m=n(18);var l=n.n(m);h.prototype={run:function(){"TURN"===this.test.server?l.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),
this.test.region):l.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(e){var b=this;this.call=new l.a(e,this.test);this.call.setIceCandidateFilter(this.iceCandidateFilter);this.call.pc1.addEventListener("icecandidate",function(a){a.candidate&&(a=l.a.parseCandidate(a.candidate.candidate),b.parsedCandidates.push(a),b.iceCandidateFilter(a)&&b.test.reportInfo("Gathered candidate of Type: "+a.type+" Protocol: "+a.protocol+" Address: "+
a.address))});var a=this.call.pc1.createDataChannel(null);a.addEventListener("open",function(){a.send("hello")});a.addEventListener("message",function(a){"world"!==a.data?b.test.reportError("Invalid data transmitted."):b.test.reportSuccess("Data successfully transmitted between peers.");b.hangup()});this.call.pc2.addEventListener("datachannel",function(a){var c=a.channel;c.addEventListener("message",function(a){"hello"!==a.data?b.hangup("Invalid data transmitted."):c.send("world")})});this.call.establishConnection();
this.timeout=setTimeout(this.hangup.bind(this,"Timed out"),5E3)},filterConfig:function(e){var b=[],a=e.iceServers[0],c=[],g=a.urls.startsWith("turns")?a.urls+"?transport=tcp":a.urls;c.push(g);a.urls=c;b.push(a);e.iceServers=b},findParsedCandidateOfSpecifiedType:function(e){for(var b in this.parsedCandidates)if(e(this.parsedCandidates[b]))return e(this.parsedCandidates[b])},hangup:function(e){e&&("Timed out"===e&&this.iceCandidateFilter.toString()===l.a.isReflexive.toString()&&this.findParsedCandidateOfSpecifiedType(l.a.isReflexive)?
this.test.reportWarning("Could not connect using reflexive candidates, likely due to the network environment/configuration."):this.test.reportError(e));clearTimeout(this.timeout);this.call.close();this.test.done()}}},function(m,t,n){function h(a,b){this.test=a;this.testDurationSeconds=1*b;this.startTime=null;this.receivedPayloadBytes=this.sentPayloadBytes=0;this.stopSending=!1;this.samplePacket="";for(a=0;1024!==a;++a)this.samplePacket+="h";this.maxNumberOfPacketsToSend=1;this.bytesToKeepBuffered=
1024*this.maxNumberOfPacketsToSend;this.lastBitrateMeasureTime=null;this.lastReceivedPayloadBytes=0;this.receiveChannel=this.senderChannel=this.call=null}function l(a,b,d){this.test=a;this.maxVideoBitrateKbps=2E3;this.durationMs=1E3*d;this.statStepMs=100;this.bweStats=new c.StatisticsAggregate(750*this.maxVideoBitrateKbps);this.rttStats=new c.StatisticsAggregate;this.qpSum=this.pliCount=this.nackCount=this.packetsLost=-1;this.packetsReceived=this.packetsSent=0;this.bitrateMean=this.framesSent=this.videoBytesRecieved=
this.videoBytesSent=this.framesDecoded=this.framesEncoded=-1;this.videoStats=[];this.call=this.startTime=null;this.deviceId=b;this.bytesSent=0;this.constraints={audio:!1,video:{optional:[{minWidth:320},{minHeight:240}]}}}function e(a,b){this.test=a;this.candidateFilter=b;this.testDurationMs=3E5;this.sendIntervalMs=100;this.delays=[];this.recvTimeStamps=[];this.running=!1;this.receiveChannel=this.senderChannel=this.call=null}function b(a,b,d){this.test=a;this.maxAudioBitrateKbps=2E3;this.durationMs=
1E3*d;this.statStepMs=100;this.bweStats=new c.StatisticsAggregate(750*this.maxAudioBitrateKbps);this.rttStats=new c.StatisticsAggregate;this.audioBytesRecieved=this.audioBytesSent=this.packetsReceived=this.packetsSent=this.packetsLost=-1;this.startTime=null;this.jitter=0;this.call=null;this.bytesSent=0;this.deviceId=b;this.constraints={audio:!0}}t.a=function(c,d,g){switch(c.test_title){case "data_throughput":(new h(c,g)).run();break;case "video_bandwidth":(new l(c,d,g)).run();break;case "audio_bandwidth":(new b(c,
d,g)).run();break;case "network_latency":(new e(c,a.a.isNotHostCandidate)).run()}};m=n(18);var a=n.n(m),c=n(13),g=[2,6],w=[200,500],d=[200,500],r=[10,30],q=[250,500,800],D=[0,30];h.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(b){this.call=new a.a(b,this.test);this.call.setIceCandidateFilter(a.a.isRelay);
this.senderChannel=this.call.pc1.createDataChannel(null);this.senderChannel.addEventListener("open",this.sendingStep.bind(this));this.call.pc2.addEventListener("datachannel",this.onReceiverChannel.bind(this));this.call.establishConnection();this.timeout=setTimeout(this.hangup.bind(this,"Timed out"),3E4)},hangup:function(a){a&&("Timed out"===a?this.test.reportError("maximum timeout"):this.test.reportError(a));clearTimeout(this.timeout);this.call.close();this.test.done()},onReceiverChannel:function(a){this.receiveChannel=
a.channel;this.receiveChannel.addEventListener("message",this.onMessageReceived.bind(this))},sendingStep:function(){clearTimeout(this.timeout);var a=new Date;this.startTime||(this.lastBitrateMeasureTime=this.startTime=a);for(var b=0;b!==this.maxNumberOfPacketsToSend&&!(this.senderChannel.bufferedAmount>=this.bytesToKeepBuffered);++b)this.sentPayloadBytes+=this.samplePacket.length,this.senderChannel.send(this.samplePacket);a-this.startTime>=1E3*this.testDurationSeconds?(this.test.setProgress(100),
this.stopSending=!0):(this.test.setProgress((a-this.startTime)/(10*this.testDurationSeconds)),setTimeout(this.sendingStep.bind(this),1))},onMessageReceived:function(a){this.receivedPayloadBytes+=a.data.length;a=new Date;if(1E3<=a-this.lastBitrateMeasureTime){var b=(this.receivedPayloadBytes-this.lastReceivedPayloadBytes)/(a-this.lastBitrateMeasureTime);b=Math.round(8E3*b)/1E3;this.test.reportSuccess("Transmitting at "+b+" kbps.");this.lastReceivedPayloadBytes=this.receivedPayloadBytes;this.lastBitrateMeasureTime=
a}this.stopSending&&this.sentPayloadBytes===this.receivedPayloadBytes&&(this.call.close(),this.call=null,this.test.reportSuccess("Total transmitted: "+8*this.receivedPayloadBytes/1E3+" kilo-bits in "+Math.round(10*(a-this.startTime))/1E4+" seconds."),this.test.done())}};l.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),
this.test.region)},start:function(b){this.call=new a.a(b,this.test);this.call.setIceCandidateFilter(a.a.isRelay);this.call.disableVideoFec();this.call.constrainVideoBitrate(this.maxVideoBitrateKbps);c.appendSourceId(this.deviceId,"video",this.constraints);c.doGetUserMedia(this.constraints,this.gotStream.bind(this),this.onFail.bind(this))},onFail:function(a){this.test.reportError("getUserMedia failed with error: "+a);this.test.done()},gotStream:function(a){this.call.pc1.addStream(a);this.call.establishConnection();
this.startTime=new Date;this.localStream=a.getVideoTracks()[0];setTimeout(this.gatherStats.bind(this),this.statStepMs)},gatherStats:function(){var a=new Date;a-this.startTime>this.durationMs?(this.test.setProgress(100),this.hangup()):(this.call.statsGatheringRunning||this.call.gatherStats(this.call.pc1,this.call.pc2,this.localStream,this.gotStats.bind(this)),this.test.setProgress(100*(a-this.startTime)/this.durationMs),setTimeout(this.gatherStats.bind(this),this.statStepMs))},gotStats:function(a,
b,c,d){if("chrome"===adapter.browserDetails.browser)for(var e in a)"undefined"!==typeof a[e].connection&&(this.bweStats.add(a[e].connection.timestamp,parseInt(a[e].connection.availableOutgoingBitrate)),this.rttStats.add(a[e].connection.timestamp,parseInt(1E3*a[e].connection.currentRoundTripTime)),this.videoStats[0]=a[e].video.local.frameWidth,this.videoStats[1]=a[e].video.local.frameHeight,this.nackCount=a[e].video.local.nackCount,this.packetsLost=c[e].video.remote.packetsLost,this.qpSum=c[e].video.remote.qpSum,
this.pliCount=a[e].video.local.pliCount,this.packetsSent=a[e].video.local.packetsSent,this.packetsReceived=c[e].video.remote.packetsReceived,this.framesEncoded=a[e].video.local.framesEncoded,this.videoBytesSent=a[e].video.local.bytesSent,this.videoBytesRecieved=c[e].video.remote.bytesReceived,this.framesDecoded=c[e].video.remote.framesDecoded);else if("firefox"===adapter.browserDetails.browser)for(var g in a)(b=1E3*a[g].video.remote.roundTripTime)&&this.rttStats.add(a[g].video.remote.timestamp,parseInt(b)),
this.bytesSent+=a[g].connection.bytesSent,this.packetsSent=a[g].video.local.packetsSent,this.packetsLost=c[g].video.remote.packetsLost,this.packetsReceived=c[g].video.remote.packetsReceived,this.qpSum=c[g].video.remote.qpSum,this.bitrateMean=a[g].video.local.bitrateMean,this.videoBytesSent=a[g].video.local.bytesSent,this.videoBytesRecieved=c[g].video.remote.bytesReceived;else this.test.reportError("Only Firefox and Chrome getStats implementations are supported.");this.completed()},hangup:function(){this.call.pc1.getLocalStreams()[0].getTracks().forEach(function(a){a.stop()});
this.call.close();this.call=null},completed:function(){if("chrome"===adapter.browserDetails.browser){var a=(new Date-this.startTime)/1E3;if(2>this.videoStats[0]&&2>this.videoStats[1])this.test.reportError("Camera failure: "+this.videoStats[0]+"x"+this.videoStats[1]+". Cannot test bandwidth without a working  camera.");else{this.test.reportSuccess("Video resolution: "+this.videoStats[0]+"x"+this.videoStats[1]);var b=Math.round(this.bweStats.getAverage()/1E3);var c=b<d[0]?"poor":b<d[1]?"moderate":"good";
var e=b<q[0]?1:b<q[1]?2:b<q[2]?4:5;this.test.reportByState("Average Video bandwidth (Send): "+b+" kbps",c);!0===this.test.bitrate_only&&this.test.fillBandwidth(this.bweStats.getAverage());!1===this.test.bitrate_only&&(this.test.reportInfo("Recommended no. of incoming videos :"+e),this.test.reportInfo("Send bandwidth estimate max: "+this.bweStats.getMax()/1E3+" kbps"),this.test.reportInfo("Send bandwidth ramp-up time: "+this.bweStats.getRampUpTime()+" ms"),this.test.reportInfo("Packets sent: "+this.packetsSent),
this.test.reportInfo("Packets received: "+this.packetsReceived),this.test.reportInfo("NACK count: "+this.nackCount),this.test.reportInfo("Picture loss indications: "+this.pliCount),this.test.reportInfo("Quality predictor sum: "+this.qpSum),this.test.reportInfo("Frames encoded: "+this.framesEncoded),this.test.reportInfo("Frames decoded: "+this.framesDecoded));0<this.packetsSent&&(c=(this.packetsSent-this.packetsReceived)/this.packetsSent*100,b=c<g[0]?"good":c<g[1]?"moderate":"poor",this.test.reportByState("Packets lost: "+
c.toFixed(2)+"%",b),!0===this.test.bitrate_only&&this.test.fillPacketsLost(c.toFixed(2)));b=(8*this.videoBytesSent/(1E3*a)).toFixed(2);a=(8*this.videoBytesRecieved/(1E3*a)).toFixed(2);this.test.reportInfo("Video Bitrate (Send) :"+b+" kbps");this.test.reportInfo("Video Bitrate (Receive) :"+a+" kbps")}}else"firefox"===adapter.browserDetails.browser&&(this.test.reportInfo("Bitrate Mean (Send): "+parseInt(this.bitrateMean)/1E3+" kbps"),a=(new Date-this.startTime)/1E3,b=(8*this.bytesSent/(1E3*a)).toFixed(2),
this.test.reportByState("Average Video bandwidth (Send): "+b+" kbps",b<d[0]?"poor":b<d[1]?"moderate":"good"),!0===this.test.bitrate_only&&this.test.fillBandwidth(1E3*b),!1===this.test.bitrate_only&&(this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+this.packetsReceived)),0<this.packetsSent&&(c=(this.packetsSent-this.packetsReceived)/this.packetsSent*100,b=c<g[0]?"good":c<g[1]?"moderate":"poor",this.test.reportByState("Packets lost: "+c.toFixed(2)+"%",
b),!0===this.test.bitrate_only&&this.test.fillPacketsLost(c.toFixed(2))),b=(8*this.videoBytesSent/(1E3*a)).toFixed(2),a=(8*this.videoBytesRecieved/(1E3*a)).toFixed(2),this.test.reportInfo("Video Bitrate (Send) :"+b+" kbps"),this.test.reportInfo("Video Bitrate (Receive) :"+a+" kbps"));a=this.rttStats.getAverage();this.test.reportByState("RTT average: "+a+" ms",a<w[0]?"good":a<w[1]?"moderate":"poor");!1===this.test.bitrate_only&&this.test.reportInfo("RTT max: "+this.rttStats.getMax()+" ms");this.test.done()}};
e.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(b){this.filterConfig(b);this.running=!0;this.call=new a.a(b,this.test);this.call.setIceCandidateFilter(this.candidateFilter);this.senderChannel=this.call.pc1.createDataChannel({ordered:!1,maxRetransmits:0});this.senderChannel.addEventListener("open",
this.send.bind(this));this.call.pc2.addEventListener("datachannel",this.onReceiverChannel.bind(this));this.call.establishConnection();c.setTimeoutWithProgressBar(this.finishTest.bind(this),this.testDurationMs)},filterConfig:function(a){var b=[],c=a.iceServers[0],d=[],e=c.urls.startsWith("turns")?c.urls+"?transport=tcp":c.urls;d.push(e);c.urls=d;b.push(c);a.iceServers=b},onReceiverChannel:function(a){this.receiveChannel=a.channel;this.receiveChannel.addEventListener("message",this.receive.bind(this))},
send:function(){this.running&&(this.senderChannel.send(""+Date.now()),setTimeout(this.send.bind(this),this.sendIntervalMs))},receive:function(a){if(this.running){a=parseInt(a.data);var b=Date.now()-a;this.recvTimeStamps.push(a);this.delays.push(b);this.test.fillData(a+b,b)}},finishTest:function(){this.running=!1;this.call.close();this.call=null;var a=c.arrayMax(this.delays),b=c.arrayMin(this.delays);this.delays.length<.8*this.testDurationMs/this.sendIntervalMs?this.test.reportError("Not enough samples gathered. Keep the page on  the foreground while the test is running."):
this.test.reportSuccess("Collected "+this.delays.length+" delay samples.");a>2*(b+100)&&this.test.reportError("There is a big difference between the min and max delay of packets. Your network appears unstable.min="+b+"max="+a);this.test.done()}};b.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},
start:function(b){this.call=new a.a(b,this.test);this.call.setIceCandidateFilter(a.a.isRelay);c.appendSourceId(this.deviceId,"audio",this.constraints);c.doGetUserMedia(this.constraints,this.gotStream.bind(this),this.onFail.bind(this))},onFail:function(a){this.test.reportError("getUserMedia failed with error: "+a);this.test.done()},gotStream:function(a){this.call.pc1.addStream(a);this.call.establishConnection();this.startTime=new Date;this.localStream=a.getAudioTracks()[0];setTimeout(this.gatherStats.bind(this),
this.statStepMs)},gatherStats:function(){var a=new Date;a-this.startTime>this.durationMs?(this.test.setProgress(100),this.hangup()):(this.call.statsGatheringRunning||this.call.gatherStats(this.call.pc1,this.call.pc2,this.localStream,this.gotStats.bind(this)),this.test.setProgress(100*(a-this.startTime)/this.durationMs),setTimeout(this.gatherStats.bind(this),this.statStepMs))},gotStats:function(a,b,c,d){if("chrome"===adapter.browserDetails.browser)for(var e in a)"undefined"!==typeof a[e].connection&&
(this.bweStats.add(a[e].connection.timestamp,parseInt(a[e].connection.availableOutgoingBitrate)),this.rttStats.add(a[e].connection.timestamp,parseInt(1E3*a[e].connection.currentRoundTripTime)),this.packetsLost=c[e].audio.remote.packetsLost,this.packetsSent=a[e].audio.local.packetsSent,this.packetsReceived=c[e].audio.remote.packetsReceived,this.audioBytesSent=a[e].audio.local.bytesSent,this.audioBytesRecieved=c[e].audio.remote.bytesReceived,this.jitter=c[e].audio.remote.jitter);else if("firefox"===
adapter.browserDetails.browser)for(var g in a)(b=1E3*a[g].audio.remote.roundTripTime)&&this.rttStats.add(a[g].audio.remote.timestamp,parseInt(b)),this.bytesSent+=a[g].connection.bytesSent,this.packetsSent=a[g].audio.local.packetsSent,this.packetsLost=c[g].audio.remote.packetsLost,this.packetsReceived=c[g].audio.remote.packetsReceived,this.jitter=c[g].audio.remote.jitter,this.audioBytesSent=a[g].audio.local.bytesSent,this.audioBytesRecieved=c[g].audio.remote.bytesReceived;else this.test.reportError("Only Firefox and Chrome getStats implementations are supported.");
this.completed()},hangup:function(){this.call.pc1.getLocalStreams()[0].getTracks().forEach(function(a){a.stop()});this.call.close();this.call=null},completed:function(){if("chrome"===adapter.browserDetails.browser){var a=(new Date-this.startTime)/1E3,b=Math.round(this.bweStats.getAverage()/1E3);this.test.reportByState("Average Audio bandwidth (Send): "+b+" kbps",b<r[0]?"poor":b<r[1]?"moderate":"good");!0===this.test.bitrate_only&&this.test.fillBandwidth(this.bweStats.getAverage());0==this.test.bitrate_only&&
(this.test.reportInfo("Send bandwidth estimate max: "+this.bweStats.getMax()/1E3+" kbps"),this.test.reportInfo("Send bandwidth ramp-up time: "+this.bweStats.getRampUpTime()+" ms"),this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+this.packetsReceived));if(0<this.packetsSent){var c=(this.packetsSent-this.packetsReceived)/this.packetsSent*100;b=c<g[0]?"good":c<g[1]?"moderate":"poor";this.test.reportByState("Packets lost: "+c.toFixed(2)+"%",b);!0===this.test.bitrate_only&&
this.test.fillPacketsLost(c.toFixed(2))}b=(8*this.audioBytesSent/(1E3*a)).toFixed(2);a=(8*this.audioBytesRecieved/(1E3*a)).toFixed(2);this.test.reportInfo("Audio Bitrate (Send) :"+b+" kbps");this.test.reportInfo("Audio Bitrate (Receive) :'"+a+" 'kbps");a=1E3*this.jitter;a>D[1]||a<=D[0]||this.test.reportByState("Jitter: "+a,"good")}else"firefox"===adapter.browserDetails.browser&&(a=(new Date-this.startTime)/1E3,!1===this.test.bitrate_only&&(this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+
this.packetsReceived)),0<this.packetsSent&&(c=(this.packetsSent-this.packetsReceived)/this.packetsSent*100,b=c<g[0]?"good":c<g[1]?"moderate":"poor",this.test.reportByState("Packets lost: "+c.toFixed(2)+"%",b),!0===this.test.bitrate_only&&this.test.fillPacketsLost(c.toFixed(2))),b=1E3*this.jitter,b>D[1]||b<=D[0]||this.test.reportByState("Jitter: "+b,"good"),b=(8*this.audioBytesSent/(1E3*a)).toFixed(2),a=(8*this.audioBytesRecieved/(1E3*a)).toFixed(2),this.test.reportInfo("Audio Bitrate (Send) :"+b+
" kbps"),this.test.reportInfo("Audio Bitrate (Receive) :'"+a+" 'kbps"));a=this.rttStats.getAverage();this.test.reportByState("RTT average: "+a+" ms",a<w[0]?"good":a<w[1]?"moderate":"poor");!1===this.test.bitrate_only&&this.test.reportInfo("RTT max: "+this.rttStats.getMax()+" ms");this.test.done()}}},function(m,t,n){function h(e,b,a){this.test=e;this.host=b;this.port=a}t.a=function(e,b,a){(new h(e,b,a)).run()};var l=n(77);h.prototype={run:function(){var e=this;l("https://"+this.host+":"+this.port+
"/proxy-token",{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"No"}}).then(function(b){return b.json()}).then(function(b){e.test.reportSuccess("Token created successfully.");if(!1===Object.prototype.hasOwnProperty.call(b,"token"))e.test.reportError("Token creation failed due to error: "+b.error),e.test.done();else{var a={video:!0,audio:!0,data:!0,videoSize:{LD:[80,45,640,360]}.SD,attributes:{name:"Test connectivity"}},c=EnxRtc.Logger.getLogLevel();EnxRtc.Logger.setLogLevel(EnxRtc.Logger.NONE);
EnxRtc.joinRoom(b.token,a,function(a,b){EnxRtc.Logger.setLogLevel(c);b&&null!=b?(e.test.reportError("Room not joined due to error: "+b.type),e.test.done()):a&&null!=a&&(a.room.disconnect(),e.test.reportSuccess("Room joined successfully."),e.test.done())})}}).catch(function(b){e.test.reportError("Token creation failed due to error: "+b);e.test.done()})}}},function(m,t,n){var h=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof h)return h;
throw Error("unable to locate global object");}();if(m.exports=t=h.fetch)t.default=h.fetch.bind(h);t.Headers=h.Headers;t.Request=h.Request;t.Response=h.Response},function(m,t,n){function h(h){return void 0==h||"app"==h?!1:!0}n(11);t.a={setCustomData:function(h,e,b){console.log("setCustomData")},getCustomData:function(l,e){console.log("getCustomData");var b={result:0};0==h(l.scope)&&(b.result=1,b.error="Invalid scope parameter "+l.scope,e(b))},saveCustomData:function(l,e,b){console.log("saveCustomData");
var a={result:0};if(0==h(l))a.result=1,a.error="Invalid scope parameter: "+l;else if(void 0==e||"object"!=typeof e)a.result=1,a.error="Invalid  data";b(a)}}},function(m,t){},function(m,t,n){t=n(31);m.exports=t.adapter=n(81)},function(m,t,n){m.exports=function(){return function(){function h(l,e,b){function a(g,d){if(!e[g]){if(!l[g]){if(c)return c(g,!0);d=Error("Cannot find module '"+g+"'");throw d.code="MODULE_NOT_FOUND",d;}d=e[g]={exports:{}};l[g][0].call(d.exports,function(b){return a(l[g][1][b]||
b)},d,d.exports,h,l,e,b)}return e[g].exports}for(var c=!1,g=0;g<b.length;g++)a(b[g]);return a}return h}()({1:[function(h,l,e){h=h("./adapter_factory.js");h=(0,h.adapterFactory)({window:window});l.exports=h},{"./adapter_factory.js":2}],2:[function(h,l,e){function b(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}Object.defineProperty(e,"__esModule",{value:!0});e.adapterFactory=function(){var b=(0<arguments.length&&
void 0!==arguments[0]?arguments[0]:{}).window,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},h=a.log,l=a.detectBrowser(b),n={browserDetails:l,commonShim:r,extractVersion:a.extractVersion,disableLog:a.disableLog,disableWarnings:a.disableWarnings};switch(l.browser){case "chrome":if(!c||!c.shimPeerConnection||!e.shimChrome){h("Chrome shim is not included in this adapter release.");break}h("adapter.js shimming chrome.");n.browserShim=
c;c.shimGetUserMedia(b);c.shimMediaStream(b);c.shimPeerConnection(b);c.shimOnTrack(b);c.shimAddTrackRemoveTrack(b);c.shimGetSendersWithDtmf(b);c.shimGetStats(b);c.shimSenderReceiverGetStats(b);c.fixNegotiationNeeded(b);r.shimRTCIceCandidate(b);r.shimConnectionState(b);r.shimMaxMessageSize(b);r.shimSendThrowTypeError(b);r.removeAllowExtmapMixed(b);break;case "firefox":if(!m||!m.shimPeerConnection||!e.shimFirefox){h("Firefox shim is not included in this adapter release.");break}h("adapter.js shimming firefox.");
n.browserShim=m;m.shimGetUserMedia(b);m.shimPeerConnection(b);m.shimOnTrack(b);m.shimRemoveStream(b);m.shimSenderGetStats(b);m.shimReceiverGetStats(b);m.shimRTCDataChannel(b);r.shimRTCIceCandidate(b);r.shimConnectionState(b);r.shimMaxMessageSize(b);r.shimSendThrowTypeError(b);break;case "edge":if(!g||!g.shimPeerConnection||!e.shimEdge){h("MS edge shim is not included in this adapter release.");break}h("adapter.js shimming edge.");n.browserShim=g;g.shimGetUserMedia(b);g.shimGetDisplayMedia(b);g.shimPeerConnection(b);
g.shimReplaceTrack(b);r.shimMaxMessageSize(b);r.shimSendThrowTypeError(b);break;case "safari":if(!d||!e.shimSafari){h("Safari shim is not included in this adapter release.");break}h("adapter.js shimming safari.");n.browserShim=d;d.shimRTCIceServerUrls(b);d.shimCreateOfferLegacy(b);d.shimCallbacksAPI(b);d.shimLocalStreamsAPI(b);d.shimRemoteStreamsAPI(b);d.shimTrackEventTransceiver(b);d.shimGetUserMedia(b);r.shimRTCIceCandidate(b);r.shimMaxMessageSize(b);r.shimSendThrowTypeError(b);r.removeAllowExtmapMixed(b);
break;default:h("Unsupported browser!")}return n};l=h("./utils");var a=b(l);l=h("./chrome/chrome_shim");var c=b(l);l=h("./edge/edge_shim");var g=b(l);l=h("./firefox/firefox_shim");var m=b(l);l=h("./safari/safari_shim");var d=b(l);h=h("./common_shim");var r=b(h)},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(h,l,e){function b(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,
writable:!0}):a[b]=c;return a}function a(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(b){return a._shimmedLocalStreams[b][0]})};var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,c){if(!c)return b.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var d=b.apply(this,arguments);this._shimmedLocalStreams[c.id]?
-1===this._shimmedLocalStreams[c.id].indexOf(d)&&this._shimmedLocalStreams[c.id].push(d):this._shimmedLocalStreams[c.id]=[c,d];return d};var c=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a.getTracks().forEach(function(a){if(b.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});var d=this.getSenders();c.apply(this,
arguments);var e=this.getSenders().filter(function(a){return-1===d.indexOf(a)});this._shimmedLocalStreams[a.id]=[a].concat(e)};var d=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{};delete this._shimmedLocalStreams[a.id];return d.apply(this,arguments)};var e=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||
{};a&&Object.keys(this._shimmedLocalStreams).forEach(function(c){var d=b._shimmedLocalStreams[c].indexOf(a);-1!==d&&b._shimmedLocalStreams[c].splice(d,1);1===b._shimmedLocalStreams[c].length&&delete b._shimmedLocalStreams[c]});return e.apply(this,arguments)}}Object.defineProperty(e,"__esModule",{value:!0});e.shimGetDisplayMedia=e.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:
function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=h("./getusermedia");Object.defineProperty(e,"shimGetUserMedia",{enumerable:!0,get:function(){return g.shimGetUserMedia}});var m=h("./getdisplaymedia");Object.defineProperty(e,"shimGetDisplayMedia",{enumerable:!0,get:function(){return m.shimGetDisplayMedia}});e.shimMediaStream=function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream};
e.shimOnTrack=function(a){if("object"!==("undefined"===typeof a?"undefined":c(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)d.wrapPeerConnectionEvent(a,"track",function(a){a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}});return a});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",
this._ontrack=a)},enumerable:!0,configurable:!0});var b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var c=this;this._ontrackpoly||(this._ontrackpoly=function(b){b.stream.addEventListener("addtrack",function(d){var e=void 0;e=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===d.track.id}):{track:d.track};var g=new Event("track");g.track=d.track;g.receiver=e;g.transceiver={receiver:e};
g.streams=[b.stream];c.dispatchEvent(g)});b.stream.getTracks().forEach(function(d){var e=void 0;e=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===d.id}):{track:d};var g=new Event("track");g.track=d;g.receiver=e;g.transceiver={receiver:e};g.streams=[b.stream];c.dispatchEvent(g)})},this.addEventListener("addstream",this._ontrackpoly));return b.apply(this,arguments)}}};e.shimGetSendersWithDtmf=function(a){if("object"===("undefined"===typeof a?
"undefined":c(a))&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var b=function(a,b){return{track:b,get dtmf(){void 0===this._dtmf&&(this._dtmf="audio"===b.kind?a.createDTMFSender(b):null);return this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};var d=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=
function(a,c){var e=d.apply(this,arguments);e||(e=b(this,a),this._senders.push(e));return e};var e=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){e.apply(this,arguments);var b=this._senders.indexOf(a);-1!==b&&this._senders.splice(b,1)}}var g=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var c=this;this._senders=this._senders||[];g.apply(this,[a]);a.getTracks().forEach(function(a){c._senders.push(b(c,a))})};
var h=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._senders=this._senders||[];h.apply(this,[a]);a.getTracks().forEach(function(a){var c=b._senders.find(function(b){return b.track===a});c&&b._senders.splice(b._senders.indexOf(c),1)})}}else if("object"===("undefined"===typeof a?"undefined":c(a))&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in
a.RTCRtpSender.prototype)){var l=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=l.apply(this,[]);b.forEach(function(b){return b._pc=a});return b};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null);return this._dtmf}})}};e.shimGetStats=function(a){if(a.RTCPeerConnection){var b=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=
function(){var a=this,c=Array.prototype.slice.call(arguments),d=c[0],e=c[1];c=c[2];if(0<arguments.length&&"function"===typeof d)return b.apply(this,arguments);if(0===b.length&&(0===arguments.length||"function"!==typeof d))return b.apply(this,[]);var g=function(a){var b={};a.result().forEach(function(a){var c={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(b){c[b]=a.stat(b)});b[c.id]=c});return b},
h=function(a){return new Map(Object.keys(a).map(function(b){return[b,a[b]]}))};return 2<=arguments.length?b.apply(this,[function(a){e(h(g(a)))},d]):(new Promise(function(c,d){b.apply(a,[function(a){c(h(g(a)))},d])})).then(e,c)}}};e.shimSenderReceiverGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":c(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver){if(!("getStats"in a.RTCRtpSender.prototype)){var b=a.RTCPeerConnection.prototype.getSenders;b&&(a.RTCPeerConnection.prototype.getSenders=
function(){var a=this,c=b.apply(this,[]);c.forEach(function(b){return b._pc=a});return c});var e=a.RTCPeerConnection.prototype.addTrack;e&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=e.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return d.filterStats(b,a.track,!0)})}}if(!("getStats"in a.RTCRtpReceiver.prototype)){var g=a.RTCPeerConnection.prototype.getReceivers;g&&(a.RTCPeerConnection.prototype.getReceivers=
function(){var a=this,b=g.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});d.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return d.filterStats(b,a.track,!1)})}}if("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype){var h=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(0<
arguments.length&&arguments[0]instanceof a.MediaStreamTrack){var b=arguments[0],c=void 0,d=void 0,e=void 0;this.getSenders().forEach(function(a){a.track===b&&(c?e=!0:c=a)});this.getReceivers().forEach(function(a){a.track===b&&(d?e=!0:d=a);return a.track===b});return e||c&&d?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):c?c.getStats():d?d.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return h.apply(this,
arguments)}}}};e.shimAddTrackRemoveTrackWithNative=a;e.shimAddTrackRemoveTrack=function(c){function e(a,b){var c=b.sdp;Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];c=c.replace(new RegExp(a._streams[b.id].id,"g"),b.id)});return new RTCSessionDescription({type:b.type,sdp:c})}function g(a,b){var c=b.sdp;Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];c=c.replace(new RegExp(b.id,"g"),a._streams[b.id].id)});return new RTCSessionDescription({type:b.type,
sdp:c})}if(c.RTCPeerConnection){var h=d.detectBrowser(c);if(c.RTCPeerConnection.prototype.addTrack&&65<=h.version)return a(c);var l=c.RTCPeerConnection.prototype.getLocalStreams;c.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,b=l.apply(this);this._reverseStreams=this._reverseStreams||{};return b.map(function(b){return a._reverseStreams[b.id]})};var m=c.RTCPeerConnection.prototype.addStream;c.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._streams=this._streams||
{};this._reverseStreams=this._reverseStreams||{};a.getTracks().forEach(function(a){if(b.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});if(!this._reverseStreams[a.id]){var d=new c.MediaStream(a.getTracks());this._streams[a.id]=d;this._reverseStreams[d.id]=a;a=d}m.apply(this,[a])};var r=c.RTCPeerConnection.prototype.removeStream;c.RTCPeerConnection.prototype.removeStream=function(a){this._streams=this._streams||{};this._reverseStreams=
this._reverseStreams||{};r.apply(this,[this._streams[a.id]||a]);delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id];delete this._streams[a.id]};c.RTCPeerConnection.prototype.addTrack=function(a,b){var d=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var e=[].slice.call(arguments,1);if(1!==e.length||!e[0].getTracks().find(function(b){return b===a}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.",
"NotSupportedError");if(this.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};(e=this._streams[b.id])?(e.addTrack(a),Promise.resolve().then(function(){d.dispatchEvent(new Event("negotiationneeded"))})):(e=new c.MediaStream([a]),this._streams[b.id]=e,this._reverseStreams[e.id]=b,this.addStream(e));return this.getSenders().find(function(b){return b.track===
a})};["createOffer","createAnswer"].forEach(function(a){var d=c.RTCPeerConnection.prototype[a],g=b({},a,function(){var a=this,b=arguments;return arguments.length&&"function"===typeof arguments[0]?d.apply(this,[function(c){c=e(a,c);b[0].apply(null,[c])},function(a){b[1]&&b[1].apply(null,a)},arguments[2]]):d.apply(this,arguments).then(function(b){return e(a,b)})});c.RTCPeerConnection.prototype[a]=g[a]});var n=c.RTCPeerConnection.prototype.setLocalDescription;c.RTCPeerConnection.prototype.setLocalDescription=
function(){if(!arguments.length||!arguments[0].type)return n.apply(this,arguments);arguments[0]=g(this,arguments[0]);return n.apply(this,arguments)};var t=Object.getOwnPropertyDescriptor(c.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(c.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=t.get.apply(this);return""===a.type?a:e(this,a)}});c.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.",
"InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(a._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var c=void 0;Object.keys(this._streams).forEach(function(d){b._streams[d].getTracks().find(function(b){return a.track===b})&&(c=b._streams[d])});c&&(1===c.getTracks().length?this.removeStream(this._reverseStreams[c.id]):
c.removeTrack(a.track),this.dispatchEvent(new Event("negotiationneeded")))}}};e.shimPeerConnection=function(a){var c=d.detectBrowser(a);!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection);if(a.RTCPeerConnection){53>c.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){var d=a.RTCPeerConnection.prototype[c],e=b({},c,function(){arguments[0]=new ("addIceCandidate"===c?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]);
return d.apply(this,arguments)});a.RTCPeerConnection.prototype[c]=e[c]});var e=a.RTCPeerConnection.prototype.addIceCandidate;a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?78>c.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};e.fixNegotiationNeeded=function(a){d.wrapPeerConnectionEvent(a,"negotiationneeded",function(a){if("stable"===a.target.signalingState)return a})};
var d=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(h("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(h,l,e){Object.defineProperty(e,"__esModule",{value:!0});e.shimGetDisplayMedia=function(b,a){b.navigator.mediaDevices&&"getDisplayMedia"in b.navigator.mediaDevices||!b.navigator.mediaDevices||("function"!==typeof a?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):
b.navigator.mediaDevices.getDisplayMedia=function(c){return a(c).then(function(a){var e=c.video&&c.video.width,d=c.video&&c.video.height;c.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a,maxFrameRate:c.video&&c.video.frameRate||3}};e&&(c.video.mandatory.maxWidth=e);d&&(c.video.mandatory.maxHeight=d);return b.navigator.mediaDevices.getUserMedia(c)})})}},{}],5:[function(h,l,e){Object.defineProperty(e,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();
var b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};e.shimGetUserMedia=function(e){var g=e&&e.navigator;if(g.mediaDevices){var d=a.detectBrowser(e),h=function(a){if("object"!==("undefined"===typeof a?"undefined":b(a))||a.mandatory||a.optional)return a;var c={};Object.keys(a).forEach(function(d){if("require"!==
d&&"advanced"!==d&&"mediaSource"!==d){var e="object"===b(a[d])?a[d]:{ideal:a[d]};void 0!==e.exact&&"number"===typeof e.exact&&(e.min=e.max=e.exact);var g=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):"deviceId"===b?"sourceId":b};if(void 0!==e.ideal){c.optional=c.optional||[];var h={};"number"===typeof e.ideal?(h[g("min",d)]=e.ideal,c.optional.push(h),h={},h[g("max",d)]=e.ideal):h[g("",d)]=e.ideal;c.optional.push(h)}void 0!==e.exact&&"number"!==typeof e.exact?(c.mandatory=c.mandatory||
{},c.mandatory[g("",d)]=e.exact):["min","max"].forEach(function(a){void 0!==e[a]&&(c.mandatory=c.mandatory||{},c.mandatory[g(a,d)]=e[a])})}});a.advanced&&(c.optional=(c.optional||[]).concat(a.advanced));return c},l=function(a,e){if(61<=d.version)return e(a);if((a=JSON.parse(JSON.stringify(a)))&&"object"===b(a.audio)){var l=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])};a=JSON.parse(JSON.stringify(a));l(a.audio,"autoGainControl","googAutoGainControl");l(a.audio,"noiseSuppression","googNoiseSuppression");
a.audio=h(a.audio)}if(a&&"object"===b(a.video)){var m=a.video.facingMode;m=m&&("object"===("undefined"===typeof m?"undefined":b(m))?m:{ideal:m});l=66>d.version;if(!(!m||"user"!==m.exact&&"environment"!==m.exact&&"user"!==m.ideal&&"environment"!==m.ideal||g.mediaDevices.getSupportedConstraints&&g.mediaDevices.getSupportedConstraints().facingMode&&!l)){delete a.video.facingMode;var q=void 0;if("environment"===m.exact||"environment"===m.ideal)q=["back","rear"];else if("user"===m.exact||"user"===m.ideal)q=
["front"];if(q)return g.mediaDevices.enumerateDevices().then(function(b){b=b.filter(function(a){return"videoinput"===a.kind});var d=b.find(function(a){return q.some(function(b){return a.label.toLowerCase().includes(b)})});!d&&b.length&&q.includes("back")&&(d=b[b.length-1]);d&&(a.video.deviceId=m.exact?{exact:d.deviceId}:{ideal:d.deviceId});a.video=h(a.video);c("chrome: "+JSON.stringify(a));return e(a)})}a.video=h(a.video)}c("chrome: "+JSON.stringify(a));return e(a)},m=function(a){return 64<=d.version?
a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,
toString:function(){return this.name+(this.message&&": ")+this.message}}};g.getUserMedia=function(a,b,c){l(a,function(a){g.webkitGetUserMedia(a,b,function(a){c&&c(m(a))})})}.bind(g);if(g.mediaDevices.getUserMedia){var n=g.mediaDevices.getUserMedia.bind(g.mediaDevices);g.mediaDevices.getUserMedia=function(a){return l(a,function(a){return n(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("",
"NotFoundError");return b},function(a){return Promise.reject(m(a))})})}}}};var a=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(h("../utils.js")),c=a.log},{"../utils.js":15}],6:[function(h,l,e){Object.defineProperty(e,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:
function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};e.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var g=e.RTCIceCandidate;e.RTCIceCandidate=function(c){"object"===("undefined"===typeof c?"undefined":b(c))&&c.candidate&&0===c.candidate.indexOf("a=")&&(c=JSON.parse(JSON.stringify(c)),c.candidate=c.candidate.substr(2));
if(c.candidate&&c.candidate.length){var d=new g(c);c=a.default.parseCandidate(c.candidate);var e=Object.assign(d,c);e.toJSON=function(){return{candidate:e.candidate,sdpMid:e.sdpMid,sdpMLineIndex:e.sdpMLineIndex,usernameFragment:e.usernameFragment}};return e}return new g(c)};e.RTCIceCandidate.prototype=g.prototype;c.wrapPeerConnectionEvent(e,"icecandidate",function(a){a.candidate&&Object.defineProperty(a,"candidate",{value:new e.RTCIceCandidate(a.candidate),writable:"false"});return a})}};e.shimMaxMessageSize=
function(b){if(b.RTCPeerConnection){var e=c.detectBrowser(b);"sctp"in b.RTCPeerConnection.prototype||Object.defineProperty(b.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var d=function(b){if(!b||!b.sdp)return!1;b=a.default.splitSections(b.sdp);b.shift();return b.some(function(b){return(b=a.default.parseMLine(b))&&"application"===b.kind&&-1!==b.protocol.indexOf("SCTP")})},g=function(a){a=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===
a||2>a.length)return-1;a=parseInt(a[1],10);return a!==a?-1:a},h=function(a){var b=65536;"firefox"===e.browser&&(b=57>e.version?-1===a?16384:2147483637:60>e.version?57===e.version?65535:65536:2147483637);return b},l=function(b,c){var d=65536;"firefox"===e.browser&&57===e.version&&(d=65535);b=a.default.matchPrefix(b.sdp,"a=max-message-size:");0<b.length?d=parseInt(b[0].substr(19),10):"firefox"===e.browser&&-1!==c&&(d=2147483637);return d},m=b.RTCPeerConnection.prototype.setRemoteDescription;b.RTCPeerConnection.prototype.setRemoteDescription=
function(){this._sctp=null;"chrome"===e.browser&&76<=e.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0});if(d(arguments[0])){var a=g(arguments[0]),b=h(a);a=l(arguments[0],a);var c=void 0;c=0===b&&0===a?Number.POSITIVE_INFINITY:0===b||0===a?Math.max(b,a):Math.min(b,a);b={};Object.defineProperty(b,"maxMessageSize",{get:function(){return c}});this._sctp=b}return m.apply(this,
arguments)}}};e.shimSendThrowTypeError=function(a){function b(a,b){var c=a.send;a.send=function(){var d=arguments[0];d=d.length||d.size||d.byteLength;if("open"===a.readyState&&b.sctp&&d>b.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+b.sctp.maxMessageSize+" bytes)");return c.apply(a,arguments)}}if(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype){var d=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=
function(){var a=d.apply(this,arguments);b(a,this);return a};c.wrapPeerConnectionEvent(a,"datachannel",function(a){b(a.channel,a.target);return a})}};e.shimConnectionState=function(a){if(a.RTCPeerConnection&&!("connectionState"in a.RTCPeerConnection.prototype)){var b=a.RTCPeerConnection.prototype;Object.defineProperty(b,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0});Object.defineProperty(b,
"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(a){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange);a&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=a)},enumerable:!0,configurable:!0});["setLocalDescription","setRemoteDescription"].forEach(function(a){var c=b[a];b[a]=function(){this._connectionstatechangepoly||(this._connectionstatechangepoly=
function(a){var b=a.target;if(b._lastConnectionState!==b.connectionState){b._lastConnectionState=b.connectionState;var c=new Event("connectionstatechange",a);b.dispatchEvent(c)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly));return c.apply(this,arguments)}})}};e.removeAllowExtmapMixed=function(a){if(a.RTCPeerConnection){var b=c.detectBrowser(a);if(!("chrome"===b.browser&&71<=b.version)){var d=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=
function(a){a&&a.sdp&&-1!==a.sdp.indexOf("\na=extmap-allow-mixed")&&(a.sdp=a.sdp.split("\n").filter(function(a){return"a=extmap-allow-mixed"!==a.trim()}).join("\n"));return d.apply(this,arguments)}}}};var a=(l=h("sdp"))&&l.__esModule?l:{default:l},c=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(h("./utils"))},{"./utils":15,sdp:17}],7:[function(h,l,e){Object.defineProperty(e,"__esModule",{value:!0});
e.shimGetDisplayMedia=e.shimGetUserMedia=void 0;var b=h("./getusermedia");Object.defineProperty(e,"shimGetUserMedia",{enumerable:!0,get:function(){return b.shimGetUserMedia}});var a=h("./getdisplaymedia");Object.defineProperty(e,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}});e.shimPeerConnection=function(a){var b=c.detectBrowser(a);if(a.RTCIceGatherer&&(a.RTCIceCandidate||(a.RTCIceCandidate=function(a){return a}),a.RTCSessionDescription||(a.RTCSessionDescription=
function(a){return a}),15025>b.version)){var d=Object.getOwnPropertyDescriptor(a.MediaStreamTrack.prototype,"enabled");Object.defineProperty(a.MediaStreamTrack.prototype,"enabled",{set:function(a){d.set.call(this,a);var b=new Event("enabled");b.enabled=a;this.dispatchEvent(b)}})}!a.RTCRtpSender||"dtmf"in a.RTCRtpSender.prototype||Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new a.RTCDtmfSender(this):"video"===this.track.kind&&
(this._dtmf=null));return this._dtmf}});a.RTCDtmfSender&&!a.RTCDTMFSender&&(a.RTCDTMFSender=a.RTCDtmfSender);var e=(0,m.default)(a,b.version);a.RTCPeerConnection=function(a){a&&a.iceServers&&(a.iceServers=(0,g.filterIceServers)(a.iceServers,b.version),c.log("ICE servers after filtering:",a.iceServers));return new e(a)};a.RTCPeerConnection.prototype=e.prototype};e.shimReplaceTrack=function(a){!a.RTCRtpSender||"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)};
var c=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(h("../utils")),g=h("./filtericeservers"),m=(h=h("rtcpeerconnection-shim"))&&h.__esModule?h:{default:h}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(h,l,e){Object.defineProperty(e,"__esModule",{value:!0});e.filterIceServers=function(a,c){var e=!1;a=JSON.parse(JSON.stringify(a));
return a.filter(function(a){if(a&&(a.urls||a.url)){var c=a.urls||a.url;a.url&&!a.urls&&b.deprecated("RTCIceServer.url","RTCIceServer.urls");var g="string"===typeof c;g&&(c=[c]);c=c.filter(function(a){return 0===a.indexOf("stun:")?!1:(a=a.startsWith("turn")&&!a.startsWith("turn:[")&&a.includes("transport=udp"))&&!e?e=!0:a&&!e});delete a.url;a.urls=g?c[0]:c;return!!c.length}})};var b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&
(b[e]=a[e]);b.default=a;return b}(h("../utils"))},{"../utils":15}],9:[function(h,l,e){Object.defineProperty(e,"__esModule",{value:!0});e.shimGetDisplayMedia=function(b){"getDisplayMedia"in b.navigator&&b.navigator.mediaDevices&&!(b.navigator.mediaDevices&&"getDisplayMedia"in b.navigator.mediaDevices)&&(b.navigator.mediaDevices.getDisplayMedia=b.navigator.getDisplayMedia.bind(b.navigator))}},{}],10:[function(h,l,e){Object.defineProperty(e,"__esModule",{value:!0});e.shimGetUserMedia=function(b){b=b&&
b.navigator;var a=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}},c=b.mediaDevices.getUserMedia.bind(b.mediaDevices);b.mediaDevices.getUserMedia=function(b){return c(b).catch(function(b){return Promise.reject(a(b))})}}},{}],11:[function(h,l,e){function b(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c;return a}Object.defineProperty(e,
"__esModule",{value:!0});e.shimGetDisplayMedia=e.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},c=h("./getusermedia");Object.defineProperty(e,"shimGetUserMedia",{enumerable:!0,get:function(){return c.shimGetUserMedia}});
var g=h("./getdisplaymedia");Object.defineProperty(e,"shimGetDisplayMedia",{enumerable:!0,get:function(){return g.shimGetDisplayMedia}});e.shimOnTrack=function(b){"object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCTrackEvent&&"receiver"in b.RTCTrackEvent.prototype&&!("transceiver"in b.RTCTrackEvent.prototype)&&Object.defineProperty(b.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};e.shimPeerConnection=function(c){var d=m.detectBrowser(c);if("object"===
("undefined"===typeof c?"undefined":a(c))&&(c.RTCPeerConnection||c.mozRTCPeerConnection)){!c.RTCPeerConnection&&c.mozRTCPeerConnection&&(c.RTCPeerConnection=c.mozRTCPeerConnection);53>d.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){var d=c.RTCPeerConnection.prototype[a],e=b({},a,function(){arguments[0]=new ("addIceCandidate"===a?c.RTCIceCandidate:c.RTCSessionDescription)(arguments[0]);return d.apply(this,arguments)});c.RTCPeerConnection.prototype[a]=
e[a]});if(68>d.version){var e=c.RTCPeerConnection.prototype.addIceCandidate;c.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var g={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},h=c.RTCPeerConnection.prototype.getStats;c.RTCPeerConnection.prototype.getStats=
function(){var a=Array.prototype.slice.call(arguments),b=a[1],c=a[2];return h.apply(this,[a[0]||null]).then(function(a){if(53>d.version&&!b)try{a.forEach(function(a){a.type=g[a.type]||a.type})}catch(z){if("TypeError"!==z.name)throw z;a.forEach(function(b,c){a.set(c,Object.assign({},b,{type:g[b.type]||b.type}))})}return a}).then(b,c)}}};e.shimSenderGetStats=function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection&&b.RTCRtpSender&&!(b.RTCRtpSender&&"getStats"in b.RTCRtpSender.prototype)){var c=
b.RTCPeerConnection.prototype.getSenders;c&&(b.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=c.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});var d=b.RTCPeerConnection.prototype.addTrack;d&&(b.RTCPeerConnection.prototype.addTrack=function(){var a=d.apply(this,arguments);a._pc=this;return a});b.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}};e.shimReceiverGetStats=function(b){if("object"===("undefined"===
typeof b?"undefined":a(b))&&b.RTCPeerConnection&&b.RTCRtpSender&&!(b.RTCRtpSender&&"getStats"in b.RTCRtpReceiver.prototype)){var c=b.RTCPeerConnection.prototype.getReceivers;c&&(b.RTCPeerConnection.prototype.getReceivers=function(){var a=this,b=c.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});m.wrapPeerConnectionEvent(b,"track",function(a){a.receiver._pc=a.srcElement;return a});b.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}};e.shimRemoveStream=
function(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;m.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(c){c.track&&a.getTracks().includes(c.track)&&b.removeTrack(c)})})};e.shimRTCDataChannel=function(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)};var m=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,
c)&&(b[c]=a[c]);b.default=a;return b}(h("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(h,l,e){Object.defineProperty(e,"__esModule",{value:!0});e.shimGetDisplayMedia=function(b,a){b.navigator.mediaDevices&&"getDisplayMedia"in b.navigator.mediaDevices||!b.navigator.mediaDevices||(b.navigator.mediaDevices.getDisplayMedia=function(c){if(!c||!c.video)return c=new DOMException("getDisplayMedia without video constraints is undefined"),c.name="NotFoundError",c.code=
8,Promise.reject(c);!0===c.video?c.video={mediaSource:a}:c.video.mediaSource=a;return b.navigator.mediaDevices.getUserMedia(c)})}},{}],13:[function(h,l,e){Object.defineProperty(e,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===
Symbol&&a!==Symbol.prototype?"symbol":typeof a};e.shimGetUserMedia=function(c){var e=a.detectBrowser(c),h=c&&c.navigator;c=c&&c.MediaStreamTrack;h.getUserMedia=function(b,c,d){a.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");h.mediaDevices.getUserMedia(b).then(c,d)};if(!(55<e.version&&"autoGainControl"in h.mediaDevices.getSupportedConstraints())){var d=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])},l=h.mediaDevices.getUserMedia.bind(h.mediaDevices);h.mediaDevices.getUserMedia=
function(a){"object"===("undefined"===typeof a?"undefined":b(a))&&"object"===b(a.audio)&&(a=JSON.parse(JSON.stringify(a)),d(a.audio,"autoGainControl","mozAutoGainControl"),d(a.audio,"noiseSuppression","mozNoiseSuppression"));return l(a)};if(c&&c.prototype.getSettings){var m=c.prototype.getSettings;c.prototype.getSettings=function(){var a=m.apply(this,arguments);d(a,"mozAutoGainControl","autoGainControl");d(a,"mozNoiseSuppression","noiseSuppression");return a}}if(c&&c.prototype.applyConstraints){var n=
c.prototype.applyConstraints;c.prototype.applyConstraints=function(a){"audio"===this.kind&&"object"===("undefined"===typeof a?"undefined":b(a))&&(a=JSON.parse(JSON.stringify(a)),d(a,"autoGainControl","mozAutoGainControl"),d(a,"noiseSuppression","mozNoiseSuppression"));return n.apply(this,[a])}}}};var a=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(h("../utils"))},{"../utils":15}],14:[function(h,
l,e){function b(a){return a&&void 0!==a.video?Object.assign({},a,{video:c.compactObject(a.video)}):a}Object.defineProperty(e,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};e.shimLocalStreamsAPI=
function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection){"getLocalStreams"in b.RTCPeerConnection.prototype||(b.RTCPeerConnection.prototype.getLocalStreams=function(){this._localStreams||(this._localStreams=[]);return this._localStreams});if(!("addStream"in b.RTCPeerConnection.prototype)){var c=b.RTCPeerConnection.prototype.addTrack;b.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._localStreams||(this._localStreams=[]);this._localStreams.includes(a)||
this._localStreams.push(a);a.getAudioTracks().forEach(function(d){return c.call(b,d,a)});a.getVideoTracks().forEach(function(d){return c.call(b,d,a)})};b.RTCPeerConnection.prototype.addTrack=function(a){var b=arguments[1];b&&(this._localStreams?this._localStreams.includes(b)||this._localStreams.push(b):this._localStreams=[b]);return c.apply(this,arguments)}}"removeStream"in b.RTCPeerConnection.prototype||(b.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._localStreams||(this._localStreams=
[]);var c=this._localStreams.indexOf(a);if(-1!==c){this._localStreams.splice(c,1);var d=a.getTracks();this.getSenders().forEach(function(a){d.includes(a.track)&&b.removeTrack(a)})}})}};e.shimRemoteStreamsAPI=function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection&&("getRemoteStreams"in b.RTCPeerConnection.prototype||(b.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in b.RTCPeerConnection.prototype))){Object.defineProperty(b.RTCPeerConnection.prototype,
"onaddstream",{get:function(){return this._onaddstream},set:function(a){var b=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=a);this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(function(a){b._remoteStreams||(b._remoteStreams=[]);if(!b._remoteStreams.includes(a)){b._remoteStreams.push(a);var c=new Event("addstream");c.stream=
a;b.dispatchEvent(c)}})})}});var c=b.RTCPeerConnection.prototype.setRemoteDescription;b.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(b){b.streams.forEach(function(b){a._remoteStreams||(a._remoteStreams=[]);if(!(0<=a._remoteStreams.indexOf(b))){a._remoteStreams.push(b);var c=new Event("addstream");c.stream=b;a.dispatchEvent(c)}})});return c.apply(a,arguments)}}};e.shimCallbacksAPI=function(b){if("object"===
("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection){b=b.RTCPeerConnection.prototype;var c=b.createOffer,d=b.createAnswer,e=b.setLocalDescription,g=b.setRemoteDescription,h=b.addIceCandidate;b.createOffer=function(a,b){var d=c.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return d;d.then(a,b);return Promise.resolve()};b.createAnswer=function(a,b){var c=d.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return c;c.then(a,b);return Promise.resolve()};
var l=function(a,b,c){a=e.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};b.setLocalDescription=l;l=function(a,b,c){a=g.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};b.setRemoteDescription=l;l=function(a,b,c){a=h.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};b.addIceCandidate=l}};e.shimGetUserMedia=function(a){var c=a&&a.navigator;if(c.mediaDevices&&c.mediaDevices.getUserMedia){a=c.mediaDevices;var d=a.getUserMedia.bind(a);c.mediaDevices.getUserMedia=
function(a){return d(b(a))}}!c.getUserMedia&&c.mediaDevices&&c.mediaDevices.getUserMedia&&(c.getUserMedia=function(a,b,d){c.mediaDevices.getUserMedia(a).then(b,d)})};e.shimConstraints=b;e.shimRTCIceServerUrls=function(a){var b=a.RTCPeerConnection;a.RTCPeerConnection=function(a,e){if(a&&a.iceServers){for(var d=[],g=0;g<a.iceServers.length;g++){var h=a.iceServers[g];!h.hasOwnProperty("urls")&&h.hasOwnProperty("url")?(c.deprecated("RTCIceServer.url","RTCIceServer.urls"),h=JSON.parse(JSON.stringify(h)),
h.urls=h.url,delete h.url,d.push(h)):d.push(a.iceServers[g])}a.iceServers=d}return new b(a,e)};a.RTCPeerConnection.prototype=b.prototype;"generateCertificate"in a.RTCPeerConnection&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return b.generateCertificate}})};e.shimTrackEventTransceiver=function(b){"object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCTrackEvent&&"receiver"in b.RTCTrackEvent.prototype&&!("transceiver"in b.RTCTrackEvent.prototype)&&Object.defineProperty(b.RTCTrackEvent.prototype,
"transceiver",{get:function(){return{receiver:this.receiver}}})};e.shimCreateOfferLegacy=function(a){var b=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(a){if(a){"undefined"!==typeof a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var c=this.getTransceivers().find(function(a){return"audio"===a.receiver.track.kind});!1===a.offerToReceiveAudio&&c?"sendrecv"===c.direction?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":
"recvonly"===c.direction&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):!0!==a.offerToReceiveAudio||c||this.addTransceiver("audio");"undefined"!==typeof a.offerToReceiveVideo&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);c=this.getTransceivers().find(function(a){return"video"===a.receiver.track.kind});!1===a.offerToReceiveVideo&&c?"sendrecv"===c.direction?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":"recvonly"===c.direction&&(c.setDirection?c.setDirection("inactive"):
c.direction="inactive"):!0!==a.offerToReceiveVideo||c||this.addTransceiver("video")}return b.apply(this,arguments)}};var c=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(h("../utils"))},{"../utils":15}],15:[function(h,l,e){function b(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c;return a}function a(a,b,c){return(a=a.match(b))&&a.length>=c&&
parseInt(a[c],10)}function c(a){return"[object Object]"!==Object.prototype.toString.call(a)?a:Object.keys(a).reduce(function(d,e){var g="[object Object]"===Object.prototype.toString.call(a[e]),h=g?c(a[e]):a[e];g=g&&!Object.keys(h).length;return void 0===h||g?d:Object.assign(d,b({},e,h))},{})}function g(a,b,c){b&&!c.has(b.id)&&(c.set(b.id,b),Object.keys(b).forEach(function(d){d.endsWith("Id")?g(a,a.get(b[d]),c):d.endsWith("Ids")&&b[d].forEach(function(b){g(a,a.get(b),c)})}))}Object.defineProperty(e,
"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};e.extractVersion=a;e.wrapPeerConnectionEvent=function(a,b,c){if(a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var d=a.addEventListener;
a.addEventListener=function(a,e){if(a!==b)return d.apply(this,arguments);var g=function(a){(a=c(a))&&e(a)};this._eventMap=this._eventMap||{};this._eventMap[e]=g;return d.apply(this,[a,g])};var e=a.removeEventListener;a.removeEventListener=function(a,c){if(a!==b||!this._eventMap||!this._eventMap[c])return e.apply(this,arguments);var d=this._eventMap[c];delete this._eventMap[c];return e.apply(this,[a,d])};Object.defineProperty(a,"on"+b,{get:function(){return this["_on"+b]},set:function(a){this["_on"+
b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]);a&&this.addEventListener(b,this["_on"+b]=a)},enumerable:!0,configurable:!0})}};e.disableLog=function(a){return"boolean"!==typeof a?Error("Argument type: "+("undefined"===typeof a?"undefined":m(a))+". Please use a boolean."):(d=a)?"adapter.js logging disabled":"adapter.js logging enabled"};e.disableWarnings=function(a){if("boolean"!==typeof a)return Error("Argument type: "+("undefined"===typeof a?"undefined":m(a))+". Please use a boolean.");
n=!a;return"adapter.js deprecation warnings "+(a?"disabled":"enabled")};e.log=function(){"object"!==("undefined"===typeof window?"undefined":m(window))||d||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)};e.deprecated=function(a,b){n&&console.warn(a+" is deprecated, please use "+b+" instead.")};e.detectBrowser=function(b){var c=b.navigator,d={browser:null,version:null};if("undefined"===typeof b||!b.navigator)return d.browser="Not a browser.",d;c.mozGetUserMedia?
(d.browser="firefox",d.version=a(c.userAgent,/Firefox\/(\d+)\./,1)):c.webkitGetUserMedia||!1===b.isSecureContext&&b.webkitRTCPeerConnection&&!b.RTCIceGatherer?(d.browser="chrome",d.version=a(c.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):c.mediaDevices&&c.userAgent.match(/Edge\/(\d+).(\d+)$/)?(d.browser="edge",d.version=a(c.userAgent,/Edge\/(\d+).(\d+)$/,2)):b.RTCPeerConnection&&c.userAgent.match(/AppleWebKit\/(\d+)\./)?(d.browser="safari",d.version=a(c.userAgent,/AppleWebKit\/(\d+)\./,1),d.supportsUnifiedPlan=
b.RTCRtpTransceiver&&"currentDirection"in b.RTCRtpTransceiver.prototype):d.browser="Not a supported browser.";return d};e.compactObject=c;e.walkStats=g;e.filterStats=function(a,b,c){var d=c?"outbound-rtp":"inbound-rtp",e=new Map;if(null===b)return e;var h=[];a.forEach(function(a){"track"===a.type&&a.trackIdentifier===b.id&&h.push(a)});h.forEach(function(b){a.forEach(function(c){c.type===d&&c.trackId===b.id&&g(a,c,e)})});return e};var d=!0,n=!0},{}],16:[function(h,l,e){function b(a,b,c,d,e){b=n.writeRtpDescription(a.kind,
b);b+=n.writeIceParameters(a.iceGatherer.getLocalParameters());b+=n.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===c?"actpass":e||"active");b+="a=mid:"+a.mid+"\r\n";b=a.rtpSender&&a.rtpReceiver?b+"a=sendrecv\r\n":a.rtpSender?b+"a=sendonly\r\n":a.rtpReceiver?b+"a=recvonly\r\n":b+"a=inactive\r\n";a.rtpSender&&(c=a.rtpSender._initialTrackId||a.rtpSender.track.id,a.rtpSender._initialTrackId=c,d="msid:"+(d?d.id:"-")+" "+c+"\r\n",b=b+("a="+d)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+
" "+d),a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+d,b+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));b+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n");return b}function a(a,b){var c=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&
(a.urls||a.url)){var d=a.urls||a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var e="string"===typeof d;e&&(d=[d]);d=d.filter(function(a){return 0!==a.indexOf("turn:")||-1===a.indexOf("transport=udp")||-1!==a.indexOf("turn:[")||c?0===a.indexOf("stun:")&&14393<=b&&-1===a.indexOf("?transport=udp"):c=!0});delete a.url;a.urls=e?d[0]:d;return!!d.length}})}function c(a,b){var c={codecs:[],headerExtensions:[],fecMechanisms:[]},d=function(a,b){a=parseInt(a,10);for(var c=
0;c<b.length;c++)if(b[c].payloadType===a||b[c].preferredPayloadType===a)return b[c]},e=function(a,b,c,e){a=d(a.parameters.apt,c);b=d(b.parameters.apt,e);return a&&b&&a.name.toLowerCase()===b.name.toLowerCase()};a.codecs.forEach(function(d){for(var g=0;g<b.codecs.length;g++){var h=b.codecs[g];if(d.name.toLowerCase()===h.name.toLowerCase()&&d.clockRate===h.clockRate&&("rtx"!==d.name.toLowerCase()||!d.parameters||!h.parameters.apt||e(d,h,a.codecs,b.codecs))){h=JSON.parse(JSON.stringify(h));h.numChannels=
Math.min(d.numChannels,h.numChannels);c.codecs.push(h);h.rtcpFeedback=h.rtcpFeedback.filter(function(a){for(var b=0;b<d.rtcpFeedback.length;b++)if(d.rtcpFeedback[b].type===a.type&&d.rtcpFeedback[b].parameter===a.parameter)return!0;return!1});break}}});a.headerExtensions.forEach(function(a){for(var d=0;d<b.headerExtensions.length;d++){var e=b.headerExtensions[d];if(a.uri===e.uri){c.headerExtensions.push(e);break}}});return c}function g(a,b,c){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],
setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[b][a].indexOf(c)}function m(a,b){var c=a.getRemoteCandidates().find(function(a){return b.foundation===a.foundation&&b.ip===a.ip&&b.port===a.port&&b.priority===a.priority&&b.protocol===a.protocol&&b.type===a.type});c||a.addRemoteCandidate(b);return!c}function d(a,b){b=Error(b);b.name=a;b.code={NotSupportedError:9,
InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[a];return b}var n=h("sdp");l.exports=function(e,h){function l(a,b){b.addTrack(a);b.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:a}))}function p(a,b){b.removeTrack(a);b.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:a}))}function q(a,b,c,d){var f=new Event("track");f.track=b;f.receiver=c;f.transceiver={receiver:c};f.streams=d;e.setTimeout(function(){a._dispatchEvent("track",f)})}var r=
function(b){var c=this,f=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(a){c[a]=f[a].bind(f)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=[];this.remoteStreams=[];this._remoteDescription=this._localDescription=null;this.signalingState="stable";this.iceGatheringState=this.connectionState=this.iceConnectionState="new";b=JSON.parse(JSON.stringify(b||{}));this.usingBundle="max-bundle"===b.bundlePolicy;if("negotiate"===
b.rtcpMuxPolicy)throw d("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");b.rtcpMuxPolicy||(b.rtcpMuxPolicy="require");switch(b.iceTransportPolicy){case "all":case "relay":break;default:b.iceTransportPolicy="all"}switch(b.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:b.bundlePolicy="balanced"}b.iceServers=a(b.iceServers||[],h);this._iceGatherers=[];if(b.iceCandidatePoolSize)for(var g=b.iceCandidatePoolSize;0<g;g--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:b.iceServers,
gatherPolicy:b.iceTransportPolicy}));else b.iceCandidatePoolSize=0;this._config=b;this.transceivers=[];this._sdpSessionId=n.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;this._isClosed=!1};Object.defineProperty(r.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}});Object.defineProperty(r.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}});r.prototype.onicecandidate=null;r.prototype.onaddstream=
null;r.prototype.ontrack=null;r.prototype.onremovestream=null;r.prototype.onsignalingstatechange=null;r.prototype.oniceconnectionstatechange=null;r.prototype.onconnectionstatechange=null;r.prototype.onicegatheringstatechange=null;r.prototype.onnegotiationneeded=null;r.prototype.ondatachannel=null;r.prototype._dispatchEvent=function(a,b){if(!this._isClosed&&(this.dispatchEvent(b),"function"===typeof this["on"+a]))this["on"+a](b)};r.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");
this._dispatchEvent("icegatheringstatechange",a)};r.prototype.getConfiguration=function(){return this._config};r.prototype.getLocalStreams=function(){return this.localStreams};r.prototype.getRemoteStreams=function(){return this.remoteStreams};r.prototype._createTransceiver=function(a,b){var c=0<this.transceivers.length;a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,
recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};this.usingBundle&&c?(a.iceTransport=this.transceivers[0].iceTransport,a.dtlsTransport=this.transceivers[0].dtlsTransport):(c=this._createIceAndDtlsTransports(),a.iceTransport=c.iceTransport,a.dtlsTransport=c.dtlsTransport);b||this.transceivers.push(a);return a};r.prototype.addTrack=function(a,b){if(this._isClosed)throw d("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(b){return b.track===
a}))throw d("InvalidAccessError","Track already exists.");for(var c,g=0;g<this.transceivers.length;g++)this.transceivers[g].track||this.transceivers[g].kind!==a.kind||(c=this.transceivers[g]);c||(c=this._createTransceiver(a.kind));this._maybeFireNegotiationNeeded();-1===this.localStreams.indexOf(b)&&this.localStreams.push(b);c.track=a;c.stream=b;c.rtpSender=new e.RTCRtpSender(a,c.dtlsTransport);return c.rtpSender};r.prototype.addStream=function(a){var b=this;if(15025<=h)a.getTracks().forEach(function(c){b.addTrack(c,
a)});else{var c=a.clone();a.getTracks().forEach(function(a,b){var d=c.getTracks()[b];a.addEventListener("enabled",function(a){d.enabled=a.enabled})});c.getTracks().forEach(function(a){b.addTrack(a,c)})}};r.prototype.removeTrack=function(a){if(this._isClosed)throw d("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(a instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var b=this.transceivers.find(function(b){return b.rtpSender===
a});if(!b)throw d("InvalidAccessError","Sender was not created by this connection.");var c=b.stream;b.rtpSender.stop();b.rtpSender=null;b.track=null;b.stream=null;-1===this.transceivers.map(function(a){return a.stream}).indexOf(c)&&-1<this.localStreams.indexOf(c)&&this.localStreams.splice(this.localStreams.indexOf(c),1);this._maybeFireNegotiationNeeded()};r.prototype.removeStream=function(a){var b=this;a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});c&&
b.removeTrack(c)})};r.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})};r.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})};r.prototype._createIceGatherer=function(a,b){var c=this;if(b&&0<a)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var d=new e.RTCIceGatherer({iceServers:this._config.iceServers,
gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(d,"state",{value:"new",writable:!0});this.transceivers[a].bufferedCandidateEvents=[];this.transceivers[a].bufferCandidates=function(b){var e=!b.candidate||0===Object.keys(b.candidate).length;d.state=e?"completed":"gathering";null!==c.transceivers[a].bufferedCandidateEvents&&c.transceivers[a].bufferedCandidateEvents.push(b)};d.addEventListener("localcandidate",this.transceivers[a].bufferCandidates);return d};r.prototype._gather=function(a,
b){var c=this,d=this.transceivers[b].iceGatherer;if(!d.onlocalcandidate){var g=this.transceivers[b].bufferedCandidateEvents;this.transceivers[b].bufferedCandidateEvents=null;d.removeEventListener("localcandidate",this.transceivers[b].bufferCandidates);d.onlocalcandidate=function(e){if(!(c.usingBundle&&0<b)){var f=new Event("icecandidate");f.candidate={sdpMid:a,sdpMLineIndex:b};var g=e.candidate;if(e=!g||0===Object.keys(g).length){if("new"===d.state||"gathering"===d.state)d.state="completed"}else"new"===
d.state&&(d.state="gathering"),g.component=1,g.ufrag=d.getLocalParameters().usernameFragment,g=n.writeCandidate(g),f.candidate=Object.assign(f.candidate,n.parseCandidate(g)),f.candidate.candidate=g,f.candidate.toJSON=function(){return{candidate:f.candidate.candidate,sdpMid:f.candidate.sdpMid,sdpMLineIndex:f.candidate.sdpMLineIndex,usernameFragment:f.candidate.usernameFragment}};g=n.getMediaSections(c._localDescription.sdp);g[f.candidate.sdpMLineIndex]=e?g[f.candidate.sdpMLineIndex]+"a=end-of-candidates\r\n":
g[f.candidate.sdpMLineIndex]+("a="+f.candidate.candidate+"\r\n");c._localDescription.sdp=n.getDescription(c._localDescription.sdp)+g.join("");g=c.transceivers.every(function(a){return a.iceGatherer&&"completed"===a.iceGatherer.state});"gathering"!==c.iceGatheringState&&(c.iceGatheringState="gathering",c._emitGatheringStateChange());e||c._dispatchEvent("icecandidate",f);g&&(c._dispatchEvent("icecandidate",new Event("icecandidate")),c.iceGatheringState="complete",c._emitGatheringStateChange())}};e.setTimeout(function(){g.forEach(function(a){d.onlocalcandidate(a)})},
0)}};r.prototype._createIceAndDtlsTransports=function(){var a=this,b=new e.RTCIceTransport(null);b.onicestatechange=function(){a._updateIceConnectionState();a._updateConnectionState()};var c=new e.RTCDtlsTransport(b);c.ondtlsstatechange=function(){a._updateConnectionState()};c.onerror=function(){Object.defineProperty(c,"state",{value:"failed",writable:!0});a._updateConnectionState()};return{iceTransport:b,dtlsTransport:c}};r.prototype._disposeIceAndDtlsTransports=function(a){var b=this.transceivers[a].iceGatherer;
b&&(delete b.onlocalcandidate,delete this.transceivers[a].iceGatherer);if(b=this.transceivers[a].iceTransport)delete b.onicestatechange,delete this.transceivers[a].iceTransport;if(b=this.transceivers[a].dtlsTransport)delete b.ondtlsstatechange,delete b.onerror,delete this.transceivers[a].dtlsTransport};r.prototype._transceive=function(a,b,d){var e=c(a.localCapabilities,a.remoteCapabilities);b&&a.rtpSender&&(e.encodings=a.sendEncodingParameters,e.rtcp={cname:n.localCName,compound:a.rtcpParameters.compound},
a.recvEncodingParameters.length&&(e.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(e));d&&a.rtpReceiver&&0<e.codecs.length&&("video"===a.kind&&a.recvEncodingParameters&&15019>h&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),e.encodings=a.recvEncodingParameters.length?a.recvEncodingParameters:[{}],e.rtcp={compound:a.rtcpParameters.compound},a.rtcpParameters.cname&&(e.rtcp.cname=a.rtcpParameters.cname),a.sendEncodingParameters.length&&(e.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),
a.rtpReceiver.receive(e))};r.prototype.setLocalDescription=function(a){var b=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(d("TypeError",'Unsupported type "'+a.type+'"'));if(!g("setLocalDescription",a.type,b.signalingState)||b._isClosed)return Promise.reject(d("InvalidStateError","Can not set local "+a.type+" in state "+b.signalingState));if("offer"===a.type){var e=n.splitSections(a.sdp);var h=e.shift();e.forEach(function(a,c){a=n.parseRtpParameters(a);b.transceivers[c].localCapabilities=
a});b.transceivers.forEach(function(a,c){b._gather(a.mid,c)})}else if("answer"===a.type){e=n.splitSections(b._remoteDescription.sdp);h=e.shift();var l=0<n.matchPrefix(h,"a=ice-lite").length;e.forEach(function(a,d){var e=b.transceivers[d],f=e.iceGatherer,g=e.iceTransport,m=e.dtlsTransport,p=e.localCapabilities,q=e.remoteCapabilities;if(!(n.isRejected(a)&&0===n.matchPrefix(a,"a=bundle-only").length||e.rejected)){var r=n.getIceParameters(a,h);a=n.getDtlsParameters(a,h);l&&(a.role="server");b.usingBundle&&
0!==d||(b._gather(e.mid,d),"new"===g.state&&g.start(f,r,l?"controlling":"controlled"),"new"===m.state&&m.start(a));d=c(p,q);b._transceive(e,0<d.codecs.length,!1)}})}b._localDescription={type:a.type,sdp:a.sdp};"offer"===a.type?b._updateSignalingState("have-local-offer"):b._updateSignalingState("stable");return Promise.resolve()};r.prototype.setRemoteDescription=function(a){var b=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(d("TypeError",'Unsupported type "'+a.type+'"'));if(!g("setRemoteDescription",
a.type,b.signalingState)||b._isClosed)return Promise.reject(d("InvalidStateError","Can not set remote "+a.type+" in state "+b.signalingState));var f={};b.remoteStreams.forEach(function(a){f[a.id]=a});var r=[],u=n.splitSections(a.sdp),t=u.shift(),v=0<n.matchPrefix(t,"a=ice-lite").length,w=0<n.matchPrefix(t,"a=group:BUNDLE ").length;b.usingBundle=w;var z=n.matchPrefix(t,"a=ice-options:")[0];b.canTrickleIceCandidates=z?0<=z.substr(14).split(" ").indexOf("trickle"):!1;u.forEach(function(d,g){var k=n.splitLines(d),
q=n.getKind(d),u=n.isRejected(d)&&0===n.matchPrefix(d,"a=bundle-only").length,z=k[0].substr(2).split(" ")[2];k=n.getDirection(d,t);var x=n.parseMsid(d),F=n.getMid(d)||n.generateIdentifier();if(u||"application"===q&&("DTLS/SCTP"===z||"UDP/DTLS/SCTP"===z))b.transceivers[g]={mid:F,kind:q,protocol:z,rejected:!0};else{!u&&b.transceivers[g]&&b.transceivers[g].rejected&&(b.transceivers[g]=b._createTransceiver(q,!0));var D=n.parseRtpParameters(d);if(!u){var y=n.getIceParameters(d,t);var C=n.getDtlsParameters(d,
t);C.role="client"}z=n.parseRtpEncodingParameters(d);var P=n.parseRtcpParameters(d),I=0<n.matchPrefix(d,"a=end-of-candidates",t).length,O=n.matchPrefix(d,"a=candidate:").map(function(a){return n.parseCandidate(a)}).filter(function(a){return 1===a.component});("offer"===a.type||"answer"===a.type)&&!u&&w&&0<g&&b.transceivers[g]&&(b._disposeIceAndDtlsTransports(g),b.transceivers[g].iceGatherer=b.transceivers[0].iceGatherer,b.transceivers[g].iceTransport=b.transceivers[0].iceTransport,b.transceivers[g].dtlsTransport=
b.transceivers[0].dtlsTransport,b.transceivers[g].rtpSender&&b.transceivers[g].rtpSender.setTransport(b.transceivers[0].dtlsTransport),b.transceivers[g].rtpReceiver&&b.transceivers[g].rtpReceiver.setTransport(b.transceivers[0].dtlsTransport));if("offer"!==a.type||u)"answer"!==a.type||u||(B=b.transceivers[g],J=B.iceGatherer,q=B.iceTransport,F=B.dtlsTransport,H=B.rtpReceiver,u=B.sendEncodingParameters,d=B.localCapabilities,b.transceivers[g].recvEncodingParameters=z,b.transceivers[g].remoteCapabilities=
D,b.transceivers[g].rtcpParameters=P,O.length&&"new"===q.state&&(!v&&!I||w&&0!==g?O.forEach(function(a){m(B.iceTransport,a)}):q.setRemoteCandidates(O)),w&&0!==g||("new"===q.state&&q.start(J,y,"controlling"),"new"===F.state&&F.start(C)),!c(B.localCapabilities,B.remoteCapabilities).codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&B.sendEncodingParameters[0].rtx&&delete B.sendEncodingParameters[0].rtx,b._transceive(B,"sendrecv"===k||"recvonly"===k,"sendrecv"===k||"sendonly"===k),
!H||"sendrecv"!==k&&"sendonly"!==k?delete B.rtpReceiver:(k=H.track,x?(f[x.stream]||(f[x.stream]=new e.MediaStream),l(k,f[x.stream]),r.push([k,H,f[x.stream]])):(f.default||(f.default=new e.MediaStream),l(k,f.default),r.push([k,H,f.default]))));else{var B=b.transceivers[g]||b._createTransceiver(q);B.mid=F;B.iceGatherer||(B.iceGatherer=b._createIceGatherer(g,w));O.length&&"new"===B.iceTransport.state&&(!I||w&&0!==g?O.forEach(function(a){m(B.iceTransport,a)}):B.iceTransport.setRemoteCandidates(O));d=
e.RTCRtpReceiver.getCapabilities(q);15019>h&&(d.codecs=d.codecs.filter(function(a){return"rtx"!==a.name}));u=B.sendEncodingParameters||[{ssrc:1001*(2*g+2)}];y=!1;if("sendrecv"===k||"sendonly"===k){y=!B.rtpReceiver;var H=B.rtpReceiver||new e.RTCRtpReceiver(B.dtlsTransport,q);if(y){k=H.track;if(!x||"-"!==x.stream)if(x){f[x.stream]||(f[x.stream]=new e.MediaStream,Object.defineProperty(f[x.stream],"id",{get:function(){return x.stream}}));Object.defineProperty(k,"id",{get:function(){return x.track}});
var J=f[x.stream]}else f.default||(f.default=new e.MediaStream),J=f.default;J&&(l(k,J),B.associatedRemoteMediaStreams.push(J));r.push([k,H,J])}}else B.rtpReceiver&&B.rtpReceiver.track&&(B.associatedRemoteMediaStreams.forEach(function(a){var b=a.getTracks().find(function(a){return a.id===B.rtpReceiver.track.id});b&&p(b,a)}),B.associatedRemoteMediaStreams=[]);B.localCapabilities=d;B.remoteCapabilities=D;B.rtpReceiver=H;B.rtcpParameters=P;B.sendEncodingParameters=u;B.recvEncodingParameters=z;b._transceive(b.transceivers[g],
!1,y)}}});void 0===b._dtlsRole&&(b._dtlsRole="offer"===a.type?"active":"passive");b._remoteDescription={type:a.type,sdp:a.sdp};"offer"===a.type?b._updateSignalingState("have-remote-offer"):b._updateSignalingState("stable");Object.keys(f).forEach(function(a){var c=f[a];if(c.getTracks().length){if(-1===b.remoteStreams.indexOf(c)){b.remoteStreams.push(c);var d=new Event("addstream");d.stream=c;e.setTimeout(function(){b._dispatchEvent("addstream",d)})}r.forEach(function(a){c.id===a[2].id&&q(b,a[0],a[1],
[c])})}});r.forEach(function(a){a[2]||q(b,a[0],a[1],[])});e.setTimeout(function(){b&&b.transceivers&&b.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&0<a.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),a.iceTransport.addRemoteCandidate({}))})},4E3);return Promise.resolve()};r.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop();
a.dtlsTransport&&a.dtlsTransport.stop();a.rtpSender&&a.rtpSender.stop();a.rtpReceiver&&a.rtpReceiver.stop()});this._isClosed=!0;this._updateSignalingState("closed")};r.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",a)};r.prototype._maybeFireNegotiationNeeded=function(){var a=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout(function(){if(a.needNegotiation){a.needNegotiation=
!1;var b=new Event("negotiationneeded");a._dispatchEvent("negotiationneeded",b)}},0))};r.prototype._updateIceConnectionState=function(){var a={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&!b.rejected&&a[b.iceTransport.state]++});var b="new";0<a.failed?b="failed":0<a.checking?b="checking":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected?b="connected":0<a.completed&&(b="completed");b!==this.iceConnectionState&&
(this.iceConnectionState=b,b=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",b))};r.prototype._updateConnectionState=function(){var a={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&b.dtlsTransport&&!b.rejected&&(a[b.iceTransport.state]++,a[b.dtlsTransport.state]++)});a.connected+=a.completed;var b="new";0<a.failed?b="failed":0<a.connecting?b="connecting":0<a.disconnected?b="disconnected":
0<a.new?b="new":0<a.connected&&(b="connected");b!==this.connectionState&&(this.connectionState=b,b=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",b))};r.prototype.createOffer=function(a){var c=this;if(c._isClosed)return Promise.reject(d("InvalidStateError","Can not call createOffer after close"));var f=c.transceivers.filter(function(a){return"audio"===a.kind}).length,g=c.transceivers.filter(function(a){return"video"===a.kind}).length;if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");
void 0!==a.offerToReceiveAudio&&(f=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio);void 0!==a.offerToReceiveVideo&&(g=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(c.transceivers.forEach(function(a){"audio"===a.kind?(f--,0>f&&(a.wantReceive=!1)):"video"===a.kind&&(g--,0>g&&(a.wantReceive=!1))});0<f||0<g;)0<f&&(c._createTransceiver("audio"),f--),0<g&&(c._createTransceiver("video"),g--);var l=n.writeSessionBoilerplate(c._sdpSessionId,
c._sdpSessionVersion++);c.transceivers.forEach(function(a,b){var d=a.track,g=a.kind,f=a.mid||n.generateIdentifier();a.mid=f;a.iceGatherer||(a.iceGatherer=c._createIceGatherer(b,c.usingBundle));f=e.RTCRtpSender.getCapabilities(g);15019>h&&(f.codecs=f.codecs.filter(function(a){return"rtx"!==a.name}));f.codecs.forEach(function(b){"H264"===b.name&&void 0===b.parameters["level-asymmetry-allowed"]&&(b.parameters["level-asymmetry-allowed"]="1");a.remoteCapabilities&&a.remoteCapabilities.codecs&&a.remoteCapabilities.codecs.forEach(function(a){b.name.toLowerCase()===
a.name.toLowerCase()&&b.clockRate===a.clockRate&&(b.preferredPayloadType=a.payloadType)})});f.headerExtensions.forEach(function(b){(a.remoteCapabilities&&a.remoteCapabilities.headerExtensions||[]).forEach(function(a){b.uri===a.uri&&(b.id=a.id)})});b=a.sendEncodingParameters||[{ssrc:1001*(2*b+1)}];d&&15019<=h&&"video"===g&&!b[0].rtx&&(b[0].rtx={ssrc:b[0].ssrc+1});a.wantReceive&&(a.rtpReceiver=new e.RTCRtpReceiver(a.dtlsTransport,g));a.localCapabilities=f;a.sendEncodingParameters=b});"max-compat"!==
c._config.bundlePolicy&&(l+="a=group:BUNDLE "+c.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");l+="a=ice-options:trickle\r\n";c.transceivers.forEach(function(a,d){l+=b(a,a.localCapabilities,"offer",a.stream,c._dtlsRole);l+="a=rtcp-rsize\r\n";!a.iceGatherer||"new"===c.iceGatheringState||0!==d&&c.usingBundle||(a.iceGatherer.getLocalCandidates().forEach(function(a){a.component=1;l+="a="+n.writeCandidate(a)+"\r\n"}),"completed"===a.iceGatherer.state&&(l+="a=end-of-candidates\r\n"))});a=
new e.RTCSessionDescription({type:"offer",sdp:l});return Promise.resolve(a)};r.prototype.createAnswer=function(){var a=this;if(a._isClosed)return Promise.reject(d("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==a.signalingState&&"have-local-pranswer"!==a.signalingState)return Promise.reject(d("InvalidStateError","Can not call createAnswer in signalingState "+a.signalingState));var g=n.writeSessionBoilerplate(a._sdpSessionId,a._sdpSessionVersion++);a.usingBundle&&
(g+="a=group:BUNDLE "+a.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");g+="a=ice-options:trickle\r\n";var f=n.getMediaSections(a._remoteDescription.sdp).length;a.transceivers.forEach(function(d,e){if(!(e+1>f))if(d.rejected)"application"===d.kind?g="DTLS/SCTP"===d.protocol?g+"m=application 0 DTLS/SCTP 5000\r\n":g+("m=application 0 "+d.protocol+" webrtc-datachannel\r\n"):"audio"===d.kind?g+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===d.kind&&(g+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),
g+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+d.mid+"\r\n";else{if(d.stream){var l;"audio"===d.kind?l=d.stream.getAudioTracks()[0]:"video"===d.kind&&(l=d.stream.getVideoTracks()[0]);l&&15019<=h&&"video"===d.kind&&!d.sendEncodingParameters[0].rtx&&(d.sendEncodingParameters[0].rtx={ssrc:d.sendEncodingParameters[0].ssrc+1})}e=c(d.localCapabilities,d.remoteCapabilities);!e.codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&d.sendEncodingParameters[0].rtx&&delete d.sendEncodingParameters[0].rtx;
g+=b(d,e,"answer",d.stream,a._dtlsRole);d.rtcpParameters&&d.rtcpParameters.reducedSize&&(g+="a=rtcp-rsize\r\n")}});var l=new e.RTCSessionDescription({type:"answer",sdp:g});return Promise.resolve(l)};r.prototype.addIceCandidate=function(a){var b=this,c;return a&&void 0===a.sdpMLineIndex&&!a.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(e,g){if(b._remoteDescription)if(a&&""!==a.candidate){var f=a.sdpMLineIndex;if(a.sdpMid)for(var h=0;h<b.transceivers.length;h++)if(b.transceivers[h].mid===
a.sdpMid){f=h;break}var l=b.transceivers[f];if(l){if(l.rejected)return e();h=0<Object.keys(a.candidate).length?n.parseCandidate(a.candidate):{};if("tcp"===h.protocol&&(0===h.port||9===h.port)||h.component&&1!==h.component)return e();if((0===f||0<f&&l.iceTransport!==b.transceivers[0].iceTransport)&&!m(l.iceTransport,h))return g(d("OperationError","Can not add ICE candidate"));g=a.candidate.trim();0===g.indexOf("a=")&&(g=g.substr(2));c=n.getMediaSections(b._remoteDescription.sdp);c[f]+="a="+(h.type?
g:"end-of-candidates")+"\r\n";b._remoteDescription.sdp=n.getDescription(b._remoteDescription.sdp)+c.join("")}else return g(d("OperationError","Can not add ICE candidate"))}else for(f=0;f<b.transceivers.length&&(b.transceivers[f].rejected||(b.transceivers[f].iceTransport.addRemoteCandidate({}),c=n.getMediaSections(b._remoteDescription.sdp),c[f]+="a=end-of-candidates\r\n",b._remoteDescription.sdp=n.getDescription(b._remoteDescription.sdp)+c.join(""),!b.usingBundle));f++);else return g(d("InvalidStateError",
"Can not add ICE candidate without a remote description"));e()})};r.prototype.getStats=function(a){if(a&&a instanceof e.MediaStreamTrack){var b=null;this.transceivers.forEach(function(c){c.rtpSender&&c.rtpSender.track===a?b=c.rtpSender:c.rtpReceiver&&c.rtpReceiver.track===a&&(b=c.rtpReceiver)});if(!b)throw d("InvalidAccessError","Invalid selector.");return b.getStats()}var c=[];this.transceivers.forEach(function(a){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(b){a[b]&&
c.push(a[b].getStats())})});return Promise.all(c).then(function(a){var b=new Map;a.forEach(function(a){a.forEach(function(a){b.set(a.id,a)})});return b})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(a){if((a=e[a])&&a.prototype&&a.prototype.getStats){var b=a.prototype.getStats;a.prototype.getStats=function(){return b.apply(this).then(function(a){var b=new Map;Object.keys(a).forEach(function(c){var d=a[c];a[c].type={inboundrtp:"inbound-rtp",
outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type;b.set(c,a[c])});return b})}}});var t=["createOffer","createAnswer"];t.forEach(function(a){var b=r.prototype[a];r.prototype[a]=function(){var a=arguments;return"function"===typeof a[0]||"function"===typeof a[1]?b.apply(this,[arguments[2]]).then(function(b){"function"===typeof a[0]&&a[0].apply(null,[b])},function(b){"function"===typeof a[1]&&a[1].apply(null,
[b])}):b.apply(this,arguments)}});t=["setLocalDescription","setRemoteDescription","addIceCandidate"];t.forEach(function(a){var b=r.prototype[a];r.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]||"function"===typeof a[2]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)},function(b){"function"===typeof a[2]&&a[2].apply(null,[b])}):b.apply(this,arguments)}});["getStats"].forEach(function(a){var b=r.prototype[a];r.prototype[a]=function(){var a=
arguments;return"function"===typeof a[1]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)}):b.apply(this,arguments)}});return r}},{sdp:17}],17:[function(h,l,e){var b={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};b.localCName=b.generateIdentifier();b.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};b.splitSections=function(a){return a.split("\nm=").map(function(a,b){return(0<b?"m="+a:a).trim()+
"\r\n"})};b.getDescription=function(a){return(a=b.splitSections(a))&&a[0]};b.getMediaSections=function(a){a=b.splitSections(a);a.shift();return a};b.matchPrefix=function(a,c){return b.splitLines(a).filter(function(a){return 0===a.indexOf(c)})};b.parseCandidate=function(a){a=0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var b={foundation:a[0],component:parseInt(a[1],10),protocol:a[2].toLowerCase(),priority:parseInt(a[3],10),ip:a[4],address:a[4],port:parseInt(a[5],
10),type:a[7]},e=8;e<a.length;e+=2)switch(a[e]){case "raddr":b.relatedAddress=a[e+1];break;case "rport":b.relatedPort=parseInt(a[e+1],10);break;case "tcptype":b.tcpType=a[e+1];break;case "ufrag":b.ufrag=a[e+1];b.usernameFragment=a[e+1];break;default:b[a[e]]=a[e+1]}return b};b.writeCandidate=function(a){var b=[];b.push(a.foundation);b.push(a.component);b.push(a.protocol.toUpperCase());b.push(a.priority);b.push(a.address||a.ip);b.push(a.port);var e=a.type;b.push("typ");b.push(e);"host"!==e&&a.relatedAddress&&
a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort));a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(b.push("tcptype"),b.push(a.tcpType));if(a.usernameFragment||a.ufrag)b.push("ufrag"),b.push(a.usernameFragment||a.ufrag);return"candidate:"+b.join(" ")};b.parseIceOptions=function(a){return a.substr(14).split(" ")};b.parseRtpMap=function(a){a=a.substr(9).split(" ");var b={payloadType:parseInt(a.shift(),10)};a=a[0].split("/");b.name=a[0];b.clockRate=parseInt(a[1],
10);b.channels=3===a.length?parseInt(a[2],10):1;b.numChannels=b.channels;return b};b.writeRtpMap=function(a){var b=a.payloadType;void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType);var e=a.channels||a.numChannels||1;return"a=rtpmap:"+b+" "+a.name+"/"+a.clockRate+(1!==e?"/"+e:"")+"\r\n"};b.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",uri:a[1]}};b.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+
(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};b.parseFmtp=function(a){for(var b={},e=a.substr(a.indexOf(" ")+1).split(";"),h=0;h<e.length;h++)a=e[h].trim().split("="),b[a[0].trim()]=a[1];return b};b.writeFmtp=function(a){var b="",e=a.payloadType;void 0!==a.preferredPayloadType&&(e=a.preferredPayloadType);if(a.parameters&&Object.keys(a.parameters).length){var h=[];Object.keys(a.parameters).forEach(function(b){a.parameters[b]?h.push(b+"="+a.parameters[b]):h.push(b)});
b+="a=fmtp:"+e+" "+h.join(";")+"\r\n"}return b};b.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};b.writeRtcpFb=function(a){var b="",e=a.payloadType;void 0!==a.preferredPayloadType&&(e=a.preferredPayloadType);a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){b+="a=rtcp-fb:"+e+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"});return b};b.parseSsrcMedia=function(a){var b=a.indexOf(" "),e={ssrc:parseInt(a.substr(7,
b-7),10)},h=a.indexOf(":",b);-1<h?(e.attribute=a.substr(b+1,h-b-1),e.value=a.substr(h+1)):e.attribute=a.substr(b+1);return e};b.parseSsrcGroup=function(a){a=a.substr(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(function(a){return parseInt(a,10)})}};b.getMid=function(a){if(a=b.matchPrefix(a,"a=mid:")[0])return a.substr(6)};b.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};b.getDtlsParameters=function(a,c){return{role:"auto",fingerprints:b.matchPrefix(a+
c,"a=fingerprint:").map(b.parseFingerprint)}};b.writeDtlsParameters=function(a,b){var c="a=setup:"+b+"\r\n";a.fingerprints.forEach(function(a){c+="a=fingerprint:"+a.algorithm+" "+a.value+"\r\n"});return c};b.getIceParameters=function(a,c){a=b.splitLines(a);a=a.concat(b.splitLines(c));return{usernameFragment:a.filter(function(a){return 0===a.indexOf("a=ice-ufrag:")})[0].substr(12),password:a.filter(function(a){return 0===a.indexOf("a=ice-pwd:")})[0].substr(10)}};b.writeIceParameters=function(a){return"a=ice-ufrag:"+
a.usernameFragment+"\r\na=ice-pwd:"+(a.password+"\r\n")};b.parseRtpParameters=function(a){for(var c={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},e=b.splitLines(a)[0].split(" "),h=3;h<e.length;h++){var d=e[h],l=b.matchPrefix(a,"a=rtpmap:"+d+" ")[0];if(l){l=b.parseRtpMap(l);var m=b.matchPrefix(a,"a=fmtp:"+d+" ");l.parameters=m.length?b.parseFmtp(m[0]):{};l.rtcpFeedback=b.matchPrefix(a,"a=rtcp-fb:"+d+" ").map(b.parseRtcpFb);c.codecs.push(l);switch(l.name.toUpperCase()){case "RED":case "ULPFEC":c.fecMechanisms.push(l.name.toUpperCase())}}}b.matchPrefix(a,
"a=extmap:").forEach(function(a){c.headerExtensions.push(b.parseExtmap(a))});return c};b.writeRtpDescription=function(a,c){var e="";e+="m="+a+" ";e+=0<c.codecs.length?"9":"0";e+=" UDP/TLS/RTP/SAVPF ";e+=c.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n";e+="c=IN IP4 0.0.0.0\r\n";e+="a=rtcp:9 IN IP4 0.0.0.0\r\n";c.codecs.forEach(function(a){e+=b.writeRtpMap(a);e+=b.writeFmtp(a);e+=b.writeRtcpFb(a)});var h=0;c.codecs.forEach(function(a){a.maxptime>
h&&(h=a.maxptime)});0<h&&(e+="a=maxptime:"+h+"\r\n");e+="a=rtcp-mux\r\n";c.headerExtensions&&c.headerExtensions.forEach(function(a){e+=b.writeExtmap(a)});return e};b.parseRtpEncodingParameters=function(a){var c=[],e=b.parseRtpParameters(a),h=-1!==e.fecMechanisms.indexOf("RED"),d=-1!==e.fecMechanisms.indexOf("ULPFEC"),l=b.matchPrefix(a,"a=ssrc:").map(function(a){return b.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute}),m=0<l.length&&l[0].ssrc,n;l=b.matchPrefix(a,"a=ssrc-group:FID").map(function(a){return a.substr(17).split(" ").map(function(a){return parseInt(a,
10)})});0<l.length&&1<l[0].length&&l[0][0]===m&&(n=l[0][1]);e.codecs.forEach(function(a){"RTX"===a.name.toUpperCase()&&a.parameters.apt&&(a={ssrc:m,codecPayloadType:parseInt(a.parameters.apt,10)},m&&n&&(a.rtx={ssrc:n}),c.push(a),h&&(a=JSON.parse(JSON.stringify(a)),a.fec={ssrc:m,mechanism:d?"red+ulpfec":"red"},c.push(a)))});0===c.length&&m&&c.push({ssrc:m});var t=b.matchPrefix(a,"b=");t.length&&(t=0===t[0].indexOf("b=TIAS:")?parseInt(t[0].substr(7),10):0===t[0].indexOf("b=AS:")?950*parseInt(t[0].substr(5),
10)-16E3:void 0,c.forEach(function(a){a.maxBitrate=t}));return c};b.parseRtcpParameters=function(a){var c={},e=b.matchPrefix(a,"a=ssrc:").map(function(a){return b.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute})[0];e&&(c.cname=e.value,c.ssrc=e.ssrc);e=b.matchPrefix(a,"a=rtcp-rsize");c.reducedSize=0<e.length;c.compound=0===e.length;a=b.matchPrefix(a,"a=rtcp-mux");c.mux=0<a.length;return c};b.parseMsid=function(a){var c=b.matchPrefix(a,"a=msid:");if(1===c.length)return a=c[0].substr(7).split(" "),
{stream:a[0],track:a[1]};a=b.matchPrefix(a,"a=ssrc:").map(function(a){return b.parseSsrcMedia(a)}).filter(function(a){return"msid"===a.attribute});if(0<a.length)return a=a[0].value.split(" "),{stream:a[0],track:a[1]}};b.generateSessionId=function(){return Math.random().toString().substr(2,21)};b.writeSessionBoilerplate=function(a,c,e){c=void 0!==c?c:2;a=a?a:b.generateSessionId();return"v=0\r\no="+(e||"thisisadapterortc")+" "+a+" "+c+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};b.writeMediaSection=function(a,
c,e,h){c=b.writeRtpDescription(a.kind,c);c+=b.writeIceParameters(a.iceGatherer.getLocalParameters());c+=b.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===e?"actpass":"active");c+="a=mid:"+a.mid+"\r\n";c=a.direction?c+("a="+a.direction+"\r\n"):a.rtpSender&&a.rtpReceiver?c+"a=sendrecv\r\n":a.rtpSender?c+"a=sendonly\r\n":a.rtpReceiver?c+"a=recvonly\r\n":c+"a=inactive\r\n";a.rtpSender&&(e="msid:"+h.id+" "+a.rtpSender.track.id+"\r\n",c=c+("a="+e)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+
" "+e),a.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+e,c+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));c+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+b.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+b.localCName+"\r\n");return c};b.getDirection=function(a,c){a=b.splitLines(a);for(var e=0;e<a.length;e++)switch(a[e]){case "a=sendrecv":case "a=sendonly":case "a=recvonly":case "a=inactive":return a[e].substr(2)}return c?
b.getDirection(c):"sendrecv"};b.getKind=function(a){return b.splitLines(a)[0].split(" ")[0].substr(2)};b.isRejected=function(a){return"0"===a.split(" ",2)[1]};b.parseMLine=function(a){a=b.splitLines(a)[0].substr(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}};b.parseOLine=function(a){a=b.matchPrefix(a,"o=")[0].substr(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}};b.isValidSDP=
function(a){if("string"!==typeof a||0===a.length)return!1;a=b.splitLines(a);for(var c=0;c<a.length;c++)if(2>a[c].length||"="!==a[c].charAt(1))return!1;return!0};"object"===typeof l&&(l.exports=b)},{}]},{},[1])(1)}()},function(m,t,n){n(83)(n(84))},function(m,t){m.exports=function(m){function h(h){"undefined"!==typeof console&&(console.error||console.log)("[Script Loader]",h)}try{"undefined"!==typeof execScript&&"undefined"!==typeof attachEvent&&"undefined"===typeof addEventListener?execScript(m):"undefined"!==
typeof eval?eval.call(null,m):h("EvalError: No eval function available")}catch(l){h(l)}}},function(m,t){m.exports="/* globals $$, jQuery, Elements, document, window, L */\n\n/**\n* Copyright 2013 Marc J. Schmidt. See the LICENSE file at the top-level\n* directory of this distribution and at\n* https://github.com/marcj/css-element-queries/blob/master/LICENSE.\n*/\nthis.L = this.L || {};\n\n/**\n * @param {HTMLElement} element\n * @param {String}      prop\n * @returns {String|Number}\n */\nL.GetComputedStyle = (computedElement, prop) => {\n  if (computedElement.currentStyle) {\n    return computedElement.currentStyle[prop];\n  } else if (window.getComputedStyle) {\n    return window.getComputedStyle(computedElement, null).getPropertyValue(prop);\n  }\n  return computedElement.style[prop];\n};\n\n/**\n *\n * @type {Function}\n * @constructor\n */\nL.ElementQueries = function ElementQueries() {\n  /**\n   *\n   * @param element\n   * @returns {Number}\n   */\n  function getEmSize(element = document.documentElement) {\n    const fontSize = L.GetComputedStyle(element, 'fontSize');\n    return parseFloat(fontSize) || 16;\n  }\n\n  /**\n   *\n   * @copyright https://github.com/Mr0grog/element-query/blob/master/LICENSE\n   *\n   * @param element\n   * @param value\n   * @param units\n   * @returns {*}\n   */\n  function convertToPx(element, originalValue) {\n    let vh;\n    let vw;\n    let chooser;\n    const units = originalValue.replace(/[0-9]*/, '');\n    const value = parseFloat(originalValue);\n    switch (units) {\n      case 'px':\n        return value;\n      case 'em':\n        return value * getEmSize(element);\n      case 'rem':\n        return value * getEmSize();\n      // Viewport units!\n      // According to http://quirksmode.org/mobile/tableViewport.html\n      // documentElement.clientWidth/Height gets us the most reliable info\n      case 'vw':\n        return (value * document.documentElement.clientWidth) / 100;\n      case 'vh':\n        return (value * document.documentElement.clientHeight) / 100;\n      case 'vmin':\n      case 'vmax':\n        vw = document.documentElement.clientWidth / 100;\n        vh = document.documentElement.clientHeight / 100;\n        chooser = Math[units === 'vmin' ? 'min' : 'max'];\n        return value * chooser(vw, vh);\n      default:\n        return value;\n      // for now, not supporting physical units (since they are just a set number of px)\n      // or ex/ch (getting accurate measurements is hard)\n    }\n  }\n\n  /**\n   *\n   * @param {HTMLElement} element\n   * @constructor\n   */\n  function SetupInformation(element) {\n    this.element = element;\n    this.options = [];\n    let i;\n    let j;\n    let option;\n    let width = 0;\n    let height = 0;\n    let value;\n    let actualValue;\n    let attrValues;\n    let attrValue;\n    let attrName;\n\n    /**\n     * @param option {mode: 'min|max', property: 'width|height', value: '123px'}\n     */\n    this.addOption = (newOption) => {\n      this.options.push(newOption);\n    };\n\n    const attributes = ['min-width', 'min-height', 'max-width', 'max-height'];\n\n    /**\n     * Extracts the computed width/height and sets to min/max- attribute.\n     */\n    this.call = () => {\n      // extract current dimensions\n      width = this.element.offsetWidth;\n      height = this.element.offsetHeight;\n\n      attrValues = {};\n\n      for (i = 0, j = this.options.length; i < j; i += 1) {\n        option = this.options[i];\n        value = convertToPx(this.element, option.value);\n\n        actualValue = option.property === 'width' ? width : height;\n        attrName = `${option.mode}-${option.property}`;\n        attrValue = '';\n\n        if (option.mode === 'min' && actualValue >= value) {\n          attrValue += option.value;\n        }\n\n        if (option.mode === 'max' && actualValue <= value) {\n          attrValue += option.value;\n        }\n\n        if (!attrValues[attrName]) attrValues[attrName] = '';\n        if (attrValue && (` ${attrValues[attrName]} `)\n          .indexOf(` ${attrValue} `) === -1) {\n          attrValues[attrName] += ` ${attrValue}`;\n        }\n      }\n\n      for (let k = 0; k < attributes.length; k += 1) {\n        if (attrValues[attributes[k]]) {\n          this.element.setAttribute(\n            attributes[k],\n            attrValues[attributes[k]].substr(1),\n          );\n        } else {\n          this.element.removeAttribute(attributes[k]);\n        }\n      }\n    };\n  }\n\n  /**\n   * @param {HTMLElement} element\n   * @param {Object}      options\n   */\n  function setupElement(originalElement, options) {\n    const element = originalElement;\n    if (element.elementQueriesSetupInformation) {\n      element.elementQueriesSetupInformation.addOption(options);\n    } else {\n      element.elementQueriesSetupInformation = new SetupInformation(element);\n      element.elementQueriesSetupInformation.addOption(options);\n      element.sensor = new L.ResizeSensor(element, () => {\n        element.elementQueriesSetupInformation.call();\n      });\n    }\n    element.elementQueriesSetupInformation.call();\n    return element;\n  }\n\n  /**\n   * @param {String} selector\n   * @param {String} mode min|max\n   * @param {String} property width|height\n   * @param {String} value\n   */\n  function queueQuery(selector, mode, property, value) {\n    let query;\n    if (document.querySelectorAll) query = document.querySelectorAll.bind(document);\n    if (!query && typeof $$ !== 'undefined') query = $$;\n    if (!query && typeof jQuery !== 'undefined') query = jQuery;\n\n    if (!query) {\n      throw new Error('No document.querySelectorAll, jQuery or Mootools\\'s $$ found.');\n    }\n\n    const elements = query(selector) || [];\n    for (let i = 0, j = elements.length; i < j; i += 1) {\n      elements[i] = setupElement(elements[i], {\n        mode,\n        property,\n        value,\n      });\n    }\n  }\n\n  const regex = /,?([^,\\n]*)\\[[\\s\\t]*(min|max)-(width|height)[\\s\\t]*[~$^]?=[\\s\\t]*\"([^\"]*)\"[\\s\\t]*]([^\\n\\s{]*)/mgi; // jshint ignore:line\n\n  /**\n   * @param {String} css\n   */\n  function extractQuery(originalCss) {\n    let match;\n    const css = originalCss.replace(/'/g, '\"');\n    while ((match = regex.exec(css)) !== null) {\n      if (match.length > 5) {\n        queueQuery(match[1] || match[5], match[2], match[3], match[4]);\n      }\n    }\n  }\n\n  /**\n   * @param {CssRule[]|String} rules\n   */\n  function readRules(originalRules) {\n    if (!originalRules) {\n      return;\n    }\n    let selector = '';\n    let rules = originalRules;\n    if (typeof originalRules === 'string') {\n      rules = originalRules.toLowerCase();\n      if (rules.indexOf('min-width') !== -1 || rules.indexOf('max-width') !== -1) {\n        extractQuery(rules);\n      }\n    } else {\n      for (let i = 0, j = rules.length; i < j; i += 1) {\n        if (rules[i].type === 1) {\n          selector = rules[i].selectorText || rules[i].cssText;\n          if (selector.indexOf('min-height') !== -1 ||\n            selector.indexOf('max-height') !== -1) {\n            extractQuery(selector);\n          } else if (selector.indexOf('min-width') !== -1 ||\n            selector.indexOf('max-width') !== -1) {\n            extractQuery(selector);\n          }\n        } else if (rules[i].type === 4) {\n          readRules(rules[i].cssRules || rules[i].rules);\n        }\n      }\n    }\n  }\n\n  /**\n   * Searches all css rules and setups the event listener\n   * to all elements with element query rules..\n   */\n  this.init = () => {\n    const styleSheets = document.styleSheets || [];\n    for (let i = 0, j = styleSheets.length; i < j; i += 1) {\n      readRules(styleSheets[i].cssText ||\n        styleSheets[i].cssRules ||\n        styleSheets[i].rules);\n    }\n  };\n};\n\nfunction init() {\n  (new L.ElementQueries()).init();\n}\n\nif (window.addEventListener) {\n  window.addEventListener('load', init, false);\n} else {\n  window.attachEvent('onload', init);\n}\n\n/**\n * Iterate over each of the provided element(s).\n *\n * @param {HTMLElement|HTMLElement[]} elements\n * @param {Function}                  callback\n */\nfunction forEachElement(elements, callback = () => { }) {\n  const elementsType = Object.prototype.toString.call(elements);\n  const isCollectionTyped = (elementsType === '[object Array]' ||\n    (elementsType === '[object NodeList]') ||\n    (elementsType === '[object HTMLCollection]') ||\n    (typeof jQuery !== 'undefined' && elements instanceof jQuery) || // jquery\n    (typeof Elements !== 'undefined' && elements instanceof Elements) // mootools\n  );\n  let i = 0;\n  const j = elements.length;\n  if (isCollectionTyped) {\n    for (; i < j; i += 1) {\n      callback(elements[i]);\n    }\n  } else {\n    callback(elements);\n  }\n}\n/**\n * Class for dimension change detection.\n *\n * @param {Element|Element[]|Elements|jQuery} element\n * @param {Function} callback\n *\n * @constructor\n */\nL.ResizeSensor = function ResizeSensor(element, callback = () => { }) {\n  /**\n   *\n   * @constructor\n   */\n  function EventQueue() {\n    let q = [];\n    this.add = (ev) => {\n      q.push(ev);\n    };\n\n    let i;\n    let j;\n    this.call = () => {\n      for (i = 0, j = q.length; i < j; i += 1) {\n        q[i].call();\n      }\n    };\n\n    this.remove = (ev) => {\n      const newQueue = [];\n      for (i = 0, j = q.length; i < j; i += 1) {\n        if (q[i] !== ev) newQueue.push(q[i]);\n      }\n      q = newQueue;\n    };\n\n    this.length = () => q.length;\n  }\n\n  /**\n   *\n   * @param {HTMLElement} element\n   * @param {Function}    resized\n   */\n  function attachResizeEvent(htmlElement, resized) {\n    // Only used for the dirty checking, so the event callback count is limted\n    //  to max 1 call per fps per sensor.\n    // In combination with the event based resize sensor this saves cpu time,\n    // because the sensor is too fast and\n    // would generate too many unnecessary events.\n    const customRequestAnimationFrame = window.requestAnimationFrame ||\n      window.mozRequestAnimationFrame ||\n      window.webkitRequestAnimationFrame ||\n      function delay(fn) {\n        return window.setTimeout(fn, 20);\n      };\n\n    const newElement = htmlElement;\n    if (!newElement.resizedAttached) {\n      newElement.resizedAttached = new EventQueue();\n      newElement.resizedAttached.add(resized);\n    } else if (newElement.resizedAttached) {\n      newElement.resizedAttached.add(resized);\n      return;\n    }\n\n    newElement.resizeSensor = document.createElement('div');\n    newElement.resizeSensor.className = 'resize-sensor';\n    const style = 'position: absolute; left: 0; top: 0; right: 0; bottom: 0; ' +\n      'overflow: hidden; z-index: -1; visibility: hidden;';\n    const styleChild = 'position: absolute; left: 0; top: 0; transition: 0s;';\n\n    newElement.resizeSensor.style.cssText = style;\n    newElement.resizeSensor.innerHTML =\n      `<div class=\"resize-sensor-expand\" style=\"${style}\">` +\n      `<div style=\"${styleChild}\"></div>` +\n      '</div>' +\n      `<div class=\"resize-sensor-shrink\" style=\"${style}\">` +\n      `<div style=\"${styleChild} width: 200%; height: 200%\"></div>` +\n      '</div>';\n    newElement.appendChild(newElement.resizeSensor);\n\n    if (L.GetComputedStyle(newElement, 'position') === 'static') {\n      newElement.style.position = 'relative';\n    }\n\n    const expand = newElement.resizeSensor.childNodes[0];\n    const expandChild = expand.childNodes[0];\n    const shrink = newElement.resizeSensor.childNodes[1];\n\n    const reset = () => {\n      expandChild.style.width = `${100000}px`;\n      expandChild.style.height = `${100000}px`;\n\n      expand.scrollLeft = 100000;\n      expand.scrollTop = 100000;\n\n      shrink.scrollLeft = 100000;\n      shrink.scrollTop = 100000;\n    };\n\n    reset();\n    let dirty = false;\n\n    const dirtyChecking = () => {\n      if (!newElement.resizedAttached) return;\n\n      if (dirty) {\n        newElement.resizedAttached.call();\n        dirty = false;\n      }\n\n      customRequestAnimationFrame(dirtyChecking);\n    };\n\n    customRequestAnimationFrame(dirtyChecking);\n    let lastWidth;\n    let lastHeight;\n    let cachedWidth;\n    let cachedHeight; // useful to not query offsetWidth twice\n\n    const onScroll = () => {\n      if ((cachedWidth = newElement.offsetWidth) !== lastWidth ||\n        (cachedHeight = newElement.offsetHeight) !== lastHeight) {\n        dirty = true;\n\n        lastWidth = cachedWidth;\n        lastHeight = cachedHeight;\n      }\n      reset();\n    };\n\n    const addEvent = (el, name, cb) => {\n      if (el.attachEvent) {\n        el.attachEvent(`on${name}`, cb);\n      } else {\n        el.addEventListener(name, cb);\n      }\n    };\n\n    addEvent(expand, 'scroll', onScroll);\n    addEvent(shrink, 'scroll', onScroll);\n  }\n\n  forEachElement(element, (elem) => {\n    attachResizeEvent(elem, callback);\n  });\n\n  this.detach = (ev) => {\n    L.ResizeSensor.detach(element, ev);\n  };\n};\n\nL.ResizeSensor.detach = (element, ev) => {\n  forEachElement(element, (elem) => {\n    const elementItem = elem;\n    if (elementItem.resizedAttached && typeof ev === 'function') {\n      elementItem.resizedAttached.remove(ev);\n      if (elementItem.resizedAttached.length()) return;\n    }\n    if (elementItem.resizeSensor) {\n      if (elementItem.contains(elementItem.resizeSensor)) {\n        elementItem.removeChild(elementItem.resizeSensor);\n      }\n      delete elementItem.resizeSensor;\n      delete elementItem.resizedAttached;\n    }\n  });\n};\n"}])["default"];

//# sourceMappingURL=EnxRtc.js.map